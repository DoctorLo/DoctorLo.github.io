<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2019CSP-Jæ™®åŠç»„å¤èµ›é¢˜è§£</title>
      <link href="/2019/11/26/2019CSP-J/"/>
      <url>/2019/11/26/2019CSP-J/</url>
      
        <content type="html"><![CDATA[<h4 id="A-æ•°å­—æ¸¸æˆ"><a href="#A-æ•°å­—æ¸¸æˆ" class="headerlink" title="A.æ•°å­—æ¸¸æˆ"></a>A.æ•°å­—æ¸¸æˆ</h4><p><strong>é¢˜æ„æè¿°</strong><br>å° K åŒå­¦å‘å° P åŒå­¦å‘é€äº†ä¸€ä¸ªé•¿åº¦ä¸º 8 çš„ 01 å­—ç¬¦ä¸²æ¥ç©æ•°å­—æ¸¸æˆï¼Œå° P åŒå­¦æƒ³ è¦çŸ¥é“å­—ç¬¦ä¸²ä¸­ç©¶ç«Ÿæœ‰å¤šå°‘ä¸ª 1ã€‚<br> æ³¨æ„ï¼š01 å­—ç¬¦ä¸²ä¸ºæ¯ä¸€ä¸ªå­—ç¬¦æ˜¯ 0 æˆ–è€… 1 çš„å­—ç¬¦ä¸²ï¼Œå¦‚â€œ101â€ï¼ˆä¸å«åŒå¼•å·ï¼‰ä¸ºä¸€ ä¸ªé•¿åº¦ä¸º 3 çš„ 01 å­—ç¬¦ä¸²ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>ç­¾åˆ°é¢˜ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="built_in">string</span> str;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; str;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;str[i];i++) <span class="keyword">if</span>(str[i] == <span class="string">'1'</span>) cnt++;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; cnt &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="B-å…¬è½¦æ¢ä¹˜"><a href="#B-å…¬è½¦æ¢ä¹˜" class="headerlink" title="B.å…¬è½¦æ¢ä¹˜"></a>B.å…¬è½¦æ¢ä¹˜</h4><p><strong>é¢˜æ„æè¿°</strong><br>è‘—åæ—…æ¸¸åŸå¸‚ B å¸‚ä¸ºäº†é¼“åŠ±å¤§å®¶é‡‡ç”¨å…¬å…±äº¤é€šæ–¹å¼å‡ºè¡Œï¼Œæ¨å‡ºäº†ä¸€ç§åœ°é“æ¢ä¹˜å…¬äº¤ è½¦çš„ä¼˜æƒ æ–¹æ¡ˆï¼šåœ¨æ­ä¹˜ä¸€æ¬¡åœ°é“åå¯ä»¥è·å¾—ä¸€å¼ ä¼˜æƒ ç¥¨ï¼Œæœ‰æ•ˆæœŸä¸º 45 åˆ†é’Ÿï¼Œåœ¨æœ‰æ•ˆæœŸå†…å¯ä»¥ æ¶ˆè€—è¿™å¼ ä¼˜æƒ ç¥¨ï¼Œå…è´¹æ­ä¹˜ä¸€æ¬¡ç¥¨ä»·ä¸è¶…è¿‡åœ°é“ç¥¨ä»·çš„å…¬äº¤è½¦ã€‚åœ¨æœ‰æ•ˆæœŸå†…æŒ‡ å¼€å§‹ä¹˜å…¬äº¤è½¦çš„æ—¶é—´ä¸å¼€å§‹ä¹˜åœ°é“çš„æ—¶é—´ä¹‹å·®å°äºç­‰äº 45 åˆ†é’Ÿï¼Œå³ï¼š$t_{bus} - t_{subway} â‰¤ 45$ã€‚<br>æ­ä¹˜åœ°é“è·å¾—çš„ä¼˜æƒ ç¥¨å¯ä»¥ç´¯ç§¯ï¼Œå³å¯ä»¥è¿ç»­æ­ä¹˜è‹¥å¹²æ¬¡åœ°é“åå†è¿ç»­ä½¿ç”¨ä¼˜ æƒ ç¥¨æ­ä¹˜å…¬äº¤è½¦ã€‚æ­ä¹˜å…¬äº¤è½¦æ—¶ï¼Œå¦‚æœå¯ä»¥ä½¿ç”¨ä¼˜æƒ ç¥¨ä¸€å®šä¼šä½¿ç”¨ä¼˜æƒ ç¥¨ï¼›å¦‚æœæœ‰å¤šå¼ ä¼˜æƒ ç¥¨æ»¡ è¶³æ¡ä»¶ï¼Œåˆ™ä¼˜å…ˆæ¶ˆè€—è·å¾—æœ€æ—©çš„ä¼˜æƒ ç¥¨ã€‚<br>ç°åœ¨ä½ å¾—åˆ°äº†å°è½©æœ€è¿‘çš„å…¬å…±äº¤é€šå‡ºè¡Œè®°å½•ï¼Œä½ èƒ½å¸®ä»–ç®—ç®—ä»–çš„èŠ±è´¹å—ï¼Ÿ</p><p><strong>è§£é¢˜æ€è·¯</strong><br>ä¸€é“æ¨¡æ‹Ÿé¢˜ï¼Œæ˜¾è€Œæ˜“è§éœ€è¦æŒ‰ç…§æ—¶é—´å‡åºï¼Œå› ä¸ºå¦‚æœè¶…è¿‡45åˆ†é’Ÿå°±æ— æ•ˆäº†ã€‚åŸºäºæ­¤åº”è¯¥æƒ³åˆ°å¯ä»¥åˆ©ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆæˆ–ç±»ä¼¼ï¼‰çš„æ•°æ®ç»“æ„æ¥ç»´æŠ¤ï¼Œæ¯æ¬¡åå…¬äº¤ï¼Œåœ¨æ‰€æœ‰ä»·å€¼å¤§äºæœ¬æ¬¡ç¥¨ä»·çš„ä¼˜æƒ åˆ¸ä¸­ä¼˜å…ˆä½¿ç”¨è¿‡æœŸæ—¶é—´æœ€æ—©çš„ï¼ˆä¸ç”¨å°±è¿‡æœŸäº†ï¼ï¼‰ï¼Œä»·å€¼æœ€ä½çš„ä¼˜æƒ åˆ¸ã€‚ä¸€æ—¦ç¥¨è¿‡æœŸäº†ï¼Œå°±åˆ æ‰ï¼Œä½†æ˜¯å¦‚æœç¥¨åªæ˜¯ä»·å€¼ä¸å¤Ÿï¼Œé‚£å¯èƒ½åé¢è¿˜ä¼šæœ‰ç”¨ï¼Œæ‰€ä»¥è¿˜è¦å‹å›å»ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> ty;</span><br><span class="line">ll t,price;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node&amp; rhs) <span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(t == rhs.t) <span class="keyword">return</span> price &gt; rhs.price;</span><br><span class="line"><span class="keyword">return</span> t &gt; rhs.t;</span><br><span class="line">&#125;</span><br><span class="line">&#125;rd[N];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">priority_queue&lt;Node&gt; q;</span><br><span class="line"><span class="built_in">stack</span>&lt;Node&gt; s;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">sort(rd+<span class="number">1</span>,rd+<span class="number">1</span>+n);</span><br><span class="line">ll res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = n;i &gt;= <span class="number">1</span>;i--)&#123;</span><br><span class="line"><span class="keyword">if</span>(!rd[i].ty)&#123;</span><br><span class="line">res += rd[i].price, q.push(rd[i]);</span><br><span class="line"><span class="keyword">continue</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">while</span>(q.size())&#123;</span><br><span class="line">Node x = q.top(); q.pop();</span><br><span class="line"><span class="keyword">if</span>(rd[i].t - x.t &gt; <span class="number">45</span>) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span>(x.price &lt; rd[i].price)&#123;</span><br><span class="line">s.push(x); <span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">flag = <span class="literal">false</span>; <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(flag) res += rd[i].price;</span><br><span class="line"><span class="keyword">while</span>(s.size()) q.push(s.top()), s.pop(); </span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;rd[i].ty,&amp;rd[i].price,&amp;rd[i].t);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="C-çºªå¿µå“"><a href="#C-çºªå¿µå“" class="headerlink" title="C.çºªå¿µå“"></a>C.çºªå¿µå“</h4><p><strong>é¢˜æ„æè¿°</strong><br>å°ä¼Ÿçªç„¶è·å¾—ä¸€ç§è¶…èƒ½åŠ›ï¼Œä»–çŸ¥é“æœªæ¥ T å¤© N ç§çºªå¿µå“æ¯å¤©çš„ä»·æ ¼ã€‚æŸä¸ªçºªå¿µå“ çš„ä»·æ ¼æ˜¯æŒ‡è´­ä¹°ä¸€ä¸ªè¯¥çºªå¿µå“æ‰€éœ€çš„é‡‘å¸æ•°é‡ï¼Œä»¥åŠå–å‡ºä¸€ä¸ªè¯¥çºªå¿µå“æ¢å›çš„é‡‘å¸æ•°é‡ã€‚<br> æ¯å¤©ï¼Œå°ä¼Ÿå¯ä»¥è¿›è¡Œä»¥ä¸‹ä¸¤ç§äº¤æ˜“<strong>æ— é™æ¬¡</strong>ï¼š<br>ä»»é€‰ä¸€ä¸ªçºªå¿µå“ï¼Œè‹¥æ‰‹ä¸Šæœ‰è¶³å¤Ÿé‡‘å¸ï¼Œä»¥å½“æ—¥ä»·æ ¼è´­ä¹°è¯¥çºªå¿µå“ï¼›å–å‡ºæŒæœ‰çš„ä»»æ„ä¸€ä¸ªçºªå¿µå“ï¼Œä»¥å½“æ—¥ä»·æ ¼æ¢å›é‡‘å¸ã€‚<br> æ¯å¤©å–å‡ºçºªå¿µå“æ¢å›çš„é‡‘å¸å¯ä»¥<strong>ç«‹å³</strong>ç”¨äºè´­ä¹°çºªå¿µå“ï¼Œå½“æ—¥è´­ä¹°çš„çºªå¿µå“ä¹Ÿå¯ä»¥<strong>å½“æ—¥å–å‡º</strong>æ¢å›é‡‘å¸ã€‚å½“ç„¶ï¼Œä¸€ç›´æŒæœ‰çºªå¿µå“ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚<br>T å¤©ä¹‹åï¼Œå°ä¼Ÿçš„è¶…èƒ½åŠ›æ¶ˆå¤±ã€‚å› æ­¤ä»–ä¸€å®šä¼šåœ¨ç¬¬ T å¤©å–å‡º<strong>æ‰€æœ‰</strong>çºªå¿µå“æ¢å›é‡‘å¸ã€‚<br>å°ä¼Ÿç°åœ¨æœ‰ M æšé‡‘å¸ï¼Œä»–æƒ³è¦åœ¨è¶…èƒ½åŠ›æ¶ˆå¤±åæ‹¥æœ‰å°½å¯èƒ½å¤šçš„é‡‘å¸ã€‚ </p><p><strong>è§£é¢˜æ€è·¯</strong><br>æœ¬é¢˜æ€è·¯å¯ä»¥æ ¹æ®æ•°æ®èŒƒå›´æ¥æƒ³ã€‚è¿™æ˜¯ä¸€é“åŠ¨æ€è§„åˆ’é¢˜ã€‚<br>åˆšå¼€å§‹æƒ³åˆ°çš„æ˜¯å»ºç«‹ä¸€å¼ å…¨å›¾ï¼Œä½†æ˜¯åæ¥å‘ç°èŠ‚ç‚¹æ•°é‡ä¸æ˜¯ N è€Œæ˜¯ NT ï¼Œå¹¶ä¸”æ€»ä»·å€¼ä¹Ÿä¸ä¸€å®šåªèƒ½èµ°ä¸€æ¡è·¯ã€‚<br>åæ¥å‘ç°å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’è§£å†³ï¼Œé¦–å…ˆè®¾ f[x]: ç¬¬xå¤©èƒ½å¤Ÿèµšåˆ°æœ€å¤šå¤šå°‘é’±ã€‚é‚£ä¹ˆæ˜¾ç„¶f[1] = mï¼Œå¹¶ä¸” f æ˜¯é€’å¢çš„ã€‚é‡ç‚¹åœ¨äºçŠ¶æ€è½¬ç§»ï¼Œf[ i ] è‚¯å®šæ˜¯ç”± f[ 1~i-1 ] æ¨å‡ºæ¥çš„ï¼Œå› ä¸ºå•ç‹¬ä¸€ä¸ª f[i-1] æ— æ³•è¡¨ç¤ºæ‰€æœ‰çŠ¶æ€ã€‚<br>å‡è®¾å½“å‰å¤„äºçŠ¶æ€ j ï¼ˆj &lt; iï¼‰ï¼Œé‚£ä¹ˆå°†ç¬¬ j å¤©ç‰©å“çš„ä»·æ ¼çœ‹ä½œèŠ±è´¹ï¼Œç¬¬ i å¤©çš„ç‰©å“ä»·æ ¼çœ‹ä½œä»·å€¼ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªå®Œå…¨èƒŒåŒ…é—®é¢˜ï¼ŒèƒŒåŒ…å®¹é‡æ˜¯å½“å¤©çš„é‡‘å¸æ•° f[j] ã€‚<br>äºæ˜¯æˆ‘ä»¬ä¸¤å±‚å¾ªç¯O(T^2)æ¥è®¡ç®— f[i] ï¼Œè€Œæ¯æ¬¡è®¡ç®—éœ€è¦O(MN) åšå®Œå…¨èƒŒåŒ…ï¼Œä½†æ˜¯å®é™…æµ‹è¯•æ•ˆç‡è¿˜è¡Œï¼Œå¯èƒ½æ˜¯æ•°æ®å¤ªå¼±äº†ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e2</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> t,n,m;</span><br><span class="line"><span class="keyword">int</span> val[N][N];</span><br><span class="line"><span class="keyword">int</span> f[N];<span class="comment">//ç¬¬ x å¤©æœ€å¤šæœ‰å¤šå°‘é’±</span></span><br><span class="line"><span class="keyword">int</span> tmp[M],mx;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">f[<span class="number">1</span>] = m;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> day = <span class="number">2</span>;day &lt;= t;day++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; day;i++)&#123;</span><br><span class="line"><span class="built_in">memset</span>(tmp,<span class="number">0</span>,<span class="keyword">sizeof</span> tmp); mx = m;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> v = val[i][j]; v &lt;= f[i];v++)&#123;</span><br><span class="line">tmp[v] = max(tmp[v-val[i][j]]+val[day][j],tmp[v]);</span><br><span class="line">mx = max(mx,tmp[v]+f[i]-v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">f[day] = max(f[day],mx);</span><br><span class="line">&#125;</span><br><span class="line">f[day] = max(f[day],f[day<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//for(int i = 1;i &lt;= t;i++) printf("%d\n",f[i]);</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,f[t]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;t,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= t;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;val[i][j]);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="D-åŠ å·¥é›¶ä»¶"><a href="#D-åŠ å·¥é›¶ä»¶" class="headerlink" title="D.åŠ å·¥é›¶ä»¶"></a>D.åŠ å·¥é›¶ä»¶</h4><p><strong>é¢˜æ„æè¿°</strong></p><p>å‡¯å‡¯çš„å·¥å‚æ­£åœ¨æœ‰æ¡ä¸ç´Šåœ°ç”Ÿäº§ä¸€ç§ç¥å¥‡çš„é›¶ä»¶ï¼Œç¥å¥‡çš„é›¶ä»¶çš„ç”Ÿäº§è¿‡ç¨‹è‡ªç„¶ä¹Ÿå¾ˆ ç¥å¥‡ã€‚å·¥å‚é‡Œæœ‰ ğ‘› ä½å·¥äººï¼Œå·¥äººä»¬ä» 1âˆ¼ğ‘›ç¼–å·ã€‚æŸäº›å·¥äººä¹‹é—´å­˜åœ¨åŒå‘çš„é›¶ä»¶ä¼ é€å¸¦ã€‚ä¿è¯æ¯ä¸¤åå·¥äººä¹‹é—´æœ€å¤šåªå­˜åœ¨ä¸€æ¡ä¼ é€å¸¦ã€‚<br>å¦‚æœ ğ‘¥ å·å·¥äººæƒ³ç”Ÿäº§ä¸€ä¸ªè¢«åŠ å·¥åˆ°ç¬¬ ğ¿(ğ¿&gt;1) é˜¶æ®µçš„é›¶ä»¶ï¼Œåˆ™æ‰€æœ‰ä¸ ğ‘¥ å·å·¥äºº æœ‰ä¼ é€å¸¦ç›´æ¥ç›¸è¿çš„å·¥äººï¼Œéƒ½éœ€è¦ç”Ÿäº§ä¸€ä¸ªè¢«åŠ å·¥åˆ°ç¬¬ ğ¿ âˆ’1 é˜¶æ®µçš„é›¶ä»¶ï¼ˆä½† ğ‘¥ å·å·¥ äººè‡ªå·±æ— éœ€ç”Ÿäº§ç¬¬ ğ¿ âˆ’1 é˜¶æ®µçš„é›¶ä»¶ï¼‰ã€‚<br>å¦‚æœ ğ‘¥ å·å·¥äººæƒ³ç”Ÿäº§ä¸€ä¸ªè¢«åŠ å·¥åˆ°ç¬¬ 1 é˜¶æ®µçš„é›¶ä»¶ï¼Œåˆ™æ‰€æœ‰ä¸ ğ‘¥ å·å·¥äººæœ‰ä¼ é€ å¸¦ç›´æ¥ç›¸è¿çš„å·¥äººï¼Œéƒ½éœ€è¦ä¸º ğ‘¥ å·å·¥äººæä¾›ä¸€ä¸ªåŸææ–™ã€‚<br>è½©è½©æ˜¯ 1 å·å·¥äººã€‚ç°åœ¨ç»™å‡º ğ‘ å¼ å·¥å•ï¼Œç¬¬ ğ‘– å¼ å·¥å•è¡¨ç¤ºç¼–å·ä¸º ğ‘ğ‘–çš„å·¥äººæƒ³ç”Ÿäº§ ä¸€ä¸ªç¬¬ ğ¿ğ‘–é˜¶æ®µçš„é›¶ä»¶ã€‚è½©è½©æƒ³çŸ¥é“å¯¹äºæ¯å¼ å·¥å•ï¼Œä»–æ˜¯å¦éœ€è¦ç»™åˆ«äººæä¾›åŸææ–™ã€‚ä»–çŸ¥é“èªæ˜çš„ä½ ä¸€å®šå¯ä»¥å¸®ä»–è®¡ç®—å‡ºæ¥ï¼</p><p><strong>è§£é¢˜æ€è·¯</strong><br>ç»è¿‡æ¨å¯¼å¯ä»¥å‘ç°ï¼Œå¦‚æœ a å·èŠ‚ç‚¹åˆ° 1 å·èŠ‚ç‚¹ï¼ˆä»¥ä¸‹åªç”¨ç¼–å·ç®€å†™ï¼‰ä¹‹é—´å­˜åœ¨ä¸€æ¡å°äº L çš„è·¯å¾„ï¼Œä¸”å®ƒä»¬çš„å·®ä¸ºå¶æ•°ï¼ˆåŒ…æ‹¬0ï¼‰ï¼Œé‚£ä¹ˆ 1 å°±è¦æä¾›åŸææ–™ã€‚<br>ä½†æ˜¯é—®é¢˜åœ¨äº 1 åˆ° a ä¹‹é—´å¯èƒ½ä¸æ­¢ä¸€æ¡è·¯å¾„ï¼Œè€Œ L ä¹Ÿä¸ä¸€å®šæ˜¯å¥‡æˆ–è€…å¶ï¼Œäºæ˜¯æˆ‘ä»¬éœ€è¦ä¿å­˜ a åˆ° 1 çš„<strong>æœ€çŸ­å¥‡è·¯å¾„</strong>ä¸<strong>æœ€çŸ­å¶è·¯å¾„</strong>ã€‚<br>åœ¨å›¾è®ºä¸­ï¼Œå¦‚æœè¾¹æƒä¸º1ï¼Œé‚£ä¹ˆæ±‚å¥‡å¶æœ€çŸ­è·¯å¾„çš„å¥½æ–¹æ³•å°±æ˜¯ç”¨åˆ†å±‚å›¾æ¥åšï¼Œå…·ä½“åšæ³•æ˜¯å»ºç«‹åŒå±‚å›¾ï¼Œå¦‚æœä»èµ·ç‚¹ä¸åœ¨åŒä¸€å±‚ï¼Œåˆ™è·¯å¾„ä¸€å®šæ˜¯å¥‡ï¼Œå¦åˆ™ä¸€å®šä¸ºå¶ï¼›è¿™æ ·åšçš„å¥½å¤„æ˜¯ä¸ç”¨é¢å¤–çš„è¾…åŠ©ä»£ç ï¼Œåªè¦åœ¨å»ºå›¾æ—¶å¤šåŠ ä¸¤æ¡è¾¹å°±è¡Œäº†ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2</span>*N;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n,m,q;</span><br><span class="line"><span class="keyword">int</span> head[N],edge[M],ver[M],nex[M] ,tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">ver[++tot] = y; edge[tot] = z;</span><br><span class="line">nex[tot] = head[x]; head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c != <span class="string">'-'</span> &amp;&amp; (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) res = res*<span class="number">10</span>+c-<span class="string">'0'</span>,c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg?-res:res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line"><span class="keyword">int</span> dis[N],vis[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> l)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(dis[a] &lt;= l &amp;&amp; !((dis[a]&amp;<span class="number">1</span>) ^ (l&amp;<span class="number">1</span>))) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span>(dis[a+n] &lt;= l &amp;&amp; !((dis[a+n]&amp;<span class="number">1</span>) ^ (l&amp;<span class="number">1</span>))) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span><span class="params">(<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">que.push(s);</span><br><span class="line"><span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> dis);</span><br><span class="line">dis[s] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(que.size())&#123;</span><br><span class="line"><span class="keyword">int</span> x = que.front(); que.pop();</span><br><span class="line">vis[x] = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(dis[y] &gt; dis[x]+z)&#123;</span><br><span class="line">dis[y] = dis[x]+z;</span><br><span class="line"><span class="keyword">if</span>(!vis[y]) que.push(y),vis[y] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">n = getInt(); m = getInt(); q = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line">x = getInt(); y = getInt();</span><br><span class="line">addEdge(x,y+n,<span class="number">1</span>); addEdge(y+n,x,<span class="number">1</span>);</span><br><span class="line">addEdge(x+n,y,<span class="number">1</span>); addEdge(y,x+n,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">SPFA(<span class="number">1</span>);</span><br><span class="line"><span class="comment">//for(int i = 1;i &lt;= n&lt;&lt;1;i++) cout &lt;&lt; dis[i] &lt;&lt; endl;</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,a,l;i &lt;= q;i++)&#123;</span><br><span class="line">a = getInt(); l = getInt();</span><br><span class="line"><span class="keyword">if</span>(solve(a,l)) <span class="built_in">puts</span>(<span class="string">"Yes"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"No"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŠ¨æ€è§„åˆ’ </tag>
            
            <tag> å›¾è®º </tag>
            
            <tag> åˆ†å±‚å›¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CodeForce#600ï¼ˆDiv2ï¼‰è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2019/11/24/cf600/"/>
      <url>/2019/11/24/cf600/</url>
      
        <content type="html"><![CDATA[<h4 id="A-Single-Push"><a href="#A-Single-Push" class="headerlink" title="A. Single Push"></a>A. Single Push</h4><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®šä¸¤ä¸ªåºåˆ— a å’Œ bï¼Œè¦æ±‚ä»åºåˆ— a ä¸­é€‰å‡ºè¿ç»­çš„ä¸€æ®µ[l , r] ï¼Œå¯¹è¿™æ®µä¸Šçš„æ¯ä¸ªä½ç½®+kï¼ˆk &gt;= 0ï¼‰ï¼Œè¯•é—®åªæ“ä½œä¸€æ¬¡èƒ½å¦ä½¿å¾—åºåˆ— a å˜ä¸ºåºåˆ— b ã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>ç”±äºåªèƒ½æ“ä½œä¸€æ¬¡ï¼Œæ‰€ä»¥éš¾åº¦å¤§å¤§ä¸‹é™ï¼Œå› æ­¤åªéœ€è¦é¡ºåºåˆ¤æ–­ a æ˜¯å¦åªæœ‰ä¸€ä¸ªåŒºé—´å’Œ b ä¸åŒï¼Œä¸”å·®å€¼å…¨éƒ¨ç›¸åŒä¸”ä¸ºè´Ÿã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> t,n;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> a[N],b[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c != <span class="string">'-'</span> &amp;&amp; (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) res = res*<span class="number">10</span> + c-<span class="string">'0'</span>,c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg?-res:res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) a[i] = a[i]-b[i];</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span>(a[i] &amp;&amp; a[i] != a[i<span class="number">-1</span>]) cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt &lt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">t = getInt();</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line">n = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) a[i] = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) b[i] = getInt();</span><br><span class="line"><span class="keyword">if</span>(solve()) <span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="B-Silly-Mistake"><a href="#B-Silly-Mistake" class="headerlink" title="B. Silly Mistake"></a>B. Silly Mistake</h4><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>å®šä¹‰ä¸€ä¸ªè¿ç»­çš„åºåˆ—æ˜¯åˆæ³•çš„ï¼Œå½“ä¸”ä»…å½“ï¼š</p><ul><li>æœ‰ä¸€ä¸ªæ­£æ•°ï¼Œå°±æœ‰ä¸€ä¸ªè´Ÿæ•°ï¼Œä¾‹å¦‚æœ‰ 5 ï¼Œå°±è¦æœ‰ -5ï¼›</li><li>è´Ÿæ•°ä¹‹å‰å¿…é¡»æœ‰å®ƒçš„æ­£æ•°ï¼Œå³ 5 åªèƒ½åœ¨ -5 å‰é¢ï¼›</li><li>æ¯ä¸ªæ•°å¯¹ä»…å‡ºç°ä¸€æ¬¡ï¼Œå³ 5 ï¼Œ-5ï¼Œ5ï¼Œ-5æ˜¯ä¸åˆæ ¼æ³•çš„ã€‚</li></ul><p>ç»™å®šä¸€ä¸ªåºåˆ— aï¼Œå…¶ä¸­ai &lt;= 1e6ï¼Œè¯·é—®å¯ä»¥å°†åºåˆ—aåˆ†ä¸ºå¤šå°‘ä¸ªåˆæ³•çš„å­åºåˆ—ï¼Œå¹¶è¾“å‡ºæ¯ä¸ªå­åºåˆ—çš„é•¿åº¦ï¼Œè‹¥ä¸å­˜åœ¨åˆ’åˆ†æ–¹æ³•ï¼Œåˆ™è¾“å‡º-1ï¼Œå¦åˆ™è¾“å‡ºä»»æ„æ»¡è¶³æ¡ä»¶çš„ç­”æ¡ˆã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>éœ€è¦åœ¨O(N)æ—¶é—´å†…è§£å†³ï¼Œå°±æ˜¯æ¨¡æ‹Ÿé¢˜ï¼Œåªéœ€è¦æ¯æ¬¡éå†åˆ°ä¸€ä¸ªæ•°å°±åˆ¤æ–­å½“ä¸”åºåˆ—æ˜¯å¦åˆæ³•å°±è¡Œäº†ï¼Œè‹¥åˆæ³•å°±åˆ’åˆ†ï¼Œå¦åˆ™æˆ–é€€å‡ºè¾“å‡º-1ï¼Œæˆ–ç»§ç»­åŠ å…¥å…ƒç´ ã€‚<br>éœ€è¦æ³¨æ„è‹¥ç”¨å‰ç¼€å’Œä½œä¸ºåˆ¤æ–­æ¡ä»¶å¯èƒ½ä¼šè¶… intï¼Œéœ€è¦ç”¨longlongï¼Œå¦å¤–å¯¹äºæ¯ä¸ªæ¡ä»¶åˆ†æ”¯ä¸€å®šè¦ä»”ç»†åˆ’åˆ†ï¼Œé¿å…é—æ¼å‡ºé”™ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c != <span class="string">'-'</span> &amp;&amp;(c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) res = res*<span class="number">10</span>+ c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg?-res:res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> vis[N],d[N],tot = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> num[N];</span><br><span class="line">__int64 sum[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(n&amp;<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) sum[i] = sum[i<span class="number">-1</span>] + a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,pre = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] &gt; <span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(num[a[i]] != <span class="number">0</span> || vis[a[i]] &gt; pre) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">num[a[i]]++; vis[a[i]] = i;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(num[-a[i]] != <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">num[-a[i]]--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(sum[i] == <span class="number">0</span>) d[++tot] = i-pre,pre = i;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(sum[i] &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!tot || sum[n]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,tot);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; tot;i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>,d[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,d[tot]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">// freopen("in","r",stdin);</span></span><br><span class="line"><span class="comment">// freopen("out","w",stdout);</span></span><br><span class="line">n = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) a[i] = getInt();</span><br><span class="line"><span class="keyword">if</span>(!solve()) <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="C-Sweets-Eating"><a href="#C-Sweets-Eating" class="headerlink" title="C. Sweets Eating"></a>C. Sweets Eating</h4><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®šä¸€ä¸ªåºåˆ— aï¼Œç»™å®š m ï¼Œå¯¹äº kï¼ˆkä»1åˆ°nï¼‰ ï¼Œè¦æ±‚ä»åºåˆ— a ä¸­æŒ‘å‡ºkä¸ªå…ƒç´ ï¼Œåˆ†ä¸ºè‹¥å¹²ç»„ï¼Œæ¯ç»„æœ€å¤šæœ‰mä¸ªå…ƒç´ ï¼Œä½¿å¾—ç¬¬ä¸€ç»„ <em> 1ï¼Œç¬¬äºŒç»„ </em> 2ï¼Œä¾æ¬¡ç±»æ¨ï¼Œä½¿å¾—å®ƒä»¬çš„æ€»å’Œæœ€å°ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>é¦–å…ˆå¯¹åºåˆ— a æ’åºï¼Œæ˜“å¾—è¦æƒ³æ€»å’Œæœ€å°ï¼Œåº”è¯¥é€‰å‡ºæœ€å°çš„ k ä¸ªå…ƒç´ ã€‚<br>å‡è®¾è¦æ±‚çš„æ˜¯ f(k) ï¼Œé‚£ä¹ˆéœ€è¦è§£å†³çš„æ˜¯å¦‚ä½•æ‰èƒ½å¿«é€Ÿçš„ä» f(k) è½¬ç§»åˆ° f(k+1)ï¼Œå¦‚æœæš´åŠ›è½¬ç§»ï¼Œæ˜¯ O(k) å¤æ‚åº¦ï¼Œå› ä¸ºè¦åŠ ä¸Šæ¯ä¸€ç»„æœ€å°çš„å…ƒç´ æ”¾åˆ°é«˜ä¸€ç»„å»ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å‰ç¼€å’Œæ¥ä¼˜åŒ–ï¼Œå…·ä½“åšæ³•æ˜¯å¼€ä¸€ä¸ªsumæ•°ç»„ï¼Œsum[i] è®°å½• %m ä¸º i çš„å…ƒç´ å’Œï¼Œæˆ‘ä»¬ä»å°åˆ°å¤§ä¾æ¬¡å°† a åºåˆ—ä¸­çš„å…ƒç´ åŠ å…¥ï¼Œå°±å¯ä»¥åœ¨O(1)è½¬ç§»ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c != <span class="string">'-'</span> &amp;&amp; (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) res = res*<span class="number">10</span> + c-<span class="string">'0'</span>,c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg?-res:res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="keyword">typedef</span> __int64 ll;</span><br><span class="line">ll sum[N],ans[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">sort(a+<span class="number">1</span>,a+<span class="number">1</span>+n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= n;k++)&#123;</span><br><span class="line">ans[k] = ans[k<span class="number">-1</span>] + sum[k%m] + a[k];</span><br><span class="line">sum[k%m] += a[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">printf</span>(<span class="string">"%I64d "</span>,ans[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">// freopen("in","r",stdin);</span></span><br><span class="line"><span class="comment">// freopen("out","w",stdout);</span></span><br><span class="line">n = getInt(); m = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) a[i] = getInt();</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="D-Harmonious-Graph"><a href="#D-Harmonious-Graph" class="headerlink" title="D. Harmonious Graph"></a>D. Harmonious Graph</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>ä¸€ä¸ªæœ‰ N ä¸ªç‚¹çš„æ— å‘å›¾ï¼ŒèŠ‚ç‚¹åˆ†åˆ«æ ‡å·ä¸º1~Nã€‚è¦æ±‚å¦‚æœå›¾ä¸­å­˜åœ¨ l â€”&gt; r çš„è·¯å¾„ï¼Œé‚£ä¹ˆå¯¹äºæ‰€æœ‰çš„ m (l &lt; m &lt; r)éƒ½æ»¡è¶³ l â€”&gt; m ã€‚ç»™å®šä¸€å¼ æ— å‘å›¾ï¼Œè¯•é—®æœ€å°‘æ·»åŠ å¤šå°‘æ¡è¾¹æ‰èƒ½ä½¿å¾—å…¶æ»¡è¶³è¦æ±‚ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æ€è·¯ä¸éš¾æƒ³ï¼Œå› ä¸ºåªè¦æ±‚è‹¥(l , r)æ˜¯è¿é€šçš„ï¼Œé‚£ä¹ˆå¯¹äº l åˆ° r å†…çš„æ‰€æœ‰ç‚¹éƒ½åº”ï¼ˆè‡³å¤šï¼‰å»¶ä¼¸å‡ºä¸€æ¡çº¿æ„æˆä¸€ä¸ªè¿é€šåˆ†é‡ï¼Œæ˜“å¾—ä¸€å¼ å›¾æœ€å¤šéœ€è¦ N-2 æ¡è¾¹ï¼›å¾ˆå®¹æ˜“æƒ³åˆ°ç”¨å¹¶æŸ¥é›†æ¥åšï¼Œå°†ç›¸è¿é€šçš„ç‚¹æ”¾åœ¨åŒä¸€ä¸ªé›†åˆï¼Œåˆ†é…ä¸€ä¸ªç¼–å·ã€‚ç„¶åè®°å½•æ¯ä¸ªé›†åˆï¼ˆè¿é€šåˆ†é‡ï¼‰æœ€åä¸€ä¸ªç‚¹çš„ä½ç½® ed ï¼Œç„¶ååªéœ€è¦ä»å‰å¾€åä¾æ¬¡éå†ï¼Œè‹¥å½“å‰èŠ‚ç‚¹åœ¨å¦ä¸€ä¸ªé›†åˆçš„èŒƒå›´å†…ï¼Œåˆ™åˆå¹¶ä¸¤ä¸ªé›†åˆå¹¶å°† ans++ï¼›è‹¥å½“å‰é›†åˆå¯ä»¥æ›´æ–°æœ‰è¾¹ç•Œï¼Œåˆ™æ›´æ–°ã€‚<br>æ€è·¯æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯è¢«å¡äº†å¥½å¤šæ¬¡ï¼Œé”™äº†å¾ˆå¤šç»†èŠ‚ï¼Œé¦–å…ˆå°±æ˜¯æ±‚é›†åˆâ€˜ç¼–å·â€™éœ€è¦è°ƒç”¨Find()å‡½æ•°ï¼Œè€Œä¸æ˜¯ç›´æ¥è®¿é—®par[]æ•°ç»„ï¼Œpar[]æ•°ç»„åªæ˜¯ä¸€ä¸ªè¾…åŠ©æ•°ç»„è€Œå·²ï¼›ç„¶åè¿˜æœ‰å°±æ˜¯é€šè¿‡Merge()å‡½æ•°åï¼Œé›†åˆçš„ç¼–å·å¯èƒ½ä¼šæ”¹å˜ï¼Œå› æ­¤æŒ‰ç…§é›†åˆçš„ç¼–å·æ¥å­˜æœ‰è¾¹ç•Œæ˜¯ä¸åˆç†çš„ï¼Œåº”è¯¥å†è½¬åŒ–ä¸ºæŒ‰ç…§ä½ç½®æ¥å­˜ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> par[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(par[x] == x) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">return</span> par[x] = Find(par[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = Find(x), b = Find(y);</span><br><span class="line"><span class="keyword">if</span>(a == b) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span>(a &lt; b) swap(a,b);</span><br><span class="line">par[a] = b;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c != <span class="string">'-'</span> &amp;&amp; (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) res = res*<span class="number">10</span>+c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> vis[N],ed[N],ls[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">n = getInt(); m = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) par[i] = i;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line">x = getInt(); y = getInt();</span><br><span class="line">Merge(x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = n;i &gt; <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(!ed[Find(i)]) ed[Find(i)] = i;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) ls[i] = ed[Find(i)];</span><br><span class="line"><span class="keyword">int</span> x = <span class="number">1</span>,last = ls[x] ,ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(i &lt; last &amp;&amp; Merge(x,i)) ans++;</span><br><span class="line"><span class="keyword">if</span>(ls[i] &gt; last)&#123;</span><br><span class="line">last = ls[i]; x = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¹¶æŸ¥é›† </tag>
            
            <tag> å‰ç¼€å’Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>STLä¹‹mapå®¹å™¨é€Ÿç‡æµ‹è¯•</title>
      <link href="/2019/11/16/mapDemo/"/>
      <url>/2019/11/16/mapDemo/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>ä¸æ­¢ä¸€æ¬¡åœ¨ä½¿ç”¨ map æ—¶è¢«å¡æ—¶é™ï¼Œmap æ˜¯ c++ çš„ STL ä¸­ä¸€ä¸ªå¸¸ç”¨ä¸”æ–¹ä¾¿çš„å®¹å™¨ï¼Œå…¶æ˜¯åŸºäºæ ‘æ¥å®ç°çš„ï¼Œå®ƒçš„æ’å…¥ä¸æŸ¥æ‰¾æ•ˆç‡å®é™…ä¸Šæ›´æ¥è¿‘O(log N )ï¼ˆNä¸ºæ’å…¥çš„å…ƒç´ ä¸ªæ•°ï¼‰ã€‚å½“ç„¶åœ¨ c++ çš„ STL ä¸­è¿˜æœ‰ç”¨å“ˆå¸Œå®ç°çš„æ— åºå…³è”å®¹å™¨ï¼Œè¿™é‡Œä¸åšè®¨è®ºã€‚<br>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¸¸å¸¸ä¼šæœ‰äººæŠŠ map æ—¶é—´å¤æ‚åº¦çœ‹ä½œO(1)ï¼Œç¡®å®åœ¨å¤§å¤šæ•°æ—¶å€™ map è¡¨ç°æ˜¯ä»¤äººæ»¡æ„çš„ï¼Œä½†åœ¨å¤§é‡ä½¿ç”¨çš„æ—¶å€™ï¼Œmapå´ä¸å°½äººæ„ã€‚</p><p>æˆ‘ä»¬å°†æµ‹è¯•å¦‚ä¸‹å‡ ç§æƒ…å½¢ä¸‹ä½¿ç”¨ map å®¹å™¨çš„æ•ˆç‡ï¼ˆæ—¶é—´ï¼‰ï¼š</p><ul><li>ä»…æ’å…¥å…ƒç´ ï¼ˆå…ƒç´ ç±»å‹ä¸ºintï¼‰</li><li>æ’å…¥ä»¥åŠæŸ¥æ‰¾ï¼ˆå…ƒç´ ç±»å‹ä¸ºintï¼‰<h4 id="æµ‹è¯•ç¯å¢ƒå‡†å¤‡"><a href="#æµ‹è¯•ç¯å¢ƒå‡†å¤‡" class="headerlink" title="æµ‹è¯•ç¯å¢ƒå‡†å¤‡"></a>æµ‹è¯•ç¯å¢ƒå‡†å¤‡</h4></li></ul><p>ä¸ºäº†ç»™å®šä¸€ä¸ªå¯¹ç…§çš„æ ‡å‡†ï¼Œå…ˆç»™å‡ºå¦‚ä¸‹æ•°æ®ï¼š</p><ul><li>æµ‹è¯•æœºç©ºå¾ªç¯ 1e6 æ¬¡å¹³å‡èŠ±è´¹ 0.0641 s</li><li>æµ‹è¯•æœºè¯»å– 1e6 ä¸ªintå‹æ•°æ®ï¼ˆå¿«è¯»+ä»æ–‡ä»¶è¾“å…¥ï¼‰å¹³å‡èŠ±è´¹ 0.2142 s</li></ul><h4 id="æµ‹è¯•ç»“æœ"><a href="#æµ‹è¯•ç»“æœ" class="headerlink" title="æµ‹è¯•ç»“æœ"></a>æµ‹è¯•ç»“æœ</h4><h5 id="ä»…æ’å…¥å…ƒç´ "><a href="#ä»…æ’å…¥å…ƒç´ " class="headerlink" title="ä»…æ’å…¥å…ƒç´ "></a>ä»…æ’å…¥å…ƒç´ </h5><p><strong>æœ¬æœºå¹³å‡èŠ±è´¹æ—¶é—´ï¼š</strong> 1.1015 s<br><strong>æµ‹è¯•ä»£ç </strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; mp;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">1e6</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> gap = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">mp[i*gap%P] = <span class="number">1</span>; gap += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h5 id="æ’å…¥ä»¥åŠæŸ¥æ‰¾å…ƒç´ "><a href="#æ’å…¥ä»¥åŠæŸ¥æ‰¾å…ƒç´ " class="headerlink" title="æ’å…¥ä»¥åŠæŸ¥æ‰¾å…ƒç´ "></a>æ’å…¥ä»¥åŠæŸ¥æ‰¾å…ƒç´ </h5><p><strong>æœ¬æœºå¹³å‡èŠ±è´¹æ—¶é—´ï¼š</strong> 1.238 s<br><strong>æµ‹è¯•ä»£ç </strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; mp;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">1e6</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> gap = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">mp[i*gap%P] = <span class="number">1</span>; gap += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">if</span>(mp.count(i));</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h4><p>æ€»ä½“ä¸Šæµ‹è¯•ç»“æœæ˜¯ç¬¦åˆé¢„æœŸçš„ï¼Œè™½ç„¶ STL å®¹å™¨å·²ç»å¾ˆä¼˜åŒ–çš„ï¼Œä½†æ˜¯æ¯•ç«Ÿè¿˜æ˜¯ç”¨æ ‘æ¥å®ç°çš„ï¼Œè¾¾ä¸åˆ° O(1) çš„æ—¶é—´å¤æ‚åº¦ï¼Œæ‰€ä»¥å¦‚æœæ˜¯å¯¹æ—¶é™è¦æ±‚å¾ˆé«˜çš„è¯ï¼Œæœ€å¥½è¿˜æ˜¯é‡‡ç”¨æ‰‹åŠ¨å†™å“ˆå¸Œè¡¨ã€‚<br>ä¸Šè¿°è®¾è®¡çš„å®éªŒæœ‰å¾ˆå¤šç¼ºé™·ï¼Œå¦‚æœªå¯¹ long longè½¬åŒ–ã€å–æ¨¡ ä»¥åŠå…¶å®ƒå¤šä½™çš„æ“ä½œè¿›è¡Œæ’é™¤å½±å“ï¼Œå¦å¤–æœ¬æ¥è¿˜æµ‹è¯•äº†charã€stringã€setç­‰ç±»å‹çš„å…ƒç´ ï¼Œä½†æ˜¯è¦è®¾è®¡ä¸€ä¸ªå¥½çš„æµ‹è¯•ä»£ç å¤ªéº»çƒ¦äº†ï¼Œå°±åˆ äº†ï¼Œæ€»çš„ç»“è®ºæ¥è¯´å°±æ˜¯ int æ˜¯æ‰€æœ‰æµ‹è¯•çš„æ•°æ®ç±»å‹ä¸­æœ€æ…¢çš„ä¸€ç§ï¼ˆç”šè‡³æ…¢äº set å’Œ string ï¼Œå¦‚æœåªè€ƒè™‘æ’å…¥å’ŒæŸ¥æ‰¾ï¼‰ã€‚<br>æœ€ç»ˆç»“è®ºå°±æ˜¯å¦‚æœéœ€è¦ä¸€ä¸ª O(1) æ—¶é—´å¤æ‚åº¦çš„æ’å…¥å’ŒæŸ¥æ‰¾ï¼ˆint ç±»å‹çš„å…ƒç´ ï¼‰ï¼Œé‚£ä¹ˆå°±ç”¨å“ˆå¸Œè¡¨ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> map </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ€å¤§æµç¬”è®°</title>
      <link href="/2019/11/15/maxFlow/"/>
      <url>/2019/11/15/maxFlow/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>æ­£å¦‚å¯ä»¥é€šè¿‡å°†é“è·¯äº¤é€šå›¾æ¨¡å‹åŒ–ä¸ºæœ‰å‘å›¾æ¥æ‰¾åˆ°ä»ä¸€ä¸ªåŸå¸‚åˆ°å¦ä¸€ä¸ªåŸå¸‚ä¹‹é—´çš„æœ€çŸ­è·¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸€ä¸ªæœ‰å‘å›¾çœ‹ä½œä¸€ä¸ªâ€œæµç½‘ç»œâ€ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥å›ç­”å…³äºç‰©æ–™æµåŠ¨æ–¹é¢çš„é—®é¢˜ã€‚è¿™ç§æµç½‘ç»œå¯ä»¥ç”¨æ¥å»ºæ¨¡å¾ˆå¤šå®é™…é—®é¢˜ï¼ŒåŒ…æ‹¬æ¶²ä½“åœ¨ç®¡é“ä¸­çš„æµåŠ¨ã€è£…é…çº¿ä¸Šçš„éƒ¨ä»¶çš„æµåŠ¨ã€ç”µç½‘ä¸­ç”µæµçš„æµåŠ¨å’Œé€šä¿¡ç½‘ç»œä¸­ä¿¡æ¯çš„æµåŠ¨ã€‚<br>æœ¬æ–‡é¦–å…ˆä»‹ç»ç½‘ç»œæµä¸­çš„ç›¸å…³æ¦‚å¿µï¼Œç„¶åç»™å‡ºæœ€å¤§æµé—®é¢˜çš„ä¸€èˆ¬è§£æ³•æ€è·¯ï¼Œä»¥åŠä¼˜åŒ–åçš„ç®—æ³•ã€‚æˆ‘ä»¬åº”è¯¥å°†ä¸»è¦ç²¾åŠ›æ”¾åœ¨æ€ç»´é”»ç‚¼å’Œé¢˜ç›®åˆ†æä¸Šï¼Œè€Œä¸è¦è¿‡äºæ‰§ç€äºé‚£äº›ç»å…¸ç®—æ³•çš„ç»†èŠ‚ä¼˜åŒ–ã€‚æœ¬æ–‡ä¸­æ•´ç†çš„ç®—æ³•åœ¨ç®—æ³•ç«èµ›ä¸­å·²ç»å¤Ÿç”¨ã€‚</p><h4 id="æ¦‚å¿µä»‹ç»"><a href="#æ¦‚å¿µä»‹ç»" class="headerlink" title="æ¦‚å¿µä»‹ç»"></a>æ¦‚å¿µä»‹ç»</h4><p><strong>æµç½‘ç»œï¼š</strong> æµç½‘ç»œ G = (V , E) æ˜¯ä¸€ä¸ªæœ‰å‘å›¾ï¼Œå›¾ä¸­æ¯æ¡è¾¹ (u , v) éƒ½æœ‰ä¸€ä¸ªéè´Ÿçš„<strong>å®¹é‡å€¼c(u , v)</strong> ã€‚è€Œä¸”ï¼Œå¦‚æœè¾¹é›†åˆ E åŒ…å«ä¸€æ¡è¾¹(u , v) ï¼Œåˆ™å›¾ä¸­ä¸å­˜åœ¨åå‘è¾¹(v , u)ã€‚</p><p><strong>æºèŠ‚ç‚¹så’Œæ±‡ç‚¹tï¼š</strong> åœ¨æµç½‘ç»œçš„æ‰€æœ‰èŠ‚ç‚¹ä¸­ï¼Œæˆ‘ä»¬åˆ†è¾¨å‡ºä¸¤ä¸ªç‰¹æ®Šçš„èŠ‚ç‚¹ï¼Œåˆ†åˆ«æ˜¯æºç‚¹så’Œæ±‡ç‚¹tï¼›æºç‚¹æ˜¯æ‰€æœ‰è·¯å¾„çš„èµ·ç‚¹ï¼Œè€Œæ±‡ç‚¹æ˜¯è·¯å¾„çš„ç»ˆç‚¹ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæºç‚¹å’Œæ±‡ç‚¹éœ€è¦äººä¸ºæŒ‡å®šã€‚</p><p><strong>æµç½‘ç»œ G ä¸­çš„æµï¼š</strong> Gä¸­æµçš„å¤§å°ï¼ˆå€¼ï¼‰ç”¨ f è¡¨ç¤ºï¼Œf(u , v)è¡¨ç¤ºä»ç‚¹ u åˆ°ç‚¹ v çš„æµçš„å¤§å°ã€‚æ•´å¼ å›¾çš„æµæ˜¯ $|f| = \sum_{v \epsilon V}f(s, v) - \sum_{v \epsilon V}f(v ,s)$ï¼ˆå‰åä¸¤ä¸ª v å«ä¹‰ä¸åŒï¼‰ï¼Œå³ä»æºç‚¹ s æµå‡ºçš„æµé‡å’Œï¼Œæˆ–ç§°ä¸ºæµå…¥æ±‡ç‚¹ t çš„æµé‡å’Œã€‚</p><p><strong>å®¹é‡é™åˆ¶ï¼š</strong> å¯¹äºæ‰€æœ‰çš„èŠ‚ç‚¹$u, v \epsilon V$ï¼Œè¦æ±‚$0 &lt;= f(u , v) &lt;= c(u , v)$<br><strong>æµé‡å®ˆæ’ï¼š</strong> å¯¹äºæ‰€æœ‰çš„èŠ‚ç‚¹ $u \epsilon V$ - { s , t }ï¼Œè¦æ±‚æµå…¥ u çš„æµé‡ç­‰äºæµå‡º u çš„æµé‡ï¼Œå³ï¼š</p><script type="math/tex; mode=display">\sum_{v \epsilon V}f(v,u) = \sum_{v \epsilon V}f(u,v)</script><p>ï¼ˆå‰åä¸¤ä¸ª v çš„å«ä¹‰ä¸åŒï¼Œä¸€ä¸ªæ˜¯å…¥è¾¹çš„èµ·ç‚¹ï¼Œä¸€ä¸ªæ˜¯å‡ºè¾¹çš„ç»ˆç‚¹ï¼‰</p><p><strong>é—®é¢˜æ¨¡å‹ï¼š</strong> åœ¨æœ€å¤§æµé—®é¢˜ä¸­ï¼Œç»™å®šä¸€ä¸ªæµç½‘ç»œG ã€ä¸€ä¸ªæºèŠ‚ç‚¹sã€ä¸€ä¸ªæ±‡ç‚¹tï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°å€¼æœ€å¤§çš„ä¸€ä¸ªæµã€‚</p><h4 id="Edmonds-Karpç®—æ³•"><a href="#Edmonds-Karpç®—æ³•" class="headerlink" title="Edmonds-Karpç®—æ³•"></a>Edmonds-Karpç®—æ³•</h4><p>è‹¥ä¸€æ¡ä»æºç‚¹ s åˆ°æ±‡ç‚¹ t çš„è·¯å¾„ä¸Šçš„å„æ¡è¾¹çš„å‰©ä½™å®¹é‡éƒ½å¤§äº 0ï¼Œåˆ™ç§°è¿™æ¡è·¯å¾„ä¸ºä¸€æ¡å¢å¹¿è·¯å¾„ã€‚æ˜¾ç„¶ï¼Œå¯ä»¥è®©ä¸€è‚¡æµæ²¿ç€å¢å¹¿è·¯å¾„ä» s æµåˆ° tï¼Œä½¿ç½‘ç»œçš„æµé‡å¢å¤§ã€‚Edmonds-Karpç®—æ³•æ€æƒ³å°±æ˜¯ä¸æ–­ç”¨BFSå¯»æ‰¾å¢å¹¿è·¯ï¼Œç›´è‡³ç½‘ç»œä¸Šä¸å­˜åœ¨å¢å¹¿è·¯ä¸ºæ­¢ã€‚<br>è¯¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(nm^2)$ã€‚ç„¶è€Œåœ¨å®é™…è¿ç”¨ä¸­åˆ™è¿œè¿œè¾¾ä¸åˆ°è¿™ä¸ªä¸Šç•Œï¼Œæ•ˆç‡è¾ƒé«˜ï¼Œä¸€èˆ¬èƒ½å¤Ÿå¤„ç† $10^3 - 10^4$è§„æ¨¡çš„ç½‘ç»œã€‚</p><p><strong>ç®—æ³•æ€è·¯ï¼š</strong><br>è¿™é‡Œä»‹ç»çš„æ˜¯åˆ©ç”¨ bfs å¯»æ‰¾å¢å¹¿è·¯çš„Edmonds-Karpå¢å¹¿è·¯ç®—æ³•ã€‚åœ¨è¯¥ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬ä¸æ–­çš„å¯»æ‰¾å¢å¹¿è·¯ï¼Œå¹¶å¢åŠ å¢å¹¿è·¯ä¸Šçš„æµï¼›é‡å¤è¿™ä¸€æ­¥éª¤ç›´è‡³ä¸å­˜åœ¨å¢å¹¿è·¯ã€‚<br>åœ¨æ¯è½®å¯»æ‰¾å¢å¹¿è·¯çš„è¿‡ç¨‹ä¸­ï¼ŒEdmonds-Karpç®—æ³•åªè€ƒè™‘å›¾ä¸­æ‰€æœ‰ f(x ,y) &lt; c(x, y)çš„è¾¹ï¼Œç”¨BFSæ‰¾åˆ°ä»»æ„ä¸€æ¡ä» s åˆ° t çš„è·¯å¾„ï¼ŒåŒæ—¶è®¡ç®—å‡ºè·¯å¾„ä¸Šå„è¾¹çš„å‰©ä½™å®¹é‡çš„æœ€å°å€¼ minfï¼Œåˆ™ç½‘ç»œçš„æµé‡å°±å¯ä»¥å¢åŠ  minfã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä¸€æ¡è¾¹çš„æµé‡ f(x ,y) &gt; 0æ—¶ï¼Œæ ¹æ®æ–œå¯¹ç§°æ€§è´¨ï¼Œå®ƒçš„åå‘è¾¹æµé‡ f(y ,x) &lt; 0ï¼Œæ­¤æ—¶å¿…å®šæœ‰ f(y , x) &lt; c(y ,x)ã€‚æ•…Edmonds-Karpç®—æ³•åœ¨BFSæ—¶é™¤äº†åŸå›¾çš„è¾¹é›† E å¤–ï¼Œè¿˜åº”è€ƒè™‘éå† E ä¸­æ¯æ¡è¾¹çš„åå‘è¾¹ã€‚<br>å…·ä½“å®ç°æ—¶ï¼Œæœ¬æ–‡é‡‡ç”¨é‚»æ¥è¡¨â€œæˆå¯¹å­˜å‚¨â€æŠ€å·§ï¼ˆå³â€™2â€™å’Œâ€™3â€™æ˜¯ä¸€å¯¹ï¼Œâ€™4â€™å’Œâ€™5â€™æ˜¯ä¸€å¯¹ï¼‰ã€‚æ¯æ¡è¾¹åªè®°å½•å‰©ä½™å®¹é‡ c-f å³å¯ï¼Œå½“ä¸€æ¡è¾¹ (x ,y) æµè¿‡å¤§å°ä¸º e çš„æµæ—¶ï¼Œä»¤ (x ,y) çš„å®¹é‡å‡å°‘ eï¼Œ(y ,x) çš„å®¹é‡å¢åŠ  e ã€‚</p><p><strong>ä»£ç æ¨¡æ¿ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span>+<span class="number">10</span>;<span class="comment">//æœ€å¤§ç‚¹æ•°</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e3</span>+<span class="number">10</span>;<span class="comment">//æœ€å¤§è¾¹æ•°</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;<span class="comment">//intèŒƒå›´å†…çš„æ— ç©·å¤§</span></span><br><span class="line"><span class="keyword">int</span> head[N], edge[M], ver[M], nex[M], tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">ver[++tot] = y; edge[tot] = z;</span><br><span class="line">nex[tot] = head[x]; head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m,s,t;<span class="comment">// å…±nä¸ªç‚¹,mæ¡è¾¹,sæ˜¯æºç‚¹,tæ˜¯æ±‡ç‚¹</span></span><br><span class="line"><span class="keyword">int</span> pre[N],incf[N];<span class="comment">//å¢å¹¿è·¯ä¸Šå„è¾¹çš„æœ€å°å‰©ä½™å®¹é‡</span></span><br><span class="line"><span class="keyword">bool</span> vis[N];<span class="comment">//æ ‡è®°æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">q.push(s); vis[s] = <span class="literal">true</span>;</span><br><span class="line">incf[s] = INF;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> x = q.front(); q.pop();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i],z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(!z || vis[y]) <span class="keyword">continue</span>;</span><br><span class="line">incf[y] = min(incf[x],z);</span><br><span class="line">pre[y] = i;<span class="comment">//è®°å½•å‰é©±*è¾¹*</span></span><br><span class="line">q.push(y); vis[y] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span>(y == t) <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//æ‰¾åˆ°ä¸€æ¡å¢å¹¿è·¯</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">EK</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*è¿”å›æœ€å¤§æµçš„å€¼*/</span></span><br><span class="line"><span class="keyword">int</span> flow = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(bfs())&#123;</span><br><span class="line"><span class="keyword">int</span> x = t;</span><br><span class="line"><span class="keyword">while</span>(x != s)&#123;</span><br><span class="line"><span class="keyword">int</span> i = pre[x];<span class="comment">//å‰é©± *è¾¹* </span></span><br><span class="line">edge[i] -= incf[t];</span><br><span class="line">edge[i^<span class="number">1</span>] += incf[t];</span><br><span class="line">x = ver[i^<span class="number">1</span>];<span class="comment">//å‰é©±ç‚¹ = åå‘è¾¹çš„ç»ˆç‚¹</span></span><br><span class="line">&#125;</span><br><span class="line">flow += incf[t];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;s,&amp;t);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">addEdge(x,y,z); addEdge(y,x,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,EK());</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç®—æ³•æ­£ç¡®æ€§éœ€è¦ç”¨åˆ°æœ€å°å‰²æ¥è¯æ˜ï¼Œè¯¦è§ã€ŠæŒ‘æˆ˜ç¨‹åºè®¾è®¡ç«èµ›ç¬¬äºŒç‰ˆã€‹P212ã€‚</p><h4 id="Dinicç®—æ³•"><a href="#Dinicç®—æ³•" class="headerlink" title="Dinicç®—æ³•"></a>Dinicç®—æ³•</h4><p> åœ¨ä»»æ„æ—¶åˆ»ï¼Œç½‘ç»œä¸­æ‰€æœ‰èŠ‚ç‚¹ä»¥åŠå‰©ä½™å®¹é‡å¤§äº0çš„è¾¹æ„æˆçš„å­å›¾è¢«ç§°ä¸ºæ®‹é‡ç½‘ç»œã€‚Edmonds-Karpæ¯è½®å¯èƒ½ä¼šéå†æ•´ä¸ªæ®‹é‡ç½‘ç»œï¼Œä½†åªæ‰¾å‡º 1 æ¡å¢å¹¿è·¯ï¼Œè¿˜æœ‰è¿›ä¸€æ­¥ä¼˜åŒ–çš„ç©ºé—´ã€‚<br> åœ¨å®½åº¦ä¼˜å…ˆéå†æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡º<strong>èŠ‚ç‚¹çš„å±‚æ¬¡d[x]</strong> ï¼Œå®ƒè¡¨ç¤º s åˆ° x æœ€å°‘éœ€è¦ç»è¿‡çš„è¾¹æ•°ã€‚åœ¨æ®‹é‡ç½‘ç»œä¸­ï¼Œæ»¡è¶³d[y] = d[x] + 1 çš„è¾¹(x ,y) æ„æˆçš„å­å›¾è¢«ç§°ä¸º<strong>åˆ†å±‚å›¾</strong> ã€‚åˆ†å±‚å›¾æ˜¾ç„¶æ˜¯ä¸€å¼ æœ‰å‘æ— ç¯å›¾ã€‚</p><p> Dinic ç®—æ³•ä¸æ–­é‡å¤ä»¥ä¸‹æ­¥éª¤ï¼Œç›´åˆ°æ®‹é‡ç½‘ç»œä¸­ s ä¸èƒ½åˆ°è¾¾ tï¼š</p><ol><li>åœ¨æ®‹é‡ç½‘ç»œä¸Š BFS æ±‚å‡ºèŠ‚ç‚¹çš„å±‚æ¬¡ï¼Œæ„é€ åˆ†å±‚å›¾</li><li>åœ¨åˆ†å±‚å›¾ä¸Š DFS å¯»æ‰¾å¢å¹¿è·¯ï¼Œåœ¨å›æº¯æ—¶å®æ—¶æ›´æ–°å‰©ä½™å®¹é‡ã€‚å¦å¤–ï¼Œæ¯ä¸ªç‚¹å¯ä»¥æµå‘å¤šæ¡å‡ºè¾¹ï¼ŒåŒæ—¶è¿˜åŠ å…¥äº†è‹¥å¹²å‰ªæï¼Œè¯¦æƒ…å‚è€ƒä»£ç ç¤ºä¾‹ã€‚</li></ol><p>Dinic ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(n^2m)$ã€‚å®é™…è¿ç”¨ä¸­è¿œè¿œè¾¾ä¸åˆ°è¿™ä¸ªä¸Šç•Œï¼Œå¯ä»¥è¯´æ˜¯æ¯”è¾ƒå®¹æ˜“å®ç°çš„æ•ˆç‡æœ€é«˜çš„ç½‘ç»œæµç®—æ³•ä¹‹ä¸€ï¼Œä¸€èˆ¬èƒ½å¤Ÿå¤„ç†$10^4 - 10^5$è§„æ¨¡çš„ç½‘ç»œã€‚ç‰¹åˆ«åœ°ï¼ŒDinicç®—æ³•æ±‚è§£äºŒåˆ†å›¾æœ€å¤§åŒ¹é…çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(m\sqrt n)$ï¼Œå®é™…è¡¨ç°åˆ™æ›´å¿«ã€‚</p><p> <strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;<span class="comment">//intæ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§èŒƒå›´çš„ä¸€åŠ</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">5</span>*N;</span><br><span class="line"><span class="keyword">int</span> head[N],edge[M],ver[M],nex[M], tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> d[N];<span class="comment">//è®°å½•èŠ‚ç‚¹çš„å±‚æ¬¡</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">ver[++tot] = y; edge[tot] = z;</span><br><span class="line">nex[tot] = head[x]; head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="keyword">int</span> n,m,s,t;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*åˆ©ç”¨bfsæ¥æ±‚å‡ºèŠ‚ç‚¹çš„å±‚æ¬¡ï¼Œæ„é€ åˆ†å±‚å›¾*/</span></span><br><span class="line"><span class="built_in">memset</span>(d,<span class="number">0</span>,<span class="keyword">sizeof</span> d);</span><br><span class="line"><span class="keyword">while</span>(q.size()) q.pop();</span><br><span class="line">q.push(s); d[s] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(q.size())&#123;</span><br><span class="line"><span class="keyword">int</span> x = q.front(); q.pop();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i],z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(!z || d[y]) <span class="keyword">continue</span>;</span><br><span class="line">q.push(y);</span><br><span class="line">d[y] = d[x] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(y == t) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dinic</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> flow)</span></span>&#123;</span><br><span class="line"><span class="comment">/* åˆ©ç”¨é€’å½’åœ¨åˆ†å±‚å›¾ä¸Šæ‰¾å¢å¹¿è·¯,è¿”å›æœ¬æ¬¡å¢å¹¿çš„æµé‡ */</span></span><br><span class="line"><span class="keyword">if</span>(x == t) <span class="keyword">return</span> flow;</span><br><span class="line"><span class="keyword">int</span> res = flow, k;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(z &amp;&amp; d[y] == d[x]+<span class="number">1</span>)&#123;</span><br><span class="line">k = dinic(y,min(res,z));<span class="comment">//é€’å½’</span></span><br><span class="line"><span class="keyword">if</span>(!k) d[y] = <span class="number">0</span>;<span class="comment">//å‰ªæ,å»æ‰å¢å¹¿å®Œæ¯•çš„ç‚¹</span></span><br><span class="line">edge[i] -= k; edge[i^<span class="number">1</span>] += k;</span><br><span class="line">res -= k;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> flow - res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;s,&amp;t);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">addEdge(x,y,z); addEdge(y,x,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> flow = <span class="number">0</span>,maxflow = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(bfs())</span><br><span class="line"><span class="keyword">while</span>(flow = dinic(s,INF)) maxflow += flow;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,maxflow);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ISAPç®—æ³•"><a href="#ISAPç®—æ³•" class="headerlink" title="ISAPç®—æ³•"></a>ISAPç®—æ³•</h4><p>ISAPç®—æ³•æ²¡æœ‰æ­£å¼çš„åç§°ï¼Œé¦–æ¬¡å‡ºç°äº Ahujaå’ŒOrlinçš„ç»å…¸æ•™æã€ŠNetwork Flowsï¼šTheoryï¼ŒAlgorithms and Applicationsã€‹ä¸­ï¼Œä½œè€…ç§°å®ƒæ˜¯ä¸€ç§ï¼šæ”¹è¿›ç‰ˆçš„SAPï¼ˆImproved SAPï¼ŒISAPï¼‰â€œã€‚</p><p>è¯¥ç®—æ³•åŸºäºè¿™æ ·ä¸€ä¸ªäº‹å®ï¼šæ¯æ¬¡å¢å¹¿åï¼Œä»»æ„èŠ‚ç‚¹åˆ°æ±‡ç‚¹ï¼ˆåœ¨æ®‹é‡ç½‘ç»œä¸­ï¼‰çš„æœ€çŸ­è·ç¦»éƒ½ä¸ä¼šå‡å°ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå‡½æ•°d(x)æ¥è¡¨ç¤ºæ®‹é‡ç½‘ç»œä¸­èŠ‚ç‚¹ x åˆ°æ±‡ç‚¹çš„è·ç¦»çš„ä¸‹ç•Œï¼ˆåœ¨Dinicä¸­æ˜¯ç”¨æ•°ç»„ d[]ï¼‰ï¼Œç„¶ååœ¨å¢å¹¿è¿‡ç¨‹ä¸­ä¸æ–­ä¿®æ­£è¿™ä¸ªä¸‹ç•Œï¼ˆè€Œä¸æ˜¯åƒDinic ç®—æ³•é‚£æ ·å¤šæ¬¡å¢å¹¿ä»¥åæ‰é‡å»ºå±‚æ¬¡å›¾ï¼‰ï¼Œåˆ™å¢å¹¿çš„æ—¶å€™å’Œ Dinic ç±»ä¼¼ï¼Œåªå…è®¸æ²¿ç€ d(y) = d(x) + 1 çš„æœ‰å‘è¾¹ (x , y) èµ°ã€‚</p><p>ä¸¥æ ¼çš„è¯´ï¼Œç®—æ³•ä¸­çš„ d å‡½æ•°æ˜¯æ»¡è¶³å¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶çš„éè´Ÿå‡½æ•°ï¼Œå³ d(t) = 0ï¼›å¯¹äºæ®‹é‡ç½‘ç»œä¸­çš„ä»»æ„å¼§ (x ,y)ï¼Œd(x) &lt;= d(y) + 1ã€‚ä¸éš¾è¯æ˜ï¼Œåªè¦æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ï¼Œd(x) å°±æ˜¯ x~t è·ç¦»çš„ä¸‹ç•Œã€‚è€Œä¸”å½“ d(s) &gt;= næ—¶ï¼Œæ®‹é‡ç½‘ç»œä¸­ä¸å­˜åœ¨ s-t è·¯ã€‚</p><p><strong>ç®—æ³•æ€è·¯</strong><br>å’Œ Dinic ç®—æ³•ç±»ä¼¼ï¼Œæ‰¾å¢å¹¿è·¯çš„è¿‡ç¨‹æ˜¯ä» s å¼€å§‹æ²¿ç€â€œå…è®¸å¼§â€ï¼ˆå³åœ¨æ®‹é‡ç½‘ç»œä¸­çš„ï¼Œæ»¡è¶³ d[x] = d[y] + 1 çš„å¼§ x â€”&gt; yï¼‰å¾€å‰èµ°ï¼ˆISAP ç®—æ³•ä¸­å«Advanceï¼‰å¦‚æœèµ°ä¸åŠ¨äº†æ€ä¹ˆåŠï¼Ÿåœ¨Dinicç®—æ³•ä¸­ï¼Œç›´æ¥â€œå¾€å›èµ°ä¸€æ­¥â€å³å¯ï¼Œå› ä¸ºå¦‚æœæ‰¾ä¸åˆ°å¢å¹¿è·¯ï¼Œä¼šé‡æ–°æ„é€ å±‚æ¬¡å›¾ï¼›ä½†åœ¨ISAPä¸­ï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªâ€œä¸€æ¬¡æ€§ä¿®æ”¹æ‰€æœ‰è·ç¦»æ ‡å·â€çš„è¿‡ç¨‹ï¼Œåªèƒ½è¾¹å¢å¹¿è¾¹ä¿®æ”¹ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨ä»ç»“ç‚¹ x å¾€å›èµ°çš„æ—¶å€™ï¼ŒæŠŠ d(x) ä¿®æ”¹ä¸º min{d(y) | (x , y)  æ˜¯æ®‹é‡ç½‘ç»œä¸­çš„å¼§ } + 1ï¼ˆISAPç®—æ³•å« Retreatï¼‰å³å¯ã€‚æ³¨æ„ï¼Œå¦‚æœæ®‹é‡ç½‘ç»œä¸­ä» x å‡ºå‘æ²¡æœ‰å¼§ï¼Œåˆ™è®¾ d(x) = nã€‚<br>ISAPç®—æ³•çœ‹ä¸Šå»ä¸éš¾ç†è§£ï¼Œä½†æ˜¯å®ç°èµ·æ¥å´æœ‰è¯¸å¤šç»†èŠ‚ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ç§â€œå½“<br>å‰å¼§â€çš„æ•°æ®ç»“æ„åŠ é€Ÿ å…è®¸å¼§ çš„æŸ»æ‰¾ï¼Œå…¶æ¬¡ï¼Œè¿˜éœ€è¦ä¸€ä¸ª gap æ•°ç»„ç»´æŠ¤æ¯ä¸ªè·ç¦»æ ‡å·<br>ç»“ç‚¹ç¼–å·ã€‚å½“æŠŠä¸€ä¸ªç»“ç‚¹çš„è·ç¦»æ ‡å·ä» x æ”¹æˆ y çš„æ—¶å€™,æŠŠ gap[x] å‡1,gap[y]åŠ 1,ç„¶å<br>æ£€æŸ¥ gap[x] æ˜¯å¦ä¸º0ã€‚å¦‚æœæ˜¯ 0 çš„è¯,è¯´æ˜ s-t ä¸è¿é€šï¼Œç®—æ³•ç»ˆæ­¢ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ gap ä¼˜åŒ–ã€‚æœ€åï¼Œåˆå§‹è·ç¦»æ ‡å·å¯ä»¥ç»Ÿä¸€è®¾ä¸º 0 ï¼Œä¹Ÿå¯ä»¥ç”¨é€†å‘BFSæ‰¾ï¼Œå•æ¬¡è¿è¡Œæ—¶æ•ˆç‡ç›¸å·®ä¸å¤§ï¼Œä½†å¦‚æœæ˜¯å¤šæ¬¡æ±‚è§£å°è§„æ¨¡ç½‘ç»œæµï¼ŒåŠ ä¸ŠBFSä»¥åé€Ÿåº¦å¾€å¾€ä¼šæœ‰æ˜æ˜¾æå‡ã€‚</p><p>æ•°æ®ç»“æ„æ–¹é¢ï¼Œåªå¤šäº†ä¸¤ä¸ªæ•°ç»„ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> pre[N];        <span class="comment">//å¯å¢å¹¿è·¯çš„ä¸Šä¸€æ¡å¼§</span></span><br><span class="line"><span class="keyword">int</span> gap[N];       <span class="comment">//è·ç¦»æ ‡å·è®¡æ•°</span></span><br></pre></td></tr></table></figure></p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">5</span>*N;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">/*ä»¥ä¸‹6è¡Œæ˜¯æ•°ç»„æ¨¡æ‹Ÿé‚»æ¥è¡¨éƒ¨åˆ†*/</span></span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],edge[M],nex[M],tot;</span><br><span class="line"><span class="keyword">int</span> cur[N],dis[N],gap[N],pre[N];</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">gap[k]:kå±‚æœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">pre[x]:xç‚¹å‰ä¸€æ¡è¾¹çš„ç¼–å·</span></span><br><span class="line"><span class="comment">cur[]æ˜¯ä¸´æ—¶æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">ver[++tot] = y, edge[tot] = z;</span><br><span class="line">nex[tot] = head[x]; head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m,s,t;</span><br><span class="line"><span class="keyword">int</span> que[N],front,rear;<span class="comment">//æ‰‹å·¥æ¨¡æ‹Ÿé˜Ÿåˆ—ï¼ŒèŠ‚çœéƒ¨åˆ†æ—¶é—´</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">front = rear = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) </span><br><span class="line">dis[i] = <span class="number">-1</span>,cur[i] = head[i],gap[i]= <span class="number">0</span>;</span><br><span class="line">dis[t] = <span class="number">0</span>;  que[rear++] = t;</span><br><span class="line"><span class="keyword">while</span>(front != rear)&#123;</span><br><span class="line"><span class="keyword">int</span> x = que[front++];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i],z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(dis[y] == <span class="number">-1</span>) </span><br><span class="line">que[rear++] = y, dis[y] = dis[x] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ~dis[t];<span class="comment">//-1çš„è¡¥ç æ˜¯11111111,æŒ‰ä½å–ååæ˜¯0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ISAP</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = s, ans = <span class="number">0</span>, i;<span class="comment">//æ—¶åˆ»æ³¨æ„iä¸èƒ½è¢«è¦†ç›–ï¼ï¼ï¼</span></span><br><span class="line">bfs(n);<span class="comment">//ä¸€æ¬¡bfsä»æ±‡ç‚¹å‘å‰æ›´æ–°å±‚æ¬¡æ•°ç»„dis</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>;i &lt;= n;i++) gap[dis[i]]++;</span><br><span class="line"><span class="keyword">while</span>(dis[s] &lt; n)&#123;</span><br><span class="line"><span class="keyword">if</span>(k == t)&#123;</span><br><span class="line"><span class="keyword">int</span> mi = INF, loc = t;</span><br><span class="line"><span class="keyword">while</span>(loc != s)&#123;</span><br><span class="line">mi = min(mi,edge[pre[loc]]);</span><br><span class="line">loc = ver[pre[loc]^<span class="number">1</span>];<span class="comment">//å‰ä¸€ä¸ªé¡¶ç‚¹</span></span><br><span class="line">&#125;</span><br><span class="line">loc = t;</span><br><span class="line"><span class="keyword">while</span>(loc != s)&#123;</span><br><span class="line">edge[pre[loc]] -= mi;</span><br><span class="line">edge[pre[loc]^<span class="number">1</span>] += mi;</span><br><span class="line">loc = ver[pre[loc]^<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">ans += mi, k = s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i = cur[k];i;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(z &amp;&amp; dis[k] == dis[y]+<span class="number">1</span>)&#123;</span><br><span class="line">pre[y] = cur[k] = i; k = y;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(i) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> m = n;</span><br><span class="line"><span class="keyword">for</span>(i = head[k];i;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i],z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(z &amp;&amp; dis[y] &lt; m) m = dis[y], cur[k] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(--gap[dis[k]] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">dis[k] = m+<span class="number">1</span>, ++gap[dis[k]];</span><br><span class="line"><span class="keyword">if</span>(k != s) k = ver[pre[k]^<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;s,&amp;t))&#123;</span><br><span class="line"><span class="built_in">memset</span>(head,<span class="number">0</span> ,<span class="keyword">sizeof</span> head); tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">addEdge(x,y,z); addEdge(y,x,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ISAP(n));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>åˆ˜æ±ä½³ï¼Œç®—æ³•ç«èµ›å…¥é—¨ç»å…¸è®­ç»ƒæŒ‡å—ï¼ŒåŒ—äº¬ï¼šæ¸…åå¤§å­¦å‡ºç‰ˆç¤¾ï¼Œ2012ï¼Œ362-363.</li><li>æç…œä¸œï¼Œç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ï¼Œéƒ‘å·ï¼šæ²³å—ç”µå­éŸ³åƒå‡ºç‰ˆç¤¾ï¼Œ2017ï¼Œ410-415.</li><li>ç§‹å¶æ‹“å“‰ï¼ŒæŒ‘æˆ˜ç¨‹åºè®¾è®¡ç«èµ›ç¬¬2ç‰ˆï¼ŒåŒ—äº¬ï¼šäººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾ï¼Œ2013ï¼Œ209-215.</li><li>Thomas H.Cormenï¼Œç®—æ³•å¯¼è®ºï¼ˆåŸä¹¦ç¬¬3ç‰ˆï¼‰ï¼ŒåŒ—äº¬ï¼šæœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾ï¼Œ2013ï¼Œ414-417.</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾è®º </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
            <tag> æœ€å¤§æµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¼™ä¼´ç®—æ³•</title>
      <link href="/2019/11/13/buddy-system/"/>
      <url>/2019/11/13/buddy-system/</url>
      
        <content type="html"><![CDATA[<h4 id="ä¼™ä¼´ç³»ç»Ÿï¼ˆBuddy-Systemï¼‰"><a href="#ä¼™ä¼´ç³»ç»Ÿï¼ˆBuddy-Systemï¼‰" class="headerlink" title="ä¼™ä¼´ç³»ç»Ÿï¼ˆBuddy Systemï¼‰"></a>ä¼™ä¼´ç³»ç»Ÿï¼ˆBuddy Systemï¼‰</h4><p><strong>ä¼™ä¼´ç³»ç»Ÿçš„ç‰¹ç‚¹</strong></p><ul><li>æ•´ä¸ªå¯åˆ†é…çš„åˆ†åŒºå¤§å°ä¸º $2^u$ã€‚</li><li>éœ€è¦çš„åˆ†åŒºå¤§å°ä¸º $2^{u-1} &lt; s &lt;= 2^u$æ—¶ï¼ŒæŠŠæ•´ä¸ªå—åˆ†é…ç»™è¯¥è¿›ç¨‹ã€‚</li></ul><p><strong>åˆ†é…åˆ†åŒºçš„è¿‡ç¨‹ï¼š</strong><br>å¦‚æœ $s &lt;= 2^{i-1}$ï¼Œåˆ™å°†å¤§å°ä¸º$2^i$çš„å½“å‰ç©ºé—²åˆ†åŒºåˆ’åˆ†ä¸ºä¸¤ä¸ªå¤§å°ä¸º$2^{i-1}$çš„ç©ºé—²åˆ†åŒº<br>é‡å¤åˆ’åˆ†è¿‡ç¨‹ï¼Œç›´è‡³$2^{i-1} &lt; s &lt;= 2^i$ï¼Œå¹¶æŠŠä¸€ä¸ªç©ºé—²åˆ†åŒºåˆ†é…ç»™è¯¥è¿›ç¨‹ã€‚</p><h4 id="ä¼™ä¼´ç³»ç»Ÿçš„å®ç°"><a href="#ä¼™ä¼´ç³»ç»Ÿçš„å®ç°" class="headerlink" title="ä¼™ä¼´ç³»ç»Ÿçš„å®ç°"></a>ä¼™ä¼´ç³»ç»Ÿçš„å®ç°</h4><p><strong>æ•°æ®ç»“æ„ï¼š</strong></p><ul><li>ç©ºé—²å—æŒ‰ç…§å¤§å°å’Œèµ·å§‹åœ°å€ç»„æˆäºŒç»´æ•°ç»„ã€‚</li><li>åˆå§‹çŠ¶æ€ï¼šåªæœ‰ä¸€ä¸ªå¤§å°ä¸º$2^u$çš„ç©ºé—²å—ã€‚</li></ul><p><strong>åˆ†é…è¿‡ç¨‹ï¼š</strong></p><ul><li>ç”±å¤§åˆ°å°åœ¨ç©ºé—²å—æ•°ç»„ä¸­æ‰¾åˆ°æœ€å°çš„å¯ç”¨ç©ºé—²å—ã€‚</li><li>å¦‚æœç©ºé—²å—è¿‡å¤§ï¼Œå¯¹å¯ç”¨çš„ç©ºé—²å—è¿›è¡ŒäºŒç­‰åˆ†ï¼Œç›´åˆ°å¾—åˆ°åˆé€‚çš„å¯ç”¨çš„ç©ºé—²å—ã€‚</li></ul><p><strong>åˆ†é…æ ·ä¾‹å›¾ç¤ºï¼š</strong><br><img src="/2019/11/13/buddy-system/1.png" alt="1"></p><p><strong>é‡Šæ”¾è¿‡ç¨‹ï¼š</strong></p><ul><li>æŠŠé‡Šæ”¾çš„ç©ºé—²å—æ”¾å…¥ç©ºé—²æ•°ç»„</li><li>åˆå¹¶æ»¡è¶³åˆå¹¶æ¡ä»¶çš„ç©ºé—²å—</li></ul><p><strong>åˆå¹¶æ¡ä»¶ï¼š</strong></p><ul><li>å¤§å°ç›¸åŒï¼Œä¾‹å¦‚éƒ½æ˜¯$2^i$</li><li>åœ°å€ç›¸é‚»</li><li>ä½åœ°å€ç©ºé—²å—èµ·å§‹åœ°å€ä¸º$2^{i+1}$çš„ä½æ•°</li></ul><h4 id="ä¼™ä¼´ç®—æ³•çš„ä¼˜ç¼ºç‚¹"><a href="#ä¼™ä¼´ç®—æ³•çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼™ä¼´ç®—æ³•çš„ä¼˜ç¼ºç‚¹"></a>ä¼™ä¼´ç®—æ³•çš„ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>è¾ƒå¥½çš„è§£å†³å¤–éƒ¨ç¢ç‰‡é—®é¢˜</li><li>å½“éœ€è¦åˆ†é…è‹¥å¹²ä¸ªå†…å­˜é¡µé¢æ—¶ï¼Œç”¨äºDMAçš„å†…å­˜é¡µé¢å¿…é¡»è¿ç»­ï¼Œä¼™ä¼´ç®—æ³•å¾ˆå¥½çš„æ»¡è¶³äº†è¿™ä¸ªè¦æ±‚</li><li>åªè¦è¯·æ±‚çš„å—ä¸è¶…è¿‡512ä¸ªé¡µé¢ï¼ˆ2kï¼‰ï¼Œå†…æ ¸å°±å°½é‡åˆ†é…è¿ç»­çš„é¡µé¢ã€‚</li><li>é’ˆå¯¹å¤§å†…å­˜åˆ†é…è®¾è®¡</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>åˆå¹¶çš„è¦æ±‚è¿‡äºä¸¥æ ¼ï¼Œåªèƒ½æ˜¯æ»¡è¶³ä¼™ä¼´å…³ç³»çš„å—æ‰èƒ½åˆå¹¶</li><li>ç¢ç‰‡é—®é¢˜ï¼šä¸€ä¸ªè¿ç»­çš„å†…å­˜ä¸­ä»…ä»…ä¸€ä¸ªé¡µé¢è¢«å ç”¨ï¼Œå¯¼è‡´æ•´ä¸ªå†…å­˜åŒºéƒ½ä¸å…·å¤‡åˆå¹¶æ¡ä»¶</li><li>æµªè´¹é—®é¢˜ï¼šä¼™ä¼´ç®—æ³•åªèƒ½åˆ†é…2çš„å¹‚æ¬¡æ–¹å†…å­˜åŒºï¼Œå½“éœ€è¦çš„å†…å­˜ä¸º$2^i+1$ K æ—¶ï¼Œä¾‹å¦‚éœ€è¦ 9K æ—¶ï¼Œå°±éœ€è¦åˆ†é…16Kçš„å†…å­˜ç©ºé—´ï¼Œå‰©ä¸‹çš„ 7K æµªè´¹äº†ã€‚</li><li>ç®—æ³•çš„æ•ˆç‡é—®é¢˜ï¼šä¼™ä¼´ç®—æ³•ä¸­æ¶‰åŠäº†æ¯”è¾ƒå¤šçš„è®¡ç®—è¿˜æœ‰é“¾è¡¨å’Œä½å›¾çš„æ“ä½œï¼Œå¼€é”€æ¯”è¾ƒå¤§ï¼Œå¦‚æœæ¯æ¬¡åˆå¹¶$2^n$å¤§å°çš„å—ä¸º$2^{n+1}$çš„å°ï¼Œé‚£ä¹ˆå¤§å°ä¸º$2^n$çš„å—ä¼šå‡å°‘ï¼Œå¦‚æœéšåç³»ç»Ÿåˆéœ€è¦$2^n$å¤§å°çš„å—ï¼Œå°±åˆè¦æ‹†åˆ†ï¼Œè¿™æ ·çš„ç«‹å³åˆå¹¶å’Œæ‹†åˆ†è¿‡ç¨‹æ— æ•ˆç‡ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºæ“ä½œç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…å­˜åˆ†é… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntuä¸‹vimç®€å•å…¥é—¨</title>
      <link href="/2019/10/26/vim-use/"/>
      <url>/2019/10/26/vim-use/</url>
      
        <content type="html"><![CDATA[<h4 id="å®‰è£…vim"><a href="#å®‰è£…vim" class="headerlink" title="å®‰è£…vim"></a>å®‰è£…vim</h4><p>åœ¨ubuntuçš„å‘½ä»¤è¡Œä¸‹è¾“å…¥<code>sudo apt install vim</code> ä»¥è·å¾—vimã€‚å¦‚é‡åˆ°æŠ¥é”™ï¼Œå¯å¤åˆ¶æŠ¥é”™ä¿¡æ¯å»ç™¾åº¦å¯»æ‰¾å¯¹åº”è§£å†³ç­–ç•¥ã€‚</p><h4 id="vimçš„ä½¿ç”¨"><a href="#vimçš„ä½¿ç”¨" class="headerlink" title="vimçš„ä½¿ç”¨"></a>vimçš„ä½¿ç”¨</h4><p>vimç¼–è¾‘å™¨æœ‰ä¸‰ç§ï¼šå‘½ä»¤æ¨¡å¼ï¼Œæœ«è¡Œæ¨¡å¼ï¼Œæ’å…¥æ¨¡å¼ã€‚</p><p>æ‰“å¼€vimæ—¶é»˜è®¤çš„æ˜¯<strong>å‘½ä»¤æ¨¡å¼</strong>ï¼Œæ­¤çŠ¶æ€ä¸‹æ•²å‡»é”®ç›˜è§†ä¸ºè¾“å…¥å‘½ä»¤è€Œéå­—ç¬¦ã€‚è‹¥æƒ³è¿›å…¥<strong>æ’å…¥æ¨¡å¼</strong>ï¼Œåˆ™è¦åœ¨å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥ i ï¼Œæ­¤æ—¶å¯ä»¥è¾“å…¥å­—ç¬¦ï¼Œç¼–è¾‘æ–‡æœ¬ï¼›è¾“å…¥å®Œæ¯•åï¼ŒæŒ‰ESCå¯é€€å›åˆ°å‘½ä»¤æ¨¡å¼ã€‚<br>å‘½ä»¤æ¨¡å¼åªæœ‰ä¸€äº›ç®€å•çš„å‘½ä»¤ï¼Œæ›´å¤šå‘½ä»¤éœ€è¦ä½¿ç”¨æœ«è¡Œæ¨¡å¼ï¼›åœ¨å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥â€ : â€œï¼ˆä¸å«å¼•å·ï¼‰å¯è¿›å…¥æœ«è¡Œæ¨¡å¼ï¼Œæœ«è¡Œæ¨¡å¼å¯ä»¥è¿›è¡Œæ›´å¤šçµæ´»çš„æ“ä½œã€‚</p><p>ä»¥ä¸Šæ˜¯ä¸‰ç§æ¨¡å¼çš„å¼‚åŒä»¥åŠåˆ‡æ¢æ–¹æ³•ã€‚</p><h4 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><p>ä»¥ä¸‹å¤åˆ¶è€å¸ˆçš„ç¬”è®°ï¼š</p><p><strong>æ¨¡å¼åˆ‡æ¢</strong></p><ol><li>è¾“å…¥iè¿›å…¥æ’å…¥æ¨¡å¼</li><li>åœ¨æ’å…¥æ¨¡å¼ä¸­æŒ‰ESCè¿›å…¥å‘½ä»¤æ¨¡å¼</li><li>åœ¨å‘½ä»¤æ¨¡å¼ä¸­è¾“å…¥ â€œ : â€œ è¿›å…¥æœ«è¡Œæ¨¡å¼</li></ol><p><strong>ä¿å­˜ï¼š</strong></p><ol><li>å‘½ä»¤æ¨¡å¼ä¸­è¾“å…¥ZZ</li><li>åœ¨æœ«è¡Œæ¨¡å¼ä¸­è¾“å…¥:wq</li></ol><p><strong>ç¼–è¯‘ï¼š</strong></p><ol><li>g++ -o test test.cpp -Wall</li></ol><p><strong>å®šä½ï¼š</strong></p><ol><li>:i å®šä½åˆ°ç¬¬ i è¡Œ</li><li>:/x å®šä½åˆ°xç¬¬ä¸€æ¬¡å‡ºç°çš„è¡Œ</li></ol><p><strong>åˆ é™¤è¡Œï¼ˆå‘½ä»¤æ¨¡å¼ä¸‹ï¼‰ï¼š</strong></p><ol><li>ddåˆ é™¤å½“å‰è¡Œ</li><li>d2dåˆ é™¤åŒ…å«å½“å‰è¡Œçš„2è¡Œï¼Œå‘ä¸‹çš„</li></ol><p><strong>æ’¤å›ï¼š</strong></p><ol><li>å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥ u</li></ol><p><strong>å¤åˆ¶ï¼ˆå‘½ä»¤æ¨¡å¼ä¸‹ï¼‰ï¼š</strong></p><ol><li>yyï¼Œä¸ddåŠŸèƒ½ç›¸ä¼¼</li><li>ç²˜è´´æ—¶æŒ‰p</li></ol><h4 id="é…ç½®vim"><a href="#é…ç½®vim" class="headerlink" title="é…ç½®vim"></a>é…ç½®vim</h4><p>æ­¤æ—¶vimå¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œä½†æ˜¯ç•Œé¢æœ‰äº›ä¸å‹å¥½ï¼Œæ²¡æœ‰è¡Œå·ï¼Œç¼©è¿›ä¹Ÿå¾ˆéš¾çœ‹ï¼Œæ›´æ²¡æœ‰è‡ªåŠ¨è¡¥å…¨ç­‰ã€‚<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æœ«è¡Œæ¨¡å¼ä¸­è¾“å…¥ä¸€äº›å‘½ä»¤æ¥ä½¿å¾—ç•Œé¢ä»¥åŠæ“ä½œæ›´åŠ å‹å¥½ï¼Œä¾‹å¦‚æ·»åŠ è¡Œå·ï¼Œè®¾ç½®ç¼©è¿›ç­‰ï¼Œä½†æ˜¯è¿™æ ·éœ€è¦æ¯æ¬¡æ‰“å¼€viméƒ½è¦é‡æ–°é…ç½®ï¼Œæ‰€ä»¥ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œå¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶è¾¾åˆ°è‡ªåŠ¨é…ç½®çš„ç›®çš„ã€‚</p><p>é¦–å…ˆé€šè¿‡ <code>cd ~</code> è¿›å…¥ç”¨æˆ·æ ¹ç›®å½•ï¼Œç„¶å<code>vim .vimrc</code> æ–°å»ºä¸€ä¸ªéšè—æ–‡ä»¶<code>.vimrc</code>ï¼Œå¹¶æ‰“å¼€ç¼–è¾‘ï¼›è¾“å…¥å¦‚ä¸‹é…ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">set nu          //æ˜¾ç¤ºè¡Œå·</span><br><span class="line">set ts=4        //åˆ¶è¡¨ç¬¦å®½åº¦</span><br><span class="line">set history=1000    </span><br><span class="line">set showmatch   //é«˜äº®æ˜¾ç¤ºåŒ¹é…çš„æ‹¬å·</span><br><span class="line">set ruler       //æ˜¾ç¤ºå°ºå¯¸</span><br><span class="line">set mouse=a     //å¯ç”¨é¼ æ ‡é€‰æ‹©</span><br><span class="line">set autoindent  //è‡ªåŠ¨ç¼©è¿›</span><br><span class="line">set cindent     //è‡ªåŠ¨ç¼©è¿›</span><br><span class="line">set nobackup    //ç¦æ­¢ç”Ÿæˆä¸´æ—¶æ–‡ä»¶</span><br><span class="line">set smartindent //è‡ªåŠ¨ç¼©è¿›</span><br><span class="line">set shiftwidth=4    //è‡ªåŠ¨ç¼©è¿›çš„é•¿åº¦</span><br><span class="line">set expandtab   //tabå˜ç©ºæ ¼</span><br><span class="line"></span><br><span class="line">//ä»¥ä¸‹æ˜¯è‡ªåŠ¨è¡¥å…¨</span><br><span class="line">inoremap&#123; &#123;&#125;&lt;ESC&gt;i&lt;CR&gt;&lt;ESC&gt;O</span><br><span class="line">inoremap( ()&lt;ESC&gt;i</span><br><span class="line">inoremap[ []&lt;ESC&gt;i</span><br><span class="line">inoremap&apos; &apos;&apos;&lt;ESC&gt;i</span><br><span class="line">inoremap&quot; &quot;&quot;&lt;ESC&gt;i</span><br><span class="line"></span><br><span class="line">set encoding=utf-8</span><br><span class="line">set softtabstop=4</span><br><span class="line"></span><br><span class="line">//å®šä¹‰F6å¿«æ·ç¼–è¯‘è¿è¡Œï¼Œåœ¨å‘½ä»¤æ¨¡å¼ä¸‹</span><br><span class="line">map &lt;F6&gt; :cal CR() &lt;CR&gt;</span><br><span class="line">func! CR()</span><br><span class="line">exec &quot;w&quot;</span><br><span class="line">exec &quot;!g++ % -o %&lt;&quot;</span><br><span class="line">exec &quot;! ./%&lt;&quot;</span><br><span class="line">endfunc</span><br></pre></td></tr></table></figure></p><p>è¾“å…¥å®ŒæˆåæŒ‰ESCè¿›å…¥å‘½ä»¤æ¨¡å¼ï¼Œå† :wq ä¿å­˜é€€å‡ºå³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å•è°ƒæ ˆä¸å•è°ƒé˜Ÿåˆ—</title>
      <link href="/2019/10/17/ddz/"/>
      <url>/2019/10/17/ddz/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>å•è°ƒæ ˆå’Œå•è°ƒé˜Ÿåˆ—éƒ½å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§å¯¹æ ˆå’Œé˜Ÿåˆ—çš„ç‰¹æ®Šç”¨æ³•ï¼Œå³è¦æ±‚æ ˆæˆ–é˜Ÿåˆ—ä¸­çš„å…ƒç´ å…·æœ‰å•è°ƒæ€§ï¼Œé€’å¢æˆ–é€’å‡ã€‚é‚£ä¹ˆå¾ˆæ˜¾ç„¶è¿™ç§æ•°æ®ç»“æ„å°±æ˜¯åŸºäºæ ˆå’Œé˜Ÿåˆ—å®ç°çš„ï¼Œå³å®ƒæ—¢ä¿ç•™äº†æ ˆçš„å…ˆè¿›åå‡ºï¼ˆé˜Ÿåˆ—å°±æ˜¯ä¿ç•™å…ˆè¿›å…ˆå‡ºï¼‰ï¼Œåˆå…·æœ‰å•è°ƒæ€§ã€‚è€Œæˆ‘ä»¬åœ¨æŸäº›æ—¶å€™æ­£éœ€è¦å…¶è¿™ç§æ€§è´¨ï¼Œæˆ‘ä»¬åœ¨è®²è§£äº†å•è°ƒæ ˆå’Œå•è°ƒé˜Ÿåˆ—çš„å®šä¹‰ã€ç‰¹æ€§ã€æ„é€ æ–¹æ³•åï¼Œä¼šå„ç»™å‡ºä¸€é“ä¾‹é¢˜æ¥ä½“ç°å®ƒä»¬çš„ç”¨æ³•ã€‚</p><h4 id="å•è°ƒæ ˆ"><a href="#å•è°ƒæ ˆ" class="headerlink" title="å•è°ƒæ ˆ"></a>å•è°ƒæ ˆ</h4><h5 id="å•è°ƒæ ˆçš„æ¦‚å¿µ"><a href="#å•è°ƒæ ˆçš„æ¦‚å¿µ" class="headerlink" title="å•è°ƒæ ˆçš„æ¦‚å¿µ"></a>å•è°ƒæ ˆçš„æ¦‚å¿µ</h5><p>å•è°ƒæ ˆæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ ˆï¼Œæ ˆå†…çš„æ‰€æœ‰å…ƒç´ éƒ½ä¿æŒç€å•è°ƒæ€§ï¼Œå³å•è°ƒé€’å¢æˆ–å•è°ƒé€’å‡ã€‚</p><h5 id="å•è°ƒæ ˆçš„æ€§è´¨"><a href="#å•è°ƒæ ˆçš„æ€§è´¨" class="headerlink" title="å•è°ƒæ ˆçš„æ€§è´¨"></a>å•è°ƒæ ˆçš„æ€§è´¨</h5><ul><li>å•è°ƒæ€§ã€‚è‹¥æ˜¯å•è°ƒé€’å¢æ ˆï¼Œåˆ™ä»æ ˆé¡¶åˆ°æ ˆåº•çš„å…ƒç´ æ˜¯ä¸¥æ ¼é€’å¢çš„ã€‚è‹¥æ˜¯å•è°ƒé€’å‡æ ˆï¼Œåˆ™ä»æ ˆé¡¶åˆ°æ ˆåº•çš„å…ƒç´ æ˜¯ä¸¥æ ¼é€’å‡çš„ã€‚</li><li>é è¿‘æ ˆåº•çš„å…ƒç´ å…ˆè¿›æ ˆï¼Œè¶Šé åçš„å…ƒç´ è¶Šåè¿›æ ˆã€‚</li></ul><p>å•è°ƒæ ˆå’Œæ™®é€šçš„æ ˆä¸€æ ·ï¼Œéƒ½åªèƒ½åœ¨æ ˆé¡¶æ“ä½œï¼Œå‹å…¥æˆ–å¼¹å‡ºã€‚è€Œæˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€äº›çº¦æŸæ¥ä½¿å¾—æ ˆå†…å…ƒç´ å…·æœ‰å•è°ƒæ€§ï¼Œä»è€Œæ„æˆå•è°ƒæ ˆã€‚</p><h5 id="æ„é€ å•è°ƒæ ˆ"><a href="#æ„é€ å•è°ƒæ ˆ" class="headerlink" title="æ„é€ å•è°ƒæ ˆ"></a>æ„é€ å•è°ƒæ ˆ</h5><p>ä»¥å•è°ƒé€’å¢æ ˆä¸ºä¾‹ï¼šå¯¹äºå½“å‰å…ƒç´ eï¼Œè‹¥eå¤§äºæ ˆé¡¶å…ƒç´ ï¼Œåˆ™è¿›æ ˆï¼Œå¦åˆ™å¼¹å‡ºæ ˆé¡¶å…ƒç´ ï¼Œå†æ¬¡è¿›è¡Œæ¯”è¾ƒï¼Œé‡å¤ç›´è‡³æ ˆé¡¶å…ƒç´ å°äºeæˆ–æ ˆä¸ºç©ºä¸ºæ­¢ï¼Œæ­¤æ—¶å°†eå‹å…¥æ ˆã€‚<br>å¯¹äºå¼¹å‡ºçš„å…ƒç´ ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦é‡æ–°å‹å›ï¼Œå› ä¸ºä¸€èˆ¬æƒ…å†µä¸‹å®ƒä»¬éƒ½å±äºè¢«â€œæ·˜æ±°â€çš„å…ƒç´ ï¼Œåé¢å‹å…¥çš„å…ƒç´ ä¸€èˆ¬åˆâ€œæ–°é²œâ€åˆâ€œç¾å‘³â€ï¼Œå³æ—¶é—´ä¸Šå’Œæ•°å€¼ä¸Šéƒ½æ¯”å…¶ä¼˜ç§€ã€‚</p><h5 id="ä¾‹é¢˜HDU1506"><a href="#ä¾‹é¢˜HDU1506" class="headerlink" title="ä¾‹é¢˜HDU1506"></a>ä¾‹é¢˜HDU1506</h5><p>å…ˆæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœé¢˜ç›®ä¸­çš„çŸ©å½¢çš„é«˜åº¦éƒ½æ˜¯å•è°ƒé€’å¢çš„ï¼Œå¦‚ä½•å¾—åˆ°æœ€ä¼˜è§£ï¼Ÿæ˜¾ç„¶æœ‰ä¸€ä¸ªè´ªå¿ƒçš„ç­–ç•¥ï¼Œå°±æ˜¯ä»¥æ¯ä¸€ä¸ªçŸ©å½¢çš„é«˜åº¦ä½œä¸ºæœ€ç»ˆå¤§çŸ©å½¢çš„é«˜åº¦ï¼Œçœ‹æœ€å®½èƒ½æ˜¯å¤šå°‘ï¼Œç„¶åç»Ÿè®¡æœ€ä¼˜è§£ã€‚<br>ä½†å¦‚æœè¿›æ¥çš„ä¸‹ä¸€çŸ©å½¢æ¯”ä¸Šä¸€ä¸ªä½ï¼Œå®ƒå…¶å®ç›¸å½“äºé™åˆ¶äº†ä¹‹å‰çŸ©å½¢çš„é«˜åº¦ï¼Œé‚£ä¹ˆä¹‹å‰çŸ©å½¢æ¯”è¿™ä¸ªçŸ©å½¢é«˜å‡ºçš„é«˜åº¦åœ¨ä»¥åçš„ç»Ÿè®¡ä¸­å°±æ²¡æœ‰ä¸æ¯«ç”¨å¤„äº†ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªæ—¶å€™æŠŠä»¥ä¹‹å‰çŸ©å½¢çš„é«˜åº¦ä½œä¸ºæœ€ç»ˆé«˜åº¦çš„ç­”æ¡ˆç»Ÿè®¡æ‰ï¼Œé‚£ä¹ˆåæ­£ä»¥åçš„ç»Ÿè®¡å’Œä¸Šä¸€ä¸ªçŸ©å½¢æ²¡æœ‰å…³ç³»ï¼Œè¿˜ä¸å¦‚æŠŠä»–åˆ é™¤ã€‚<br>è¿™æ ·ï¼Œæˆ‘ä»¬å®é™…ä¸Šå°±å¾—åˆ°äº†å•è°ƒæ ˆçš„æ¨¡å‹ï¼Œåªéœ€è¦ç»´æŠ¤ä¸€ä¸ªå•è°ƒæ ˆï¼Œåœ¨ç»´æŠ¤å•è°ƒæ€§çš„å¼¹å‡ºæ“ä½œæ—¶ç»Ÿè®¡å®½åº¦ï¼Œæ›´æ–°ç­”æ¡ˆå³å¯åœ¨O(n) æ—¶é—´å†…å¾—åˆ°æœ€ä¼˜è§£ã€‚<br>ä¸ºäº†æ–¹ä¾¿æŠŠæœ€åå‰©ä¸‹çš„ï¼Œä»¥åŠå•è°ƒé€’å¢çš„çŸ©å½¢ä¹Ÿç»Ÿè®¡è¿›å»ï¼Œæˆ‘ä»¬å‡è®¾a[n+1]çš„ä½ç½®æœ‰ä¸€ä¸ªé«˜åº¦ä¸º0çš„çŸ©å½¢ï¼Œæœ€åå°†å®ƒåŠ å…¥å•è°ƒæ ˆæ—¶ä»–ä¼šå°†æ‰€æœ‰çŸ©å½¢éƒ½å¼¹å‡ºï¼Œé‚£ä¹ˆç­”æ¡ˆä¹Ÿå°±å®Œæˆæœ€åçš„æ›´æ–°äº†ã€‚</p><h5 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h5><p>è§é™„å½•éƒ¨åˆ†code-1</p><h4 id="å•è°ƒé˜Ÿåˆ—"><a href="#å•è°ƒé˜Ÿåˆ—" class="headerlink" title="å•è°ƒé˜Ÿåˆ—"></a>å•è°ƒé˜Ÿåˆ—</h4><h5 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h5><p>å•è°ƒé˜Ÿåˆ—çš„æ¦‚å¿µå’Œå•è°ƒæ ˆç±»ä¼¼ï¼Œåªæ˜¯æŠŠå…ˆè¿›åå‡ºæ”¹æˆå…ˆè¿›å…ˆå‡ºå°±å¯ä»¥äº†ã€‚å…¶å…·æœ‰å…ˆè¿›å…ˆå‡ºçš„ç‰¹æ€§å¹¶ä¸”é˜Ÿåˆ—ä¸­å…ƒç´ å…·æœ‰å•è°ƒæ€§ã€‚<br>å•è°ƒæ˜¯ä¸€ç§æ€æƒ³ï¼Œå½“æˆ‘ä»¬è§£å†³é—®é¢˜çš„æ—¶å€™å‘ç°æœ‰è®¸å¤šå†—æ‚æ— ç”¨çš„çŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å•è°ƒæ€æƒ³ï¼Œç”¨å•è°ƒé˜Ÿåˆ—æˆ–ç±»ä¼¼äºå•è°ƒé˜Ÿåˆ—çš„æ–¹æ³•å»é™¤å†—æ‚çŠ¶æ€ï¼Œä¿å­˜æˆ‘ä»¬æƒ³è¦çš„çŠ¶æ€ã€‚</p><h5 id="å•è°ƒé˜Ÿåˆ—çš„æ€§è´¨"><a href="#å•è°ƒé˜Ÿåˆ—çš„æ€§è´¨" class="headerlink" title="å•è°ƒé˜Ÿåˆ—çš„æ€§è´¨"></a>å•è°ƒé˜Ÿåˆ—çš„æ€§è´¨</h5><ul><li>å•è°ƒé˜Ÿåˆ—çš„æœ€ä¼˜é€‰æ‹©åœ¨é˜Ÿé¦–ã€‚</li><li>é˜Ÿåˆ—å…ƒç´ å…·æœ‰å•è°ƒæ€§ã€‚</li><li>å»é™¤å†—ä½™çŠ¶æ€ï¼ˆæ— ç”¨çŠ¶æ€ï¼‰ã€‚</li><li>ç»´æŠ¤åŒºé—´æœ€å€¼ã€‚</li></ul><h5 id="å•è°ƒé˜Ÿåˆ—çš„æ„é€ æ–¹æ³•"><a href="#å•è°ƒé˜Ÿåˆ—çš„æ„é€ æ–¹æ³•" class="headerlink" title="å•è°ƒé˜Ÿåˆ—çš„æ„é€ æ–¹æ³•"></a>å•è°ƒé˜Ÿåˆ—çš„æ„é€ æ–¹æ³•</h5><ul><li>ç»´æŠ¤é˜Ÿé¦–ï¼ˆå¯¹äºä¸Šé¢˜å°±æ˜¯å¦‚æœé˜Ÿé¦–å·²ç»æ˜¯å½“å‰å…ƒç´ çš„mä¸ªä¹‹å‰ï¼Œåˆ™é˜Ÿé¦–å°±åº”è¯¥è¢«åˆ äº†,head++ï¼‰</li><li>åœ¨é˜Ÿå°¾æ’å…¥ï¼ˆæ¯æ’å…¥ä¸€ä¸ªå°±è¦ä»é˜Ÿå°¾å¼€å§‹å¾€å‰å»é™¤å†—æ‚çŠ¶æ€ï¼Œä¿æŒå•è°ƒæ€§ï¼‰</li></ul><p>å‡å¦‚å¯¹äºåºåˆ—Aï¼ša1,  a2 , â€¦ an å»ºç«‹ä¸€ä¸ªå•è°ƒé€’å‡æ ˆç»´æŠ¤é•¿åº¦ä¸ºmçš„å­—æ®µæœ€å¤§å€¼ï¼Œé‚£ä¹ˆå¯¹äºå½“å‰å…ƒç´ eï¼Œè‹¥é˜Ÿé¦–å…ƒç´ å°äºeï¼Œé‚£ä¹ˆå…¶ä½ç½®ä¸Šä¸å ä¼˜åŠ¿ï¼ˆè¦è¢«è¸¢å‡ºé•¿åº¦ä¸ºmçš„å­—æ®µï¼‰ï¼Œè€Œä¸”å…¶æ•°å€¼ä¸Šä¹Ÿä¸å ä¼˜åŠ¿ï¼ˆæ¯”æ–°æ¥çš„eè¦å°ï¼‰ï¼Œæ‰€ä»¥å…¶å°±è¦è¢«èˆå¼ƒã€‚é‡å¤è¿™ä¸€æ“ä½œï¼Œç›´è‡³é˜Ÿé¦–å…ƒç´ å¤§äºå…ƒç´ eï¼Œé‚£ä¹ˆè¯´æ˜å…¶è¿˜æœ‰ç”¨ï¼Œå°±ä¿ç•™ã€‚<br>ä¸¾ä¸ªåº”ç”¨ä¾‹å­ï¼š</p><p>æ•°åˆ—ä¸ºï¼š6 4 10 10 8 6 4 2 12 14<br>N=10,K=3;<br>é‚£ä¹ˆæˆ‘ä»¬æ„é€ ä¸€ä¸ªé•¿åº¦ä¸º3çš„å•è°ƒé€’å‡é˜Ÿåˆ—ï¼š<br>é¦–å…ˆï¼Œé‚£6å’Œå®ƒçš„ä½ç½®0æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œæˆ‘ä»¬ç”¨(6,0)è¡¨ç¤ºï¼Œæ¯ä¸€æ­¥æ’å…¥å…ƒç´ æ—¶é˜Ÿåˆ—ä¸­çš„å…ƒç´ å¦‚ä¸‹<br>æ’å…¥6ï¼š(6,0);<br>æ’å…¥4ï¼š(6,0),(4,1);<br>æ’å…¥10ï¼š(10,2);<br>æ’å…¥ç¬¬äºŒä¸ª10ï¼Œä¿ç•™åé¢é‚£ä¸ªï¼š(10,3);<br>æ’å…¥8ï¼š(10,3),(8,4);<br>æ’å…¥6ï¼š(10,3),(8,4),(6,5);<br>æ’å…¥4ï¼Œä¹‹å‰çš„10å·²ç»è¶…å‡ºèŒƒå›´æ‰€ä»¥æ’æ‰ï¼š(8,4),(6,5),(4,6);<br>æ’å…¥2ï¼ŒåŒç†ï¼š(6,5),(4,6),(2,7);<br>æ’å…¥12ï¼š(12,8);<br>æ’å…¥14ï¼š(14,9);<br>é‚£ä¹ˆf(i)å°±æ˜¯ç¬¬iæ­¥æ—¶é˜Ÿåˆ—å½“ä¸­çš„é¦–å…ƒç´ ï¼š6,6,10,10,10,10,8,6,12,14åŒç†ï¼Œæœ€å°å€¼ä¹Ÿå¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—æ¥åšã€‚</p><h5 id="ä¾‹é¢˜Poj-2823"><a href="#ä¾‹é¢˜Poj-2823" class="headerlink" title="ä¾‹é¢˜Poj 2823"></a>ä¾‹é¢˜Poj 2823</h5><p>ç»™å®šä¸€ä¸ªæ•°åˆ—ï¼Œä»å·¦è‡³å³è¾“å‡ºæ¯ä¸ªé•¿åº¦ä¸ºmçš„æ•°åˆ—æ®µå†…çš„æœ€å°æ•°å’Œæœ€å¤§æ•°ã€‚æ•°åˆ—é•¿åº¦ï¼š$N&lt;=10^6ï¼Œm&lt;=N$<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>æˆ‘ä»¬çŸ¥é“ï¼Œæš´åŠ›æšä¸¾çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªåœ°æ–¹æ˜¯é‡å¤æ¯”è¾ƒäº†ï¼Œå°±æ˜¯åœ¨æ‰¾å½“å‰çš„f(i)çš„æ—¶å€™ï¼Œiçš„å‰é¢å…¶å®ƒm-1ä¸ªæ•°åœ¨ç®—f(i-1)çš„æ—¶å€™æˆ‘ä»¬å°±æ¯”è¾ƒè¿‡äº†ã€‚å½“ä½ ä¸€ä¸ªä¸ªå¾€ä¸‹æ‰¾æ—¶ï¼Œæ¯ä¸€æ¬¡éƒ½æ˜¯å°‘ä¸€ä¸ªç„¶åå¤šä¸€ä¸ªï¼Œå¦‚æœå°‘çš„ä¸æ˜¯æœ€å¤§å€¼ï¼Œç„¶åå†é—®æ–°åŠ è¿›æ¥çš„ï¼Œçœ‹èµ·æ¥å¾ˆçœæ—¶é—´å¯¹å§ï¼Œé‚£ä¹ˆå¦‚æœå°‘äº†çš„æ˜¯æœ€å¤§å€¼å‘¢ï¼Ÿç¬¬äºŒä¸ªæœ€å¤§å€¼æ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿé‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½ä¿å­˜ä¸Šä¸€æ¬¡çš„ç»“æœå‘¢ï¼Ÿå½“ç„¶ä¸»è¦æ˜¯içš„å‰k-1ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼äº†ã€‚ç­”æ¡ˆæ˜¯å¯ä»¥ï¼Œè¿™å°±è¦ç”¨åˆ°å•è°ƒé˜Ÿåˆ—ã€‚</p><h5 id="ä»£ç ç¤ºä¾‹-1"><a href="#ä»£ç ç¤ºä¾‹-1" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h5><p>è§é™„å½•éƒ¨åˆ†code-2</p><h4 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h4><h5 id="code-1ï¼š-HDU1506"><a href="#code-1ï¼š-HDU1506" class="headerlink" title="code-1ï¼š HDU1506"></a>code-1ï¼š HDU1506</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> a[N],n,Stack[N],w[N];</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="function">ll <span class="title">max</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a &gt; b?a:b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(Stack,<span class="number">0</span>,<span class="keyword">sizeof</span> Stack);</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;ans = <span class="number">0</span>;a[n+<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n+<span class="number">1</span>;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(Stack[top] &lt; a[i])&#123;</span><br><span class="line">Stack[++top] = a[i];</span><br><span class="line">w[top] = <span class="number">1</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">ll sumw = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(Stack[top] &gt; a[i])&#123;</span><br><span class="line">sumw += w[top];</span><br><span class="line">ans = max(ans,sumw*Stack[top]);</span><br><span class="line">top--;</span><br><span class="line">&#125;</span><br><span class="line">Stack[++top] = a[i];w[top] = sumw + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n) &amp;&amp; n)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="code-2-Poj2823"><a href="#code-2-Poj2823" class="headerlink" title="code-2 Poj2823"></a>code-2 Poj2823</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x,y;</span><br><span class="line">&#125;v[<span class="number">1010000</span>]; <span class="comment">//xè¡¨ç¤ºå€¼ï¼Œyè¡¨ç¤ºä½ç½® å¯ä»¥ç†è§£ä¸ºä¸‹æ ‡</span></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">1010000</span>],n,m,mx[<span class="number">1010000</span>],mn[<span class="number">1010000</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getmin</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,head=<span class="number">1</span>,tail=<span class="number">0</span>;<span class="comment">// é»˜è®¤èµ·å§‹ä½ç½®ä¸º1 å› ä¸ºæ’å…¥æ˜¯v[++tail]æ•…åˆå§‹åŒ–ä¸º0</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;=tail &amp;&amp; v[tail].x&gt;=a[i]) tail--;</span><br><span class="line">        v[++tail].x=a[i],v[tail].y=i;</span><br><span class="line">                <span class="comment">// æ ¹æ®é¢˜ç›® å‰m-1ä¸ªå…ˆç›´æ¥è¿›å…¥é˜Ÿåˆ—</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;=tail &amp;&amp; v[tail].x&gt;=a[i]) tail--;</span><br><span class="line">        v[++tail].x=a[i],v[tail].y=i;</span><br><span class="line">        <span class="keyword">while</span>(v[head].y&lt;i-m+<span class="number">1</span>) head++;</span><br><span class="line">        mn[i-m+<span class="number">1</span>]=v[head].x;</span><br><span class="line">               <span class="comment">// é“ç†åŒä¸Šï¼Œå½“ç„¶äº† è¦æŠŠå·²ç»è¶…å‡ºèŒƒå›´çš„ä»headå¼€å§‹æ’å‡º</span></span><br><span class="line">               <span class="comment">//  ç„¶åæ¯ä¸ªé˜Ÿé¦–åˆ™æ˜¯ç›®å‰mä¸ªæ•°çš„æœ€å°å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getmax</span><span class="params">()</span> <span class="comment">//æœ€å¤§å€¼åŒæœ€å°å€¼çš„é“ç†ï¼Œåªä¸è¿‡æ˜¯ç»´æŠ¤çš„æ˜¯é€’å‡é˜Ÿåˆ—</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,head=<span class="number">1</span>,tail=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;=tail &amp;&amp; v[tail].x&lt;=a[i]) tail--;</span><br><span class="line">        v[++tail].x=a[i],v[tail].y=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;=tail &amp;&amp; v[tail].x&lt;=a[i]) tail--;</span><br><span class="line">        v[++tail].x=a[i],v[tail].y=i;</span><br><span class="line">        <span class="keyword">while</span>(v[head].y&lt;i-m+<span class="number">1</span>) head++;</span><br><span class="line">        mx[i-m+<span class="number">1</span>]=v[head].x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</span><br><span class="line">    getmin();</span><br><span class="line">    getmax();</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n-m+<span class="number">1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i==<span class="number">1</span>)<span class="built_in">printf</span>(<span class="string">"%d"</span>,mn[i]);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">" %d"</span>,mn[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n-m+<span class="number">1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i==<span class="number">1</span>)<span class="built_in">printf</span>(<span class="string">"%d"</span>,mx[i]);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">" %d"</span>,mx[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å•è°ƒæ ˆ </tag>
            
            <tag> å•è°ƒé˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åç¼€æ•°ç»„é¢˜é›†</title>
      <link href="/2019/10/17/lcp-problems/"/>
      <url>/2019/10/17/lcp-problems/</url>
      
        <content type="html"><![CDATA[<p>sa[i]ï¼šæ’åä¸ºiçš„åç¼€èµ·å§‹ä½ç½®æ˜¯å¤šå°‘ã€‚<br>rank[i]ï¼šä» i ä½ç½®èµ·å§‹çš„åç¼€åœ¨æ‰€æœ‰åç¼€ä¸­å­—å…¸åºæ’åºååºå·ï¼Œä¸saäº’é€†ã€‚<br>lcp[i]ï¼šS[sa[i] ,â€¦] ä¸ S[sa[i+1] , â€¦]çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚</p><h4 id="Musical-Theme"><a href="#Musical-Theme" class="headerlink" title="Musical Theme"></a>Musical Theme</h4><p><a href="http://poj.org/problem?id=1743" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™nä¸ªæ•°ç»„æˆçš„ä¸²ï¼Œæ±‚æ˜¯å¦æœ‰å¤šä¸ªâ€œç›¸ä¼¼â€ä¸”ä¸é‡å çš„å­ä¸²çš„é•¿åº¦å¤§äºç­‰äº5ï¼Œä¸¤ä¸ªå­ä¸²ç›¸ä¼¼å½“ä¸”ä»…å½“é•¿åº¦ç›¸ç­‰ä¸”æ¯ä¸€ä½çš„æ•°å­—å·®éƒ½ç›¸ç­‰ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æœ¬é¢˜é¢˜æ„æœ‰äº›éš¾ç†è§£ã€‚å°±æ˜¯åˆ©ç”¨åç¼€æ•°ç»„+é«˜åº¦æ•°ç»„è§£å†³æœ€é•¿ä¸é‡å¤å­ä¸²é—®é¢˜ï¼Œè§£æ³•å¾ˆå¥—è·¯ï¼Œå°±æ˜¯äºŒåˆ†+åˆ¤æ–­ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//POJ1743</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],b[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c!=<span class="string">'-'</span> &amp;&amp; (c&lt;<span class="string">'0'</span> || c&gt;<span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span> (c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c&gt;=<span class="string">'0'</span> &amp;&amp; c&lt;=<span class="string">'9'</span>)</span><br><span class="line">ans = ans*<span class="number">10</span> + c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg ? -ans : ans; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> sa[N],rk[N],lcp[N],tmp[N];</span><br><span class="line"><span class="keyword">int</span> len,k;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= len?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= len?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">int</span> S[],<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line">len = n;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rk[i] = i &lt; len?S[i]:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+<span class="number">1</span>+len,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= len;i++)</span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]]+compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++) rk[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">int</span> S[],<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++) rk[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j + h &lt; len &amp;&amp; i + h &lt; len;h++)</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> pre = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(lcp[<span class="number">1</span>] &gt;= x) pre = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!pre &amp;&amp; lcp[i] &gt;= x) pre = i;</span><br><span class="line"><span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &gt;= x)<span class="comment">//æ³¨æ„ä¸€ä¸‹åˆ°åº•æ˜¯iè¿˜æ˜¯i-1</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">abs</span>(sa[pre] - sa[i]) &gt; x) <span class="keyword">return</span> <span class="literal">true</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">construct_sa(a,sa);</span><br><span class="line">construct_lcp(a,sa,lcp);</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">0</span>,r = n;</span><br><span class="line"><span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(check(mid)) l = mid+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> r = mid<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(++r &lt; <span class="number">5</span>) r = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n) &amp;&amp; n)&#123;</span><br><span class="line"><span class="comment">//æ³¨æ„ï¼Œè¯¥æ¨¡æ¿å¿…é¡»ä»ä¸‹æ ‡0å¼€å§‹å­˜ï¼</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++) b[i] = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++) a[i] = b[i]-b[i<span class="number">-1</span>]+<span class="number">100</span>;</span><br><span class="line">a[<span class="number">0</span>] = b[<span class="number">0</span>]+<span class="number">100</span>; solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Milk-Patterns"><a href="#Milk-Patterns" class="headerlink" title="Milk Patterns"></a>Milk Patterns</h4><p><a href="http://poj.org/problem?id=3261" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°</strong><br>æ±‚å¯é‡å çš„ï¼Œå‡ºç°kæ¬¡çš„æœ€é•¿é‡å¤å­ä¸²ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>è¿™ä¸ªå°±æ˜¯å¯é‡å çš„æœ€é•¿é‡å¤å­ä¸²äº†ï¼Œè¦æ±‚æ±‚å‡ºæœ€é•¿çš„ï¼Œé‡å¤å‡ºç°kæ¬¡ä»¥ä¸Šçš„å­ä¸²ï¼Œé€šè¿‡é¢˜æ„ä»¥åŠæ ·ä¾‹è§‚å¯Ÿå¯çŸ¥ï¼Œæ˜¯å…è®¸å­ä¸²é‡å¤çš„ã€‚è§£å†³æ–¹æ³•å’Œä¸Šé¢˜ç±»ä¼¼ï¼Œä¹Ÿæ˜¯åç¼€æ•°ç»„+äºŒåˆ†ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//POJ3261</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,k,a[N],kk;</span><br><span class="line"><span class="keyword">int</span> rk[N],sa[N],lcp[N],tmp[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= n?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">int</span> S[],<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rk[i] = i &lt; n?S[i]:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ«æŠŠå…¨å±€å˜é‡çš„kè¦†ç›–äº†ï¼ï¼ï¼</span></span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+<span class="number">1</span>+n,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) </span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">int</span> S[],<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j+h &lt; n &amp;&amp; i+h &lt; n;h++)</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &gt;= x) cnt++;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(cnt &gt;= kk) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">cnt = <span class="number">1</span>;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt &gt;= kk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">construct_sa(a,sa);</span><br><span class="line">construct_lcp(a,sa,lcp);</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">0</span>, r = n;</span><br><span class="line"><span class="comment">//for(int i = 1;i &lt;= n;i++) printf("%d ",lcp[i]);</span></span><br><span class="line"><span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(check(mid)) l = mid+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> r = mid<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;kk) != EOF)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ä¸åŒå­ä¸²çš„ä¸ªæ•°"><a href="#ä¸åŒå­ä¸²çš„ä¸ªæ•°" class="headerlink" title="ä¸åŒå­ä¸²çš„ä¸ªæ•°"></a>ä¸åŒå­ä¸²çš„ä¸ªæ•°</h4><p><a href="https://www.luogu.org/problem/P2408" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚å…¶æ‰€æœ‰å­ä¸²ä¸­ï¼Œä¸åŒçš„å­ä¸²æ•°é‡ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>åˆ©ç”¨åç¼€æ•°ç»„+é«˜åº¦æ•°ç»„æ±‚è§£ã€‚å·²çŸ¥é«˜åº¦æ•°ç»„lcpï¼Œé‚£ä¹ˆé¦–å…ˆå¯ä»¥çŸ¥é“ç¬¬ä¸€ä¸ªsa[1]æœ‰n - sa[1]ä¸ªä¸åŒå­ä¸²ï¼›è€Œ2~nï¼Œæ¯ä¸ªsa[i] æœ‰ n - sa[i] - lcp[i-1] ä¸ªä¸åŒå­ä¸²ã€‚ç´¯åŠ å³å¯ï¼Œæ³¨æ„ç»“æœå¯èƒ½çˆ† intã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//P2408ä¸åŒå­ä¸²çš„ä¸ªæ•°</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> sa[N],lcp[N],tmp[N],k,rk[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= n?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *S,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rk[i] = i &lt; n?S[i]:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+<span class="number">1</span>+n,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) </span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j+h &lt; n &amp;&amp; i+h &lt; n;h++)</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ll sum = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">()</span></span>&#123;</span><br><span class="line">sum = n - sa[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)</span><br><span class="line">sum += n - sa[i] - lcp[i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">construct_sa(str,sa);</span><br><span class="line">construct_lcp(str,sa,lcp);</span><br><span class="line">calc();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">freopen(<span class="string">"123.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">freopen(<span class="string">"222.txt"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n))&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Substring"><a href="#Substring" class="headerlink" title="Substring"></a>Substring</h4><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5769" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚æ‰€æœ‰ä¸åŒçš„ï¼Œä¸”åŒ…å«<strong>å­—ç¬¦x</strong>çš„å­ä¸²æ•°é‡ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>å’Œä¸Šä¸€é¢˜æœ‰äº›ç±»ä¼¼ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦ç¡®ä¿æ¯ä¸€ä¸ªè¢«ç»Ÿè®¡çš„å­ä¸²åŒ…å«å­—ç¬¦xã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ•°ç»„pos[p]æ¥è®°å½• p åé¢ç¬¬ä¸€ä¸ªå­—ç¬¦ x çš„ä½ç½®ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»å¤´å¼€å§‹ç»Ÿè®¡æ—¶ï¼Œsa[1]æœ‰n - pos[ sa[1] ] ä¸ªåˆæ³•å­ä¸²ï¼Œå…¶å®ƒä½ç½®æœ‰ n - max(pos[ sa[i] ] , sa[i] + lcp[i])ä¸ªåˆæ³•å­ä¸²ï¼Œå°†å®ƒä»¬ç´¯åŠ èµ·æ¥å³å¯ã€‚<br>è¿™é¢˜é€‰G++ç¼–è¯‘å™¨å°±è¶…æ—¶ï¼Œé€‰C++å°±å¯ä»¥é€šè¿‡ï¼ŒçŒœæµ‹å¯èƒ½å’ŒSTLæœ‰å…³ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Hdu5769,G++è¶…æ—¶,C++AC</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> t,n;</span><br><span class="line"><span class="keyword">char</span> str[N],lv[<span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> rk[N],sa[N],lcp[N],tmp[N],k;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= n?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rk[i] = i &lt; n?S[i]:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+<span class="number">1</span>+n,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j+h &lt; n &amp;&amp; i+h &lt; n;h++)</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> pos[N];<span class="comment">//pos[x]:xåé¢ç¬¬ä¸€ä¸ªlvå‡ºç°çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> idx = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">construct_sa(str,sa);</span><br><span class="line">construct_lcp(str,sa,lcp);</span><br><span class="line">pos[n] = n;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = n<span class="number">-1</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(str[i] == lv[<span class="number">0</span>]) pos[i] = i;</span><br><span class="line"><span class="keyword">else</span> pos[i] = pos[i+<span class="number">1</span>];</span><br><span class="line">sum = n - pos[sa[<span class="number">1</span>]];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)</span><br><span class="line">sum += n - max(pos[sa[i]],sa[i]+lcp[i<span class="number">-1</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Case #%d: %lld\n"</span>,++idx,sum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">freopen(<span class="string">"123.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">freopen(<span class="string">"222.txt"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s%s"</span>,lv,str);</span><br><span class="line">n = <span class="built_in">strlen</span>(str);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Life-Forms"><a href="#Life-Forms" class="headerlink" title="Life Forms"></a>Life Forms</h4><p><a href="http://poj.org/problem?id=3294" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™å®šnä¸ªå­—ç¬¦ä¸²ï¼Œè¯·é—®å®ƒä»¬ä¹‹é—´å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€åŠçš„æœ€é•¿å…¬å…±å­ä¸²æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªï¼ŒæŒ‰å­—å…¸åºè¾“å‡ºã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>åˆ©ç”¨åç¼€æ•°ç»„+é«˜åº¦æ•°ç»„æ±‚è§£ã€‚æˆ‘ä»¬å°†nä¸ªå­—ç¬¦ä¸²æ‹¼æ¥ä¸­ä¸€ä¸ªâ€œæ¯ä¸²â€ï¼Œä¸­é—´ç”¨ä¸åŒçš„å­—ç¬¦é—´éš”ï¼›ç„¶åå¯¹æ¯ä¸²æ±‚é«˜åº¦æ•°ç»„lcpï¼Œæˆ‘ä»¬ä¾æ—§æ˜¯ç”¨äºŒåˆ†æœç´¢åˆ¤å®šé•¿åº¦pæ˜¯å¦åˆæ³•ï¼Œæ¯æ¬¡åˆ¤å®šä»å‰å‘åç”¨O(N)æ—¶é—´éå†ç»Ÿè®¡ä¸€éå³å¯ã€‚å½“æˆ‘ä»¬å¾—åˆ°æœ€é•¿çš„åˆæ³•é•¿åº¦ p åï¼Œå†åˆ©ç”¨ç±»ä¼¼çš„æ–¹æ³•è¾“å‡ºæ‰€æœ‰çš„å­ä¸²ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="built_in">string</span> str,s;</span><br><span class="line"><span class="keyword">int</span> n,k,len;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> sa[N],rk[N],lcp[N],tmp[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line">    <span class="keyword">int</span> ri = i+k &lt;= len?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">int</span> rj = j+k &lt;= len?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="built_in">string</span> S,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line">    len = S.length();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++)&#123;</span><br><span class="line">        sa[i] = i;</span><br><span class="line">        rk[i] = i &lt; len ? S[i]:<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//kä¸€å®šä¸èƒ½è®¾ç½®æˆå±€éƒ¨å˜é‡å¯¼è‡´è¦†ç›–å…¨å±€å˜é‡ï¼ï¼ï¼</span></span><br><span class="line">    <span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= len;k *= <span class="number">2</span>)&#123;</span><br><span class="line">        sort(sa,sa+len+<span class="number">1</span>,compare_sa);</span><br><span class="line">        tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= len;i++)</span><br><span class="line">            tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++) rk[i] = tmp[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="built_in">string</span> S,<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line">    len = S.length();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++) rk[sa[i]] = i;</span><br><span class="line">    <span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> j = sa[rk[i]<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line">        <span class="keyword">for</span>(;j+h &lt; len &amp;&amp; i+h &lt; len;h++)</span><br><span class="line">            <span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">        lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">110</span>],idx[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">1</span>; <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line">    vis[idx[sa[<span class="number">1</span>]]] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= len;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &lt; p)&#123;</span><br><span class="line">            cnt = <span class="number">1</span>; <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);vis[idx[sa[i]]] = <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!vis[idx[sa[i]]]) cnt++,vis[idx[sa[i]]] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(cnt &gt;= n/<span class="number">2</span>+<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">1</span>; <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line">    vis[idx[sa[<span class="number">1</span>]]] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= len+<span class="number">1</span>;i++)&#123;  <span class="comment">//lcp[len+1] = 0,ä½œä¸ºç»“æŸæ ‡å¿—</span></span><br><span class="line">        <span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &lt; p)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cnt &gt;= n/<span class="number">2</span>+<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = sa[i<span class="number">-1</span>];j &lt; sa[i<span class="number">-1</span>]+p;j++) <span class="built_in">cout</span> &lt;&lt; str[j];</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cnt = <span class="number">1</span>; <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);vis[idx[sa[i]]] = <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!vis[idx[sa[i]]]) cnt++,vis[idx[sa[i]]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    construct_sa(str,sa);</span><br><span class="line">    construct_lcp(str,sa,lcp);</span><br><span class="line">    <span class="comment">/*sa[i]ï¼šå­˜æ”¾æ’åç¬¬içš„åç¼€çš„èµ·å§‹ä½ç½®*/</span></span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, r = len;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(check(mid)) l = mid+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> r = mid<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(r &lt;= <span class="number">0</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">"?"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">else</span> print(r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; n &amp;&amp; n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; str; <span class="built_in">cout</span> &lt;&lt; str &lt;&lt; <span class="built_in">endl</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">2</span>,tot = <span class="number">0</span>; str = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; s; str += s+<span class="keyword">char</span>(++cnt);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt;= s.length();j++) idx[tot++] = i;</span><br><span class="line">        &#125; </span><br><span class="line">        solve();</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Maximum-repetition-substring"><a href="#Maximum-repetition-substring" class="headerlink" title="Maximum repetition substring"></a>Maximum repetition substring</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œé‡å¤æ¬¡æ•°æœ€å¤šçš„è¿ç»­é‡å¤å­ä¸²æ˜¯ä»€ä¹ˆï¼ˆå¾ªç¯æ¬¡æ•°æœ€å¤šçš„å¾ªç¯å­ä¸²ï¼‰ã€‚è¦æ±‚è¾“å‡ºå­—å…¸åºæœ€å°çš„ã€‚</p><p>ä¾‹å¦‚ï¼šccabababcä¸­ï¼Œè¿ç»­å¾ªç¯æ¬¡æ•°æœ€å¤šçš„å­ä¸²æ˜¯abababã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>è¿™é¢˜æˆ‘å¯¹ç…§é¢˜è§£å†™äº†å¾ˆä¹…ï¼Œæ€æƒ³å‹‰å¼ºææ‡‚ã€‚<br>å…ˆè¯´åšæ³•ï¼Œæ˜¯æšä¸¾é•¿åº¦lenï¼ˆä»1åˆ°nï¼‰ï¼Œç„¶ååˆ¤æ–­ä»¥ len ä¸ºå¾ªç¯é•¿åº¦çš„ è¿ç»­å¾ªç¯æ¬¡æ•° æœ€å¤šçš„ å­ä¸² é•¿åº¦ æ˜¯å¤šå°‘ï¼›å‡è®¾è¿™ä¸ªå­ä¸²é•¿åº¦æ˜¯ l ï¼Œé‚£ä¹ˆå®ƒçš„è¿ç»­å¾ªç¯æ¬¡æ•°å°±æ˜¯ l/lenã€‚<br>æˆ‘ä»¬è€ƒè™‘å¦‚ä½•æ±‚å­ä¸²é•¿åº¦ l ã€‚å¦‚æœæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¾ªç¯èŠ‚é•¿åº¦ä¸ºlenï¼Œé‚£ä¹ˆå¿…ç„¶æœ‰s[1,n-len] = s[len , n]ï¼Œå› æ­¤ï¼Œå¦‚æœå­—ç¬¦ä¸² s[len, n] ä¸ s[ 2 <em> len, n] çš„å…¬å…±å‰ç¼€é•¿åº¦ä¸º lcpï¼Œé‚£ä¹ˆ s[len ,n] çš„å¾ªç¯èŠ‚ä¸ªæ•°ä¸ºlcp / len + 1ï¼ˆåŠ ä¸Šçš„ä¸€ä¸ªæ˜¯å¼€å¤´ä¸ºè®¡ç®—åœ¨lcpå†…çš„å¾ªç¯èŠ‚ ï¼‰ã€‚<br>å› æ­¤æˆ‘ä»¬åªéœ€è¦å¯¹s[0] , s[len] ,s[2 </em> len] â€¦ , åˆ¤æ–­ç›¸å·® len çš„ä¸¤ä¸ªç›¸é‚»åç¼€çš„ lcpï¼Œå°±å¯ä»¥è®¡ç®—è¯¥å­ä¸²å¾ªç¯èŠ‚ä¸ªæ•°ã€‚è¿™æ˜¯ç”±äºå¦‚æœä¸€ä¸ªå­ä¸²çš„å¾ªç¯èŠ‚é•¿åº¦ä¸º lenï¼Œä¸”å¾ªç¯è‡³å°‘ä¸¤æ¬¡ï¼Œé‚£ä¹ˆæ˜¾ç„¶å®ƒä¼šåŒ…å«ç›¸é‚»çš„ä¸¤ä¸ªlenï¼Œå¦åˆ™å°±æ„ä¸æˆå¾ªç¯äº†ã€‚å½“ç„¶å¯èƒ½èµ·ç‚¹å¹¶ä¸åœ¨lençš„å€æ•°ä½ç½®ä¸Šï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦å‘å‰æ‹“å±•ä¸€ä¸‹ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> cse = <span class="number">0</span>,n;</span><br><span class="line"><span class="keyword">int</span> k,rk[N],lcp[N],sa[N],tmp[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= n?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rk[i] = i &lt; n?S[i]:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+<span class="number">1</span>+n,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]]+compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j+h &lt; n &amp;&amp; i+h &lt; n;h++)</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> st[N][<span class="number">22</span>],Log[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">st_init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) st[i][<span class="number">0</span>] = lcp[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++) Log[i] = Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j) &lt;= n;j++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>) &lt;= n;i++)</span><br><span class="line">st[i][j] = min(st[i][j<span class="number">-1</span>],st[i+(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l &gt; r) swap(l,r); r--;</span><br><span class="line"><span class="keyword">int</span> kk = Log[r-l+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> min(st[l][kk],st[r-(<span class="number">1</span>&lt;&lt;kk)+<span class="number">1</span>][kk]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mxtc = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> q[N],cnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i+len &lt; n;i += len)&#123;</span><br><span class="line"><span class="keyword">int</span> l = ask(rk[i],rk[i+len]);</span><br><span class="line"><span class="keyword">int</span> res = l/len+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> pre = i - (len-l%len);</span><br><span class="line"><span class="keyword">if</span>(pre &gt;= <span class="number">0</span> &amp;&amp; ask(rk[pre],rk[pre+len]) &gt;= len) res++;</span><br><span class="line"><span class="keyword">if</span>(mxtc &lt; res) mxtc = res,cnt = <span class="number">0</span>,q[++cnt] = len;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(mxtc == res &amp;&amp; len != q[cnt]) q[++cnt] = len;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printAns</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= cnt;j++)</span><br><span class="line"><span class="keyword">if</span>(ask(rk[sa[i]],rk[sa[i]+q[j]]) &gt;= q[j]*(mxtc<span class="number">-1</span>))&#123;</span><br><span class="line">str[sa[i]+q[j]*mxtc] = <span class="string">'\0'</span>;</span><br><span class="line"><span class="built_in">puts</span>(str+sa[i]); <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">construct_sa(str,sa);</span><br><span class="line">construct_lcp(str,sa,lcp);<span class="comment">//lcp[n]æ˜¯æ’ç­‰äº0çš„</span></span><br><span class="line"><span class="comment">/*ä¸‹ä¸€æ­¥æ±‚é‡å¤æ¬¡æ•°æœ€å¤šçš„è¿ç»­é‡å¤å­ä¸²*/</span></span><br><span class="line">st_init();</span><br><span class="line">mxtc = cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) calc(i); </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Case %d: "</span>,++cse);</span><br><span class="line">printAns();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str) != EOF)&#123;</span><br><span class="line">n = <span class="built_in">strlen</span>(str);</span><br><span class="line"><span class="keyword">if</span>(n == <span class="number">1</span> &amp;&amp; str[<span class="number">0</span>] == <span class="string">'#'</span>) <span class="keyword">break</span>;</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Common-Substrings"><a href="#Common-Substrings" class="headerlink" title="Common Substrings"></a>Common Substrings</h4><p><a href="http://poj.org/problem?id=3415" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™å®š2ä¸ªå­—ç¬¦ä¸²Aå’ŒBï¼Œä»¥åŠä¸€ä¸ªæ•´æ•°kã€‚ç›®æ ‡æ˜¯æ±‚å‡ºè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­å…¬å…±å­ä¸²çš„æ•°é‡ï¼Œä¾‹å¦‚A:xx , B:xxï¼Œk = 1ï¼Œé‚£ä¹ˆå…¬å…±å­ä¸²æ•°é‡å°±æ˜¯5ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>å°†Aå’ŒBæ‹¼æ¥åœ¨ä¸€èµ·ï¼Œä¸­é—´ç”¨ä¸€ä¸ªæœªå‡ºç°è¿‡çš„å­—ç¬¦é—´éš”ï¼Œæ–°ä¸²S = A+â€™#â€™+Bï¼›ç„¶åå¯¹Sæ±‚é«˜åº¦æ•°ç»„ï¼Œåˆ©ç”¨é«˜åº¦æ•°ç»„æ¥æ±‚è§£ã€‚<br>å¯¹äºå±äº B çš„æ¯ä¸€ä¸ªåç¼€ï¼Œç»Ÿè®¡å®ƒä¸æ‰€æœ‰å±äº A çš„åç¼€çš„ lcpï¼ˆæœ€é•¿å…¬å…±å‰ç¼€ï¼‰ï¼Œå¹¶ç»Ÿè®¡lcp-m+1ï¼Œè¿™å°±æ˜¯è¯¥åç¼€å’Œ A çš„å…¬å…±å­ä¸²æ•°é‡ã€‚è¿™æ ·åšçš„å¤æ‚åº¦æ˜¯O(N^2)ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å•è°ƒæ ˆæ¥åœ¨ O(N) æ—¶é—´å†…è§£å†³ï¼›æˆ‘ä»¬ä»å‰å‘åéå†lcpæ•°ç»„ï¼Œå°†å±äºAçš„åç¼€çš„ lcp å‹å…¥æ ˆï¼›ç”±äºä¸¤ä¸ªå­—ç¬¦ä¸²çš„åç¼€æ˜¯å–å®ƒä»¬ä¸­é—´çš„æœ€å°å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥ç»´æŠ¤å•è°ƒé€’å‡æ ˆï¼ŒåŒæ—¶éœ€è¦ç»´æŠ¤çš„æ˜¯ sumï¼Œsumä»£è¡¨å½“å‰ A ä¸­ç›¸åŒçš„å­ä¸²æ•°é‡ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå½“å‰åç¼€å±äº B ï¼Œåˆ™ç›´æ¥åŠ ä¸Šsumå³å¯ã€‚</p><p>ç”±äºæˆ‘ä»¬æ˜¯é¡ºåºéå†çš„ï¼Œåªç»Ÿè®¡äº†Aå¯¹Bçš„è´¡çŒ®ï¼Œå†åè¿‡æ¥ç»Ÿè®¡ä¸€æ¬¡Bå¯¹Açš„è´¡çŒ®å³å¯ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> A[N],B[N];</span><br><span class="line"><span class="keyword">int</span> rk[N],tmp[N],lcp[N],sa[N],k;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = i+k &lt;= n?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rk[i] = i &lt; n?S[i]:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+<span class="number">1</span>+n,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *S,<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j =sa[rk[i]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j+h &lt; n &amp;&amp; i+h &lt; n;h++)</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> idx[N];<span class="comment">//åˆå§‹åŒ–ä¸º0</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">ll h,cnt;</span><br><span class="line">&#125;Stack[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">construct_sa(A,sa);</span><br><span class="line">construct_lcp(A,sa,lcp);</span><br><span class="line">ll ans = <span class="number">0</span>,sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line">ll cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(top &amp;&amp; Stack[top].h &gt;= lcp[i<span class="number">-1</span>])&#123;</span><br><span class="line">cnt += Stack[top].cnt;</span><br><span class="line">sum -= Stack[top].cnt * (Stack[top].h-m+<span class="number">1</span>);</span><br><span class="line">top--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &gt;= m)&#123;</span><br><span class="line">cnt += idx[sa[i<span class="number">-1</span>]] == <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt) Stack[++top] = Node&#123;lcp[i<span class="number">-1</span>],cnt&#125;;</span><br><span class="line">sum += (lcp[i<span class="number">-1</span>]-m+<span class="number">1</span>)*cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(idx[sa[i]] == <span class="number">1</span>) ans += sum;</span><br><span class="line">&#125;</span><br><span class="line">top = <span class="number">0</span>; sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line">ll cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(top &amp;&amp; Stack[top].h &gt;= lcp[i<span class="number">-1</span>])&#123;</span><br><span class="line">cnt += Stack[top].cnt;</span><br><span class="line">sum -= Stack[top].cnt * (Stack[top].h-m+<span class="number">1</span>);</span><br><span class="line">top--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &gt;= m)&#123;</span><br><span class="line">cnt += idx[sa[i<span class="number">-1</span>]] == <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt) Stack[++top] = Node&#123;lcp[i<span class="number">-1</span>],cnt&#125;;</span><br><span class="line">sum += (lcp[i<span class="number">-1</span>]-m+<span class="number">1</span>)*cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!idx[sa[i]]) ans += sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m) != EOF &amp;&amp; m)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,A);</span><br><span class="line"><span class="built_in">memset</span>(idx,<span class="number">0</span>,<span class="keyword">sizeof</span> idx);</span><br><span class="line">n = <span class="built_in">strlen</span>(A); </span><br><span class="line">idx[n] = <span class="number">2</span>; A[n++] = <span class="string">'#'</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++) idx[i] = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,A+n);</span><br><span class="line">n = <span class="built_in">strlen</span>(A);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åç¼€æ•°ç»„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åç¼€æ•°ç»„çš„å¸¸è§åº”ç”¨</title>
      <link href="/2019/10/17/lcp-use/"/>
      <url>/2019/10/17/lcp-use/</url>
      
        <content type="html"><![CDATA[<h3 id="åç¼€æ•°ç»„çš„åº”ç”¨"><a href="#åç¼€æ•°ç»„çš„åº”ç”¨" class="headerlink" title="åç¼€æ•°ç»„çš„åº”ç”¨"></a>åç¼€æ•°ç»„çš„åº”ç”¨</h3><h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>åç¼€æ•°ç»„æ˜¯å¤„ç†å­—ç¬¦ä¸²ç›¸å…³é—®é¢˜çš„æœ‰åŠ›å·¥å…·ï¼Œåç¼€æ•°ç»„çš„é¢˜å‹ä¸è§£æ³•ç›¸å¯¹å›ºå®šï¼Œå› æ­¤å¯¹äºæœ¬æ–‡ä¸­çš„å‡ ç§é¢˜å‹è¦æŒæ¡è§£æ³•ä¸åŸç†ã€‚æœ¬æ–‡å‡è®¾è¯»è€…å·²ç»æŒæ¡æ±‚åç¼€æ•°ç»„ï¼ˆsaï¼‰ä»¥åŠé«˜åº¦æ•°ç»„ï¼ˆlcpï¼‰çš„ç®—æ³•ã€‚<br>æœ¬æ–‡å°†ä»‹ç»4ç±»åç¼€æ•°ç»„çš„åº”ç”¨ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li>æœ€é•¿å…¬å…±å‰ç¼€</li><li>å•ä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜</li><li>ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜</li><li>å¤šä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜<h4 id="ç›¸å…³ç¬¦å·è¯´æ˜"><a href="#ç›¸å…³ç¬¦å·è¯´æ˜" class="headerlink" title="ç›¸å…³ç¬¦å·è¯´æ˜"></a>ç›¸å…³ç¬¦å·è¯´æ˜</h4>S æ˜¯åŸå­—ç¬¦ä¸²ã€‚<br>suffix( i )è¡¨ç¤ºå­—ç¬¦ä¸² S ä»ä½ç½® i å¼€å§‹çš„åç¼€ã€‚<br>sa( i )è¡¨ç¤ºæ’åä¸ºç¬¬ i çš„åç¼€çš„èµ·å§‹ä½ç½®ã€‚<br>rk( i )è¡¨ç¤º èµ·å§‹ä½ç½®ä¸º i çš„åç¼€çš„æ’åã€‚<br>lcp( i )è¡¨ç¤ºæ’åä¸º i çš„åç¼€ä¸æ’åä¸º i+1 çš„åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦ã€‚</li></ul><h4 id="æœ€é•¿å…¬å…±å‰ç¼€"><a href="#æœ€é•¿å…¬å…±å‰ç¼€" class="headerlink" title="æœ€é•¿å…¬å…±å‰ç¼€"></a>æœ€é•¿å…¬å…±å‰ç¼€</h4><p><strong>ä¾‹1ï¼š</strong> ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¢é—®æŸä¸¤ä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>æˆ‘ä»¬å·²ç»çŸ¥é“lcp[ i ]æ˜¯æ’åä¸º i çš„åç¼€ä¸æ’åä¸º i+1 çš„åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦ï¼Œè€Œæˆ‘ä»¬åˆå¯ä»¥é€šè¿‡saæ•°ç»„æ¥å¾—åˆ°ä»»æ„ä¿©ä¸ªåç¼€çš„æ’åï¼Œå› æ­¤å¯¹äºç»™å®šçš„ä¸¤ä¸ªåç¼€ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ±‚å‡ºå®ƒä»¬çš„æ’åï¼Œåˆ†åˆ«è®¾ä¸º i å’Œ j ï¼ˆi &lt;= jï¼‰ï¼Œé‚£ä¹ˆans = min{ lcp[i] , lcp[i+1] , â€¦ , lcp[j - 1] }ï¼Œä¹Ÿå°±ç›¸å½“äºæ±‚RMQé—®é¢˜ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„è¯¢é—®å¯ä»¥å½“åšRMQé—®é¢˜æ¥é‡‡ç”¨åˆé€‚çš„ç®—æ³•ï¼ˆä¾‹å¦‚stè¡¨ï¼‰ã€‚</p><h4 id="å•ä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜"><a href="#å•ä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜" class="headerlink" title="å•ä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜"></a>å•ä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜</h4><p>è¿™ç±»é—®é¢˜çš„ä¸€ä¸ªå¸¸ç”¨åšæ³•æ˜¯å…ˆæ±‚åç¼€æ•°ç»„å’Œlcpæ•°ç»„ï¼Œç„¶ååˆ©ç”¨lcpæ•°ç»„æ±‚è§£ã€‚</p><h5 id="é‡å¤å­ä¸²é—®é¢˜"><a href="#é‡å¤å­ä¸²é—®é¢˜" class="headerlink" title="é‡å¤å­ä¸²é—®é¢˜"></a>é‡å¤å­ä¸²é—®é¢˜</h5><p><strong>é‡å¤å­ä¸²ï¼š</strong> å­—ç¬¦ä¸²Råœ¨å­—ç¬¦ä¸²Lä¸­è‡³å°‘å‡ºç°ä¸¤æ¬¡ï¼Œåˆ™ç§° R æ˜¯ L çš„é‡å¤å­ä¸²ã€‚</p><p><strong>ä¾‹2ï¼šå¯é‡å æœ€é•¿é‡å¤å­ä¸²</strong><br>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚æœ€é•¿é‡å¤å­ä¸²ï¼Œè¿™ä¸¤ä¸ªå­ä¸²å¯ä»¥é‡å ã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>æ±‚æœ€é•¿é‡å¤å­ä¸²ï¼Œç­‰ä»·äºæ±‚ä¸¤ä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€çš„æœ€å¤§å€¼ã€‚äºæ˜¯æˆ‘ä»¬åªéœ€è¦æ±‚å‡ºlcpæ•°ç»„ä¸­çš„æœ€å¤§å€¼å³å¯ã€‚ç”±äºä»»æ„ä¸¤ä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€ä¸€å®šæ˜¯lcpæ•°ç»„ä¸­æŸä¸€æ®µçš„æœ€å°å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼ä¸€å®šä¸å¤§äºlcpæ•°ç»„é‡Œçš„æœ€å¤§å€¼ã€‚æ‰€ä»¥æœ€é•¿é‡å¤å­ä¸²çš„é•¿åº¦å°±æ˜¯lcpæ•°ç»„é‡Œçš„æœ€å¤§å€¼ã€‚è¯¥åšæ³•æ—¶é—´å¤æ‚åº¦ä¸ºO(N)ã€‚</p><p><strong>ä¾‹3ï¼šä¸å¯é‡å æœ€é•¿é‡å¤å­ä¸²</strong><br>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚æœ€é•¿é‡å¤å­ä¸²ï¼Œè¿™ä¸¤ä¸ªå­ä¸²ä¸èƒ½é‡å ã€‚<br><strong>Musical Theme</strong><br><a href="http://poj.org/problem?id=1743" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™nä¸ªæ•°ç»„æˆçš„ä¸²ï¼Œæ±‚æ˜¯å¦æœ‰å¤šä¸ªâ€œç›¸ä¼¼â€ä¸”ä¸é‡å çš„å­ä¸²çš„é•¿åº¦å¤§äºç­‰äº5ï¼Œä¸¤ä¸ªå­ä¸²ç›¸ä¼¼å½“ä¸”ä»…å½“é•¿åº¦ç›¸ç­‰ä¸”æ¯ä¸€ä½çš„æ•°å­—å·®éƒ½ç›¸ç­‰ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æœ¬é¢˜é¢˜æ„æœ‰äº›éš¾ç†è§£ã€‚å°±æ˜¯åˆ©ç”¨åç¼€æ•°ç»„+é«˜åº¦æ•°ç»„è§£å†³æœ€é•¿ä¸é‡å¤å­ä¸²é—®é¢˜ï¼Œè§£æ³•å¾ˆå¥—è·¯ï¼Œå°±æ˜¯äºŒåˆ†+åˆ¤æ–­ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//POJ1743</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],b[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c!=<span class="string">'-'</span> &amp;&amp; (c&lt;<span class="string">'0'</span> || c&gt;<span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span> (c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c&gt;=<span class="string">'0'</span> &amp;&amp; c&lt;=<span class="string">'9'</span>)</span><br><span class="line">ans = ans*<span class="number">10</span> + c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg ? -ans : ans; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> sa[N],rk[N],lcp[N],tmp[N];</span><br><span class="line"><span class="keyword">int</span> len,k;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= len?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= len?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">int</span> S[],<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line">len = n;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rk[i] = i &lt; len?S[i]:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+<span class="number">1</span>+len,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= len;i++)</span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]]+compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++) rk[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">int</span> S[],<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++) rk[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j + h &lt; len &amp;&amp; i + h &lt; len;h++)</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> pre = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(lcp[<span class="number">1</span>] &gt;= x) pre = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!pre &amp;&amp; lcp[i] &gt;= x) pre = i;</span><br><span class="line"><span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &gt;= x)<span class="comment">//æ³¨æ„ä¸€ä¸‹åˆ°åº•æ˜¯iè¿˜æ˜¯i-1</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">abs</span>(sa[pre] - sa[i]) &gt; x) <span class="keyword">return</span> <span class="literal">true</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">construct_sa(a,sa);</span><br><span class="line">construct_lcp(a,sa,lcp);</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">0</span>,r = n;</span><br><span class="line"><span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(check(mid)) l = mid+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> r = mid<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(++r &lt; <span class="number">5</span>) r = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n) &amp;&amp; n)&#123;</span><br><span class="line"><span class="comment">//æ³¨æ„ï¼Œè¯¥æ¨¡æ¿å¿…é¡»ä»ä¸‹æ ‡0å¼€å§‹å­˜ï¼</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++) b[i] = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++) a[i] = b[i]-b[i<span class="number">-1</span>]+<span class="number">100</span>;</span><br><span class="line">a[<span class="number">0</span>] = b[<span class="number">0</span>]+<span class="number">100</span>; solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>ä¾‹4ï¼šå¯é‡å çš„kæ¬¡æœ€é•¿é‡å¤å­ä¸²POJ3261</strong><br><a href="http://poj.org/problem?id=3261" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°</strong><br>æ±‚å¯é‡å çš„ï¼Œå‡ºç°kæ¬¡çš„æœ€é•¿é‡å¤å­ä¸²ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>è¿™ä¸ªå°±æ˜¯å¯é‡å çš„æœ€é•¿é‡å¤å­ä¸²äº†ï¼Œè¦æ±‚æ±‚å‡ºæœ€é•¿çš„ï¼Œé‡å¤å‡ºç°kæ¬¡ä»¥ä¸Šçš„å­ä¸²ï¼Œé€šè¿‡é¢˜æ„ä»¥åŠæ ·ä¾‹è§‚å¯Ÿå¯çŸ¥ï¼Œæ˜¯å…è®¸å­ä¸²é‡å¤çš„ã€‚è§£å†³æ–¹æ³•å’Œä¸Šé¢˜ç±»ä¼¼ï¼Œä¹Ÿæ˜¯åç¼€æ•°ç»„+äºŒåˆ†ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//POJ3261</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,k,a[N],kk;</span><br><span class="line"><span class="keyword">int</span> rk[N],sa[N],lcp[N],tmp[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= n?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">int</span> S[],<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rk[i] = i &lt; n?S[i]:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ«æŠŠå…¨å±€å˜é‡çš„kè¦†ç›–äº†ï¼ï¼ï¼</span></span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+<span class="number">1</span>+n,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) </span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">int</span> S[],<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j+h &lt; n &amp;&amp; i+h &lt; n;h++)</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &gt;= x) cnt++;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(cnt &gt;= kk) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">cnt = <span class="number">1</span>;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt &gt;= kk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">construct_sa(a,sa);</span><br><span class="line">construct_lcp(a,sa,lcp);</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">0</span>, r = n;</span><br><span class="line"><span class="comment">//for(int i = 1;i &lt;= n;i++) printf("%d ",lcp[i]);</span></span><br><span class="line"><span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(check(mid)) l = mid+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> r = mid<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;kk) != EOF)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h5 id="å­ä¸²çš„ä¸ªæ•°"><a href="#å­ä¸²çš„ä¸ªæ•°" class="headerlink" title="å­ä¸²çš„ä¸ªæ•°"></a>å­ä¸²çš„ä¸ªæ•°</h5><p><strong>ä¾‹5ï¼šæ±‚ä¸åŒå­ä¸²çš„ä¸ªæ•°</strong><br><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚å…¶æ‰€æœ‰å­ä¸²ä¸­ï¼Œä¸åŒçš„å­ä¸²æ•°é‡ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>åˆ©ç”¨åç¼€æ•°ç»„+é«˜åº¦æ•°ç»„æ±‚è§£ã€‚å·²çŸ¥é«˜åº¦æ•°ç»„lcpï¼Œé‚£ä¹ˆé¦–å…ˆå¯ä»¥çŸ¥é“ç¬¬ä¸€ä¸ªsa[1]æœ‰n - sa[1]ä¸ªä¸åŒå­ä¸²ï¼›è€Œ2~nï¼Œæ¯ä¸ªsa[i] æœ‰ n - sa[i] - lcp[i-1] ä¸ªä¸åŒå­ä¸²ã€‚ç´¯åŠ å³å¯ï¼Œæ³¨æ„ç»“æœå¯èƒ½çˆ† intã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//P2408ä¸åŒå­ä¸²çš„ä¸ªæ•°</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> sa[N],lcp[N],tmp[N],k,rk[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= n?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *S,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rk[i] = i &lt; n?S[i]:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+<span class="number">1</span>+n,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) </span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j+h &lt; n &amp;&amp; i+h &lt; n;h++)</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ll sum = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">()</span></span>&#123;</span><br><span class="line">sum = n - sa[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)</span><br><span class="line">sum += n - sa[i] - lcp[i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">construct_sa(str,sa);</span><br><span class="line">construct_lcp(str,sa,lcp);</span><br><span class="line">calc();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">freopen(<span class="string">"123.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">freopen(<span class="string">"222.txt"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n))&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h5 id="å›æ–‡å­ä¸²"><a href="#å›æ–‡å­ä¸²" class="headerlink" title="å›æ–‡å­ä¸²"></a>å›æ–‡å­ä¸²</h5><p><strong>ä¾‹6ï¼šæ±‚æœ€é•¿å›æ–‡å­ä¸²</strong></p><p>ç©·ä¸¾æ¯ä¸€ä½ï¼Œç„¶åè®¡ç®—ä»¥è¿™ä¸ªå­—ç¬¦ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²ã€‚æ³¨æ„è¿™é‡Œè¦å¯¹é•¿åº¦åˆ†å¥‡å¶è®¨è®ºã€‚ä¸¤ç§æƒ…å†µéƒ½å¯ä»¥è½¬åŒ–ä¸ºæ±‚ä¸€ä¸ªåç¼€å’Œä¸€ä¸ªåè¿‡æ¥å†™çš„åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚å…·ä½“åšæ³•æ˜¯ï¼šå°†æ•´ä¸ªå­—ç¬¦åè¿‡æ¥æ”¾åœ¨åŸå­—ç¬¦ä¸²åé¢ï¼Œä¸­é—´ç”¨ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦éš”å¼€ï¼Œè¿™æ ·å°±è½¬åŒ–ä¸ºäº†æ±‚æ–°ä¸²çš„æŸä¸¤ä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚</p><h5 id="è¿ç»­é‡å¤å­ä¸²"><a href="#è¿ç»­é‡å¤å­ä¸²" class="headerlink" title="è¿ç»­é‡å¤å­ä¸²"></a>è¿ç»­é‡å¤å­ä¸²</h5><p><strong>ä¾‹7ï¼šé‡å¤æ¬¡æ•°æœ€å¤šçš„è¿ç»­å­ä¸²</strong><br><strong>Maximum repetition substring</strong><br><strong>é¢˜æ„ç®€è¿°</strong><br>æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œé‡å¤æ¬¡æ•°æœ€å¤šçš„è¿ç»­é‡å¤å­ä¸²æ˜¯ä»€ä¹ˆï¼ˆå¾ªç¯æ¬¡æ•°æœ€å¤šçš„å¾ªç¯å­ä¸²ï¼‰ã€‚è¦æ±‚è¾“å‡ºå­—å…¸åºæœ€å°çš„ã€‚</p><p>ä¾‹å¦‚ï¼šccabababcä¸­ï¼Œè¿ç»­å¾ªç¯æ¬¡æ•°æœ€å¤šçš„å­ä¸²æ˜¯abababã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>è¿™é¢˜æˆ‘å¯¹ç…§é¢˜è§£å†™äº†å¾ˆä¹…ï¼Œæ€æƒ³å‹‰å¼ºææ‡‚ã€‚<br>å…ˆè¯´åšæ³•ï¼Œæ˜¯æšä¸¾é•¿åº¦lenï¼ˆä»1åˆ°nï¼‰ï¼Œç„¶ååˆ¤æ–­ä»¥ len ä¸ºå¾ªç¯é•¿åº¦çš„ è¿ç»­å¾ªç¯æ¬¡æ•° æœ€å¤šçš„ å­ä¸² é•¿åº¦ æ˜¯å¤šå°‘ï¼›å‡è®¾è¿™ä¸ªå­ä¸²é•¿åº¦æ˜¯ l ï¼Œé‚£ä¹ˆå®ƒçš„è¿ç»­å¾ªç¯æ¬¡æ•°å°±æ˜¯ l/lenã€‚<br>æˆ‘ä»¬è€ƒè™‘å¦‚ä½•æ±‚å­ä¸²é•¿åº¦ l ã€‚å¦‚æœæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¾ªç¯èŠ‚é•¿åº¦ä¸ºlenï¼Œé‚£ä¹ˆå¿…ç„¶æœ‰s[1,n-len] = s[len , n]ï¼Œå› æ­¤ï¼Œå¦‚æœå­—ç¬¦ä¸² s[len, n] ä¸ s[ 2 <em> len, n] çš„å…¬å…±å‰ç¼€é•¿åº¦ä¸º lcpï¼Œé‚£ä¹ˆ s[len ,n] çš„å¾ªç¯èŠ‚ä¸ªæ•°ä¸ºlcp / len + 1ï¼ˆåŠ ä¸Šçš„ä¸€ä¸ªæ˜¯å¼€å¤´ä¸ºè®¡ç®—åœ¨lcpå†…çš„å¾ªç¯èŠ‚ ï¼‰ã€‚<br>å› æ­¤æˆ‘ä»¬åªéœ€è¦å¯¹s[0] , s[len] ,s[2 </em> len] â€¦ , åˆ¤æ–­ç›¸å·® len çš„ä¸¤ä¸ªç›¸é‚»åç¼€çš„ lcpï¼Œå°±å¯ä»¥è®¡ç®—è¯¥å­ä¸²å¾ªç¯èŠ‚ä¸ªæ•°ã€‚è¿™æ˜¯ç”±äºå¦‚æœä¸€ä¸ªå­ä¸²çš„å¾ªç¯èŠ‚é•¿åº¦ä¸º lenï¼Œä¸”å¾ªç¯è‡³å°‘ä¸¤æ¬¡ï¼Œé‚£ä¹ˆæ˜¾ç„¶å®ƒä¼šåŒ…å«ç›¸é‚»çš„ä¸¤ä¸ªlenï¼Œå¦åˆ™å°±æ„ä¸æˆå¾ªç¯äº†ã€‚å½“ç„¶å¯èƒ½èµ·ç‚¹å¹¶ä¸åœ¨lençš„å€æ•°ä½ç½®ä¸Šï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦å‘å‰æ‹“å±•ä¸€ä¸‹ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> cse = <span class="number">0</span>,n;</span><br><span class="line"><span class="keyword">int</span> k,rk[N],lcp[N],sa[N],tmp[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= n?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rk[i] = i &lt; n?S[i]:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+<span class="number">1</span>+n,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]]+compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j+h &lt; n &amp;&amp; i+h &lt; n;h++)</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> st[N][<span class="number">22</span>],Log[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">st_init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) st[i][<span class="number">0</span>] = lcp[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++) Log[i] = Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j) &lt;= n;j++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>) &lt;= n;i++)</span><br><span class="line">st[i][j] = min(st[i][j<span class="number">-1</span>],st[i+(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l &gt; r) swap(l,r); r--;</span><br><span class="line"><span class="keyword">int</span> kk = Log[r-l+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> min(st[l][kk],st[r-(<span class="number">1</span>&lt;&lt;kk)+<span class="number">1</span>][kk]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mxtc = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> q[N],cnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i+len &lt; n;i += len)&#123;</span><br><span class="line"><span class="keyword">int</span> l = ask(rk[i],rk[i+len]);</span><br><span class="line"><span class="keyword">int</span> res = l/len+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> pre = i - (len-l%len);</span><br><span class="line"><span class="keyword">if</span>(pre &gt;= <span class="number">0</span> &amp;&amp; ask(rk[pre],rk[pre+len]) &gt;= len) res++;</span><br><span class="line"><span class="keyword">if</span>(mxtc &lt; res) mxtc = res,cnt = <span class="number">0</span>,q[++cnt] = len;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(mxtc == res &amp;&amp; len != q[cnt]) q[++cnt] = len;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printAns</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= cnt;j++)</span><br><span class="line"><span class="keyword">if</span>(ask(rk[sa[i]],rk[sa[i]+q[j]]) &gt;= q[j]*(mxtc<span class="number">-1</span>))&#123;</span><br><span class="line">str[sa[i]+q[j]*mxtc] = <span class="string">'\0'</span>;</span><br><span class="line"><span class="built_in">puts</span>(str+sa[i]); <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">construct_sa(str,sa);</span><br><span class="line">construct_lcp(str,sa,lcp);<span class="comment">//lcp[n]æ˜¯æ’ç­‰äº0çš„</span></span><br><span class="line"><span class="comment">/*ä¸‹ä¸€æ­¥æ±‚é‡å¤æ¬¡æ•°æœ€å¤šçš„è¿ç»­é‡å¤å­ä¸²*/</span></span><br><span class="line">st_init();</span><br><span class="line">mxtc = cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) calc(i); </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Case %d: "</span>,++cse);</span><br><span class="line">printAns();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str) != EOF)&#123;</span><br><span class="line">n = <span class="built_in">strlen</span>(str);</span><br><span class="line"><span class="keyword">if</span>(n == <span class="number">1</span> &amp;&amp; str[<span class="number">0</span>] == <span class="string">'#'</span>) <span class="keyword">break</span>;</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜"><a href="#ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜" class="headerlink" title="ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜"></a>ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜</h4><p>è¿™ç±»é—®é¢˜çš„ä¸€ä¸ªå¸¸ç”¨åšæ³•æ˜¯ï¼Œå…ˆè¿æ¥è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åæ±‚åç¼€æ•°ç»„å’Œé«˜åº¦æ•°ç»„ï¼Œå†åˆ©ç”¨é«˜åº¦æ•°ç»„æ±‚è§£ã€‚</p><h5 id="å…¬å…±å­ä¸²"><a href="#å…¬å…±å­ä¸²" class="headerlink" title="å…¬å…±å­ä¸²"></a>å…¬å…±å­ä¸²</h5><p><strong>ä¾‹8ï¼šå…¬å…±å­ä¸²çš„æ•°é‡ï¼šCommon Substrings</strong></p><p><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™å®š2ä¸ªå­—ç¬¦ä¸²Aå’ŒBï¼Œä»¥åŠä¸€ä¸ªæ•´æ•°kã€‚ç›®æ ‡æ˜¯æ±‚å‡ºè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­å…¬å…±å­ä¸²çš„æ•°é‡ï¼Œä¾‹å¦‚A:xx , B:xxï¼Œk = 1ï¼Œé‚£ä¹ˆå…¬å…±å­ä¸²æ•°é‡å°±æ˜¯5ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>å°†Aå’ŒBæ‹¼æ¥åœ¨ä¸€èµ·ï¼Œä¸­é—´ç”¨ä¸€ä¸ªæœªå‡ºç°è¿‡çš„å­—ç¬¦é—´éš”ï¼Œæ–°ä¸²S = A+â€™#â€™+Bï¼›ç„¶åå¯¹Sæ±‚é«˜åº¦æ•°ç»„ï¼Œåˆ©ç”¨é«˜åº¦æ•°ç»„æ¥æ±‚è§£ã€‚<br>å¯¹äºå±äº B çš„æ¯ä¸€ä¸ªåç¼€ï¼Œç»Ÿè®¡å®ƒä¸æ‰€æœ‰å±äº A çš„åç¼€çš„ lcpï¼ˆæœ€é•¿å…¬å…±å‰ç¼€ï¼‰ï¼Œå¹¶ç»Ÿè®¡lcp-m+1ï¼Œè¿™å°±æ˜¯è¯¥åç¼€å’Œ A çš„å…¬å…±å­ä¸²æ•°é‡ã€‚è¿™æ ·åšçš„å¤æ‚åº¦æ˜¯O(N^2)ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å•è°ƒæ ˆæ¥åœ¨ O(N) æ—¶é—´å†…è§£å†³ï¼›æˆ‘ä»¬ä»å‰å‘åéå†lcpæ•°ç»„ï¼Œå°†å±äºAçš„åç¼€çš„ lcp å‹å…¥æ ˆï¼›ç”±äºä¸¤ä¸ªå­—ç¬¦ä¸²çš„åç¼€æ˜¯å–å®ƒä»¬ä¸­é—´çš„æœ€å°å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥ç»´æŠ¤å•è°ƒé€’å‡æ ˆï¼ŒåŒæ—¶éœ€è¦ç»´æŠ¤çš„æ˜¯ sumï¼Œsumä»£è¡¨å½“å‰ A ä¸­ç›¸åŒçš„å­ä¸²æ•°é‡ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå½“å‰åç¼€å±äº B ï¼Œåˆ™ç›´æ¥åŠ ä¸Šsumå³å¯ã€‚</p><p>ç”±äºæˆ‘ä»¬æ˜¯é¡ºåºéå†çš„ï¼Œåªç»Ÿè®¡äº†Aå¯¹Bçš„è´¡çŒ®ï¼Œå†åè¿‡æ¥ç»Ÿè®¡ä¸€æ¬¡Bå¯¹Açš„è´¡çŒ®å³å¯ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> A[N],B[N];</span><br><span class="line"><span class="keyword">int</span> rk[N],tmp[N],lcp[N],sa[N],k;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = i+k &lt;= n?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rk[i] = i &lt; n?S[i]:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+<span class="number">1</span>+n,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *S,<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rk[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j =sa[rk[i]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j+h &lt; n &amp;&amp; i+h &lt; n;h++)</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> idx[N];<span class="comment">//åˆå§‹åŒ–ä¸º0</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">ll h,cnt;</span><br><span class="line">&#125;Stack[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">construct_sa(A,sa);</span><br><span class="line">construct_lcp(A,sa,lcp);</span><br><span class="line">ll ans = <span class="number">0</span>,sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line">ll cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(top &amp;&amp; Stack[top].h &gt;= lcp[i<span class="number">-1</span>])&#123;</span><br><span class="line">cnt += Stack[top].cnt;</span><br><span class="line">sum -= Stack[top].cnt * (Stack[top].h-m+<span class="number">1</span>);</span><br><span class="line">top--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &gt;= m)&#123;</span><br><span class="line">cnt += idx[sa[i<span class="number">-1</span>]] == <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt) Stack[++top] = Node&#123;lcp[i<span class="number">-1</span>],cnt&#125;;</span><br><span class="line">sum += (lcp[i<span class="number">-1</span>]-m+<span class="number">1</span>)*cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(idx[sa[i]] == <span class="number">1</span>) ans += sum;</span><br><span class="line">&#125;</span><br><span class="line">top = <span class="number">0</span>; sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line">ll cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(top &amp;&amp; Stack[top].h &gt;= lcp[i<span class="number">-1</span>])&#123;</span><br><span class="line">cnt += Stack[top].cnt;</span><br><span class="line">sum -= Stack[top].cnt * (Stack[top].h-m+<span class="number">1</span>);</span><br><span class="line">top--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &gt;= m)&#123;</span><br><span class="line">cnt += idx[sa[i<span class="number">-1</span>]] == <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt) Stack[++top] = Node&#123;lcp[i<span class="number">-1</span>],cnt&#125;;</span><br><span class="line">sum += (lcp[i<span class="number">-1</span>]-m+<span class="number">1</span>)*cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!idx[sa[i]]) ans += sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m) != EOF &amp;&amp; m)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,A);</span><br><span class="line"><span class="built_in">memset</span>(idx,<span class="number">0</span>,<span class="keyword">sizeof</span> idx);</span><br><span class="line">n = <span class="built_in">strlen</span>(A); </span><br><span class="line">idx[n] = <span class="number">2</span>; A[n++] = <span class="string">'#'</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++) idx[i] = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,A+n);</span><br><span class="line">n = <span class="built_in">strlen</span>(A);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å¤šä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜"><a href="#å¤šä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜" class="headerlink" title="å¤šä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜"></a>å¤šä¸ªå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜</h4><p>è¿™ç±»é—®é¢˜çš„ä¸€ä¸ªå¸¸ç”¨åšæ³•æ˜¯ï¼Œå…ˆå°†æ‰€æœ‰çš„å­—ç¬¦ä¸²è¿æ¥èµ·æ¥ï¼Œç„¶åæ±‚åç¼€æ•°ç»„å’Œé«˜åº¦æ•°ç»„ï¼Œå†åˆ©ç”¨é«˜åº¦æ•°ç»„è¿›è¡Œæ±‚è§£ã€‚ä¸­é—´å¯èƒ½è¿˜è¦åˆ©ç”¨äºŒåˆ†ç­”æ¡ˆã€‚</p><p><strong>ä¾‹9ï¼šä¸å°äºkä¸ªå­—ç¬¦ä¸²ä¸­çš„æœ€é•¿å­ä¸²ã€‚</strong></p><p><strong>Life Forms</strong><br><a href="http://poj.org/problem?id=3294" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™å®šnä¸ªå­—ç¬¦ä¸²ï¼Œè¯·é—®å®ƒä»¬ä¹‹é—´å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€åŠçš„æœ€é•¿å…¬å…±å­ä¸²æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªï¼ŒæŒ‰å­—å…¸åºè¾“å‡ºã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>åˆ©ç”¨åç¼€æ•°ç»„+é«˜åº¦æ•°ç»„æ±‚è§£ã€‚æˆ‘ä»¬å°†nä¸ªå­—ç¬¦ä¸²æ‹¼æ¥ä¸­ä¸€ä¸ªâ€œæ¯ä¸²â€ï¼Œä¸­é—´ç”¨ä¸åŒçš„å­—ç¬¦é—´éš”ï¼›ç„¶åå¯¹æ¯ä¸²æ±‚é«˜åº¦æ•°ç»„lcpï¼Œæˆ‘ä»¬ä¾æ—§æ˜¯ç”¨äºŒåˆ†æœç´¢åˆ¤å®šé•¿åº¦pæ˜¯å¦åˆæ³•ï¼Œæ¯æ¬¡åˆ¤å®šä»å‰å‘åç”¨O(N)æ—¶é—´éå†ç»Ÿè®¡ä¸€éå³å¯ã€‚å½“æˆ‘ä»¬å¾—åˆ°æœ€é•¿çš„åˆæ³•é•¿åº¦ p åï¼Œå†åˆ©ç”¨ç±»ä¼¼çš„æ–¹æ³•è¾“å‡ºæ‰€æœ‰çš„å­ä¸²ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="built_in">string</span> str,s;</span><br><span class="line"><span class="keyword">int</span> n,k,len;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> sa[N],rk[N],lcp[N],tmp[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(rk[i] != rk[j]) <span class="keyword">return</span> rk[i] &lt; rk[j];</span><br><span class="line">    <span class="keyword">int</span> ri = i+k &lt;= len?rk[i+k]:<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">int</span> rj = j+k &lt;= len?rk[j+k]:<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="built_in">string</span> S,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line">    len = S.length();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++)&#123;</span><br><span class="line">        sa[i] = i;</span><br><span class="line">        rk[i] = i &lt; len ? S[i]:<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//kä¸€å®šä¸èƒ½è®¾ç½®æˆå±€éƒ¨å˜é‡å¯¼è‡´è¦†ç›–å…¨å±€å˜é‡ï¼ï¼ï¼</span></span><br><span class="line">    <span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= len;k *= <span class="number">2</span>)&#123;</span><br><span class="line">        sort(sa,sa+len+<span class="number">1</span>,compare_sa);</span><br><span class="line">        tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= len;i++)</span><br><span class="line">            tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + compare_sa(sa[i<span class="number">-1</span>],sa[i]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++) rk[i] = tmp[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="built_in">string</span> S,<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line">    len = S.length();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++) rk[sa[i]] = i;</span><br><span class="line">    <span class="keyword">int</span> h = <span class="number">0</span>; lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> j = sa[rk[i]<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line">        <span class="keyword">for</span>(;j+h &lt; len &amp;&amp; i+h &lt; len;h++)</span><br><span class="line">            <span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">        lcp[rk[i]<span class="number">-1</span>] = h;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">110</span>],idx[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">1</span>; <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line">    vis[idx[sa[<span class="number">1</span>]]] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= len;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &lt; p)&#123;</span><br><span class="line">            cnt = <span class="number">1</span>; <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);vis[idx[sa[i]]] = <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!vis[idx[sa[i]]]) cnt++,vis[idx[sa[i]]] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(cnt &gt;= n/<span class="number">2</span>+<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">1</span>; <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line">    vis[idx[sa[<span class="number">1</span>]]] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= len+<span class="number">1</span>;i++)&#123;  <span class="comment">//lcp[len+1] = 0,ä½œä¸ºç»“æŸæ ‡å¿—</span></span><br><span class="line">        <span class="keyword">if</span>(lcp[i<span class="number">-1</span>] &lt; p)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cnt &gt;= n/<span class="number">2</span>+<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = sa[i<span class="number">-1</span>];j &lt; sa[i<span class="number">-1</span>]+p;j++) <span class="built_in">cout</span> &lt;&lt; str[j];</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cnt = <span class="number">1</span>; <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);vis[idx[sa[i]]] = <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!vis[idx[sa[i]]]) cnt++,vis[idx[sa[i]]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    construct_sa(str,sa);</span><br><span class="line">    construct_lcp(str,sa,lcp);</span><br><span class="line">    <span class="comment">/*sa[i]ï¼šå­˜æ”¾æ’åç¬¬içš„åç¼€çš„èµ·å§‹ä½ç½®*/</span></span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, r = len;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(check(mid)) l = mid+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> r = mid<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(r &lt;= <span class="number">0</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">"?"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">else</span> print(r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; n &amp;&amp; n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; str; <span class="built_in">cout</span> &lt;&lt; str &lt;&lt; <span class="built_in">endl</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">2</span>,tot = <span class="number">0</span>; str = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; s; str += s+<span class="keyword">char</span>(++cnt);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt;= s.length();j++) idx[tot++] = i;</span><br><span class="line">        &#125; </span><br><span class="line">        solve();</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>ç½—ç©—éªï¼Œåç¼€æ•°ç»„â€”â€”å¤„ç†å­—ç¬¦ä¸²çš„æœ‰åˆ©å·¥å…·ï¼Œ2009.1</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åç¼€æ•°ç»„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‘é“¾å‰–åˆ†é¢˜é›†</title>
      <link href="/2019/10/12/lct-problems/"/>
      <url>/2019/10/12/lct-problems/</url>
      
        <content type="html"><![CDATA[<p>æ ‘é“¾å‰–åˆ†å¸¸ç”¨äºå¤„ç†é™æ€æ ‘ä¸Šæ“ä½œï¼Œæ•ˆç‡å¾ˆé«˜ï¼Œå†™èµ·æ¥ä¹Ÿå°±æ˜¯å›ºå®šçš„è½»é‡è¾¹æ‹†åˆ†+çº¿æ®µæ ‘ï¼Œä½†æ˜¯ä»£ç ä¸€èˆ¬éƒ½æ˜¯100è¡Œ+ï¼Œå®¹æ˜“å‡ºé”™ã€‚<br>æœ¬é¢˜é›†ä¸­çš„æ ‘é“¾å‰–åˆ†ç»ƒä¹ é¢˜ï¼Œåœ¨è§£å†³æ€è·¯ä¸Šæ²¡ä»€ä¹ˆéš¾ç‚¹ï¼Œä¸»è¦æ˜¯å¦‚ä½•è®¾è®¡çº¿æ®µæ ‘ä»¥åŠå¦‚ä½•æ›´æ–°+è¯¢é—®ï¼Œä¹Ÿå°±æ˜¯è¯´è¦æƒ³å¥½æ€ä¹ˆç»´æŠ¤çº¿æ®µæ ‘ï¼Œå…¶å®ƒåœ°æ–¹æ²¡ä»€ä¹ˆå¤ªéš¾çš„ï¼Œä½†æ˜¯ä»£ç é•¿å°±å®¹æ˜“å‡ºbugï¼Œå¤šå†™å†™å°±å¥½äº†ã€‚æœ€åä¸€é¢˜æ˜¯çº¿æ®µæ ‘åŠ¨æ€å¼€ç‚¹ï¼Œè¿™å’Œå¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘ï¼ˆåŠ¨æ€ä¸»å¸­æ ‘ï¼‰ä¸€æ ·çš„æ€æƒ³ï¼Œåªéœ€è¦å°†æ™®é€šçš„çº¿æ®µæ ‘ç»™ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å³å¯ã€‚</p><h4 id="æ ‘çš„ç»Ÿè®¡"><a href="#æ ‘çš„ç»Ÿè®¡" class="headerlink" title="æ ‘çš„ç»Ÿè®¡"></a>æ ‘çš„ç»Ÿè®¡</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šZJOI 2008<br>ä¸€æ ‘ä¸Šæœ‰ n ä¸ªèŠ‚ç‚¹ï¼Œç¼–å·åˆ†åˆ«ä¸º 1 åˆ° nï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼ wã€‚æˆ‘ä»¬å°†ä»¥ä¸‹é¢çš„å½¢å¼æ¥è¦æ±‚ä½ å¯¹è¿™æ£µæ ‘å®Œæˆä¸€äº›æ“ä½œï¼š</p><p>1.CHANGE u t ï¼šæŠŠèŠ‚ç‚¹ u æƒå€¼æ”¹ä¸º tï¼›</p><p>2.QMAX u v ï¼šè¯¢é—®ç‚¹ u åˆ°ç‚¹ v è·¯å¾„ä¸Šçš„èŠ‚ç‚¹çš„æœ€å¤§æƒå€¼ï¼›</p><p>3.QSUM u v ï¼šè¯¢é—®ç‚¹ u åˆ°ç‚¹ v è·¯å¾„ä¸Šçš„èŠ‚ç‚¹çš„æƒå€¼å’Œã€‚</p><p>æ³¨æ„ï¼šä»ç‚¹ u åˆ°ç‚¹ v è·¯å¾„ä¸Šçš„èŠ‚ç‚¹åŒ…æ‹¬ u å’Œ v æœ¬èº«ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æ ‘é“¾å‰–åˆ†+çº¿æ®µæ ‘ä¸Šå•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢ï¼Œéœ€è¦æ³¨æ„æŸ¥è¯¢æ“ä½œï¼Œåˆ©ç”¨åˆ°äº†LCAå€å¢æ€æƒ³ï¼Œæ ‘é“¾å‰–åˆ†ä¸­å¾ˆå¤šåŒºé—´ä¿®æ”¹å’ŒæŸ¥è¯¢æ“ä½œéƒ½æ˜¯è¿™æ ·å®Œæˆçš„ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> ll INF = <span class="number">1e18</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2</span>*N;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],edge[M],nex[M],tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    ver[++tot] = y, edge[tot] = z;</span><br><span class="line">    nex[tot] = head[x], head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,q,a[N];</span><br><span class="line"><span class="comment">/*çˆ¶äº²,æ·±åº¦,å­æ ‘å¤§å°,é‡å„¿å­,é‡è·¯å¾„é¡¶éƒ¨èŠ‚ç‚¹,</span></span><br><span class="line"><span class="comment">    æ ‘ä¸­èŠ‚ç‚¹åœ¨çº¿æ®µæ ‘ä¸­ä¸‹æ ‡,çº¿æ®µæ ‘ä¸­èŠ‚ç‚¹å¯¹åº”æ ‘ä¸­ä½ç½®*/</span></span><br><span class="line"><span class="keyword">int</span> par[N],deep[N],size[N],son[N],top[N],seg[N],rev[N];</span><br><span class="line"><span class="keyword">int</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*åˆ©ç”¨æ·±æœæ›´æ–°par,size,deep,sonæ•°ç»„*/</span></span><br><span class="line">    vis[x] = <span class="literal">true</span>; size[x] = <span class="number">1</span>;</span><br><span class="line">    par[x] = fa; deep[x] = deep[fa]+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(y == fa || vis[y]) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(y,x);</span><br><span class="line">        size[x] += size[y]; <span class="comment">//ç´¯åŠ å­æ ‘å¤§å°</span></span><br><span class="line">        <span class="keyword">if</span>(size[y] &gt; size[son[x]]) son[x] = y;<span class="comment">//æ±‚é‡å„¿å­</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(son[x])&#123; <span class="comment">//å…ˆèµ°é‡å„¿å­,ä½¿å¾—é‡è·¯å¾„åœ¨çº¿æ®µæ ‘ä¸­è¿ç»­</span></span><br><span class="line">        seg[son[x]] = ++seg[<span class="number">0</span>];<span class="comment">//0ä½ç½®ç”¨ä¸åˆ°,åˆ©ç”¨æ¥è®¡æ•°</span></span><br><span class="line">        top[son[x]] = top[x];</span><br><span class="line">        rev[seg[<span class="number">0</span>]] = son[x];</span><br><span class="line">        dfs2(son[x],x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(top[y]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="comment">/*è‹¥yæ²¡æœ‰è¢«éå†è¿‡,å³yä¸æ˜¯xçš„é‡å„¿å­æˆ–è€…çˆ¶äº²*/</span></span><br><span class="line">        seg[y] = ++seg[<span class="number">0</span>]; rev[seg[<span class="number">0</span>]] = y;</span><br><span class="line">        top[y] = y; dfs2(y,x);</span><br><span class="line">        <span class="comment">/*å¦‚æœx--&gt;yæ˜¯è½»è¾¹,é‚£ä¹ˆyå°±æ˜¯å…¶æ‰€åœ¨é‡è·¯å¾„é¡¶éƒ¨èŠ‚ç‚¹*/</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l,r;</span><br><span class="line">    ll mx, sum;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> l(x) t[x].l</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> r(x) t[x].r</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> mx(x) t[x].mx</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> sum(x) t[x].sum</span></span><br><span class="line">&#125;t[N*<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    l(rt) = l, r(rt) = r;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        mx(rt) = sum(rt) = a[rev[l]]; <span class="comment">//çº¿æ®µæ ‘ä¸ŠlèŠ‚ç‚¹å¯¹åº”ç€æ ‘ä¸Šrev[l]ç‚¹</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    BuildTree(rt*<span class="number">2</span>,l,mid); BuildTree(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">    mx(rt) = max(mx(rt&lt;&lt;<span class="number">1</span>),mx(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>));</span><br><span class="line">    sum(rt) = sum(rt&lt;&lt;<span class="number">1</span>) + sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preHandle</span><span class="params">()</span></span>&#123;</span><br><span class="line">    dfs1(<span class="number">1</span>,<span class="number">0</span>); <span class="comment">//æˆ‘ä»¬ä»¥1å·èŠ‚ç‚¹ä¸ºæ ¹</span></span><br><span class="line">    <span class="comment">/*æ ¹èŠ‚ç‚¹æ‰€åœ¨é‡è·¯å¾„çš„é¡¶éƒ¨èŠ‚ç‚¹ä¹Ÿæ˜¯æ ¹èŠ‚ç‚¹,èµ‹åˆå€¼*/</span></span><br><span class="line">    seg[<span class="number">0</span>] = seg[<span class="number">1</span>] = top[<span class="number">1</span>] = rev[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    dfs2(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    BuildTree(<span class="number">1</span>,<span class="number">1</span>,seg[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line">ll tmx,tsum;<span class="comment">//åˆ©ç”¨å…¨å±€å˜é‡åŒæ—¶ç»Ÿè®¡2ä¸ªç­”æ¡ˆ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*å°†ä»¥rtä¸ºæ ¹çš„åŒºé—´å†…å±äº[l,r]éƒ¨åˆ†çš„å’Œç´¯åŠ åˆ°tsumä¸Š,å¹¶æ›´æ–°tmx*/</span></span><br><span class="line">    <span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r)&#123;</span><br><span class="line">        tsum += sum(rt); tmx = max(tmx,mx(rt));</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) query(rt&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) query(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*è¿”å›xä¸yä¹‹é—´è·¯å¾„ä¸Šæƒå€¼æœ€å¤§ç‚¹çš„æƒå€¼*/</span></span><br><span class="line">    <span class="keyword">int</span> fx = top[x] , fy = top[y];</span><br><span class="line">    <span class="keyword">while</span>(fx != fy)&#123;<span class="comment">//å…ˆå°†xå’Œyæ¡æ•´åˆ°åŒä¸€ä¸ªé‡é“¾ä¸Š</span></span><br><span class="line">        <span class="keyword">if</span>(deep[fx] &lt; deep[fy]) swap(x,y),swap(fx,fy);</span><br><span class="line">        query(<span class="number">1</span>,seg[fx],seg[x]);</span><br><span class="line">        x = par[fx]; fx = top[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(deep[x] &gt; deep[y]) swap(x,y);<span class="comment">//è·¯å¾„æµ…çš„ç¼–å·å°</span></span><br><span class="line">    query(<span class="number">1</span>,seg[x],seg[y]); <span class="comment">//å†æ›´æ–°ä¸€æ¬¡</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> x,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*æŠŠçº¿æ®µæ ‘èŠ‚ç‚¹xçš„æƒå€¼æ”¹ä¸ºval*/</span></span><br><span class="line">    <span class="keyword">if</span>(l(rt) == r(rt))&#123;</span><br><span class="line">        mx(rt) = sum(rt) = val;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l(rt) + r(rt) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x &gt; mid) change(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,x,val);</span><br><span class="line">    <span class="keyword">else</span> change(rt&lt;&lt;<span class="number">1</span>,x,val);</span><br><span class="line">    mx(rt) = max(mx(rt&lt;&lt;<span class="number">1</span>),mx(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>));</span><br><span class="line">    sum(rt) = sum(rt&lt;&lt;<span class="number">1</span>) + sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">        freopen(<span class="string">"123.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">        freopen(<span class="string">"222.txt"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt; n;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">        addEdge(x,y,<span class="number">1</span>); addEdge(y,x,<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;q);</span><br><span class="line">    preHandle();<span class="comment">//æ ‘é“¾å‰–åˆ†é¢„å¤„ç†</span></span><br><span class="line">    <span class="keyword">char</span> op[<span class="number">20</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= q;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s%d%d"</span>,op,&amp;x,&amp;y);</span><br><span class="line">        <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">'C'</span>) change(<span class="number">1</span>,seg[x],y);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            tmx = -INF; tsum = <span class="number">0</span>;</span><br><span class="line">            ask(x,y);<span class="comment">//åŒæ—¶æ›´æ–°æœ€å¤§å€¼ä¸è·¯å¾„å’Œ</span></span><br><span class="line">            <span class="keyword">if</span>(op[<span class="number">1</span>] == <span class="string">'M'</span>) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,tmx);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,tsum);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ã€ŒHAOI2015ã€æ ‘ä¸Šæ“ä½œ"><a href="#ã€ŒHAOI2015ã€æ ‘ä¸Šæ“ä½œ" class="headerlink" title="ã€ŒHAOI2015ã€æ ‘ä¸Šæ“ä½œ"></a>ã€ŒHAOI2015ã€æ ‘ä¸Šæ“ä½œ</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>æœ‰ä¸€æ£µç‚¹æ•°ä¸º N çš„æ ‘ï¼Œä»¥ç‚¹ 1 ä¸ºæ ¹ï¼Œä¸”æ ‘æœ‰ç‚¹æƒã€‚ç„¶åæœ‰ M ä¸ªæ“ä½œï¼Œåˆ†ä¸ºä¸‰ç§ï¼š</p><p>1ã€æŠŠæŸä¸ªèŠ‚ç‚¹ x çš„ç‚¹æƒå¢åŠ  a ã€‚</p><p>2ã€æŠŠæŸä¸ªèŠ‚ç‚¹ x ä¸ºæ ¹çš„å­æ ‘ä¸­æ‰€æœ‰ç‚¹çš„ç‚¹æƒéƒ½å¢åŠ  a ã€‚</p><p>3ã€è¯¢é—®æŸä¸ªèŠ‚ç‚¹ x åˆ°æ ¹çš„è·¯å¾„ä¸­æ‰€æœ‰ç‚¹çš„ç‚¹æƒå’Œã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æ ‘é“¾å‰–åˆ†+çº¿æ®µæ ‘ä¸ŠåŒºé—´ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢ã€‚ç”¨åˆ°äº†çº¿æ®µæ ‘ä¸Šçš„å»¶è¿Ÿæ ‡è®°ï¼Œå…¶å®å’Œæ™®é€šçº¿æ®µæ ‘æ²¡å•¥åŒºåˆ«ï¼Œå°±æ˜¯æŸ¥è¯¢å’Œä¿®æ”¹æ—¶å€™è¦ç”¨LCAå€å¢æ€æƒ³å°†æ ‘ä¸Šçš„é“¾è½¬åŒ–ä¸ºçº¿æ®µæ ‘ä¸Šçš„åŒºé—´ã€‚åªè¦ç†è§£äº†æ ‘ä¸ŠèŠ‚ç‚¹å’Œçº¿æ®µæ ‘ä¸‹æ ‡æ˜¯é€šè¿‡seg[x] å’Œ rev[seg[x]]æ¥è½¬æ¢çš„å³å¯ã€‚</p><p>å¦å¤–è¿˜éœ€è¦æ˜ç™½çº¿æ®µæ ‘ä¸Šé‡é“¾çš„seg[]å€¼æ˜¯è¿ç»­çš„ï¼ŒåŒä¸€ä¸ªå­æ ‘ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹ä¸‹æ ‡ä¹Ÿæ˜¯è¿ç»­çš„ï¼Œè¿™ä¸ªç»“è®ºå¯ä»¥é€šè¿‡è§‚å¯Ÿdfs2çš„å®ç°å¾—åˆ°ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],edge[M],nex[M],tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    ver[++tot] = y,edge[tot] = z;</span><br><span class="line">    nex[tot] = head[x]; head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m,a[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c!=<span class="string">'-'</span> &amp;&amp; (c&lt;<span class="string">'0'</span> || c&gt;<span class="string">'9'</span>)) c = getchar();</span><br><span class="line">    <span class="keyword">if</span> (c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c&gt;=<span class="string">'0'</span> &amp;&amp; c&lt;=<span class="string">'9'</span>)</span><br><span class="line">        ans = ans*<span class="number">10</span> + c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> neg ? -ans : ans; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> deep[N],par[N],top[N],size[N],son[N],seg[N],rev[N];</span><br><span class="line"><span class="keyword">int</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    vis[x] = <span class="literal">true</span>; par[x] = fa;</span><br><span class="line">    deep[x] = deep[fa]+<span class="number">1</span>; size[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(vis[y] || y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(y,x);</span><br><span class="line">        size[x] += size[y]; </span><br><span class="line">        <span class="keyword">if</span>(size[y] &gt; size[son[x]]) son[x] = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(son[x])&#123;</span><br><span class="line">        seg[son[x]] = ++seg[<span class="number">0</span>];</span><br><span class="line">        rev[seg[<span class="number">0</span>]] = son[x];</span><br><span class="line">        top[son[x]] = top[x];</span><br><span class="line">        dfs2(son[x],x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(top[y]) <span class="keyword">continue</span>;</span><br><span class="line">        seg[y] = ++seg[<span class="number">0</span>]; rev[seg[<span class="number">0</span>]] = y;</span><br><span class="line">        top[y] = y; dfs2(y,x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l,r;</span><br><span class="line">    ll sum,add;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> l(x) t[x].l</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> r(x) t[x].r</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> sum(x) t[x].sum</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> add(x) t[x].add</span></span><br><span class="line">&#125;t[N*<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    l(rt) = l,r(rt) = r,add(rt) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        sum(rt) = a[rev[l]]; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    BuildTree(rt&lt;&lt;<span class="number">1</span>,l,mid); BuildTree(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">    sum(rt) = sum(rt&lt;&lt;<span class="number">1</span>) + sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preHandle</span><span class="params">()</span></span>&#123;</span><br><span class="line">    dfs1(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    seg[<span class="number">0</span>] = seg[<span class="number">1</span>] = top[<span class="number">1</span>] = rev[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    dfs2(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    BuildTree(<span class="number">1</span>,<span class="number">1</span>,seg[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spread</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!add(rt)) <span class="keyword">return</span>;</span><br><span class="line">    sum(rt&lt;&lt;<span class="number">1</span>) += (r(rt&lt;&lt;<span class="number">1</span>)-l(rt&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>)*add(rt);</span><br><span class="line">    sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>) += (r(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>)-l(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>)+<span class="number">1</span>)*add(rt);</span><br><span class="line">    add(rt&lt;&lt;<span class="number">1</span>) += add(rt); add(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>) += add(rt);</span><br><span class="line">    add(rt) = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,ll val)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r)&#123;</span><br><span class="line">        sum(rt) += (r(rt) - l(rt)+<span class="number">1</span>)*val;</span><br><span class="line">        add(rt) += val; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    spread(rt);</span><br><span class="line">    <span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) Add(rt&lt;&lt;<span class="number">1</span>,l,r,val);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) Add(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,val);</span><br><span class="line">    sum(rt) = sum(rt&lt;&lt;<span class="number">1</span>)+sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r) <span class="keyword">return</span> sum(rt);</span><br><span class="line">    spread(rt); ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = l(rt) + r(rt) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) res += query(rt&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) res += query(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*ä»èŠ‚ç‚¹xåˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„å’Œ*/</span></span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        res += query(<span class="number">1</span>,seg[top[x]],seg[x]);</span><br><span class="line">        x = par[top[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    n = getInt(); m = getInt();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) a[i] = getInt();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt; n;i++)&#123;</span><br><span class="line">        x = getInt(); y = getInt();</span><br><span class="line">        addEdge(x,y,<span class="number">1</span>); addEdge(y,x,<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    preHandle();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,op,x,y;i &lt;= m;i++)&#123;</span><br><span class="line">        op = getInt();</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            x = getInt(); y = getInt();</span><br><span class="line">            Add(<span class="number">1</span>,seg[x],seg[x],y);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)&#123;</span><br><span class="line">            x = getInt(); y = getInt();</span><br><span class="line">            Add(<span class="number">1</span>,seg[x],seg[x]+size[x]<span class="number">-1</span>,y);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            x = getInt(); <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ask(x));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ã€ŒNOI2015ã€è½¯ä»¶åŒ…ç®¡ç†å™¨"><a href="#ã€ŒNOI2015ã€è½¯ä»¶åŒ…ç®¡ç†å™¨" class="headerlink" title="ã€ŒNOI2015ã€è½¯ä»¶åŒ…ç®¡ç†å™¨"></a>ã€ŒNOI2015ã€è½¯ä»¶åŒ…ç®¡ç†å™¨</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>Linux ç”¨æˆ·å’Œ OSX ç”¨æˆ·ä¸€å®šå¯¹è½¯ä»¶åŒ…ç®¡ç†å™¨ä¸ä¼šé™Œç”Ÿã€‚é€šè¿‡è½¯ä»¶åŒ…ç®¡ç†å™¨ï¼Œä½ å¯ä»¥é€šè¿‡ä¸€è¡Œå‘½ä»¤å®‰è£…æŸä¸€ä¸ªè½¯ä»¶åŒ…ï¼Œç„¶åè½¯ä»¶åŒ…ç®¡ç†å™¨ä¼šå¸®åŠ©ä½ ä»è½¯ä»¶æºä¸‹è½½è½¯ä»¶åŒ…ï¼ŒåŒæ—¶è‡ªåŠ¨è§£å†³æ‰€æœ‰çš„ä¾èµ–ï¼ˆå³ä¸‹è½½å®‰è£…è¿™ä¸ªè½¯ä»¶åŒ…çš„å®‰è£…æ‰€ä¾èµ–çš„å…¶å®ƒè½¯ä»¶åŒ…ï¼‰ï¼Œå®Œæˆæ‰€æœ‰çš„é…ç½®ã€‚Debian/Ubuntu ä½¿ç”¨çš„ apt-getï¼ŒFedora/CentOS ä½¿ç”¨çš„ yumï¼Œä»¥åŠ OSX ä¸‹å¯ç”¨çš„ Homebrew éƒ½æ˜¯ä¼˜ç§€çš„è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚</p><p>ä½ å†³å®šè®¾è®¡ä½ è‡ªå·±çš„è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚ä¸å¯é¿å…åœ°ï¼Œä½ è¦è§£å†³è½¯ä»¶åŒ…ä¹‹é—´çš„ä¾èµ–é—®é¢˜ã€‚å¦‚æœè½¯ä»¶åŒ… A ä¾èµ–è½¯ä»¶åŒ… Bï¼Œé‚£ä¹ˆå®‰è£…è½¯ä»¶åŒ… A ä»¥å‰ï¼Œå¿…é¡»å…ˆå®‰è£…è½¯ä»¶åŒ… Bã€‚åŒæ—¶ï¼Œå¦‚æœæƒ³è¦å¸è½½è½¯ä»¶åŒ… Bï¼Œåˆ™å¿…é¡»å¸è½½è½¯ä»¶åŒ… Aã€‚ç°åœ¨ä½ å·²ç»è·å¾—äº†æ‰€æœ‰çš„è½¯ä»¶åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚è€Œä¸”ï¼Œç”±äºä½ ä¹‹å‰çš„å·¥ä½œï¼Œé™¤ 0 å·è½¯ä»¶åŒ…ä»¥å¤–ï¼Œåœ¨ä½ çš„ç®¡ç†å™¨å½“ä¸­çš„è½¯ä»¶åŒ…éƒ½ä¼šä¾èµ–ä¸€ä¸ªä¸”ä»…ä¸€ä¸ªè½¯ä»¶åŒ…ï¼Œè€Œ 0 å·è½¯ä»¶åŒ…ä¸ä¾èµ–ä»»ä½•ä¸€ä¸ªè½¯ä»¶åŒ…ã€‚ä¾èµ–å…³ç³»ä¸å­˜åœ¨ç¯ï¼ˆè‹¥æœ‰m(mâ‰¥2) ä¸ªè½¯ä»¶åŒ…A1,A2,A3,â€¦,Am ï¼Œå…¶ä¸­ A1 ä¾èµ– A2ï¼ŒA2ä¾èµ– A3 ä¾èµ– A4 ï¼Œâ€¦â€¦ï¼ŒAmâˆ’1 ä¾èµ– Am ï¼Œè€Œ Am ä¾èµ– A1 ï¼Œåˆ™ç§°è¿™ m ä¸ªè½¯ä»¶åŒ…çš„ä¾èµ–å…³ç³»æ„æˆç¯ï¼‰ï¼Œå½“ç„¶ä¹Ÿä¸ä¼šæœ‰ä¸€ä¸ªè½¯ä»¶åŒ…ä¾èµ–è‡ªå·±ã€‚</p><p>ç°åœ¨ä½ è¦ä¸ºä½ çš„è½¯ä»¶åŒ…ç®¡ç†å™¨å†™ä¸€ä¸ªä¾èµ–è§£å†³ç¨‹åºã€‚æ ¹æ®åé¦ˆï¼Œç”¨æˆ·å¸Œæœ›åœ¨å®‰è£…å’Œå¸è½½æŸä¸ªè½¯ä»¶åŒ…æ—¶ï¼Œå¿«é€Ÿåœ°çŸ¥é“è¿™ä¸ªæ“ä½œå®é™…ä¸Šä¼šæ”¹å˜å¤šå°‘ä¸ªè½¯ä»¶åŒ…çš„å®‰è£…çŠ¶æ€ï¼ˆå³å®‰è£…æ“ä½œä¼šå®‰è£…å¤šå°‘ä¸ªæœªå®‰è£…çš„è½¯ä»¶åŒ…ï¼Œæˆ–å¸è½½æ“ä½œä¼šå¸è½½å¤šå°‘ä¸ªå·²å®‰è£…çš„è½¯ä»¶åŒ…ï¼‰ï¼Œä½ çš„ä»»åŠ¡å°±æ˜¯å®ç°è¿™ä¸ªéƒ¨åˆ†ã€‚æ³¨æ„ï¼Œå®‰è£…ä¸€ä¸ªå·²å®‰è£…çš„è½¯ä»¶åŒ…ï¼Œæˆ–å¸è½½ä¸€ä¸ªæœªå®‰è£…çš„è½¯ä»¶åŒ…ï¼Œéƒ½ä¸ä¼šæ”¹å˜ä»»ä½•è½¯ä»¶åŒ…çš„å®‰è£…çŠ¶æ€ï¼Œå³åœ¨æ­¤æƒ…å†µä¸‹ï¼Œæ”¹å˜å®‰è£…çŠ¶æ€çš„è½¯ä»¶åŒ…æ•°ä¸º 0ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>è¦ç”»å›¾ç†è§£é¢˜æ„ï¼Œè‹¥Aä¾èµ–Bï¼Œåˆ™å®‰è£…Aä¹‹å‰è¦å®‰è£…Bï¼Œè‹¥å¸è½½Bè¦å…ˆå¸è½½Aã€‚ä¹Ÿå°±æ˜¯è¯´è¦å®‰è£…Aï¼Œå°±è¦ç¡®ä¿Aåˆ°æ ¹èŠ‚ç‚¹è·¯å¾„ä¸Šè½¯ä»¶éƒ½å·²å®‰è£…ï¼›è‹¥å¸è½½Aï¼Œå°±è¦ç¡®ä¿ A çš„å­æ ‘ä¸ºç©ºã€‚</p><p>äºæ˜¯å°±æ˜¯æ ‘ä¸Šæ“ä½œï¼Œè‹¥å¸è½½ä¸€ä¸ªè½¯ä»¶ x ï¼Œå°±æ˜¯æŸ¥è¯¢å®ƒå­æ ‘ä¸Šå·²å®‰è£…çš„è½¯ä»¶ä¸ªæ•°ï¼ˆåŒ…æ‹¬å®ƒè‡ªå·±ï¼‰ï¼Œè¾“å‡ºåå†åˆ é™¤å³å¯ï¼›è‹¥å®‰è£…ä¸€ä¸ªè½¯ä»¶ x ï¼Œå°±æ˜¯æŸ¥è¯¢ x åˆ°æ ¹èŠ‚ç‚¹è·¯å¾„ä¸Šæœªå®‰è£…çš„è½¯ä»¶ä¸ªæ•°ï¼ˆåŒ…æ‹¬å®ƒè‡ªå·±ï¼‰ï¼Œè¾“å‡ºåå†å®‰è£…ã€‚å› ä¸ºè½¯ä»¶å®‰è£…å’Œå¸è½½åªæ˜¯æ”¹å˜å…¶çŠ¶æ€ï¼ˆå·²å®‰è£…ï¼š1ï¼Œæœªå®‰è£…ï¼š0ï¼‰ï¼Œè€Œä¸æ”¹å˜ç»“æ„ï¼ˆå½»åº•åˆ é™¤èŠ‚ç‚¹ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ ‘é“¾å‰–åˆ†+çº¿æ®µæ ‘è§£å†³ã€‚</p><p>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ€ä¹ˆæŠŠæ•´æ£µå­æ ‘éƒ½æ¸…é›¶ï¼Œæ€ä¹ˆæŠŠåˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„éƒ½ç½® 1ï¼Œæ˜¾ç„¶è¦ç”¨å»¶è¿Ÿæ ‡è®°ï¼Œä½†æ˜¯å»¶è¿Ÿæ ‡è®°å´ä¸åº”è¯¥ç´¯åŠ ï¼Œé‚£è¦æ€ä¹ˆå¤„ç†ï¼Ÿ<br>ç½® 1 æ—¶å»¶è¿Ÿæ ‡è®°add = 1ï¼Œç½®0æ—¶å»¶è¿Ÿæ ‡è®°add = -1ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹å¦‚æœå»¶è¿Ÿæ ‡è®°ä¸ä¸º0ï¼Œé‚£ä¹ˆè¯¥èŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘æ‰€æœ‰è½¯ä»¶çŠ¶æ€ç›¸åŒã€‚æˆ‘ä»¬ä¸‹ä¼ å»¶è¿Ÿæ ‡è®°æ“ä½œå°è£…åœ¨spreadå‡½æ•°å†…ï¼Œå¯ä»¥å‚è€ƒå¦‚ä½•å®ç°å»¶è¿Ÿæ ‡è®°çš„æ›´æ–°ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> ll;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],edge[M],nex[M],tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    ver[++tot] = y, edge[tot] = z;</span><br><span class="line">    nex[tot] = head[x], head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> par[N],deep[N],size[N],son[N],top[N],seg[N],rev[N];</span><br><span class="line"><span class="keyword">int</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    vis[x] = <span class="literal">true</span>; par[x] = fa;</span><br><span class="line">    deep[x] = deep[fa]+<span class="number">1</span>; size[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(vis[y]) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(y,x);</span><br><span class="line">        size[x] += size[y];</span><br><span class="line">        <span class="keyword">if</span>(size[y] &gt; size[son[x]]) son[x] = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(son[x])&#123;</span><br><span class="line">        seg[son[x]] = ++seg[<span class="number">0</span>];</span><br><span class="line">        rev[seg[<span class="number">0</span>]] = son[x];</span><br><span class="line">        top[son[x]] = top[x];</span><br><span class="line">        dfs2(son[x],x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(top[y]) <span class="keyword">continue</span>;</span><br><span class="line">        seg[y] = ++seg[<span class="number">0</span>]; rev[seg[<span class="number">0</span>]] = y;</span><br><span class="line">        top[y] = y; dfs2(y,x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l,r,sum,add;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> l(x) t[x].l</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> r(x) t[x].r</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> sum(x) t[x].sum</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> add(x) t[x].add</span></span><br><span class="line">&#125;t[N*<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    l(rt) = l,r(rt) = r,add(rt) = sum(rt) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    BuildTree(rt&lt;&lt;<span class="number">1</span>,l,mid); BuildTree(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">    sum(rt) = sum(rt&lt;&lt;<span class="number">1</span>) + sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preHandle</span><span class="params">()</span></span>&#123;</span><br><span class="line">    dfs1(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    seg[<span class="number">0</span>] = seg[<span class="number">1</span>] = top[<span class="number">1</span>] = rev[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    dfs2(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    BuildTree(<span class="number">1</span>,<span class="number">1</span>,seg[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spread</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!add(rt)) <span class="keyword">return</span>; </span><br><span class="line">    <span class="keyword">if</span>(add(rt) == <span class="number">-1</span>)&#123;</span><br><span class="line">        sum(rt&lt;&lt;<span class="number">1</span>) = sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>) = <span class="number">0</span>;</span><br><span class="line">        add(rt&lt;&lt;<span class="number">1</span>) = add(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>) = add(rt);</span><br><span class="line">        add(rt) = <span class="number">0</span>; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sum(rt&lt;&lt;<span class="number">1</span>) = (r(rt&lt;&lt;<span class="number">1</span>)-l(rt&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>)*add(rt);</span><br><span class="line">    sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>) = (r(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>)-l(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>)+<span class="number">1</span>)*add(rt);</span><br><span class="line">    add(rt&lt;&lt;<span class="number">1</span>) = add(rt); add(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>) = add(rt);</span><br><span class="line">    add(rt) = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,ll val)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(val == <span class="number">-1</span>) sum(rt) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> sum(rt) = (r(rt) - l(rt)+<span class="number">1</span>);</span><br><span class="line">        add(rt) = val; </span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    spread(rt);</span><br><span class="line">    <span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) Add(rt&lt;&lt;<span class="number">1</span>,l,r,val);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) Add(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,val);</span><br><span class="line">    sum(rt) = sum(rt&lt;&lt;<span class="number">1</span>)+sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r) <span class="keyword">return</span> sum(rt);</span><br><span class="line">    spread(rt); ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = l(rt) + r(rt) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) res += query(rt&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) res += query(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask1</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> query(<span class="number">1</span>,seg[x],seg[x]+size[x]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask2</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        res += query(<span class="number">1</span>,seg[top[x]],seg[x]);</span><br><span class="line">        x = par[top[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add2</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        Add(<span class="number">1</span>,seg[top[x]],seg[x],<span class="number">1</span>);</span><br><span class="line">        x = par[top[x]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x;i &lt; n;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">        addEdge(x+<span class="number">1</span>,i+<span class="number">1</span>,<span class="number">1</span>); addEdge(i+<span class="number">1</span>,x+<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    preHandle();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m); <span class="keyword">char</span> op[<span class="number">22</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s%d"</span>,op,&amp;x); x++;</span><br><span class="line">        <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">'u'</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask1(x));</span><br><span class="line">            Add(<span class="number">1</span>,seg[x],seg[x]+size[x]<span class="number">-1</span>,<span class="number">-1</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,deep[x]-ask2(x));</span><br><span class="line">            Add2(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æŸ“è‰²"><a href="#æŸ“è‰²" class="headerlink" title="æŸ“è‰²"></a>æŸ“è‰²</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šSDOI 2011<br>ç»™å®šä¸€æ£µæœ‰ n ä¸ªèŠ‚ç‚¹çš„æ— æ ¹æ ‘å’Œ m ä¸ªæ“ä½œï¼Œæ“ä½œå…±ä¸¤ç±»ã€‚<br>1ã€å°†èŠ‚ç‚¹ a åˆ°èŠ‚ç‚¹ b è·¯å¾„ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æŸ“ä¸Šé¢œè‰²ï¼›<br>2ã€è¯¢é—®èŠ‚ç‚¹ a åˆ°èŠ‚ç‚¹ b è·¯å¾„ä¸Šçš„é¢œè‰²æ®µæ•°é‡ï¼Œè¿ç»­ç›¸åŒé¢œè‰²çš„è®¤ä¸ºæ˜¯åŒä¸€æ®µï¼Œä¾‹å¦‚ 112221 ç”±ä¸‰æ®µç»„æˆï¼š11 ã€ 222ã€1ã€‚</p><p>è¯·ä½ å†™ä¸€ä¸ªç¨‹åºä¾æ¬¡å®Œæˆæ“ä½œã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>å¦‚æœä¸æ˜¯åœ¨æ ‘ä¸Šï¼Œæ˜¯åœ¨åŒºé—´ä¸Šï¼Œè¯¥å¦‚ä½•æ“ä½œï¼Ÿç”¨çº¿æ®µæ ‘è§£å†³ã€‚çº¿æ®µæ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹æœ‰lcï¼šå·¦ç«¯ç‚¹é¢œè‰²ï¼Œrcï¼šå³ç«¯ç‚¹é¢œè‰²ï¼Œsameï¼šåŒºé—´é¢œè‰²æ˜¯å¦å”¯ä¸€ï¼ˆ1è¡¨ç¤ºå”¯ä¸€ï¼Œ0è¡¨ç¤ºä¸å”¯ä¸€ï¼‰ï¼Œsumï¼šåŒºé—´å†…é¢œè‰²æ®µæ•°é‡ã€‚<br>é‚£ä¹ˆæ›´æ–°æ˜¾ç„¶è¦ç”¨å»¶è¿Ÿæ ‡è®°ï¼Œæ ‡è®°åœ¨sameä¸Šï¼Œè€Œåˆå¹¶æ“ä½œéœ€è¦è€ƒè™‘ä¸­é—´ç›¸æ¥çš„ç«¯ç‚¹é¢œè‰²æ˜¯å¦ç›¸åŒï¼Œè‹¥ç›¸åŒåˆ™é¢œè‰²æ®µæ•°é‡è¦-1ã€‚äºæ˜¯åŒºé—´ä¸Šâ€œæŸ“è‰²â€é—®é¢˜å°±å¯ä»¥ç”¨çº¿æ®µæ ‘è§£å†³äº†ã€‚</p><p>åœ¨æ ‘ä¸Šæ˜¾ç„¶ç±»ä¼¼ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥é€šè¿‡æ ‘é“¾å‰–åˆ†æ¥å°†æ ‘ç»™è½¬åŒ–ä¸ºåŒºé—´ã€‚å”¯ä¸€éº»çƒ¦çš„åœ°æ–¹å°±æ˜¯ç«¯ç‚¹é¢œè‰²é—®é¢˜ï¼Œåœ¨åŒºé—´ä¸Šï¼Œæˆ‘ä»¬åªéœ€è¦åˆ¤æ–­å·¦å­æ ‘çš„å³ç«¯ç‚¹ã€å³å­æ ‘çš„å·¦ç«¯ç‚¹æ˜¯å¦é¢œè‰²ç›¸åŒå³å¯ï¼Œä½†æ˜¯æ ‘ä¸Šçš„è·¯å¾„æ˜¯é€šè¿‡å€å¢æ¥æ‰¾çš„ï¼Œæ˜¾ç„¶éœ€è¦è®°å½•æ¯ä¸€æ¡é“¾çš„ç«¯ç‚¹é¢œè‰²ï¼Œéº»çƒ¦åœ¨äºå¦‚ä½•è®°å½•å¹¶åˆ¤æ–­ã€‚</p><p>æ ‘é“¾å‰–åˆ†åèŠ‚ç‚¹è¶Šæµ…ï¼Œå…¶segè¶Šå°ï¼Œäºæ˜¯éœ€è¦åˆ¤æ–­é¢œè‰²æ˜¯å¦ç›¸åŒçš„æ˜¯seg[fx]å’Œ seg[par[fx]]ï¼Œè¿™æ˜¯ç”±äºæˆ‘ä»¬åœ¨å€å¢è°ƒæ•´æ·±åº¦æ—¶å€™æ˜¯è‡ªåº•å‘ä¸Šçš„ï¼Œè‡ªç„¶è¦åˆ¤æ–­æ·±åº¦æµ…çš„èŠ‚ç‚¹ã€‚ä¸ºäº†ç¾è§‚ä»¥åŠç®€ä¾¿ï¼Œè®¾ getcol(x) è¿”å›è¯¥èŠ‚ç‚¹çš„é¢œè‰²ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],edge[M],ver[M],nex[M], tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    ver[++tot] = y, edge[tot] = z;</span><br><span class="line">    nex[tot] = head[x], head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> deep[N],seg[N],rev[N],top[N],son[N],size[N],par[N];</span><br><span class="line"><span class="keyword">int</span> vis[N],a[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    vis[x] = <span class="literal">true</span>; par[x] = fa;</span><br><span class="line">    deep[x] = deep[fa]+<span class="number">1</span>; size[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(vis[y] || y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(y,x);</span><br><span class="line">        size[x] += size[y];</span><br><span class="line">        <span class="keyword">if</span>(size[y] &gt; size[son[x]]) son[x] = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(son[x])&#123;</span><br><span class="line">        seg[son[x]] = ++seg[<span class="number">0</span>];</span><br><span class="line">        rev[seg[<span class="number">0</span>]] = son[x];</span><br><span class="line">        top[son[x]] = top[x];</span><br><span class="line">        dfs2(son[x],x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(top[y]) <span class="keyword">continue</span>;</span><br><span class="line">        seg[y] = ++seg[<span class="number">0</span>]; rev[seg[<span class="number">0</span>]] = y;</span><br><span class="line">        top[y] = y; dfs2(y,x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line">    <span class="comment">/*lc:åŒºé—´å·¦ç«¯ç‚¹é¢œè‰²,rc:åŒºé—´å³ç«¯ç‚¹é¢œè‰²,sum:åŒºé—´å†…é¢œè‰²æ®µæ•°*/</span></span><br><span class="line">    <span class="keyword">int</span> l,r,lc,rc,sum;</span><br><span class="line">    <span class="keyword">int</span> same;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> l(x) t[x].l</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> r(x) t[x].r</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> lc(x) t[x].lc</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rc(x) t[x].rc</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> sum(x) t[x].sum</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> same(x) t[x].same</span></span><br><span class="line">&#125;t[N*<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Updata</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;<span class="comment">//æ›´æ–°èŠ‚ç‚¹rtçš„sameã€rcã€lcå’Œsum</span></span><br><span class="line">    same(rt) = same(rt&lt;&lt;<span class="number">1</span>) &amp;&amp; same(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>) &amp;&amp; rc(rt&lt;&lt;<span class="number">1</span>) == lc(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">    sum(rt) = sum(rt&lt;&lt;<span class="number">1</span>)+sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(rc(rt&lt;&lt;<span class="number">1</span>) == lc(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>)) sum(rt)--;</span><br><span class="line">    lc(rt) = lc(rt&lt;&lt;<span class="number">1</span>); rc(rt) = rc(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    l(rt) = l,r(rt) = r,same(rt) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        lc(rt) = rc(rt) = a[rev[l]];</span><br><span class="line">        sum(rt) = <span class="number">1</span>; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    BuildTree(rt&lt;&lt;<span class="number">1</span>,l,mid); BuildTree(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">    Updata(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preHandle</span><span class="params">()</span></span>&#123;</span><br><span class="line">    dfs1(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    seg[<span class="number">0</span>] = seg[<span class="number">1</span>] = rev[<span class="number">1</span>] = top[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    dfs2(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    BuildTree(<span class="number">1</span>,<span class="number">1</span>,seg[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spread</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!same(rt)) <span class="keyword">return</span>;<span class="comment">//å°†æ‡’æƒ°æ ‡è®°ä¸‹ä¼ ï¼Œå³å¯¹å­æ ‘æŸ“ç›¸åŒé¢œè‰²</span></span><br><span class="line">    sum(rt&lt;&lt;<span class="number">1</span>) = sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>) = <span class="number">1</span>;</span><br><span class="line">    lc(rt&lt;&lt;<span class="number">1</span>) = rc(rt&lt;&lt;<span class="number">1</span>) = lc(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>) = rc(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>) = lc(rt);</span><br><span class="line">    same(rt&lt;&lt;<span class="number">1</span>) = same(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>) = <span class="number">1</span>; same(rt) = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> col)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r)&#123;</span><br><span class="line">        sum(rt) = <span class="number">1</span>; lc(rt) = rc(rt) = col;</span><br><span class="line">        same(rt) = <span class="number">1</span>; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    spread(rt);<span class="comment">//æ‡’æƒ°æ ‡è®°</span></span><br><span class="line">    <span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) modify(rt&lt;&lt;<span class="number">1</span>,l,r,col);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) modify(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,col);</span><br><span class="line">    Updata(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fx = top[x],fy = top[y];</span><br><span class="line">    <span class="keyword">while</span>(fx != fy)&#123;</span><br><span class="line">        <span class="keyword">if</span>(deep[fx] &lt; deep[fy]) swap(x,y),swap(fx,fy);</span><br><span class="line">        modify(<span class="number">1</span>,seg[fx],seg[x],z);</span><br><span class="line">        x = par[fx]; fx = top[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(deep[x] &gt; deep[y]) swap(x,y);</span><br><span class="line">    modify(<span class="number">1</span>,seg[x],seg[y],z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r) <span class="keyword">return</span> sum(rt);</span><br><span class="line">    spread(rt);</span><br><span class="line">    <span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span> ,res= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) res += query(rt&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) res += query(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="comment">/*åˆå¹¶æ—¶ä¸­é—´é¢œè‰²ç›¸åŒ,è¦å‡å»ä¸€æ®µ*/</span></span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid &amp;&amp; mid &lt; r &amp;&amp; rc(rt&lt;&lt;<span class="number">1</span>) == lc(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>)) res--;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getcol</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> x)</span></span>&#123;<span class="comment">//è¿™ä¸ªå‡½æ•°å¤ªå¥½ç”¨äº†ï¼Œå“­å“­</span></span><br><span class="line">    <span class="keyword">if</span>(l(rt) == r(rt)) <span class="keyword">return</span> lc(rt);</span><br><span class="line">    spread(rt);</span><br><span class="line">    <span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x &lt;= mid) <span class="keyword">return</span> getcol(rt&lt;&lt;<span class="number">1</span>,x);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> getcol(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fx = top[x], fy = top[y], res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(fx != fy)&#123;</span><br><span class="line">        <span class="keyword">if</span>(deep[fx] &lt; deep[fy]) swap(fx,fy),swap(x,y);</span><br><span class="line">        res += query(<span class="number">1</span>,seg[fx],seg[x]);</span><br><span class="line">        <span class="keyword">if</span>(getcol(<span class="number">1</span>,seg[fx]) == getcol(<span class="number">1</span>,seg[par[fx]])) res--;</span><br><span class="line">        x = par[fx]; fx = top[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(deep[x] &gt; deep[y]) swap(x,y);</span><br><span class="line">    res += query(<span class="number">1</span>,seg[x],seg[y]);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt; n;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y); </span><br><span class="line">        addEdge(x,y,<span class="number">1</span>); addEdge(y,x,<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    preHandle(); <span class="keyword">char</span> op[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>,op);</span><br><span class="line">        <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">'Q'</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(x,y));</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">            change(x,y,z);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ã€ŒSDOI2014ã€æ—…è¡Œ"><a href="#ã€ŒSDOI2014ã€æ—…è¡Œ" class="headerlink" title="ã€ŒSDOI2014ã€æ—…è¡Œ"></a>ã€ŒSDOI2014ã€æ—…è¡Œ</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>S å›½æœ‰ N ä¸ªåŸå¸‚ï¼Œç¼–å·ä» 1 åˆ° Nã€‚åŸå¸‚é—´ç”¨ Nâˆ’1 æ¡åŒå‘é“è·¯è¿æ¥ï¼Œæ»¡è¶³ä»ä¸€ä¸ªåŸå¸‚å‡ºå‘å¯ä»¥åˆ°è¾¾å…¶å®ƒæ‰€æœ‰åŸå¸‚ã€‚æ¯ä¸ªåŸå¸‚ä¿¡ä»°ä¸åŒçš„å®—æ•™ï¼Œå¦‚é£å¤©é¢æ¡ç¥æ•™ã€éšå½¢ç‹¬è§’å…½æ•™ã€ç»åœ°æ•™éƒ½æ˜¯å¸¸è§çš„ä¿¡ä»°ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ç”¨ä¸åŒçš„æ­£æ•´æ•°ä»£è¡¨å„ç§å®—æ•™ï¼ŒS å›½å¢ƒå†…æ€»å…±æœ‰ C ç§ä¸åŒçš„å®—æ•™ã€‚<br>S å›½çš„å±…æ°‘å¸¸å¸¸æ—…è¡Œã€‚æ—…è¡Œæ—¶ä»–ä»¬æ€»ä¼šèµ°æœ€çŸ­è·¯ï¼Œå¹¶ä¸”ä¸ºäº†é¿å…éº»çƒ¦ï¼Œåªåœ¨ä¿¡ä»°å’Œä»–ä»¬ç›¸åŒçš„åŸå¸‚ç•™å®¿ã€‚å½“ç„¶æ—…ç¨‹çš„ç»ˆç‚¹ä¹Ÿæ˜¯ä¿¡ä»°ä¸ä»–ç›¸åŒçš„åŸå¸‚ã€‚S å›½æ”¿åºœä¸ºæ¯ä¸ªåŸå¸‚æ ‡å®šäº†ä¸åŒçš„æ—…è¡Œè¯„çº§ï¼Œæ—…è¡Œè€…ä»¬å¸¸ä¼šè®°ä¸‹é€”ä¸­ï¼ˆåŒ…æ‹¬èµ·ç‚¹å’Œç»ˆç‚¹ï¼‰ç•™å®¿è¿‡çš„åŸå¸‚çš„è¯„çº§æ€»å’Œæˆ–æœ€å¤§å€¼ã€‚<br>åœ¨ S å›½çš„å†å²ä¸Šå¸¸ä¼šå‘ç”Ÿä»¥ä¸‹å‡ ç§äº‹ä»¶ï¼š</p><p>1ã€CC x cï¼šåŸå¸‚ x çš„å±…æ°‘å…¨ä½“æ”¹ä¿¡äº† c æ•™ï¼›</p><p>2ã€CW x wï¼šåŸå¸‚ x çš„è¯„çº§è°ƒæ•´ä¸º wï¼›</p><p>3ã€QS x yï¼šä¸€ä½æ—…è¡Œè€…ä»åŸå¸‚ x å‡ºå‘ï¼Œåˆ°åŸå¸‚ yï¼Œå¹¶è®°ä¸‹äº†é€”ä¸­ç•™å®¿è¿‡çš„åŸå¸‚çš„è¯„çº§æ€»å’Œï¼›</p><p>4ã€QM x yï¼šä¸€ä½æ—…è¡Œè€…ä»åŸå¸‚ x å‡ºå‘ï¼Œåˆ°åŸå¸‚ yï¼Œå¹¶è®°ä¸‹äº†é€”ä¸­ç•™å®¿è¿‡çš„åŸå¸‚çš„è¯„çº§æœ€å¤§å€¼ã€‚<br>ç”±äºå¹´ä»£ä¹…è¿œï¼Œæ—…è¡Œè€…è®°ä¸‹çš„æ•°å­—å·²ç»é—å¤±äº†ï¼Œä½†è®°å½•å¼€å§‹ä¹‹å‰æ¯åº§åŸå¸‚çš„ä¿¡ä»°ä¸è¯„çº§ï¼Œè¿˜æœ‰äº‹ä»¶è®°å½•æœ¬èº«æ˜¯å®Œå¥½çš„ã€‚è¯·æ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œè¿˜åŸæ—…è¡Œè€…è®°ä¸‹çš„æ•°å­—ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬è®¤ä¸ºäº‹ä»¶ä¹‹é—´çš„é—´éš”è¶³å¤Ÿé•¿ï¼Œä»¥è‡´åœ¨ä»»æ„ä¸€æ¬¡æ—…è¡Œä¸­ï¼Œæ‰€æœ‰åŸå¸‚çš„è¯„çº§å’Œä¿¡ä»°ä¿æŒä¸å˜ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>å¦‚æœæ²¡æœ‰ä¿¡ä»°ï¼Œé‚£å°±æ˜¯ç®€å•çš„æ ‘é“¾å‰–åˆ†æ¨¡æ¿é¢˜ï¼Œä½†è¿™é¢˜å¤šäº†ä¸ªä¿¡ä»°ï¼Œæ­£å¸¸æ€è·¯æ˜¯å¼€æ•°ç»„å­˜æ”¾å¯¹åº”ä¿¡ä»°çš„è¯„çº§ï¼Œä½†æ˜¯æ˜¾ç„¶ä¸ç°å®ï¼Œä»ç©ºé—´è§’åº¦æ¥çœ‹ã€‚<br>è¿™é¢˜ç”¨åˆ°äº†åŠ¨æ€å¼€ç‚¹ï¼Œå’Œå¯æŒä¹…åŒ–çº¿æ®µæ ‘ç±»ä¼¼ï¼Œåªéœ€è¦ç¨å¾®æ”¹ä¸€ä¸‹çº¿æ®µæ ‘æ¨¡æ¿å³å¯ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],edge[M],nex[M],tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    ver[++tot] = y,edge[tot] = z;</span><br><span class="line">    nex[tot] = head[x], head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> deep[N],par[N],size[N],top[N],seg[N],rev[N],son[N];</span><br><span class="line"><span class="keyword">int</span> vis[N],a[N],c[N];<span class="comment">//a:åˆå§‹è¯„çº§ c:åˆå§‹ä¿¡ä»°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    deep[x] = deep[fa]+<span class="number">1</span>;par[x] = fa;</span><br><span class="line">    size[x] = <span class="number">1</span>;vis[x] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(vis[y] || y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(y,x);</span><br><span class="line">        size[x] += size[y];</span><br><span class="line">        <span class="keyword">if</span>(size[y] &gt; size[son[x]]) son[x] = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(son[x])&#123;</span><br><span class="line">        seg[son[x]] = ++seg[<span class="number">0</span>];</span><br><span class="line">        rev[seg[<span class="number">0</span>]] = son[x];</span><br><span class="line">        top[son[x]] = top[x];</span><br><span class="line">        dfs2(son[x],x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i],z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(top[y]) <span class="keyword">continue</span>;</span><br><span class="line">        seg[y] = ++seg[<span class="number">0</span>]; rev[seg[<span class="number">0</span>]] = y;</span><br><span class="line">        top[y] = y; dfs2(y,x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ls,rs;</span><br><span class="line">    ll mx,sum;</span><br><span class="line">    SegmentTree()&#123;</span><br><span class="line">        ls = rs = mx = sum = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> ls(x) t[x].ls</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rs(x) t[x].rs</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> mx(x) t[x].mx</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> sum(x) t[x].sum</span></span><br><span class="line">&#125;t[N*<span class="number">20</span>];</span><br><span class="line"><span class="keyword">int</span> root[N],sz = <span class="number">1</span>;<span class="comment">//æœ€å¤šæœ‰å¤šå°‘ä¸ªæ ¹èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preHandle</span><span class="params">()</span></span>&#123;</span><br><span class="line">    dfs1(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    seg[<span class="number">0</span>] = seg[<span class="number">1</span>] = rev[<span class="number">1</span>] = top[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    dfs2(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> &amp;rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> pos,ll val)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!rt) rt = ++sz;</span><br><span class="line">    mx(rt) = max(mx(rt),val); sum(rt) += val;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span>; <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(pos &lt;= mid) Add(ls(rt),l,mid,pos,val);</span><br><span class="line">    <span class="keyword">else</span> Add(rs(rt),mid+<span class="number">1</span>,r,pos,val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delete</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> pos)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        sum(rt) = mx(rt) = <span class="number">0</span>; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(pos &lt;= mid) Delete(ls(rt),l,mid,pos);</span><br><span class="line">    <span class="keyword">else</span> Delete(rs(rt),mid+<span class="number">1</span>,r,pos);</span><br><span class="line">    sum(rt) = sum(ls(rt)) + sum(rs(rt));</span><br><span class="line">    mx(rt) = max(mx(ls(rt)),mx(rs(rt)));</span><br><span class="line">&#125;</span><br><span class="line">ll mx,sum;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">  <span class="comment">//  printf("%d %d %d %d %d\n",rt,L,R,l,r);</span></span><br><span class="line">    <span class="keyword">if</span>(!rt) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= L &amp;&amp; R &lt;= r)&#123;</span><br><span class="line">      <span class="comment">//  printf("%d %d\n",mx(rt),sum(rt));</span></span><br><span class="line">        mx = max(mx,mx(rt)); sum += sum(rt); <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = L+R&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) query(ls(rt),L,mid,l,r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) query(rs(rt),mid+<span class="number">1</span>,R,l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*è¿”å›xåˆ°yè·¯å¾„ä¸Šä¿¡ä»°rtçš„è¯„çº§æœ€å¤§å€¼ä»¥åŠæ€»å’Œ*/</span></span><br><span class="line">    <span class="keyword">int</span> fx = top[x],fy = top[y];</span><br><span class="line">    <span class="keyword">while</span>(fx != fy)&#123;</span><br><span class="line">        <span class="keyword">if</span>(deep[fx] &lt; deep[fy]) swap(x,y),swap(fx,fy);</span><br><span class="line">        query(rt,<span class="number">1</span>,seg[<span class="number">0</span>],seg[fx],seg[x]);</span><br><span class="line">        x = par[fx]; fx = top[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(deep[x] &gt; deep[y]) swap(x,y);</span><br><span class="line">    query(rt,<span class="number">1</span>,seg[<span class="number">0</span>],seg[x],seg[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,a+i,c+i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt; n;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">        addEdge(x,y,<span class="number">1</span>); addEdge(y,x,<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    preHandle();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">        Add(root[c[i]],<span class="number">1</span>,seg[<span class="number">0</span>],seg[i],a[i]);</span><br><span class="line">    <span class="keyword">char</span> op[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s%d%d"</span>,op,&amp;x,&amp;y);</span><br><span class="line">        <span class="keyword">if</span>(op[<span class="number">1</span>] == <span class="string">'C'</span>)&#123;</span><br><span class="line">            Delete(root[c[x]],<span class="number">1</span>,seg[<span class="number">0</span>],seg[x]);</span><br><span class="line">            Add(root[c[x] = y],<span class="number">1</span>,seg[<span class="number">0</span>],seg[x],a[x]);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">1</span>] == <span class="string">'W'</span>)&#123;</span><br><span class="line">            Delete(root[c[x]],<span class="number">1</span>,seg[<span class="number">0</span>],seg[x]);</span><br><span class="line">            Add(root[c[x]],<span class="number">1</span>,seg[<span class="number">0</span>],seg[x],a[x] = y);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            mx = sum = <span class="number">0</span>;<span class="comment">//ä¸€èµ·æ›´æ–°ï¼Œå°‘å†™ä»£ç ï¼Œç¾æ»‹æ»‹</span></span><br><span class="line">            ask(root[c[x]],x,y);</span><br><span class="line">            <span class="keyword">if</span>(op[<span class="number">1</span>] == <span class="string">'S'</span>) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,sum);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,mx);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘é“¾å‰–åˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‘é“¾å‰–åˆ†ç¬”è®°</title>
      <link href="/2019/10/10/lct/"/>
      <url>/2019/10/10/lct/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>æ ‘é“¾å‰–åˆ†æ˜¯ç”¨æ¥ç»´æŠ¤é™æ€æ ‘ä¸Šè·¯å¾„ä¿¡æ¯çš„æ•°æ®ç»“æ„ï¼Œé™æ€å³æ ‘çš„å½¢æ€ä¸èƒ½æ”¹å˜ï¼ˆå¢åˆ ç‚¹æˆ–è€…æ¢æ ¹ï¼Œæ”¹å˜äº†æ„é€ ï¼‰ã€‚<br>å…¶æ€æƒ³æ˜¯å°†æ ‘ä¸Šçš„è·¯å¾„åˆ†ä¸ºé‡è·¯å¾„å’Œè½»è¾¹ï¼Œç„¶åä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ†é…ä¸€ä¸ªç¼–å·ï¼Œé‡è·¯å¾„ä¸ŠèŠ‚ç‚¹çš„ç¼–å·æ˜¯è¿ç»­çš„ï¼›æ¥ç€å¯¹è¿™äº›ç¼–å·å»ºç«‹ä¸€æ£µçº¿æ®µæ ‘ï¼Œè¿™æ ·å°±å¯ä»¥å°†é‡è·¯å¾„å½“ä½œåŒºé—´æ¥ç»´æŠ¤äº†ï¼›åˆ©ç”¨äº†â€œæ¯ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„ä¸Šéƒ½æœ‰ä¸è¶…è¿‡O(logN)æ¡è½»è¾¹å’ŒO(logN)æ¡é‡è·¯å¾„â€ç»“è®ºæ¥ä¿è¯æ—¶é—´å¤æ‚åº¦ã€‚</p><h4 id="ç®—æ³•ç®€ä»‹"><a href="#ç®—æ³•ç®€ä»‹" class="headerlink" title="ç®—æ³•ç®€ä»‹"></a>ç®—æ³•ç®€ä»‹</h4><p>æ ‘é“¾å‰–åˆ†é€šå¸¸ç”¨äºè§£å†³ä¸€ç±»ç»´æŠ¤é™æ€æ ‘ä¸Šè·¯å¾„ä¿¡æ¯çš„é—®é¢˜ï¼Œä¾‹å¦‚ï¼Œç»™å®šä¸€æ£µç‚¹å¸¦æƒçš„æ ‘ï¼Œæ¥ä¸‹æ¥æ¯æ¬¡æ“ä½œä¼šä¿®æ”¹æŸæ¡è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹çš„æƒå€¼ï¼ˆä¿®æ”¹ä¸ºåŒä¸€ä¸ªå€¼æˆ–æ˜¯åŠ ä¸ŠåŒä¸€ä¸ªå€¼ç­‰ï¼‰ï¼Œä»¥åŠè¯¢é—®æŸæ¡è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹çš„æƒå€¼å’Œã€‚</p><p>å½“è¿™æ£µæ ‘æ˜¯ä¸€æ¡é“¾æ—¶ï¼Œè¿™ä¸ªé—®é¢˜å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªåºåˆ—ä¸ŠåŒºé—´ä¿®æ”¹ã€åŒºé—´è¯¢é—®çš„é—®é¢˜ï¼Œå¯ä»¥ç”¨çº¿æ®µæ ‘ç­‰æ•°æ®ç»“æ„è§£å†³ã€‚</p><p>å¯¹äºå…¶ä»–æƒ…å†µï¼Œç”±äºæ ‘çš„å½¢æ€æ˜¯ä¸å˜çš„ï¼Œå› æ­¤æ ‘é“¾å‰–åˆ†çš„ç­–ç•¥æ˜¯å°†è¿™äº›ç‚¹æŒ‰æŸç§æ–¹å¼ç»„ç»‡èµ·æ¥ï¼Œå‰–åˆ†æˆè‹¥å¹²æ¡é“¾ï¼Œæ¯æ¡é“¾å°±ç›¸å½“äºä¸€ä¸ªåºåˆ—ã€‚è¿™æ ·ï¼Œæ“ä½œçš„è·¯å¾„å¯ä»¥æ‹†åˆ†ä¸ºæŸå‡ æ¡é“¾ï¼Œä¹Ÿå°±æ˜¯è‹¥å¹²ä¸ªå®Œæ•´åºåˆ—æˆ–æ˜¯æŸä¸ªåºåˆ—ä¸Šçš„ä¸€æ®µåŒºé—´ï¼Œæ­¤æ—¶å¯åˆ©ç”¨çº¿æ®µæ ‘ç­‰å¤„ç†åºåˆ—ä¸ŠåŒºé—´æ“ä½œçš„æ•°æ®ç»“æ„è§£å†³é—®é¢˜ã€‚</p><p>æ ‘é“¾å‰–åˆ†çš„æ ¸å¿ƒæ˜¯å¦‚ä½•æ°å½“çš„å°†æ ‘å‰–åˆ†ä¸ºè‹¥å¹²æ¡é“¾ã€‚å½“é“¾çš„åˆ’åˆ†æ–¹å¼ç¡®å®šåï¼Œæˆ‘ä»¬åªè¦å°†å®ƒä»¬çœ‹ä½œæ˜¯ä¸€ä¸ªä¸ªåºåˆ—ï¼Œå°†æ‰€æœ‰åºåˆ—æŒ‰é¡ºåºæ‹¼æ¥èµ·æ¥ï¼Œæ¯æ¡é“¾å°±æˆäº†ä¸€æ®µåŒºé—´ï¼Œè€Œåºåˆ—ä¸Šçš„åŒºé—´é—®é¢˜æ˜¯æˆ‘ä»¬æ‰€ç†Ÿæ‚‰å’Œæ“…é•¿çš„ã€‚</p><h4 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h4><h5 id="åˆ’åˆ†è½»é‡è¾¹"><a href="#åˆ’åˆ†è½»é‡è¾¹" class="headerlink" title="åˆ’åˆ†è½»é‡è¾¹"></a>åˆ’åˆ†è½»é‡è¾¹</h5><p>ä¸‹é¢ä»¥ç‚¹å¸¦æƒçš„æ ‘ä¸ºä¾‹ï¼Œç»“åˆè·¯å¾„æƒå€¼ä¿®æ”¹ã€è·¯å¾„è¯¢é—®æƒå€¼å’Œé—®é¢˜ï¼Œä»‹ç»å¸¸ç”¨çš„å‰–åˆ†æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯è½»ã€é‡è¾¹å‰–åˆ†ã€‚<br>æˆ‘ä»¬å°†æ ‘ä¸­çš„è¾¹åˆ†ä¸ºä¸¤ç§ï¼šè½»è¾¹ å’Œ é‡è¾¹ã€‚å¦‚å›¾1æ‰€ç¤ºï¼Œå›¾ä¸­çº¢è‰²çš„è¾¹æ˜¯é‡è¾¹ï¼Œå…¶ä½™çš„æ˜¯è½»è¾¹ã€‚<br><img src="/2019/10/10/lct/1.png" alt="1"><br>å›¾1ï¼šèŠ‚ç‚¹æ•°å­—ä»£è¡¨å­æ ‘å¤§å°ï¼ˆsizeï¼‰<br>æˆ‘ä»¬å¯ä»¥ä»¥ä»»æ„ç‚¹ä¸ºæ ¹ï¼Œç„¶åè®°size( u )ä¸ºä»¥uä¸ºæ ¹çš„å­æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œä»¤ v ä¸º u æ‰€æœ‰å„¿å­ä¸­ size å€¼æœ€å¤§çš„ä¸€ä¸ªï¼Œåˆ™(u,v)æ˜¯é‡è¾¹ï¼Œv ç§°ä¸º u çš„é‡å„¿å­ã€‚u åˆ°å…¶ä½™å„¿å­çš„è¾¹ä¸ºè½»è¾¹ã€‚</p><h5 id="è½»é‡è¾¹çš„æ€§è´¨"><a href="#è½»é‡è¾¹çš„æ€§è´¨" class="headerlink" title="è½»é‡è¾¹çš„æ€§è´¨"></a>è½»é‡è¾¹çš„æ€§è´¨</h5><p>è½»é‡è¾¹æœ‰å¦‚ä¸‹å‡ ä¸ªæ€§è´¨ï¼š</p><ol><li>å¦‚æœ(u , v)ä¸ºè½»è¾¹ï¼Œåˆ™ size( v ) &lt;= size( u ) / 2ã€‚</li><li>ä»æ ¹åˆ°æŸä¸€ç‚¹vçš„è·¯å¾„ä¸Šçš„è½»è¾¹ä¸ªæ•°ä¸å¤šäºO(logN)ã€‚</li><li>æˆ‘ä»¬ç§°æŸæ¡è·¯å¾„ä¸ºé‡è·¯å¾„ï¼ˆé“¾ï¼‰ï¼Œå½“ä¸”ä»…å½“å®ƒå…¨éƒ¨ç”±é‡è¾¹ç»„æˆï¼ˆç‰¹æ®Šåœ°ï¼Œä¸€ä¸ªç‚¹ä¹Ÿç®—ä¸€æ¡é‡è·¯å¾„ï¼‰ã€‚é‚£ä¹ˆå¯¹äºæ¯ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„ä¸Šéƒ½æœ‰ä¸è¶…è¿‡O(logN)æ¡è½»è¾¹å’ŒO(logN)æ¡é‡è·¯å¾„ã€‚</li></ol><p>åŒæ—¶æˆ‘ä»¬ä¹Ÿå®¹æ˜“å‘ç°ï¼Œä¸€ä¸ªç‚¹åœ¨ä¸”åªåœ¨ä¸€æ¡é‡è·¯å¾„ä¸Šï¼Œè€Œæ¯æ¡é‡è·¯å¾„ä¸€å®šæ˜¯ä¸€æ¡ä»æ ¹èŠ‚ç‚¹æ–¹å‘å‘å¶èŠ‚ç‚¹æ–¹å‘å»¶ç”³çš„æ·±åº¦é€’å¢çš„è·¯å¾„ï¼ˆå› ä¸ºä¸€ä¸ªéå¶èŠ‚ç‚¹æœ‰ä¸”åªæœ‰ä¸€ä¸ªé‡å„¿å­ï¼‰ã€‚</p><h5 id="å¦‚ä½•å¤„ç†æ ‘ä¸Šçš„è·¯å¾„"><a href="#å¦‚ä½•å¤„ç†æ ‘ä¸Šçš„è·¯å¾„" class="headerlink" title="å¦‚ä½•å¤„ç†æ ‘ä¸Šçš„è·¯å¾„"></a>å¦‚ä½•å¤„ç†æ ‘ä¸Šçš„è·¯å¾„</h5><p>å¯¹æ ‘è¿›è¡Œè½»ã€é‡è¾¹å‰–åˆ†åï¼Œæ“ä½œæ‰€è¦å¤„ç†çš„è·¯å¾„ï¼ˆu , vï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«å¤„ç†uï¼Œvä¸¤ä¸ªç‚¹åˆ°å…¶æœ€è¿‘å…¬å…±ç¥–å…ˆçš„è·¯å¾„ã€‚æ ¹æ®æ€§è´¨3ï¼Œè·¯å¾„å¯ä»¥åˆ†è§£ä¸ºæœ€å¤šO(logN)æ¡çš„é‡è·¯å¾„å’Œæœ€å¤šO(logN)çš„è½»è¾¹ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬<strong>åªè€ƒè™‘å¦‚ä½•ç»´æŠ¤è¿™ä¸¤ç§å¯¹è±¡ã€‚</strong></p><p>å¯¹äºé‡è·¯å¾„ï¼Œå®ƒä»¬æ­¤æ—¶ç›¸å½“äºä¸€ä¸ªåºåˆ—ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦ç”¨çº¿æ®µæ ‘ç»´æŠ¤ã€‚è€Œå¯¹äºè½»è¾¹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è·³è¿‡ï¼Œè®¿é—®ä¸‹ä¸€æ¡é‡è·¯å¾„ï¼Œå› ä¸ºè½»è¾¹çš„ä¸¤ç«¯ç‚¹ä¸€å®šåœ¨æŸä¸¤æ¡é‡è·¯å¾„ä¸Šã€‚è¿™ä¸¤ç§æ“ä½œçš„æ—¶é—´å¤æ‚åº¦åˆ†åˆ«ä¸º$O(log^2N)$å’ŒO(logN)ï¼Œå› æ­¤æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(log^2N)$ã€‚</p><h5 id="å‰–åˆ†æ–¹æ³•"><a href="#å‰–åˆ†æ–¹æ³•" class="headerlink" title="å‰–åˆ†æ–¹æ³•"></a>å‰–åˆ†æ–¹æ³•</h5><p>è½»ã€é‡è¾¹å‰–åˆ†çš„è¿‡ç¨‹å¯ä»¥ç”¨ä¸¤æ¬¡dfså®ç°ï¼Œæœ‰æ—¶ä¸ºäº†é˜²æ­¢é€’å½’è¿‡æ·±è€Œå¯¼è‡´æ ˆæº¢å‡ºï¼Œä¹Ÿå¯ä»¥ç”¨bfså®ç°ã€‚<br><strong>å‰–åˆ†è¿‡ç¨‹ä¸­ä¸»è¦è®¡ç®—å¦‚ä¸‹7ä¸ªå€¼ï¼š</strong><br>par[x] : xåœ¨æ ‘ä¸­çš„çˆ¶äº²ã€‚<br>deep[x]ï¼šxåœ¨æ ‘ä¸­çš„æ·±åº¦ã€‚<br>size[x]ï¼šxçš„å­æ ‘èŠ‚ç‚¹æ•°ï¼ˆå­æ ‘å¤§å°ï¼‰ã€‚<br>son[x]ï¼šxçš„é‡å„¿å­ï¼Œå³u-&gt;son[u]ä¸ºé‡è¾¹ã€‚<br>top[x]ï¼šxæ‰€åœ¨é‡è·¯å¾„çš„é¡¶éƒ¨èŠ‚ç‚¹ï¼ˆæ·±åº¦æœ€å°ï¼‰ã€‚<br>seg[x]ï¼šxæ‰€åœ¨çº¿æ®µæ ‘ä¸­çš„ä½ç½®ï¼ˆä¸‹æ ‡ï¼‰ã€‚<br>rev[x]ï¼šçº¿æ®µæ ‘ä¸­ç¬¬xä¸ªä½ç½®å¯¹åº”çš„æ ‘ä¸­èŠ‚ç‚¹ç¼–å·ï¼Œå³rev[seg[x] ] = xã€‚</p><p>ç¬¬ä¸€é dfs æ—¶å¯ä»¥è®¡ç®—å‰ 4 ä¸ªå€¼ï¼Œç¬¬äºŒé dfs å¯ä»¥è®¡ç®—å 3 ä¸ªå€¼ã€‚è€Œè®¡ç®— seg æ—¶ï¼ŒåŒä¸€æ¡é‡è·¯å¾„ä¸Šçš„ç‚¹éœ€è¦æŒ‰é¡ºåºæ’åœ¨è¿ç»­çš„ä¸€æ®µä½ç½®ï¼Œä¹Ÿå°±æ˜¯ä¸€æ®µåŒºé—´ã€‚</p><p>å°†ä¸€æ¡è·¯å¾„(u ,v)æ‹†åˆ†ä¸ºè‹¥å¹²æ¡é‡è·¯å¾„çš„è¿‡ç¨‹ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå¯»æ‰¾æœ€è¿‘å…¬å…±ç¥–å…ˆçš„è¿‡ç¨‹ã€‚è€ƒè™‘â€œæš´åŠ›â€çš„åšæ³•ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©uï¼Œvä¸­æ·±åº¦è¾ƒå¤§çš„ç‚¹å‘ä¸Šèµ°ä¸€æ­¥ï¼Œç›´åˆ°u = vã€‚ç°åœ¨æœ‰äº†é‡è·¯å¾„ï¼Œç”±äºæˆ‘ä»¬è®°å½•äº†é‡è·¯å¾„çš„é¡¶éƒ¨èŠ‚ç‚¹top[x]ï¼Œè¿˜è®°å½•äº†æ¯ä¸ªç‚¹åœ¨åºåˆ—ä¸­çš„ä½ç½®ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦ä¸€æ­¥æ­¥èµ°ã€‚å‡å®štop[u]å’Œtop[v]ä¸åŒï¼Œé‚£ä¹ˆå®ƒä»¬çš„æœ€è¿‘å…¬å…±ç¥–å…ˆå¯èƒ½åœ¨å…¶ä¸­ä¸€æ¡é‡è·¯å¾„ä¸Šï¼Œä¹Ÿå¯èƒ½åœ¨å…¶ä»–çš„é‡è·¯å¾„ä¸Šï¼Œå› ä¸ºLCAæ˜¾ç„¶ä¸å¯èƒ½åœ¨topæ·±åº¦è¾ƒå¤§çš„é‚£æ¡é‡è·¯å¾„ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆå¤„ç†topæ·±åº¦è¾ƒå¤§çš„ã€‚å‡è®¾uæ˜¯æ·±åº¦è¾ƒå¤§çš„ï¼Œåˆ™å¯ä»¥ç›´æ¥æ¡åˆ°par[top[u]]å¤„ï¼Œä¸”è·³è¿‡çš„è¿™ä¸€æ®µï¼Œåœ¨çº¿æ®µæ ‘ä¸­æ˜¯ä¸€æ®µåŒºé—´ï¼Œè‹¥æˆ‘ä»¬æŒ‰ç…§æ·±åº¦ä»å°åˆ°å¤§æ¥å­˜å‚¨ç‚¹ï¼Œåˆ™è¿™æ®µåŒºé—´ä¸ºï¼š[seg[top[x]] , seg[x]]ã€‚å½“uï¼Œvçš„topç›¸åŒæ—¶ï¼Œè¯´æ˜å®ƒä»¬èµ°åˆ°äº†åŒä¸€æ¡é‡è·¯å¾„ä¸Šï¼Œè¿™æ—¶å®ƒä»¬ä¹‹é—´çš„è·¯å¾„ä¹Ÿæ˜¯åºåˆ—ä¸Šçš„ä¸€æ®µåŒºé—´ï¼Œä¸”uï¼Œvä¸­æ·±åº¦è¾ƒå°çš„é‚£ç‚¹æ˜¯åŸè·¯å¾„çš„LCAã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†ç»™å‡ºçš„ä»»æ„è·¯å¾„æ‹†åˆ†æˆè‹¥å¹²æ¡é‡è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è‹¥å¹²ä¸ªåŒºé—´ï¼Œå¹¶ç”¨çº¿æ®µæ ‘ç­‰æ•°æ®ç»“æ„å¤„ç†æ“ä½œã€‚</p><h4 id="ä¾‹é¢˜æ¨¡æ¿"><a href="#ä¾‹é¢˜æ¨¡æ¿" class="headerlink" title="ä¾‹é¢˜æ¨¡æ¿"></a>ä¾‹é¢˜æ¨¡æ¿</h4><p>åŸé¢˜æ¥è‡ªï¼šZJOI 2008</p><p>ä¸€æ ‘ä¸Šæœ‰ n ä¸ªèŠ‚ç‚¹ï¼Œç¼–å·åˆ†åˆ«ä¸º 1 åˆ° nï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼ wã€‚æˆ‘ä»¬å°†ä»¥ä¸‹é¢çš„å½¢å¼æ¥è¦æ±‚ä½ å¯¹è¿™æ£µæ ‘å®Œæˆä¸€äº›æ“ä½œï¼š<br>1.CHANGE u t ï¼šæŠŠèŠ‚ç‚¹ u æƒå€¼æ”¹ä¸º tï¼›<br>2.QMAX u v ï¼šè¯¢é—®ç‚¹ u åˆ°ç‚¹ v è·¯å¾„ä¸Šçš„èŠ‚ç‚¹çš„æœ€å¤§æƒå€¼ï¼›<br>3.QSUM u v ï¼šè¯¢é—®ç‚¹ u åˆ°ç‚¹ v è·¯å¾„ä¸Šçš„èŠ‚ç‚¹çš„æƒå€¼å’Œã€‚<br>æ³¨æ„ï¼šä»ç‚¹ u åˆ°ç‚¹ v è·¯å¾„ä¸Šçš„èŠ‚ç‚¹åŒ…æ‹¬ u å’Œ v æœ¬èº«ã€‚</p><p>æ¨¡æ¿ä½¿ç”¨è¯´æ˜ï¼š</p><ul><li>å°†æ ‘æ‹†åˆ†æˆè‹¥å¹²æ¡é“¾ï¼Œä¸ºæ ‘ä¸Šæ¯ä¸ªç‚¹åˆ†é…ä¸€ä¸ªç¼–å·ï¼ŒåŒä¸€æ¡é“¾ä¸Šçš„ç¼–å·è¿ç»­ï¼Œç„¶ååœ¨è¿™äº›ç¼–å·ä¸Šå»ºç«‹çº¿æ®µæ ‘ç»´æŠ¤ã€‚seg[x]æ˜¯æ ‘ä¸Šçš„èŠ‚ç‚¹xåœ¨çº¿æ®µæ ‘çš„ä¸‹æ ‡ï¼Œrev[y]æ˜¯çº¿æ®µæ ‘ä¸‹æ ‡ä¸º y èŠ‚ç‚¹åœ¨æ ‘ä¸­çš„ç¼–å·ã€‚</li><li>æ ‘çš„èŠ‚ç‚¹ç¼–å·è¦ä»1å¼€å§‹ï¼Œä¸èƒ½ä»0ã€‚</li><li>å­æ ‘åœ¨çº¿æ®µæ ‘ä¸­çš„ä¸‹æ ‡æ˜¯è¿ç»­çš„ï¼Œä»¥ x ä¸ºæ ¹çš„å­æ ‘èµ·ç‚¹ä¸‹æ ‡æ˜¯seg[x]ï¼Œç»ˆç‚¹æ˜¯seg[x]+size[x]-1ã€‚</li></ul><p><strong>ä»£ç æ¨¡æ¿</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span>Â <span class="keyword">namespace</span>Â <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span>Â <span class="keyword">long</span>Â <span class="keyword">long</span>Â ll;</span><br><span class="line"><span class="keyword">const</span>Â llÂ INFÂ =Â <span class="number">1e18</span>;</span><br><span class="line"><span class="keyword">const</span>Â <span class="keyword">int</span>Â NÂ =Â <span class="number">3e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span>Â <span class="keyword">int</span>Â MÂ =Â <span class="number">2</span>*N;</span><br><span class="line"><span class="keyword">int</span>Â head[N],ver[M],edge[M],nex[M],totÂ =Â <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span>Â x,<span class="keyword">int</span>Â y,<span class="keyword">int</span>Â z)</span></span>&#123;</span><br><span class="line">Â Â Â Â ver[++tot]Â =Â y,Â edge[tot]Â =Â z;</span><br><span class="line">Â Â Â Â nex[tot]Â =Â head[x],Â head[x]Â =Â tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span>Â n,q,a[N];</span><br><span class="line"><span class="comment">/*çˆ¶äº²,æ·±åº¦,å­æ ‘å¤§å°,é‡å„¿å­,é‡è·¯å¾„é¡¶éƒ¨èŠ‚ç‚¹,</span></span><br><span class="line"><span class="comment">Â Â Â Â æ ‘ä¸­èŠ‚ç‚¹åœ¨çº¿æ®µæ ‘ä¸­ä¸‹æ ‡,çº¿æ®µæ ‘ä¸­èŠ‚ç‚¹å¯¹åº”æ ‘ä¸­ä½ç½®*/</span></span><br><span class="line"><span class="keyword">int</span>Â par[N],deep[N],size[N],son[N],top[N],seg[N],rev[N];</span><br><span class="line"><span class="keyword">int</span>Â vis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span>Â x,<span class="keyword">int</span>Â fa)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">/*åˆ©ç”¨æ·±æœæ›´æ–°par,size,deep,sonæ•°ç»„*/</span></span><br><span class="line">Â Â Â Â vis[x]Â =Â <span class="literal">true</span>;Â size[x]Â =Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â par[x]Â =Â fa;Â deep[x]Â =Â deep[fa]+<span class="number">1</span>;</span><br><span class="line">Â Â Â Â <span class="keyword">for</span>(<span class="keyword">int</span>Â iÂ =Â head[x];iÂ ;iÂ =Â nex[i])&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">int</span>Â yÂ =Â ver[i],Â zÂ =Â edge[i];</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(yÂ ==Â faÂ ||Â vis[y])Â <span class="keyword">continue</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â dfs1(y,x);</span><br><span class="line">Â Â Â Â Â Â Â Â size[x]Â +=Â size[y];Â <span class="comment">//ç´¯åŠ å­æ ‘å¤§å°</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(size[y]Â &gt;Â size[son[x]])Â son[x]Â =Â y;<span class="comment">//æ±‚é‡å„¿å­</span></span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span>Â x,<span class="keyword">int</span>Â fa)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(son[x])&#123;Â <span class="comment">//å…ˆèµ°é‡å„¿å­,ä½¿å¾—é‡è·¯å¾„åœ¨çº¿æ®µæ ‘ä¸­è¿ç»­</span></span><br><span class="line">Â Â Â Â Â Â Â Â seg[son[x]]Â =Â ++seg[<span class="number">0</span>];<span class="comment">//0ä½ç½®ç”¨ä¸åˆ°,åˆ©ç”¨æ¥è®¡æ•°</span></span><br><span class="line">Â Â Â Â Â Â Â Â top[son[x]]Â =Â top[x];</span><br><span class="line">Â Â Â Â Â Â Â Â rev[seg[<span class="number">0</span>]]Â =Â son[x];</span><br><span class="line">Â Â Â Â Â Â Â Â dfs2(son[x],x);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">for</span>(<span class="keyword">int</span>Â iÂ =Â head[x];i;iÂ =Â nex[i])&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">int</span>Â yÂ =Â ver[i],Â zÂ =Â edge[i];</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(top[y])Â <span class="keyword">continue</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">/*è‹¥yæ²¡æœ‰è¢«éå†è¿‡,å³yä¸æ˜¯xçš„é‡å„¿å­æˆ–è€…çˆ¶äº²*/</span></span><br><span class="line">Â Â Â Â Â Â Â Â seg[y]Â =Â ++seg[<span class="number">0</span>];Â rev[seg[<span class="number">0</span>]]Â =Â y;</span><br><span class="line">Â Â Â Â Â Â Â Â top[y]Â =Â y;Â dfs2(y,x);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">/*å¦‚æœx--&gt;yæ˜¯è½»è¾¹,é‚£ä¹ˆyå°±æ˜¯å…¶æ‰€åœ¨é‡è·¯å¾„é¡¶éƒ¨èŠ‚ç‚¹*/</span></span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span>Â <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â l,r;</span><br><span class="line">Â Â Â Â llÂ mx,Â sum;</span><br><span class="line">Â Â Â Â <span class="meta">#<span class="meta-keyword">define</span>Â l(x)Â t[x].l</span></span><br><span class="line">Â Â Â Â <span class="meta">#<span class="meta-keyword">define</span>Â r(x)Â t[x].r</span></span><br><span class="line">Â Â Â Â <span class="meta">#<span class="meta-keyword">define</span>Â mx(x)Â t[x].mx</span></span><br><span class="line">Â Â Â Â <span class="meta">#<span class="meta-keyword">define</span>Â sum(x)Â t[x].sum</span></span><br><span class="line">&#125;t[N*<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span>Â rt,<span class="keyword">int</span>Â l,<span class="keyword">int</span>Â r)</span></span>&#123;</span><br><span class="line">Â Â Â Â l(rt)Â =Â l,Â r(rt)Â =Â r;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(lÂ ==Â r)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â mx(rt)Â =Â sum(rt)Â =Â a[rev[l]];Â <span class="comment">//çº¿æ®µæ ‘ä¸ŠlèŠ‚ç‚¹å¯¹åº”ç€æ ‘ä¸Šrev[l]ç‚¹</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â midÂ =Â l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">Â Â Â Â BuildTree(rt*<span class="number">2</span>,l,mid);Â BuildTree(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">Â Â Â Â mx(rt)Â =Â max(mx(rt&lt;&lt;<span class="number">1</span>),mx(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>));</span><br><span class="line">Â Â Â Â sum(rt)Â =Â sum(rt&lt;&lt;<span class="number">1</span>)Â +Â sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">preHandle</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â dfs1(<span class="number">1</span>,<span class="number">0</span>);Â <span class="comment">//æˆ‘ä»¬ä»¥1å·èŠ‚ç‚¹ä¸ºæ ¹</span></span><br><span class="line">Â Â Â Â <span class="comment">/*æ ¹èŠ‚ç‚¹æ‰€åœ¨é‡è·¯å¾„çš„é¡¶éƒ¨èŠ‚ç‚¹ä¹Ÿæ˜¯æ ¹èŠ‚ç‚¹,èµ‹åˆå€¼*/</span></span><br><span class="line">Â Â Â Â seg[<span class="number">0</span>]Â =Â seg[<span class="number">1</span>]Â =Â top[<span class="number">1</span>]Â =Â rev[<span class="number">1</span>]Â =Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â dfs2(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">Â Â Â Â BuildTree(<span class="number">1</span>,<span class="number">1</span>,seg[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line">llÂ tmx,tsum;<span class="comment">//åˆ©ç”¨å…¨å±€å˜é‡åŒæ—¶ç»Ÿè®¡2ä¸ªç­”æ¡ˆ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">query</span><span class="params">(<span class="keyword">int</span>Â rt,<span class="keyword">int</span>Â l,<span class="keyword">int</span>Â r)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">/*å°†ä»¥rtä¸ºæ ¹çš„åŒºé—´å†…å±äº[l,r]éƒ¨åˆ†çš„å’Œç´¯åŠ åˆ°tsumä¸Š,å¹¶æ›´æ–°tmx*/</span></span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(lÂ &lt;=Â l(rt)Â &amp;&amp;Â r(rt)Â &lt;=Â r)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â tsumÂ +=Â sum(rt);Â tmxÂ =Â max(tmx,mx(rt));</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â ;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â midÂ =Â l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(lÂ &lt;=Â mid)Â query(rt&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(rÂ &gt;Â mid)Â query(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">ask</span><span class="params">(<span class="keyword">int</span>Â x,<span class="keyword">int</span>Â y)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">/*è¿”å›xä¸yä¹‹é—´è·¯å¾„ä¸Šæƒå€¼æœ€å¤§ç‚¹çš„æƒå€¼*/</span></span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â fxÂ =Â top[x]Â ,Â fyÂ =Â top[y];</span><br><span class="line">Â Â Â Â <span class="keyword">while</span>(fxÂ !=Â fy)&#123;<span class="comment">//å…ˆå°†xå’Œyæ¡æ•´åˆ°åŒä¸€ä¸ªé‡é“¾ä¸Š</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(deep[fx]Â &lt;Â deep[fy])Â swap(x,y),swap(fx,fy);</span><br><span class="line">Â Â Â Â Â Â Â Â query(<span class="number">1</span>,seg[fx],seg[x]);</span><br><span class="line">Â Â Â Â Â Â Â Â xÂ =Â par[fx];Â fxÂ =Â top[x];</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(deep[x]Â &gt;Â deep[y])Â swap(x,y);<span class="comment">//è·¯å¾„æµ…çš„ç¼–å·å°</span></span><br><span class="line">Â Â Â Â query(<span class="number">1</span>,seg[x],seg[y]);Â <span class="comment">//å†æ›´æ–°ä¸€æ¬¡</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span>Â <span class="title">change</span><span class="params">(<span class="keyword">int</span>Â rt,<span class="keyword">int</span>Â x,<span class="keyword">int</span>Â val)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">/*æŠŠçº¿æ®µæ ‘èŠ‚ç‚¹xçš„æƒå€¼æ”¹ä¸ºval*/</span></span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(l(rt)Â ==Â r(rt))&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â mx(rt)Â =Â sum(rt)Â =Â val;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">int</span>Â midÂ =Â l(rt)Â +Â r(rt)Â &gt;&gt;Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(xÂ &gt;Â mid)Â change(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,x,val);</span><br><span class="line">Â Â Â Â <span class="keyword">else</span>Â change(rt&lt;&lt;<span class="number">1</span>,x,val);</span><br><span class="line">Â Â Â Â mx(rt)Â =Â max(mx(rt&lt;&lt;<span class="number">1</span>),mx(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>));</span><br><span class="line">Â Â Â Â sum(rt)Â =Â sum(rt&lt;&lt;<span class="number">1</span>)Â +Â sum(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="meta">#<span class="meta-keyword">ifdef</span>Â LOCAL</span></span><br><span class="line">Â Â Â Â Â Â Â Â freopen(<span class="string">"123.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â freopen(<span class="string">"222.txt"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</span><br><span class="line">Â Â Â Â <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">Â Â Â Â <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">Â Â Â Â <span class="keyword">for</span>(<span class="keyword">int</span>Â iÂ =Â <span class="number">1</span>,x,y;iÂ &lt;Â n;i++)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">Â Â Â Â Â Â Â Â addEdge(x,y,<span class="number">1</span>);Â addEdge(y,x,<span class="number">1</span>);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">for</span>(<span class="keyword">int</span>Â iÂ =Â <span class="number">1</span>;iÂ &lt;=Â n;i++)Â <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">Â Â Â Â <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;q);</span><br><span class="line">Â Â Â Â preHandle();<span class="comment">//æ ‘é“¾å‰–åˆ†é¢„å¤„ç†</span></span><br><span class="line">Â Â Â Â <span class="keyword">char</span>Â op[<span class="number">20</span>];</span><br><span class="line">Â Â Â Â <span class="keyword">for</span>(<span class="keyword">int</span>Â iÂ =Â <span class="number">1</span>,x,y;iÂ &lt;=Â q;i++)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="built_in">scanf</span>(<span class="string">"%s%d%d"</span>,op,&amp;x,&amp;y);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(op[<span class="number">0</span>]Â ==Â <span class="string">'C'</span>)Â change(<span class="number">1</span>,seg[x],y);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">else</span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â tmxÂ =Â -INF;Â tsumÂ =Â <span class="number">0</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â ask(x,y);<span class="comment">//åŒæ—¶æ›´æ–°æœ€å¤§å€¼ä¸è·¯å¾„å’Œ</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>(op[<span class="number">1</span>]Â ==Â <span class="string">'M'</span>)Â <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,tmx);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">else</span>Â <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,tsum);</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
            <tag> æ ‘é“¾å‰–åˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‘ä¸Šå€å¢LCAé¢˜é›†</title>
      <link href="/2019/10/09/lca-problems/"/>
      <url>/2019/10/09/lca-problems/</url>
      
        <content type="html"><![CDATA[<p>æ ‘ä¸Šå€å¢æ³•å¯ä»¥ç”¨äºæ±‚LCAï¼Œå½“ç„¶åœ¨å…¶å®ƒåœºåˆä¹Ÿæœ‰åº”ç”¨ï¼Œåœ¨å¾ˆå¤šæ—¶å€™çœ‹ä¼¼ä¸æ˜¯æ ‘å½¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è½¬åŒ–æˆæ ‘å½¢ç»“æ„ï¼Œç„¶ååœ¨æ ‘ä¸­è¿›è¡Œæ“ä½œï¼Œè¿™ç§æ“ä½œå¯ä»¥æ˜¯æ±‚äºŒè€…ä¹‹é—´çš„æœ€è¿‘çŠ¶æ€ï¼Œæˆ–è€…æ˜¯äºŒè€…ä¹‹é—´çš„è·ç¦»ï¼Œå¦‚æœ€åä¸€é¢˜ã€‚<br>å¦å¤–å…³äºæ ‘çš„é¢˜å‹ï¼Œæœ€å¥½è¿˜æ˜¯æ ¹æ®æ ·ä¾‹ç”»å›¾æ€è€ƒï¼Œå¾€å¾€å¯ä»¥æ¯”ç©ºæƒ³è·å¾—æ›´å¤šæ€è·¯ã€‚</p><h4 id="ç‚¹çš„è·ç¦»"><a href="#ç‚¹çš„è·ç¦»" class="headerlink" title="ç‚¹çš„è·ç¦»"></a>ç‚¹çš„è·ç¦»</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™å®šä¸€æ£µ n ä¸ªç‚¹çš„æ ‘ï¼ŒQ ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç‚¹ x åˆ°ç‚¹ y ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>æ¨¡æ¿é¢˜ï¼Œç”¨æ ‘ä¸Šå€å¢æ³•ï¼Œåˆå§‹åŒ–æ—¶é—´ä¸ºO(NlogN)ï¼ŒæŸ¥è¯¢æ—¶é—´O(logN)ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],nex[M],tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">ver[++tot] = y; nex[tot] = head[x]; head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,q;</span><br><span class="line"><span class="comment">//anc[x][i]è¡¨ç¤ºxå¾€ä¸Šèµ°2^iæ­¥çš„ç¥–å…ˆç¼–å· </span></span><br><span class="line"><span class="keyword">int</span> anc[N][<span class="number">25</span>], deep[N],dis[N];</span><br><span class="line"><span class="keyword">int</span> root = <span class="number">1</span>;<span class="comment">//è¿™æ£µæ ‘çš„æ ¹,æ— ç‰¹æ®Šè¯´æ˜å¯ä»¥ä¸º1 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">22</span>;i++)</span><br><span class="line">anc[x][i] = anc[anc[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i] , z = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(dis[y] || y == root) <span class="keyword">continue</span>;</span><br><span class="line">deep[y] = deep[x]+<span class="number">1</span>;</span><br><span class="line">dis[y] = dis[x] + z;</span><br><span class="line">anc[y][<span class="number">0</span>] = x; dfs(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(deep[u] &lt; deep[v]) swap(u,v);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(deep[anc[u][i]] &gt;= deep[v]) u = anc[u][i];</span><br><span class="line"><span class="keyword">if</span>(u == v) <span class="keyword">return</span> u;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(anc[u][i] != anc[v][i])&#123;</span><br><span class="line">u = anc[u][i]; v= anc[v][i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> anc[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="comment">/*logNæ—¶é—´å†…è¿”å›xä¸yä¹‹é—´çš„è·ç¦»,æ³¨æ„æ˜¯å¦ä¼šçˆ†int*/</span> </span><br><span class="line"><span class="keyword">return</span> dis[x] + dis[y] - <span class="number">2</span>*dis[Lca(x,y)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt; n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">addEdge(x,y); addEdge(y,x);<span class="comment">//åŒå‘è¾¹ </span></span><br><span class="line">&#125;</span><br><span class="line">deep[<span class="number">0</span>] = <span class="number">-1</span>; dfs(root);<span class="comment">//å®Œæˆé¢„å¤„ç† </span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;q);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= q;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(x,y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="æš—çš„é”é“¾"><a href="#æš—çš„é”é“¾" class="headerlink" title="æš—çš„é”é“¾*"></a>æš—çš„é”é“¾*</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šPOJ 3417</p><p>Dark æ˜¯ä¸€å¼ æ— å‘å›¾ï¼Œå›¾ä¸­æœ‰ N ä¸ªèŠ‚ç‚¹å’Œä¸¤ç±»è¾¹ï¼Œä¸€ç±»è¾¹è¢«ç§°ä¸ºä¸»è¦è¾¹ï¼Œè€Œå¦ä¸€ç±»è¢«ç§°ä¸ºé™„åŠ è¾¹ã€‚Dark æœ‰ Nâ€“1 æ¡ä¸»è¦è¾¹ï¼Œå¹¶ä¸” Dark çš„ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´éƒ½å­˜åœ¨ä¸€æ¡åªç”±ä¸»è¦è¾¹æ„æˆçš„è·¯å¾„ã€‚å¦å¤–ï¼ŒDark è¿˜æœ‰ M æ¡é™„åŠ è¾¹ã€‚</p><p>ä½ çš„ä»»åŠ¡æ˜¯æŠŠ Dark æ–©ä¸ºä¸è¿é€šçš„ä¸¤éƒ¨åˆ†ã€‚ä¸€å¼€å§‹ Dark çš„é™„åŠ è¾¹éƒ½å¤„äºæ— æ•ŒçŠ¶æ€ï¼Œä½ åªèƒ½é€‰æ‹©ä¸€æ¡ä¸»è¦è¾¹åˆ‡æ–­ã€‚ä¸€æ—¦ä½ åˆ‡æ–­äº†ä¸€æ¡ä¸»è¦è¾¹ï¼ŒDark å°±ä¼šè¿›å…¥é˜²å¾¡æ¨¡å¼ï¼Œä¸»è¦è¾¹ä¼šå˜ä¸ºæ— æ•Œçš„è€Œé™„åŠ è¾¹å¯ä»¥è¢«åˆ‡æ–­ã€‚ä½†æ˜¯ä½ çš„èƒ½åŠ›åªèƒ½å†åˆ‡æ–­ Dark çš„ä¸€æ¡é™„åŠ è¾¹ã€‚</p><p>ç°åœ¨ä½ æƒ³è¦çŸ¥é“ï¼Œä¸€å…±æœ‰å¤šå°‘ç§æ–¹æ¡ˆå¯ä»¥å‡»è´¥ Darkã€‚æ³¨æ„ï¼Œå°±ç®—ä½ ç¬¬ä¸€æ­¥åˆ‡æ–­ä¸»è¦è¾¹ä¹‹åå°±å·²ç»æŠŠ Dark æ–©ä¸ºä¸¤æˆªï¼Œä½ ä¹Ÿéœ€è¦åˆ‡æ–­ä¸€æ¡é™„åŠ è¾¹æ‰ç®—å‡»è´¥äº† Darkã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>è¿™æ˜¯ä¸€é“éœ€è¦è§‚å¯Ÿå’Œè½¬åŒ–é¢˜æ„çš„é—®é¢˜ã€‚<br>åœ¨æ ‘ä¸Šå¦‚æœæœ‰ä¸€æ¡é™„åŠ è¾¹ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªç¯ï¼Œå¯çŸ¥æ¯ä¸ªç¯å†…æœ€å¤šæœ‰ä¸€æ¡é™„åŠ è¾¹ã€‚å¦‚æœä¸€æ¡ä¸»è¦è¾¹åœ¨ç¯ä¸­ï¼Œåˆ™ç§°è¯¥ä¸»è¦è¾¹è¢«<strong>è¦†ç›–</strong> ï¼Œå®ƒåœ¨å‡ ä¸ªç¯å†…ï¼Œå°±è¢«è¦†ç›–äº†å‡ æ¬¡ã€‚å¯çŸ¥ä¸€ä¸ªä¸»è¦è¾¹æœ€å¤šè¢«è¦†ç›–2æ¬¡ã€‚<br>å¦‚æœä¸€æ¡ä¸»è¦è¾¹è¢«è¦†ç›–äº† 2 æ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ— è®ºæ€ä¹ˆåˆ‡éƒ½åˆ‡ä¸æ–­ Darkï¼Œå› ä¸ºåˆ‡æ–­äº†ä¸»è¦è¾¹åï¼Œè¿˜æ˜¯ä¸€ä¸ªç¯ï¼Œè€Œåˆ‡æ–­ä¸€ä¸ªç¯éœ€è¦åˆ‡æ–­ä¸¤æ¡è¾¹ã€‚å¦‚æœä¸€æ¡ä¸»è¦è¾¹è¢«è¦†ç›–äº† 1 æ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ‡æ–­è¯¥ä¸»è¦è¾¹åï¼Œå†åˆ‡æ–­å®ƒçš„é™„åŠ è¾¹å³å¯ï¼Œå³åªæœ‰ä¸€ç§æ–¹æ¡ˆã€‚å¦‚æœä¸€æ¡ä¸»è¦è¾¹è¢«è¦†ç›–0æ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ‡å®Œè¯¥ä¸»è¦è¾¹åï¼Œå¯ä»¥ä»»æ„åˆ‡ä¸€æ¡é™„åŠ è¾¹ï¼Œå…± m ä¸­æ–¹æ¡ˆï¼ˆm æ˜¯é™„åŠ è¾¹çš„æ¡æ•°ï¼‰ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚å‡ºæ¯æ¡ä¸»è¦è¾¹è¢«é™„åŠ è¾¹è¦†ç›–æ¬¡æ•°å³å¯ï¼Œæˆ‘ä»¬è®¾ f[x] ä¸º x åˆ°å…¶çˆ¶èŠ‚ç‚¹çš„ä¸»è¦è¾¹è¢«è¦†ç›–çš„æ¬¡æ•°ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<strong>æ ‘ä¸Šå·®åˆ†</strong>æ¥æ±‚ f æ•°ç»„ï¼Œæ ‘ä¸Šå·®åˆ†çš„æ€æƒ³å°±ä¸é¢å¤–ä»‹ç»äº†ï¼Œå…·ä½“åšæ³•æ˜¯å¦‚æœæœ‰ä¸€æ¡é™„åŠ è¾¹(x, y)ï¼Œé‚£ä¹ˆf[x]++ ,f[y]++ï¼ŒåŒæ—¶ f[ Lca(x, y) ] -= 2ï¼Œè¿™æ ·å½“æˆ‘ä»¬æ·»åŠ å®Œé™„åŠ è¾¹åï¼Œå°† f æ•°ç»„ä»å¶å­èŠ‚ç‚¹å‘ä¸Šç´¯åŠ ï¼Œå³å¯æ›´æ–°å®Œæ¯• f æ•°ç»„ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],nex[M], tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">ver[++tot] = y; nex[tot] = head[x];head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m,f[N];</span><br><span class="line"><span class="keyword">int</span> dis[N],deep[N],anc[N][<span class="number">24</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">22</span>;i++) </span><br><span class="line">anc[x][i] = anc[anc[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i], z = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(dis[y] || y == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">deep[y] = deep[x] + <span class="number">1</span>;</span><br><span class="line">dis[y] = dis[x] + z;</span><br><span class="line">anc[y][<span class="number">0</span>] = x; dfs(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(deep[x] &lt; deep[y]) swap(x,y);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(deep[anc[x][i]] &gt;= deep[y]) x = anc[x][i];</span><br><span class="line"><span class="keyword">if</span>(x == y) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(anc[x][i] != anc[y][i])&#123;</span><br><span class="line">x = anc[x][i]; y = anc[y][i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> anc[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">vis[x] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i];</span><br><span class="line"><span class="keyword">if</span>(vis[y]) <span class="keyword">continue</span>;</span><br><span class="line">f[x] += dfs2(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> f[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt; n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">addEdge(x,y); addEdge(y,x);</span><br><span class="line">&#125;</span><br><span class="line">dfs(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">f[x]++; f[y]++; f[Lca(x,y)] -= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">dfs2(<span class="number">1</span>); <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">if</span>(!f[i]) ans += m;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(f[i] == <span class="number">1</span>) ans++;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å¼‚è±¡çŸ³"><a href="#å¼‚è±¡çŸ³" class="headerlink" title="å¼‚è±¡çŸ³*"></a>å¼‚è±¡çŸ³*</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šContest Hunter Round #56</p><p>åœ¨ Adera çš„å¼‚æ—¶ç©ºä¸­æœ‰ä¸€å¼ åœ°å›¾ã€‚è¿™å¼ åœ°å›¾ä¸Šæœ‰ N ä¸ªç‚¹ï¼Œæœ‰ Nâˆ’1 æ¡åŒå‘è¾¹æŠŠå®ƒä»¬è¿é€šèµ·æ¥ã€‚èµ·åˆåœ°å›¾ä¸Šæ²¡æœ‰ä»»ä½•å¼‚è±¡çŸ³ï¼Œåœ¨æ¥ä¸‹æ¥çš„ M ä¸ªæ—¶åˆ»ä¸­ï¼Œæ¯ä¸ªæ—¶åˆ»ä¼šå‘ç”Ÿä»¥ä¸‹ä¸‰ç§ç±»å‹çš„äº‹ä»¶ä¹‹ä¸€ï¼š</p><p>åœ°å›¾çš„æŸä¸ªç‚¹ä¸Šå‡ºç°äº†å¼‚è±¡çŸ³ï¼ˆå·²ç»å‡ºç°çš„ä¸ä¼šå†æ¬¡å‡ºç°ï¼‰ï¼›</p><p>åœ°å›¾æŸä¸ªç‚¹ä¸Šçš„å¼‚è±¡çŸ³è¢«æ‘§æ¯ï¼ˆä¸ä¼šæ‘§æ¯æ²¡æœ‰å¼‚è±¡çŸ³çš„ç‚¹ï¼‰ï¼›</p><p>å‘ç©å®¶è¯¢é—®ä½¿æ‰€æœ‰å¼‚è±¡çŸ³æ‰€åœ¨çš„ç‚¹è¿é€šçš„è¾¹é›†çš„æ€»é•¿åº¦æœ€å°æ˜¯å¤šå°‘ã€‚</p><p>è¯·ä½ ä½œä¸ºç©å®¶å›ç­”è¿™äº›é—®é¢˜ã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œç°è‰²èŠ‚ç‚¹è¡¨ç¤ºå‡ºç°äº†å¼‚è±¡çŸ³ï¼ŒåŠ ç²—çš„è¾¹è¡¨ç¤ºè¢«é€‰ä¸ºè¿é€šå¼‚è±¡çŸ³çš„è¾¹é›†ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æˆ‘ä¹Ÿä¸å¤ªèƒ½ç†è§£è¿™é¢˜çš„æ€è·¯æ˜¯æ€ä¹ˆå‘ç°çš„ã€‚<br>å¾ˆè‡ªç„¶çš„æƒ³æ³•å°±æ˜¯æ±‚æ‰€æœ‰ k ä¸ªå¼‚è±¡çŸ³ä¸¤ä¸¤ä¹‹é—´çš„è·ç¦»å’Œï¼Œç„¶å / (k-1) å³ä¸ºç­”æ¡ˆï¼Œä½†æ˜¾ç„¶ä¼šè¶…æ—¶ã€‚<br>æ­£è§£æ˜¯åˆ©ç”¨ä¸€ä¸ªç»“è®ºï¼Œè¯¥ç»“è®ºé¢˜è§£æ²¡ç»™å‡ºè¯æ˜ï¼Œææ‡‚äº†å†è¡¥ä¸Šã€‚<br>å¯¹è¿™é¢—æ ‘å…ˆè¿›è¡Œdfséå†ï¼Œç»™æ¯ä¸ªèŠ‚ç‚¹æ‰“ä¸Šä¸€ä¸ªæ—¶é—´æˆ³ï¼Œè®¾èŠ‚ç‚¹ x çš„æ—¶é—´æˆ³ä¸º dfn[x]ï¼›è®¾å·²å­˜åœ¨çš„å¼‚è±¡çŸ³ä¸­ï¼Œdfnåºæ˜¯ x å‰é©±çš„èŠ‚ç‚¹ç¼–å·ä¸º preï¼Œåç»§èŠ‚ç‚¹ç¼–å·ä¸º nexï¼Œé‚£ä¹ˆåœ¨ x å¤„æ’å…¥å¼‚è±¡çŸ³åï¼Œ ans += Dis(pre , x) + Dis(x, nex) - Dis(pre, nex)ã€‚<br>åˆ é™¤ä¸€ä¸ªå¼‚è±¡çŸ³åŒç†ï¼Œå‡å»å°±å¥½ã€‚<br>è¯æ˜æš‚æ—¶æ²¡æœ‰ï¼Œå¦å¤–è¿™ä¸ªè¦åšæ³•è®°ä½ï¼Œæ˜¯ç”¨æ¥æ±‚æ ‘ä¸Šå¤šä¸ªèŠ‚ç‚¹ä¹‹é—´çš„æœ€çŸ­æ€»è·¯å¾„ç”¨çš„ã€‚</p><p>è¿˜è¦æ³¨æ„setçš„ç”¨æ³•ï¼Œå¦‚æœsetä¸ºç©ºï¼Œé‚£ä¹ˆbegin() = end()ï¼Œæ­¤æ—¶å¦‚æœç”¨æŒ‡å‘end()çš„è¿­ä»£å™¨è‡ªå¢æˆ–è‡ªå‡éƒ½æ˜¯ä¸åˆæ³•çš„ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],nex[M], tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">ver[++tot] = y; nex[tot] = head[x];head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m,f[N];</span><br><span class="line"><span class="keyword">int</span> dis[N],deep[N],anc[N][<span class="number">24</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">22</span>;i++) </span><br><span class="line">anc[x][i] = anc[anc[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i], z = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(dis[y] || y == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">deep[y] = deep[x] + <span class="number">1</span>;</span><br><span class="line">dis[y] = dis[x] + z;</span><br><span class="line">anc[y][<span class="number">0</span>] = x; dfs(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(deep[x] &lt; deep[y]) swap(x,y);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(deep[anc[x][i]] &gt;= deep[y]) x = anc[x][i];</span><br><span class="line"><span class="keyword">if</span>(x == y) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(anc[x][i] != anc[y][i])&#123;</span><br><span class="line">x = anc[x][i]; y = anc[y][i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> anc[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">vis[x] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i];</span><br><span class="line"><span class="keyword">if</span>(vis[y]) <span class="keyword">continue</span>;</span><br><span class="line">f[x] += dfs2(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> f[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt; n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">addEdge(x,y); addEdge(y,x);</span><br><span class="line">&#125;</span><br><span class="line">dfs(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">f[x]++; f[y]++; f[Lca(x,y)] -= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">dfs2(<span class="number">1</span>); <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">if</span>(!f[i]) ans += m;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(f[i] == <span class="number">1</span>) ans++;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¬¡å°ç”Ÿæˆæ ‘"><a href="#æ¬¡å°ç”Ÿæˆæ ‘" class="headerlink" title="æ¬¡å°ç”Ÿæˆæ ‘*"></a>æ¬¡å°ç”Ÿæˆæ ‘*</h4><p>è¿™æ˜¯é˜³å“¥å“¥è´Ÿè´£çš„é¢˜å‹ï¼Œæˆ‘å°±ä¸è¶Šç•Œäº†ã€‚</p><h4 id="Dis"><a href="#Dis" class="headerlink" title="Dis"></a>Dis</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™å‡º n ä¸ªç‚¹çš„ä¸€æ£µæ ‘ï¼Œå¤šæ¬¡è¯¢é—®ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·ç¦»ã€‚<br>æ³¨æ„ï¼šè¾¹æ˜¯åŒå‘çš„ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>è¿™ä¸ªå°±æ˜¯æ ‡å‡†çš„æ¨¡æ¿é¢˜äº†ï¼Œå’Œç¬¬ä¸€é¢˜ä¸€æ ·ï¼Œæ³¨æ„ä¸€ä¸‹ç»†èŠ‚å³å¯ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],nex[M],edge[M],tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">ver[++tot] = y; nex[tot] = head[x];</span><br><span class="line">edge[tot] = z; head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,q;</span><br><span class="line"><span class="keyword">int</span> anc[N][<span class="number">25</span>], deep[N],dis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">22</span>;i++)</span><br><span class="line">anc[x][i] = anc[anc[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i] , z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(dis[y] || y == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">deep[y] = deep[x]+<span class="number">1</span>;</span><br><span class="line">dis[y] = dis[x] + z;</span><br><span class="line">anc[y][<span class="number">0</span>] = x; dfs(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(deep[u] &lt; deep[v]) swap(u,v);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(deep[anc[u][i]] &gt;= deep[v]) u = anc[u][i];</span><br><span class="line"><span class="keyword">if</span>(u == v) <span class="keyword">return</span> u;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(anc[u][i] != anc[v][i])&#123;</span><br><span class="line">u = anc[u][i]; v= anc[v][i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> anc[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> dis[x] + dis[y] - <span class="number">2</span>*dis[Lca(x,y)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;q);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt; n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">addEdge(x,y,z); addEdge(y,x,z);</span><br><span class="line">&#125;</span><br><span class="line">dfs(<span class="number">1</span>);<span class="comment">//å®Œæˆé¢„å¤„ç†</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= q;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(x,y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ç¥–å­™è¯¢é—®"><a href="#ç¥–å­™è¯¢é—®" class="headerlink" title="ç¥–å­™è¯¢é—®"></a>ç¥–å­™è¯¢é—®</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>å·²çŸ¥ä¸€æ£µ n ä¸ªèŠ‚ç‚¹çš„æœ‰æ ¹æ ‘ã€‚æœ‰ m ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®ç»™å‡ºäº†ä¸€å¯¹èŠ‚ç‚¹çš„ç¼–å· x å’Œ yï¼Œè¯¢é—® x ä¸ y çš„ç¥–å­™å…³ç³»ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>ç®€å•çš„æ¨¡æ¿é¢˜ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœ x == yï¼Œé‚£ä¹ˆæ˜¯å±äº<strong>å…¶å®ƒæƒ…å†µ</strong>å“¦ã€‚<br>å¦å¤–è¿˜éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œdeep[0] = -1ï¼Œå¦åˆ™ä¼šå’Œæ ¹èŠ‚ç‚¹æ•°å€¼ç›¸ç­‰è€Œå‡ºé”™ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],edge[M],nex[M],tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">ver[++tot] = y; edge[tot] = z;</span><br><span class="line">nex[tot] = head[x]; head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> anc[N][<span class="number">25</span>], dis[N],deep[N];</span><br><span class="line"><span class="keyword">int</span> root;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">22</span>;i++)</span><br><span class="line">anc[x][i] = anc[anc[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(dis[y] || y == root) <span class="keyword">continue</span>;</span><br><span class="line">deep[y] = deep[x]+<span class="number">1</span>;</span><br><span class="line">dis[y] = dis[x] + <span class="number">1</span>;</span><br><span class="line">anc[y][<span class="number">0</span>] = x; dfs(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(deep[x] &lt; deep[y]) swap(x,y);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(deep[anc[x][i]] &gt;= deep[y]) x = anc[x][i];</span><br><span class="line"><span class="keyword">if</span>(x == y) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(anc[x][i] != anc[y][i])&#123;</span><br><span class="line">x = anc[x][i]; y = anc[y][i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> anc[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line"><span class="keyword">if</span>(y == <span class="number">-1</span>) root = x;</span><br><span class="line"><span class="keyword">else</span> addEdge(x,y,<span class="number">1</span>), addEdge(y,x,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å› ä¸ºdeep[root] = 0,å¦‚æœdeep[0] = 0,åˆ™ä¼šè®¤ä¸º 0 å·èŠ‚ç‚¹ä¹Ÿæ˜¯æ ¹ */</span></span><br><span class="line">deep[<span class="number">0</span>] = <span class="number">-1</span>; dfs(root);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line"><span class="keyword">int</span> par = Lca(x,y);</span><br><span class="line"><span class="keyword">if</span>(x == y) <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(par == x) <span class="built_in">puts</span>(<span class="string">"1"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(par == y) <span class="built_in">puts</span>(<span class="string">"2"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="èšä¼š"><a href="#èšä¼š" class="headerlink" title="èšä¼š*"></a>èšä¼š*</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šAHOI 2008</p><p>Y å²›é£æ™¯ç¾ä¸½å®œäººï¼Œæ°”å€™æ¸©å’Œï¼Œç‰©äº§ä¸°å¯Œã€‚Y å²›ä¸Šæœ‰ N ä¸ªåŸå¸‚ï¼Œæœ‰ Nâˆ’1 æ¡åŸå¸‚é—´çš„é“è·¯è¿æ¥ç€å®ƒä»¬ã€‚æ¯ä¸€æ¡é“è·¯éƒ½è¿æ¥æŸä¸¤ä¸ªåŸå¸‚ã€‚å¹¸è¿çš„æ˜¯ï¼Œå°å¯å¯é€šè¿‡è¿™äº›é“è·¯å¯ä»¥èµ°é Y å²›çš„æ‰€æœ‰åŸå¸‚ã€‚ç¥å¥‡çš„æ˜¯ï¼Œä¹˜è½¦ç»è¿‡æ¯æ¡é“è·¯æ‰€éœ€è¦çš„è´¹ç”¨éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p>å°å¯å¯ï¼Œå°å¡å¡å’Œå° YY ç»å¸¸æƒ³èšä¼šï¼Œæ¯æ¬¡èšä¼šï¼Œä»–ä»¬éƒ½ä¼šé€‰æ‹©ä¸€ä¸ªåŸå¸‚ï¼Œä½¿å¾—ä¸‰ä¸ªäººåˆ°è¾¾è¿™ä¸ªåŸå¸‚çš„æ€»è´¹ç”¨æœ€å°ã€‚</p><p>ç”±äºä»–ä»¬è®¡åˆ’ä¸­è¿˜ä¼šæœ‰å¾ˆå¤šæ¬¡èšä¼šï¼Œæ¯æ¬¡éƒ½é€‰æ‹©ä¸€ä¸ªåœ°ç‚¹æ˜¯å¾ˆçƒ¦äººçš„äº‹æƒ…ï¼Œæ‰€ä»¥ä»–ä»¬å†³å®šæŠŠè¿™ä»¶äº‹æƒ…äº¤ç»™ä½ æ¥å®Œæˆã€‚ä»–ä»¬ä¼šæä¾›ç»™ä½ åœ°å›¾ä»¥åŠè‹¥å¹²æ¬¡èšä¼šå‰ä»–ä»¬æ‰€å¤„çš„ä½ç½®ï¼Œå¸Œæœ›ä½ ä¸ºä»–ä»¬çš„æ¯ä¸€æ¬¡èšä¼šé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„åœ°ç‚¹ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>åœ¨ä¸€æ£µæ ‘ä¸Šæ±‚ä¸‰ä¸ªç‚¹ (x, y ,z) ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ï¼Œæˆ‘ä»¬æ±‚å‡ºdis[x, y] + dis[x , z] + dis[y , z]ï¼Œç”»å›¾å°±ä¼šå‘ç°æ¯ä¸€æ®µè·¯å¾„éƒ½è¢«é‡å¤è®¡ç®—äº† 2 æ¬¡ï¼Œäºæ˜¯æˆ‘ä»¬å†å°†ç­”æ¡ˆ / 2å°±å¾—åˆ°äº†ä¸‰ä¸ªç‚¹ä¹‹é—´çš„è·¯å¾„ã€‚<br>å‡è®¾è¿™ä¸ªèšä¼šç‚¹ä¸º p ï¼Œé‚£ä¹ˆæ˜¾ç„¶ p æ˜¯ä¸‰æ¡è·¯å¾„çš„äº¤æ±‡ç‚¹ï¼Œå¦åˆ™è·¯å¾„å’Œè‚¯å®šä¸ä¼šæ˜¯æœ€çŸ­ã€‚ä¸‹ä¸€æ­¥çš„ç›®æ ‡å°±æ˜¯æ±‚å‡ºè¿™ä¸ªäº¤æ±‡ç‚¹çš„åæ ‡ã€‚</p><p>å¦‚æœæˆ‘ä»¬ä»¥æŸä¸ªç‚¹ä¸ºæ ¹ï¼Œä¸ºæ¯ä¸ªèŠ‚ç‚¹æ›´æ–°æ·±åº¦deepï¼ˆå°±åƒæˆ‘ä»¬åœ¨æ±‚LCAæ—¶ä¸€æ ·ï¼‰ï¼Œé‚£ä¹ˆæ˜¾ç„¶ p ç‚¹å°±æ˜¯ Lca[x, y] , Lca[x , z] , Lca[y , z] ä¸‰è€…ä¸­deepæœ€å¤§ï¼ˆæœ€æ·±ï¼‰çš„ç‚¹ï¼Œè¿™ä¹Ÿå¯ä»¥é€šè¿‡ç”»å›¾è§‚å¯Ÿå‡ºæ¥ï¼Œä¹Ÿå¾ˆå®¹æ˜“è¯æ˜ã€‚</p><p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨æ ‘ä¸Šå€å¢æ³•æ±‚å‡ºLcaï¼Œåœ¨O(NlogN)æ—¶é—´å†…è§£å†³è¯¥é¢˜ï¼Œä½†æ˜¯å¸¸æ•°ä¸å¤ªä¼˜ç§€ï¼Œæé™æ•°æ®è¿˜æ˜¯ä¼šè¢«å¡æ‰ï¼Œå¦‚æœæƒ³æ»¡åˆ†éœ€è¦ç”¨æ ‘é“¾å‰–åˆ†ï¼Œä¸è¿‡è¯¥æ€è·¯å·²ç»å¯ä»¥é€šè¿‡ä¸€æœ¬é€šojä¸Šçš„æ•°æ®äº†ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],edge[M],nex[M], tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">ver[++tot] = y, edge[tot] = z;</span><br><span class="line">nex[tot] = head[x] , head[x] = tot;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c != <span class="string">'-'</span> &amp;&amp; (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>,c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) </span><br><span class="line">res = res*<span class="number">10</span>+c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg?-res:res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> root = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> deep[N],anc[N][<span class="number">24</span>],dis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">22</span>;i++)</span><br><span class="line">anc[x][i] = anc[anc[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(dis[y] || y == root) <span class="keyword">continue</span>;</span><br><span class="line">deep[y] = deep[x] + <span class="number">1</span>;</span><br><span class="line">dis[y] = dis[x] + <span class="number">1</span>;</span><br><span class="line">anc[y][<span class="number">0</span>] = x; dfs(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(deep[x] &lt; deep[y]) swap(x,y);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(deep[anc[x][i]] &gt;= deep[y]) x = anc[x][i];</span><br><span class="line"><span class="keyword">if</span>(x == y) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">if</span>(anc[x][i] != anc[y][i])&#123;</span><br><span class="line">x = anc[x][i]; y = anc[y][i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> anc[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dis</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> dis[x] + dis[y] - <span class="number">2</span>*dis[Lca(x,y)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!x) <span class="keyword">return</span>;</span><br><span class="line">print(x/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span>(x%<span class="number">10</span>+<span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">n = getInt(); m = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt; n;i++)&#123;</span><br><span class="line">x = getInt(); y = getInt();</span><br><span class="line">addEdge(x,y,<span class="number">1</span>); addEdge(y,x,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">deep[<span class="number">0</span>] = <span class="number">-1</span>; dfs(root);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt;= m;i++)&#123;</span><br><span class="line">x = getInt(); y = getInt(); z = getInt();</span><br><span class="line"><span class="keyword">int</span> par = Lca(x,y); </span><br><span class="line"><span class="keyword">int</span> p2 = Lca(x,z) , p3 = Lca(y,z);</span><br><span class="line"><span class="keyword">if</span>(deep[par] &lt; deep[p2]) par = p2;</span><br><span class="line"><span class="keyword">if</span>(deep[par] &lt; deep[p3]) par = p3;</span><br><span class="line"><span class="keyword">int</span> res = Dis(x,y) + Dis(x,z) + Dis(y,z) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">print(par); <span class="built_in">putchar</span>(<span class="string">' '</span>); print(res); <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="è·³è·³æ£‹"><a href="#è·³è·³æ£‹" class="headerlink" title="è·³è·³æ£‹**"></a>è·³è·³æ£‹**</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šBZOJ 2144</p><p>è·³è·³æ£‹æ˜¯åœ¨ä¸€æ¡æ•°è½´ä¸Šè¿›è¡Œçš„ã€‚æ£‹å­åªèƒ½æ‘†åœ¨æ•´ç‚¹ä¸Šã€‚æ¯ä¸ªç‚¹ä¸èƒ½æ‘†è¶…è¿‡ä¸€ä¸ªæ£‹å­ã€‚æˆ‘ä»¬ç”¨è·³è·³æ£‹æ¥åšä¸€ä¸ªç®€å•çš„æ¸¸æˆï¼šæ£‹ç›˜ä¸Šæœ‰ä¸‰é¢—æ£‹å­ï¼Œåˆ†åˆ«åœ¨ a,b,c è¿™ä¸‰ä¸ªä½ç½®ã€‚æˆ‘ä»¬è¦é€šè¿‡æœ€å°‘çš„è·³åŠ¨æŠŠä»–ä»¬çš„ä½ç½®ç§»åŠ¨æˆ x,y,zï¼ˆæ³¨æ„ï¼šæ£‹å­æ˜¯æ²¡æœ‰åŒºåˆ«çš„ï¼‰ã€‚</p><p>è·³åŠ¨çš„è§„åˆ™å¾ˆç®€å•ï¼Œä»»æ„é€‰ä¸€é¢—æ£‹å­ï¼Œå¯¹ä¸€é¢—ä¸­è½´æ£‹å­è·³åŠ¨ã€‚è·³åŠ¨åä¸¤é¢—æ£‹å­è·ç¦»ä¸å˜ã€‚ä¸€æ¬¡åªå…è®¸è·³è¿‡ä¸€é¢—æ£‹å­ã€‚</p><p>å†™ä¸€ä¸ªç¨‹åºï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦å¯ä»¥å®Œæˆä»»åŠ¡ã€‚å¦‚æœå¯ä»¥ï¼Œè¾“å‡ºæœ€å°‘éœ€è¦çš„è·³åŠ¨æ¬¡æ•°ã€‚<br><img src="/2019/10/09/lca-problems/1.png" alt="1"><br><strong>è§£é¢˜æ€è·¯</strong><br>è¿™é¢˜æœ‰å¥½å‡ ä¸ªéš¾ç‚¹ï¼Œæ€è·¯ä¹Ÿä¸æ˜¯é‚£ä¹ˆå®¹æ˜“æƒ³åˆ°ã€‚</p><p>é¦–å…ˆæ¯”è¾ƒå®¹æ˜“æƒ³åˆ°çš„æ˜¯ï¼Œæœ‰å“ªäº›ç‚¹æ˜¯å¯ä»¥è¾¾åˆ°çš„ï¼›è®¾a,b,cå‡åºï¼Œl1 = b-a, l2 = c-bï¼Œé‚£ä¹ˆ(l1, l2)å¯ä»¥è½¬ç§»åˆ° (l1, l2-l1) å’Œ (l1-l2 , l2)ã€‚<br>é‚£ä¹ˆæ¯æ¬¡è½¬ç§»äº†å¤šå°‘é•¿åº¦ï¼Œå‘å“ªä¸ªæ–¹å‘è½¬ç§»çš„æˆ‘ä»¬éƒ½çŸ¥é“äº†ï¼Œè‡ªç„¶å°±å¯ä»¥å¾—åˆ°ç‚¹çš„è½¬ç§»ã€‚å°±æ¯”å¦‚ (l1 , l2)  â€”&gt; (l1 , l2 - l1) ï¼Œå°±å¯¹åº”ç€(a ,b ,c)â€”&gt;(b, 2b-a, c)ã€‚</p><p>æ—¢ç„¶æˆ‘ä»¬çŸ¥é“ç‚¹å¦‚ä½•è½¬ç§»ï¼Œé‚£ä¹ˆé—®é¢˜å°±å˜æˆäº†åˆ¤æ–­ (a , b, c) å’Œ (x , y , z) æ˜¯å¦å¯ä»¥è½¬ç§»åˆ°åŒä¸€ä¸ªçŠ¶æ€ã€‚</p><p>æˆ‘ä»¬ä¸Šé¢åªè®¨è®ºäº†ä¸¤ç«¯èŠ‚ç‚¹å‘ä¸­é—´è·³ï¼ˆå¯¹åº”ç€åˆæ³•é•¿åº¦çš„ç›¸å‡ï¼Œaè·³åˆ°bã€cä¸­é—´ï¼Œcè·³åˆ°aã€bä¸­é—´ï¼‰ï¼Œæ²¡è€ƒè™‘ä¸­é—´èŠ‚ç‚¹å‘ä¸¤è¾¹è·³ï¼ˆaå…³äºcè·³ï¼Œæˆ–cå…³äºaè·³ï¼Œæˆ–bå…³äºaã€cè·³ï¼Œå¯¹åº”ç€åˆæ³•é•¿åº¦çš„ç›¸åŠ ï¼‰ï¼Œå®é™…ä¸Šä¸¤è€…éƒ½æˆç«‹ï¼Œæ¯”å¦‚(l1 , l2)â€”&gt;(l1, l1+l2)å¯¹åº”ç€(a ,b ,c) â€”&gt; (b , a , c) ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬å°†å…¶ä¸­ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ä¸æ–­å˜å¤§ï¼Œä¼šç»ˆæ­¢äºæ­£æ— ç©·ï¼Œä½†å¦‚æœä¸æ–­ç¼©å°ï¼Œå°±ä¼šç»ˆæ­¢äºæŸä¸€ä¸ªéè´Ÿæ•´æ•°ï¼›åŸºäºæ­¤æˆ‘ä»¬åªè€ƒè™‘â€œä¸¤è¾¹çš„ç‚¹å‘ä¸­é—´è·³â€è¿™ç§æƒ…å†µï¼Œè¿™å¯¹åº”ç€å¼€å§‹ä»‹ç»çš„ä¸¤ä¸ªå‡æ³•è½¬ç§»ã€‚</p><p>åˆ°æ­¤å°±æœ‰äº›æ˜æœ—äº†ï¼Œæ¯ä¸ªçŠ¶æ€çœ‹ä½œä¸€ä¸ªèŠ‚ç‚¹ï¼Œè½¬ç§»ä¸€æ¬¡å°±çœ‹ä½œå‘ä¸Šèµ°ä¸€æ­¥ï¼Œæœ€ç»ˆä¸€å®šä¼šç»ˆæ­¢äºæŸä¸€ä¸ªçŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€å°±å¯ä»¥çœ‹ä½œæ ¹èŠ‚ç‚¹ï¼›æˆ‘ä»¬å°†(a ,b ,c) ä¸ (x, y , z)åŒæ—¶â€œå‘ä¸Šâ€è½¬ç§»ï¼Œå¦‚æœå®ƒä»¬ç»ˆæ­¢äºåŒä¸€ä¸ªçŠ¶æ€ï¼Œå°±è¯´æ˜å®ƒä»¬å¯ä»¥äº’ç›¸æŠµè¾¾ï¼Œå¦åˆ™åˆ™ä¸èƒ½ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯è¦åˆ¤æ–­æœ€å°çš„æ­¥æ•°ï¼Œå³(a ,b ,c) åˆ° (x , y , z) çš„æœ€å°‘è½¬ç§»æ¬¡æ•°ã€‚è¿™å°±ç›¸å½“äºæ±‚äºŒè€…çš„LCAï¼Œå› ä¸ºå®ƒä»¬æœ‰å…±åŒçš„â€œæ ¹èŠ‚ç‚¹â€ï¼Œå¹¶ä¸”æœ‰ç€åˆ°æ ¹èŠ‚ç‚¹çš„å”¯ä¸€è·¯å¾„ï¼Œæ‰€ä»¥å¯ä»¥å°†å®ƒä»¬çš„è½¬ç§»çœ‹ä½œä¸€æ£µæ ‘ï¼Œè¾¹æƒä¸º1ï¼Œæ±‚ç€ä¸¤ä¸ªçŠ¶æ€ä¹‹é—´çš„è·ç¦»ã€‚</p><p>ç”±äºæˆ‘ä»¬åˆ©ç”¨çš„æ˜¯åˆæ³•é•¿åº¦çš„è½¬ç§»æ¥å¯¹åº”ç€ç‚¹çš„çŠ¶æ€çš„è½¬ç§»ï¼Œå³(l1, l2) â€”&gt; (l1 , l2-l1)æˆ–(l1-l2, l2)ã€‚è¿™å’Œæ›´ç›¸å‡æŸæœ¯ gcd(a, b) = gcd(a, b-a) = gcd(a-b, a)ç›¸åŒï¼Œè€Œæ¬§å‡ é‡Œå¾—åˆå‘Šè¯‰æˆ‘ä»¬ gcd(a ,b) = gcd(b ,a%b)ï¼Œäºæ˜¯æœ¬æ¥ O(N) çš„å‡æ³•å˜æˆäº† O(log N)çš„é™¤æ³•ï¼ˆå–æ¨¡ï¼‰ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨O(logN)çš„æ—¶é—´å†…è½¬ç§»åˆ°ä»»æ„ä¸€ä¸ªçˆ¶çŠ¶æ€ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“è¯¥å‘ä¸Šè½¬ç§»å‡ æ­¥æ‰æ˜¯æœ€å°‘æ­¥æ•°ï¼Œäºæ˜¯æˆ‘ä»¬è¦å…ˆå°†äºŒè€…çš„<strong>æ·±åº¦</strong>è°ƒåˆ°ç›¸åŒï¼Œç„¶ååŒæ—¶å‘ä¸Šèµ° k æ­¥ï¼Œè¿™å¯ä»¥ç”¨å€å¢å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨äºŒåˆ†æœç´¢å®ç°ã€‚æ±‚æ·±åº¦æˆ‘ä»¬å¯ä»¥åœ¨æ±‚ç¬¬ä¸€é—®æ—¶é¡ºä¾¿æ±‚è§£ï¼ŒåŒæ—¶æ·±åº¦ä¹Ÿæ˜¯æœ€é•¿è·¯å¾„ï¼Œç”¨äºäºŒåˆ†ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">5</span>],b[<span class="number">5</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> x,y,z;</span><br><span class="line">Node()&#123;&#125;</span><br><span class="line">Node(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z):x(x),y(y),z(z)&#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> != (<span class="keyword">const</span> Node&amp; B) <span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> !(x == B.x &amp;&amp; y == B.y &amp;&amp; z == B.z);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> deep;</span><br><span class="line"><span class="function">Node <span class="title">jump</span><span class="params">(Node h, <span class="keyword">int</span> step)</span></span>&#123;</span><br><span class="line"><span class="comment">/*è¿”å›ä»ä½ç½®hå‘ä¸Šè·³stepæ­¥åçš„çŠ¶æ€,é¡ºä¾¿è®°å½•ä¸€ä¸‹å½“å‰æ·±åº¦(è·æ ¹è·ç¦»)*/</span></span><br><span class="line">Node res = h;</span><br><span class="line"><span class="keyword">int</span> t1 = h.y-h.x, t2 = h.z - h.y;</span><br><span class="line"><span class="keyword">if</span>(t1 == t2) <span class="keyword">return</span> res; </span><br><span class="line"><span class="keyword">if</span>(t1 &lt; t2)&#123;</span><br><span class="line"><span class="keyword">int</span> t = min(step,(t2<span class="number">-1</span>)/t1);<span class="comment">//ç”¨é™¤æ³•ä¼˜åŒ– </span></span><br><span class="line">step -= t; deep += t;<span class="comment">//è®°å½•ä¸€ä¸‹æ·±åº¦ </span></span><br><span class="line">res.y += t*t1; res.x += t*t1;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> t = min(step,(t1<span class="number">-1</span>)/t2);</span><br><span class="line">step -= t; deep += t;</span><br><span class="line">res.y -= t*t2; res.z -= t*t2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(step) <span class="keyword">return</span> jump(res,step);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x,Node h1,Node h2)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> !(jump(h1,x) != jump(h2,x));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">3</span>;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">3</span>;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,b+i);</span><br><span class="line">sort(a+<span class="number">1</span>,a+<span class="number">4</span>); sort(b+<span class="number">1</span>,b+<span class="number">4</span>);</span><br><span class="line">Node h1(a[1],a[2],a[3]) , h2(b[1],b[2],b[3]);</span><br><span class="line">Node aa = jump(h1,INF); <span class="keyword">int</span> d1 = deep; deep = <span class="number">0</span>;</span><br><span class="line">Node bb = jump(h2,INF); <span class="keyword">int</span> d2 = deep; deep = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(aa != bb)&#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"NO"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line"><span class="comment">/*è®¡ç®—æ­¥æ•°ï¼šå…ˆè°ƒæ•´åˆ°åŒä¸€æ·±åº¦,å†äºŒåˆ†ä¸€èµ·è·³*/</span></span><br><span class="line"><span class="keyword">if</span>(d1 &lt; d2) swap(d1,d2),swap(h1,h2);</span><br><span class="line">h1 = jump(h1,d1-d2);</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">0</span>, r = d1;</span><br><span class="line"><span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(check(mid,h1,h2)) r = mid<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">else</span> l = mid+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="number">2</span>*l+d1-d2);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> lca </tag>
            
            <tag> æ ‘ä¸Šå€å¢ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ€å°ç”Ÿæˆæ ‘ç›¸å…³é—®é¢˜</title>
      <link href="/2019/10/09/MSTs/"/>
      <url>/2019/10/09/MSTs/</url>
      
        <content type="html"><![CDATA[<p><strong>æ‘˜è¦ï¼š</strong><br>åœ¨å¯¹æœ€å°ç”Ÿæˆæ ‘ç®—æ³•æœ‰ä¸€å®šç†è§£åï¼Œæˆ‘ä»¬å¯¹å…¸å‹çš„æœ€å°ç”Ÿæˆæ ‘é¢˜å‹åº”è¯¥ä¸éš¾è§£å†³ï¼Œä½†æ˜¯å¯¹äºç”±æœ€å°ç”Ÿæˆæ ‘æ¨¡å‹å˜å½¢è€Œæ¥çš„å‡ ç§æ¨¡å‹ï¼Œæˆ‘ä»¬ä»éœ€åšä¸€æ¬¡æ€»ç»“ä¸è®°å½•ã€‚<br>é¦–å…ˆæˆ‘ä»¬éœ€è¦æå‡ºæœ€å°ç”Ÿæˆæ ‘å‡ ä¸ªæ€§è´¨ï¼Œä¾¿äºæ¨å¯¼ç®—æ³•ï¼›ç„¶åæˆ‘ä»¬å°†ä»‹ç»6ç§æœ€å°ç”Ÿæˆæ ‘ç›¸å…³é—®é¢˜æ¨¡å‹ï¼Œå¹¶è®¨è®ºä¸€èˆ¬è§£æ³•ä¸æ›´ä¼˜è§£æ³•ï¼›å…¶ä¸­æœ‰çš„è§£æ³•æ˜¾è€Œæ˜“è§ï¼Œæ¥å—èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œä½†æœ‰çš„è§£æ³•å´éœ€è¦ä»ç†è®ºä¸Šé€»è¾‘ä¸¥å¯†çš„è¿›è¡Œæ¨å¯¼ï¼Œæ„é€ ç®—æ³•å¹¶è¯æ˜ç®—æ³•çš„æ­£ç¡®æ€§ï¼Œè¿™éƒ¨åˆ†éš¾åº¦ç¨å¤§ã€‚<br>è¿™6ä¸ªç›¸å…³é—®é¢˜åˆ†åˆ«æ˜¯ï¼šå¢é‡æœ€å°ç”Ÿæˆæ ‘ï¼Œæœ€å°ç“¶é¢ˆç”Ÿæˆæ ‘ï¼Œæœ€å°ç“¶é¢ˆè·¯ï¼Œæ¯å¯¹èŠ‚ç‚¹çš„æœ€å°ç“¶é¢ˆè·¯ï¼Œæ¬¡å°ç”Ÿæˆæ ‘ï¼Œæœ€å°æœ‰å‘ç”Ÿæˆæ ‘ã€‚</p><h4 id="å›¾è®ºä¸­çš„2ä¸ªæ€§è´¨ï¼š"><a href="#å›¾è®ºä¸­çš„2ä¸ªæ€§è´¨ï¼š" class="headerlink" title="å›¾è®ºä¸­çš„2ä¸ªæ€§è´¨ï¼š"></a>å›¾è®ºä¸­çš„2ä¸ªæ€§è´¨ï¼š</h4><ul><li><strong>åˆ‡å‰²æ€§è´¨ï¼š</strong> å‡å®šæ‰€æœ‰è¾¹æƒå‡ä¸ç›¸åŒã€‚è®¾Sä¸ºæ—¢éç©ºé›†ä¹Ÿéå…¨é›†çš„Vçš„å­é›†ï¼Œè¾¹eæ˜¯æ»¡è¶³ä¸€ä¸ªç«¯ç‚¹åœ¨Så†…ï¼Œå¦ä¸€ä¸ªç«¯ç‚¹ä¸åœ¨Så†…çš„æ‰€æœ‰è¾¹ä¸­æƒå€¼æœ€å°çš„ä¸€ä¸ªï¼Œåˆ™å›¾Gçš„æ‰€æœ‰ç”Ÿæˆæ ‘å‡åŒ…å«eã€‚</li><li><strong>å›è·¯æ€§è´¨ï¼š</strong> å‡å®šæ‰€æœ‰è¾¹æƒå€¼å‡ä¸ç›¸åŒã€‚è®¾Cæ˜¯å›¾Gä¸­ä»»æ„å›è·¯ï¼Œè¾¹eæ˜¯Cä¸Šæƒå€¼æœ€å¤§çš„è¾¹ï¼Œåˆ™å›¾Gçš„æ‰€æœ‰ç”Ÿæˆæ ‘å‡ä¸åŒ…å«eã€‚</li></ul><p>åœ¨æ­¤ä¸ç»™å‡ºè¯æ˜ã€‚</p><h4 id="å¢é‡æœ€å°ç”Ÿæˆæ ‘"><a href="#å¢é‡æœ€å°ç”Ÿæˆæ ‘" class="headerlink" title="å¢é‡æœ€å°ç”Ÿæˆæ ‘"></a>å¢é‡æœ€å°ç”Ÿæˆæ ‘</h4><p><strong>é—®é¢˜æè¿°ï¼š</strong><br>ä»åŒ…å«nä¸ªç‚¹çš„ç©ºå›¾å¼€å§‹ï¼Œä¾æ¬¡åŠ å…¥mæ¡å¸¦æƒè¾¹ã€‚æ¯åŠ å…¥ä¸€æ¡è¾¹ï¼Œè¾“å‡ºå½“å‰å›¾ä¸­çš„æœ€å°ç”Ÿæˆæ ‘æƒå€¼ï¼ˆå¦‚æœå½“å‰å›¾ä¸è¿é€šï¼Œåˆ™è¾“å‡ºæ— è§£ï¼‰ã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>å¦‚æœæ¯æ¬¡é‡æ–°æ±‚å®Œæ•´çš„æœ€å°ç”Ÿæˆæ ‘é—®é¢˜ï¼Œæ€»æ—¶é—´å¤æ‚åº¦é«˜è¾¾O(m^2 log n)ã€‚æ ¹æ®å›è·¯çš„æ€§è´¨ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹æ”¹è¿›ç®—æ³•ï¼š</p><blockquote><p>æ¯æ¬¡æ±‚å‡ºæ–°çš„æœ€å°ç”Ÿæˆæ ‘åï¼ŒæŠŠå…¶å®ƒçš„è¾¹åˆ é™¤ã€‚ç”±äºæ¯æ¬¡åªéœ€è®¡ç®—ä¸€ä¸ªnæ¡è¾¹ï¼ˆåŸç”Ÿæˆæ ‘æœ‰ n - 1æ¡ï¼Œæ–°åŠ å…¥ä¸€æ¡ï¼‰çš„å›¾çš„æœ€å°ç”Ÿæˆæ ‘ï¼ŒKruskalç®—æ³•çš„æ—¶é—´å¤æ‚åº¦é™ä¸ºO(n log n)ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸ºO(nm log n)ã€‚</p></blockquote><p>è¿™ä¸ªç®—æ³•å¯ä»¥è¿›ä¸€æ­¥æ”¹è¿›:</p><blockquote><p>åŠ å…¥ä¸€æ¡è¾¹e = (u, v)ä¹‹åï¼Œå›¾ä¸­æ°å¥½åŒ…å«ä¸€ä¸ªç¯ã€‚æ ¹æ®å›è·¯æ€§è´¨ï¼Œåˆ é™¤è¯¥å›è·¯ä¸Šæƒå€¼æœ€å¤§çš„è¾¹å³å¯ï¼Œå› æ­¤åªéœ€åœ¨åŠ è¾¹ä¹‹å‰çš„MSTä¸Šæ‰¾åˆ°uåˆ°vçš„å”¯ä¸€è·¯å¾„ä¸Šçš„æƒå€¼æœ€å¤§çš„è¾¹ï¼Œå†å’Œeæ¯”è¾ƒï¼Œåˆ é™¤æƒå€¼è¾ƒå¤§çš„ä¸€æ¡ã€‚ç”±äºè·¯å¾„å”¯ä¸€ï¼Œå¯ä»¥ç”¨DFSæˆ–BFSæ‰¾åˆ°è¿™æ¡uåˆ°vçš„è·¯å¾„ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸ºO(nm)ã€‚</p></blockquote><h4 id="æœ€å°ç“¶é¢ˆç”Ÿæˆæ ‘"><a href="#æœ€å°ç“¶é¢ˆç”Ÿæˆæ ‘" class="headerlink" title="æœ€å°ç“¶é¢ˆç”Ÿæˆæ ‘"></a>æœ€å°ç“¶é¢ˆç”Ÿæˆæ ‘</h4><p><strong>é—®é¢˜æè¿°ï¼š</strong><br>ç»™å‡ºåŠ æƒæ— å‘å›¾ï¼Œæ±‚ä¸€æ£µç”Ÿæˆæ ‘ï¼Œä½¿å¾—æœ€å¤§è¾¹æƒå€¼å°½é‡å°ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>ç”±äºåªå…³å¿ƒæœ€å¤§è¾¹æƒå€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸€ä¸ªç©ºå›¾å¼€å§‹ï¼ŒæŒ‰ç…§æƒå€¼ä»å°åˆ°å¤§çš„é¡ºåºä¾æ¬¡åŠ å…¥å„æ¡è¾¹ï¼Œåˆ™å›¾ç¬¬ä¸€æ¬¡è¿é€šæ—¶ï¼Œè¯¥å›¾çš„æœ€å°ç”Ÿæˆæ ‘å°±æ˜¯åŸå›¾çš„æœ€å°ç“¶é¢ˆç”Ÿæˆæ ‘ã€‚å¯ä»¥å‘ç°ï¼ŒåŸå›¾çš„æœ€å°ç”Ÿæˆæ ‘å°±æ˜¯ä¸€æ£µæœ€å°ç“¶é¢ˆç”Ÿæˆæ ‘ï¼ˆä½†ä¸æ˜¯æ¯æ£µæœ€å°ç“¶é¢ˆç”Ÿæˆæ ‘éƒ½æ˜¯æœ€å°ç”Ÿæˆæ ‘ï¼‰ã€‚</p><h4 id="æœ€å°ç“¶é¢ˆè·¯"><a href="#æœ€å°ç“¶é¢ˆè·¯" class="headerlink" title="æœ€å°ç“¶é¢ˆè·¯"></a>æœ€å°ç“¶é¢ˆè·¯</h4><p><strong>é—®é¢˜æè¿°ï¼š</strong><br>ç»™å®šåŠ æƒæ— å‘å›¾çš„ä¸¤ä¸ªèŠ‚ç‚¹uå’Œvï¼Œæ±‚å‡ºä»uåˆ°vçš„ä¸€æ¡è·¯å¾„ï¼Œä½¿å¾—è·¯å¾„ä¸Šæœ€é•¿è¾¹å°½é‡çŸ­ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è¿™ä¸ªé—®é¢˜å¯ä»¥ç”¨äºŒåˆ†æ³•+BFSè§£å†³ï¼Œä½†æˆ‘ä»¬æœ‰æ›´å¥½çš„ç®—æ³•ã€‚å…ˆæ±‚å‡ºè¿™ä¸ªå›¾çš„æœ€å°ç”Ÿæˆæ ‘ï¼Œåˆ™èµ·ç‚¹å’Œç»ˆç‚¹åœ¨æ ‘ä¸Šçš„å”¯ä¸€è·¯å¾„å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„è·¯å¾„ï¼Œè¿™æ¡è·¯å¾„ä¸Šçš„æœ€é•¿è¾¹å°±æ˜¯é—®é¢˜çš„ç­”æ¡ˆã€‚</p><h4 id="æ¯å¯¹ç»“ç‚¹é—´çš„æœ€å°ç“¶é¢ˆè·¯"><a href="#æ¯å¯¹ç»“ç‚¹é—´çš„æœ€å°ç“¶é¢ˆè·¯" class="headerlink" title="æ¯å¯¹ç»“ç‚¹é—´çš„æœ€å°ç“¶é¢ˆè·¯"></a>æ¯å¯¹ç»“ç‚¹é—´çš„æœ€å°ç“¶é¢ˆè·¯</h4><p><strong>é—®é¢˜æè¿°ï¼š</strong><br>ç»™å‡ºåŠ æƒæ— å‘å›¾ï¼Œæ±‚æ¯ä¸¤ä¸ªèŠ‚ç‚¹uå’Œvä¹‹é—´çš„æœ€å°ç“¶é¢ˆè·¯çš„æœ€å¤§è¾¹é•¿f(u,v)ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><blockquote><p>å…ˆæ±‚æœ€å°ç”Ÿæˆæ ‘ã€‚æ¥ä¸‹æ¥ï¼Œç”¨DFSæŠŠæœ€å°ç”Ÿæˆæ ‘å˜æˆæœ‰æ ¹æ ‘ï¼ŒåŒæ—¶è®¡ç®—f(u,v)ï¼Œå½“æ–°è®¿é—®ä¸€ä¸ªèŠ‚ç‚¹uæ—¶ï¼Œè€ƒè™‘æ‰€æœ‰å·²ç»è®¿é—®è¿‡çš„è€èŠ‚ç‚¹xï¼Œæ›´æ–°f(x,u) = max(f(x,v) , w(u,v))ï¼Œå…¶ä¸­væ˜¯uçš„çˆ¶èŠ‚ç‚¹ã€‚æ¯ä¸ªf(u,v)åªéœ€ç»è¿‡å¸¸æ•°æ—¶é—´è®¡ç®—ï¼Œå› æ­¤æ˜¯æ—¶é—´å¤æ‚åº¦ä¸ºO(n^2)ã€‚</p></blockquote><h4 id="æ¬¡å°ç”Ÿæˆæ ‘"><a href="#æ¬¡å°ç”Ÿæˆæ ‘" class="headerlink" title="æ¬¡å°ç”Ÿæˆæ ‘"></a>æ¬¡å°ç”Ÿæˆæ ‘</h4><p><strong>é—®é¢˜æè¿°ï¼š</strong><br>æŠŠæ‰€æœ‰ç”Ÿæˆæ ‘æŒ‰ç…§æƒå€¼ä¹‹å’Œä»å¤§åˆ°å°çš„é¡ºåºæ’åˆ—ï¼Œæ±‚æ’åœ¨ç¬¬äºŒä½çš„ç”Ÿæˆæ ‘ã€‚æ³¨æ„ï¼Œå¦‚æœæœ€å°ç”Ÿæˆæ ‘ä¸å”¯ä¸€ï¼Œæ¬¡å°ç”Ÿæˆæ ‘çš„æƒå€¼ä¸æœ€å°ç”Ÿæˆæ ‘ç›¸åŒã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong> </p><blockquote><p>æ¬¡å°ç”Ÿæˆæ ‘ä¸ä¼šä¸æœ€å°ç”Ÿæˆæ ‘å®Œå…¨ç›¸åŒï¼Œå› æ­¤å¯ä»¥æšä¸¾æœ€å°ç”Ÿæˆæ ‘ä¸­ä¸åœ¨æ¬¡å°ç”Ÿæˆæ ‘ä¸­å‡ºç°çš„è¾¹ã€‚æ³¨æ„æœ€å°ç”Ÿæˆæ ‘åªæœ‰n-1æ¡è¾¹ï¼Œæ‰€ä»¥åªéœ€æšä¸¾n-1æ¬¡ã€‚æ¯æ¬¡åœ¨å‰©ä¸‹çš„è¾¹é‡Œæ±‚ä¸€æ¬¡æœ€å°ç”Ÿæˆæ ‘ï¼Œåˆ™è¿™n-1æ£µâ€œç¼ºä¸€æ¡è¾¹çš„å›¾â€çš„æœ€å°ç”Ÿæˆæ ‘ä¸­æƒæœ€å°çš„å°±æ˜¯åŸå›¾çš„æ¬¡å°ç”Ÿæˆæ ‘ã€‚</p></blockquote><p>è¿˜æœ‰ä¸€ç§æ›´å¥½çš„æ–¹æ³•ï¼š</p><blockquote><p>æšä¸¾è¦åŠ å…¥å“ªæ¡æ–°è¾¹ã€‚åœ¨æœ€å°ç”Ÿæˆæ ‘ä¸ŠåŠ ä¸€æ¡è¾¹u-vä¹‹åï¼Œå›¾ä¸Šä¼šå‡ºç°ä¸€æ¡å›è·¯ï¼Œå› æ­¤åˆ é™¤çš„è¾¹å¿…é¡»åœ¨æœ€å°ç”Ÿæˆæ ‘ä¸Šuåˆ°vçš„è·¯å¾„ä¸Šï¼Œä¸”æ˜¯è¿™æ¡è·¯å¾„ä¸Šçš„æœ€é•¿è¾¹ã€‚å¯ä»¥è¯æ˜ï¼Œæ¬¡å°ç”Ÿæˆæ ‘ä¸€å®šå¯ä»¥ç”±æœ€å°ç”Ÿæˆæ ‘åŠ ä¸€æ¡è¾¹å†åˆ ä¸€æ¡è¾¹å¾—åˆ°ï¼ˆç§°ä¸ºè¾¹äº¤æ¢ï¼‰ï¼Œå› æ­¤åªéœ€æŒ‰ç…§â€œæ¯å¯¹èŠ‚ç‚¹ä¹‹é—´çš„æœ€å°ç“¶é¢ˆè·¯â€çš„æ–¹æ³•æ±‚å‡ºæ¯å¯¹èŠ‚ç‚¹uå’Œvåœ¨æœ€å°ç”Ÿæˆæ ‘ä¸­å”¯ä¸€è·¯å¾„çš„æœ€å¤§è¾¹æƒmaxcost[u][v]ï¼Œåˆ™å‰©ä¸‹çš„éƒ¨åˆ†åªéœ€è¦O(m)æ—¶é—´ï¼ˆæšä¸¾æ‰€æœ‰m-n+1æ¡è¾¹è¿›è¡Œäº¤æ¢ï¼Œæ¯æ¬¡èŠ±O(1)æ—¶é—´æ±‚å‡ºæ–°ç”Ÿæˆæ ‘çš„æƒå€¼ï¼‰ã€‚æ€»æ—¶é—´å¤æ‚åº¦ä¸ºO(n^2)ã€‚</p></blockquote><h4 id="æœ€å°æœ‰å‘ç”Ÿæˆæ ‘"><a href="#æœ€å°æœ‰å‘ç”Ÿæˆæ ‘" class="headerlink" title="æœ€å°æœ‰å‘ç”Ÿæˆæ ‘"></a>æœ€å°æœ‰å‘ç”Ÿæˆæ ‘</h4><p><strong>é—®é¢˜æè¿°ï¼š</strong><br>ç»™å®šä¸€ä¸ªæœ‰å‘å¸¦æƒå›¾Gå’Œå…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹uï¼Œæ‰¾å‡ºä¸€ä¸ªä»¥uä¸ºæ ¹èŠ‚ç‚¹ï¼Œæƒå’Œæœ€å°çš„æœ‰å‘ç”Ÿæˆæ ‘ã€‚æœ‰å‘ç”Ÿæˆæ ‘ï¼ˆdirected spanning treeï¼‰ä¹Ÿå«æ ‘å½¢å›¾ï¼ˆarborescenceï¼‰ï¼Œæ˜¯æŒ‡ä¸€ä¸ªç±»ä¼¼æ ‘çš„æœ‰å‘å›¾ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li>æ°å¥½æœ‰ä¸€ä¸ªå…¥åº¦ä¸º0çš„ç‚¹ï¼Œç§°ä¸ºæ ¹èŠ‚ç‚¹</li><li>å…¶å®ƒèŠ‚ç‚¹çš„å…¥åº¦å‡ä¸º1</li><li>å¯ä»¥ä»æ ¹èŠ‚ç‚¹åˆ°è¾¾å…¶å®ƒæ‰€æœ‰èŠ‚ç‚¹</li></ul><p>ä¸éš¾å‘ç°ï¼Œå¦‚æœæ ‘å½¢å›¾çš„èŠ‚ç‚¹æ•°ä¸ºnï¼Œå®ƒçš„è¾¹æ•°ä¸€å®šä¸ºn-1ï¼Œä¸”æ ‘å½¢å›¾ä¸­ä¸å­˜åœ¨æœ‰å‘ç¯ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>å›ºå®šæ ¹çš„æœ€å°æ ‘å½¢å›¾å¯ä»¥ç”¨æœ±-åˆ˜ç®—æ³•è§£å†³ã€‚</p><blockquote><p>é¦–å…ˆæ˜¯é¢„å¤„ç†ï¼Œåˆ é™¤è‡ªç¯å¹¶åˆ¤æ–­æ ¹èŠ‚ç‚¹æ˜¯å¦å¯ä»¥åˆ°è¾¾å…¶å®ƒæ‰€æœ‰èŠ‚ç‚¹ã€‚å¦‚æœä¸æ˜¯ï¼Œè¾“å‡ºæ— è§£å¹¶ç»ˆæ­¢ç¨‹åºã€‚<br>æ¥ä¸‹æ¥æ˜¯ç®—æ³•çš„ä¸»è¿‡ç¨‹ï¼š<br>é¦–å…ˆï¼Œç»™æ‰€æœ‰éæ ¹èŠ‚ç‚¹é€‰æ‹©ä¸€æ¡æƒæœ€å°çš„å…¥è¾¹ã€‚å¦‚æœé€‰å‡ºæ¥çš„n-1æ¡è¾¹ä¸æ„æˆåœˆï¼Œåˆ™å¯ä»¥è¯æ˜è¿™äº›è¾¹å°±å½¢æˆäº†ä¸€ä¸ªæœ€å°æ ‘å½¢å›¾ï¼Œå¦åˆ™æŠŠæ¯ä¸ªåœˆå„æ”¶ç¼©æˆä¸€ä¸ªç‚¹ï¼Œç»§ç»­ä¸Šè¿°è¿‡ç¨‹ã€‚<br>ç¼©åœˆä¹‹åï¼Œåœˆä¸Šæ‰€æœ‰è¾¹éƒ½æ¶ˆå¤±äº†ï¼Œå› æ­¤åœ¨æœ€ç»ˆç­”æ¡ˆé‡Œéœ€è¦åŠ ä¸Šè¿™äº›è¾¹æƒä¹‹å’Œã€‚ä½†è¿™æ ·åšæœ‰ä¸ªé—®é¢˜ï¼šå‡è®¾åœ¨ç®—æ³•çš„æŸæ¬¡è¿­ä»£ä¸­ï¼ŒæŠŠåœˆCæ”¶ç¼©ä¸ºäººå·¥èŠ‚ç‚¹vï¼Œåˆ™åœ¨ä¸‹ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œç»™vé€‰æ‹©çš„å…¥å¼§å°†ä¸åœ¨åœˆCä¸­çš„å…¥å¼§å‘ç”Ÿå†²çªã€‚ï¼ˆå‡è®¾Xåœ¨åœˆä¸­å·²ç»æœ‰äº†å…¥å¼§Y-&gt;Xï¼‰å› æ­¤å¦‚æœæ”¶ç¼©ä¹‹ååˆé€‰äº†ä¸€ä¸ªå…¥å¼§Z-&gt;Xï¼Œå¿…é¡»æŠŠå¼§Y-&gt;Xä»æœ€å°æ ‘å½¢å›¾ä¸­åˆ é™¤ã€‚è¿™ç­‰ä»·äºæŠŠå¼§Z-&gt;Xçš„æƒå€¼å‡å°‘äº†Y-&gt;Xçš„æƒå€¼ã€‚</p></blockquote><h5 id="å‚è€ƒä¹¦ç›®"><a href="#å‚è€ƒä¹¦ç›®" class="headerlink" title="å‚è€ƒä¹¦ç›®"></a>å‚è€ƒä¹¦ç›®</h5><ul><li>åˆ˜æ±ä½³ï¼Œç®—æ³•ç«èµ›å…¥é—¨ç»å…¸è®­ç»ƒæŒ‡å—ï¼ŒåŒ—äº¬ï¼šæ¸…åå¤§å­¦å‡ºç‰ˆç¤¾ï¼Œ2012ï¼Œ343-344</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ®µæ ‘é¢˜é›†</title>
      <link href="/2019/10/07/segmentTree-problems/"/>
      <url>/2019/10/07/segmentTree-problems/</url>
      
        <content type="html"><![CDATA[<h4 id="åŒºé—´å’Œ"><a href="#åŒºé—´å’Œ" class="headerlink" title="åŒºé—´å’Œ"></a>åŒºé—´å’Œ</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™å®šä¸€æ•°åˆ—ï¼Œè§„å®šæœ‰ä¸¤ç§æ“ä½œï¼Œä¸€æ˜¯ä¿®æ”¹æŸä¸ªå…ƒç´ ï¼ŒäºŒæ˜¯æ±‚åŒºé—´çš„è¿ç»­å’Œã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>çº¿æ®µæ ‘å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢çš„æ¨¡æ¿ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> l,r;</span><br><span class="line">ll dat;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) t[x].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) t[x].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> dat(x) t[x].dat</span></span><br><span class="line">&#125;t[N*<span class="number">4</span>];</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">/*ä¸ºåŒºé—´[l,r]å»ºç«‹ä»¥rtä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘*/</span></span><br><span class="line">l(rt) = l, r(rt) = r,dat(rt) = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">BuildTree(rt*<span class="number">2</span>,l,mid);</span><br><span class="line">BuildTree(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> p,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l(rt) == r(rt))&#123;</span><br><span class="line">dat(rt) += val; <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = l(rt) + r(rt) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(p &lt;= mid) Add(rt*<span class="number">2</span>,p,val);</span><br><span class="line"><span class="keyword">else</span> Add(rt*<span class="number">2</span>+<span class="number">1</span>,p,val);</span><br><span class="line">dat(rt) = dat(rt*<span class="number">2</span>) + dat(rt*<span class="number">2</span>+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l(rt) == l &amp;&amp; r(rt) == r) <span class="keyword">return</span> dat(rt);</span><br><span class="line"><span class="keyword">int</span> mid = l(rt) + r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l &gt; mid) <span class="keyword">return</span> ask(rt*<span class="number">2</span>+<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(r &lt;= mid) <span class="keyword">return</span> ask(rt*<span class="number">2</span>,l,r);</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">return</span> ask(rt*<span class="number">2</span>,l,mid)+ask(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">BuildTree(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,k,a,b;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;k,&amp;a,&amp;b);</span><br><span class="line"><span class="keyword">if</span>(k) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ask(<span class="number">1</span>,a,b));</span><br><span class="line"><span class="keyword">else</span> Add(<span class="number">1</span>,a,b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="A-Simple-Problem-with-Integers"><a href="#A-Simple-Problem-with-Integers" class="headerlink" title="A Simple Problem with Integers"></a>A Simple Problem with Integers</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>è¿™æ˜¯ä¸€é“æ¨¡æ¿é¢˜ã€‚</p><p>ç»™å®šæ•°åˆ— a[1],a[2],â€¦,a[n]ï¼Œä½ éœ€è¦ä¾æ¬¡è¿›è¡Œ q ä¸ªæ“ä½œï¼Œæ“ä½œæœ‰ä¸¤ç±»ï¼š</p><p>C l r xï¼šç»™å®š l,r,xï¼Œå¯¹äºæ‰€æœ‰ iâˆˆ[l,r]ï¼Œå°† a[i] åŠ ä¸Š xï¼ˆæ¢è¨€ä¹‹ï¼Œå°† a[l],a[l+1],â€¦,a[r] åˆ†åˆ«åŠ ä¸Š xï¼‰ï¼›</p><p>Q l rï¼šç»™å®š l,rï¼Œæ±‚ âˆ‘ri=la[i] çš„å€¼ï¼ˆæ¢è¨€ä¹‹ï¼Œæ±‚ a[l]+a[l+1]+â‹¯+a[r] çš„å€¼ï¼‰ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>è¿™é¢˜ä¹Ÿæ˜¯POJ3468ã€‚å¯ä»¥ç”¨å¾ˆå¤šç§æ–¹æ³•è§£å†³ï¼Œæ˜¯ä¸ªç»ƒæ‰‹çš„æ¨¡æ¿é¢˜ã€‚çº¿æ®µæ ‘åŒºé—´ä¿®æ”¹+åŒºé—´æŸ¥è¯¢ï¼Œå»¶è¿Ÿæ ‡è®°çš„ç®€å•ä½¿ç”¨ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> l,r;</span><br><span class="line">ll sum,add;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) t[x].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) t[x].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(x) t[x].sum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> add(x) t[x].add</span></span><br><span class="line">&#125;t[N*<span class="number">4</span>];</span><br><span class="line"><span class="keyword">int</span> n,m,a[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">l(rt) = l, r(rt) = r;</span><br><span class="line"><span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">sum(rt) = a[l]; <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">BuildTree(rt*<span class="number">2</span>,l,mid); BuildTree(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">sum(rt) = sum(rt*<span class="number">2</span>) + sum(rt*<span class="number">2</span>+<span class="number">1</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spread</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å°†å»¶è¿Ÿæ ‡è®°å‘ä¸‹ä¼ ä¸€å±‚*/</span></span><br><span class="line"><span class="keyword">if</span>(!add(p)) <span class="keyword">return</span>;</span><br><span class="line">sum(p*<span class="number">2</span>) += (r(p*<span class="number">2</span>)-l(p*<span class="number">2</span>)+<span class="number">1</span>)*add(p);</span><br><span class="line">sum(p*<span class="number">2</span>+<span class="number">1</span>) += (r(p*<span class="number">2</span>+<span class="number">1</span>)-l(p*<span class="number">2</span>+<span class="number">1</span>)+<span class="number">1</span>)*add(p);</span><br><span class="line">add(p*<span class="number">2</span>) += add(p); add(p*<span class="number">2</span>+<span class="number">1</span>) += add(p);</span><br><span class="line">add(p) = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line"><span class="comment">/*[l,r]å†…æ‰€æœ‰ä½ç½®ä¸Šå…ƒç´ éƒ½+val*/</span> </span><br><span class="line"><span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r)&#123;</span><br><span class="line">sum(rt) += (r(rt)-l(rt)+<span class="number">1</span>)*val;</span><br><span class="line">add(rt) += val; <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">spread(rt);</span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) change(rt*<span class="number">2</span>,l,r,val);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) change(rt*<span class="number">2</span>+<span class="number">1</span>,l,r,val);</span><br><span class="line">sum(rt) = sum(rt*<span class="number">2</span>) + sum(rt*<span class="number">2</span>+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å›ç­”[l,r]åŒºé—´å’Œ*/</span> </span><br><span class="line"><span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r) <span class="keyword">return</span> sum(rt);</span><br><span class="line">spread(rt); ll res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) res += ask(rt*<span class="number">2</span>,l,r);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) res += ask(rt*<span class="number">2</span>+<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c != <span class="string">'-'</span> &amp;&amp; (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) ans = ans*<span class="number">10</span>+c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg?-ans:ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line">n = getInt(); m = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) a[i] = getInt();</span><br><span class="line">BuildTree(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="keyword">char</span> op[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,l,r,x;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,op);</span><br><span class="line"><span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">'C'</span>)&#123;</span><br><span class="line">l = getInt(); r = getInt(); x = getInt();</span><br><span class="line">change(<span class="number">1</span>,l,r,x);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">l = getInt(); r = getInt();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ask(<span class="number">1</span>,l,r));</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="æœ€å¤§æ•°"><a href="#æœ€å¤§æ•°" class="headerlink" title="æœ€å¤§æ•°"></a>æœ€å¤§æ•°</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šJSOI 2008</p><p>ç»™å®šä¸€ä¸ªæ­£æ•´æ•°æ•°åˆ— a1,a2,a3,â‹¯,an ï¼Œæ¯ä¸€ä¸ªæ•°éƒ½åœ¨ 0âˆ¼pâ€“1 ä¹‹é—´ã€‚å¯ä»¥å¯¹è¿™åˆ—æ•°è¿›è¡Œä¸¤ç§æ“ä½œï¼š</p><p>æ·»åŠ æ“ä½œï¼šå‘åºåˆ—åæ·»åŠ ä¸€ä¸ªæ•°ï¼Œåºåˆ—é•¿åº¦å˜æˆ n+1ï¼›</p><p>è¯¢é—®æ“ä½œï¼šè¯¢é—®è¿™ä¸ªåºåˆ—ä¸­æœ€å L ä¸ªæ•°ä¸­æœ€å¤§çš„æ•°æ˜¯å¤šå°‘ã€‚</p><p>ç¨‹åºè¿è¡Œçš„æœ€å¼€å§‹ï¼Œæ•´æ•°åºåˆ—ä¸ºç©ºã€‚å†™ä¸€ä¸ªç¨‹åºï¼Œè¯»å…¥æ“ä½œçš„åºåˆ—ï¼Œå¹¶è¾“å‡ºè¯¢é—®æ“ä½œçš„ç­”æ¡ˆã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>å› ä¸ºæœ€å¤šæœ‰Nä¸ªæ•°ï¼Œé‚£ä¹ˆå…ˆæ ¹æ®[1 , N]å»ºç«‹çº¿æ®µæ ‘ï¼Œæå‰æŠŠä½ç½®ç©ºå‡ºæ¥å°±å¥½äº†ï¼ŒnowæŒ‡é’ˆè®°å½•æœ€åä¸€ä¸ªä½ç½®ï¼Œæ¯æ¬¡æŠŠæ–°åŠ å…¥çš„å…ƒç´ æ’å…¥++nowï¼Œè€Œè¯¢é—®æœ€åLä¸ªæ•°çš„æœ€å¤§å€¼ï¼Œåˆ™ç”¨ask(now - L , now)æ¥æŸ¥è¯¢å³å¯ï¼Œå…¶å®ƒçš„å°±æ˜¯çº¿æ®µæ ‘ä¸Šç»´æŠ¤åŒºé—´æœ€å¤§å€¼ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> l,r;</span><br><span class="line">ll mx;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) t[x].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) t[x].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mx(x) t[x].mx</span></span><br><span class="line">&#125;t[N*<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">l(rt) = l, r(rt) = r, mx(rt) = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">BuildTree(rt*<span class="number">2</span>,l,mid); BuildTree(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> p,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l(rt) == r(rt))&#123;</span><br><span class="line">mx(rt) = val; <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(p &gt; mid) change(rt*<span class="number">2</span>+<span class="number">1</span>,p,val);</span><br><span class="line"><span class="keyword">else</span> change(rt*<span class="number">2</span>,p,val);</span><br><span class="line">mx(rt) = max(mx(rt*<span class="number">2</span>),mx(rt*<span class="number">2</span>+<span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r) <span class="keyword">return</span> mx(rt);</span><br><span class="line"><span class="keyword">int</span> mid = l(rt) + r(rt)&gt;&gt;<span class="number">1</span> , res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) res = ask(rt*<span class="number">2</span>,l,r);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) res = max(res,ask(rt*<span class="number">2</span>+<span class="number">1</span>,l,r));</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> m,p,ans,now;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;m,&amp;p);</span><br><span class="line">BuildTree(<span class="number">1</span>,<span class="number">1</span>,N<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">char</span> op[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s%d"</span>,op,&amp;x);</span><br><span class="line"><span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">'A'</span>) change(<span class="number">1</span>,++now,(x*<span class="number">1l</span>l+ans)%p);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans = ask(<span class="number">1</span>,now-x+<span class="number">1</span>,now));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="èŠ±ç¥æ¸¸å†å„å›½"><a href="#èŠ±ç¥æ¸¸å†å„å›½" class="headerlink" title="èŠ±ç¥æ¸¸å†å„å›½*"></a>èŠ±ç¥æ¸¸å†å„å›½*</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šBZOJ 3211</p><p>èŠ±ç¥å–œæ¬¢æ­¥è¡Œæ¸¸å†å„å›½ï¼Œé¡ºä¾¿è™çˆ†å„åœ°ç«èµ›ã€‚èŠ±ç¥æœ‰ä¸€æ¡æ¸¸è§ˆè·¯çº¿ï¼Œå®ƒæ˜¯çº¿å‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰æ¸¸å†å›½å®¶å‘ˆä¸€æ¡çº¿çš„å½¢çŠ¶æ’åˆ—ï¼ŒèŠ±ç¥å¯¹æ¯ä¸ªå›½å®¶éƒ½æœ‰ä¸€ä¸ªå–œæ¬¢ç¨‹åº¦ï¼ˆå½“ç„¶èŠ±ç¥å¹¶ä¸ä¸€å®šå–œæ¬¢æ‰€æœ‰å›½å®¶ï¼‰ã€‚</p><p>æ¯ä¸€æ¬¡æ—…è¡Œä¸­ï¼ŒèŠ±ç¥ä¼šé€‰æ‹©ä¸€æ¡æ—…æ¸¸è·¯çº¿ï¼Œå®ƒåœ¨é‚£ä¸€ä¸²å›½å®¶ä¸­æ˜¯è¿ç»­çš„ä¸€æ®µï¼Œè¿™æ¬¡æ—…è¡Œå¸¦æ¥çš„å¼€å¿ƒå€¼æ˜¯è¿™äº›å›½å®¶çš„å–œæ¬¢åº¦çš„æ€»å’Œï¼Œå½“ç„¶èŠ±ç¥å¯¹è¿™äº›å›½å®¶çš„å–œæ¬¢ç¨‹åºå¹¶ä¸æ˜¯æ’å®šçš„ï¼Œæœ‰æ—¶ä¼šçªç„¶å¯¹æŸäº›å›½å®¶äº§ç”Ÿåæ„Ÿï¼Œä½¿ä»–å¯¹è¿™äº›å›½å®¶çš„å–œæ¬¢åº¦ Î´ å˜ä¸º $\sqrtÎ´$ï¼ˆå¯èƒ½æ˜¯èŠ±ç¥è™çˆ†äº†é‚£äº›å›½å®¶çš„ OIï¼Œä»è€Œæ„Ÿåˆ°ä¹å‘³ï¼‰ã€‚</p><p>ç°åœ¨ç»™å‡ºèŠ±ç¥æ¯æ¬¡çš„æ—…è¡Œè·¯çº¿ï¼Œä»¥åŠå¼€å¿ƒåº¦çš„å˜åŒ–ï¼Œè¯·æ±‚å‡ºèŠ±ç¥æ¯æ¬¡æ—…è¡Œçš„å¼€å¿ƒå€¼ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æˆ‘åˆšå¼€å§‹æƒ³çš„æ˜¯å¦‚ä½•æŠŠä¿®æ”¹å»¶è¿Ÿï¼Œä½†æ˜¯åæ¥å‘ç°ä¸å¤ªå®¹æ˜“å®ç°ã€‚å¾ˆå®¹æ˜“çš„å‘ç°çš„å°±æ˜¯1e9å¼€æ ¹10æ¬¡åå°±æ˜¯1äº†ï¼ˆå½“ç„¶è¿˜æœ‰ä¸‹å–æ•´ï¼‰ï¼Œæ‰€ä»¥é¢˜ç›®èŒƒå›´å†…æ‰€æœ‰æ•°æœ€å¤šå¼€æ ¹10æ¬¡å°±ä¼šå˜æˆ1æˆ–0ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è®°å½•æ¯ä¸ªç‚¹è¢«ä¿®æ”¹äº†å¤šå°‘æ¬¡ï¼Œå¦‚æœå·²ç»ä¿®æ”¹äº†10æ¬¡ä»¥ä¸Šï¼Œé‚£ä¹ˆå†ä¿®æ”¹ä¹Ÿæ— æ„ä¹‰äº†ã€‚<br>äºæ˜¯æˆ‘ä»¬å¯ä»¥æ¯æ¬¡ä¿®æ”¹éƒ½ä¿®æ”¹åˆ°å¶å­èŠ‚ç‚¹ï¼ˆå› ä¸ºæ— æ³•å»¶è¿Ÿæˆ–æ•´æ®µä¿®æ”¹ï¼‰ï¼ŒåŒæ—¶è®°å½•æ¯ä¸ªèŠ‚ç‚¹è¢«ä¿®æ”¹äº†å¤šå°‘æ¬¡ï¼Œå¦‚æœä¸€æ®µåŒºé—´ä¿®æ”¹æ¬¡æ•°æœ€å°çš„èŠ‚ç‚¹éƒ½ä¿®æ”¹äº†10æ¬¡ï¼Œé‚£ä¹ˆè¿™ä¸€æ®µåŒºé—´å°±éƒ½ä¸ç”¨ä¿®æ”¹äº†ï¼›è¿™å°±ä¼šå¤§å¤§é™ä½æ—¶é—´å¤æ‚åº¦ï¼Œå› ä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹æœ€å¤šè¢«ä¿®æ”¹10æ¬¡ï¼ŒO(10NlogN)ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> l,r,mi;</span><br><span class="line">ll sum;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) t[x].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) t[x].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mi(x) t[x].mi</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(x) t[x].sum</span></span><br><span class="line">&#125;t[N*<span class="number">4</span>];</span><br><span class="line"><span class="keyword">int</span> n,m,a[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">l(rt) = l,r(rt) = r,mi(rt) = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">sum(rt) = a[l]; <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">BuildTree(rt*<span class="number">2</span>,l,mid); BuildTree(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">sum(rt) = sum(rt*<span class="number">2</span>) + sum(rt*<span class="number">2</span>+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(mi(rt) &gt; <span class="number">10</span>) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(l(rt) == r(rt))&#123;</span><br><span class="line">sum(rt) = a[l(rt)] = <span class="built_in">sqrt</span>(a[l(rt)]); </span><br><span class="line">mi(rt)++; <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = l(rt) + r(rt) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) change(rt*<span class="number">2</span>,l,r);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) change(rt*<span class="number">2</span>+<span class="number">1</span>,l,r);</span><br><span class="line">sum(rt) = sum(rt*<span class="number">2</span>) + sum(rt*<span class="number">2</span>+<span class="number">1</span>);</span><br><span class="line">mi(rt) = min(mi(rt*<span class="number">2</span>),mi(rt*<span class="number">2</span>+<span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r) <span class="keyword">return</span> sum(rt);</span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>; ll res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) res += ask(rt*<span class="number">2</span>,l,r);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) res += ask(rt*<span class="number">2</span>+<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">BuildTree(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,op,l,r;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;op,&amp;l,&amp;r);</span><br><span class="line"><span class="keyword">if</span>(op == <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ask(<span class="number">1</span>,l,r));</span><br><span class="line"><span class="keyword">else</span> change(<span class="number">1</span>,l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ç»´æŠ¤åºåˆ—"><a href="#ç»´æŠ¤åºåˆ—" class="headerlink" title="ç»´æŠ¤åºåˆ—*"></a>ç»´æŠ¤åºåˆ—*</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šAHOI 2009</p><p>è€å¸ˆäº¤ç»™å°å¯å¯ä¸€ä¸ªç»´æŠ¤æ•°åˆ—çš„ä»»åŠ¡ï¼Œç°åœ¨å°å¯å¯å¸Œæœ›ä½ æ¥å¸®ä»–å®Œæˆã€‚</p><p>æœ‰é•¿ä¸º n çš„æ•°åˆ—ï¼Œä¸å¦¨è®¾ä¸º a1,a2,â‹¯,an ã€‚æœ‰å¦‚ä¸‹ä¸‰ç§æ“ä½œå½¢å¼ï¼š</p><p>æŠŠæ•°åˆ—ä¸­çš„ä¸€æ®µæ•°å…¨éƒ¨ä¹˜ä¸€ä¸ªå€¼ï¼›</p><p>æŠŠæ•°åˆ—ä¸­çš„ä¸€æ®µæ•°å…¨éƒ¨åŠ ä¸€ä¸ªå€¼ï¼›</p><p>è¯¢é—®æ•°åˆ—ä¸­çš„ä¸€æ®µæ•°çš„å’Œï¼Œç”±äºç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œä½ åªéœ€è¾“å‡ºè¿™ä¸ªæ•°æ¨¡ P çš„å€¼ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>è¿™ä¸ªå¦‚æœä¿®æ”¹æ“ä½œåªæœ‰ 2 æˆ– 1ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªåŒºé—´ä¿®æ”¹-å»¶è¿Ÿæ ‡è®°çš„æ¨¡æ¿é¢˜ï¼Œä½†æ˜¯å®ƒæŠŠâ€œä¹˜â€å’Œâ€œåŠ â€æ“ä½œæ”¾åœ¨äº†ä¸€èµ·ï¼Œå½“ç„¶è¿˜æ˜¯éœ€è¦ç”¨å»¶è¿Ÿæ ‡è®°æ¥åšï¼Œaddè¡¨ç¤ºå¾…åŠ ä¸Šçš„å€¼ï¼Œmulè¡¨ç¤ºå¾…ä¹˜çš„å€¼ã€‚<br>æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨å‘ä¸‹ä¼ é€’å»¶è¿Ÿæ ‡è®°æ—¶ï¼Œæ˜¯å…ˆä¼ é€’åŠ æ³•å‘¢ï¼Œè¿˜æ˜¯ä¹˜æ³•å‘¢ï¼Ÿå…¶å®é—®é¢˜çš„æ ¹æºä¸åœ¨è¿™ï¼Œè€Œåœ¨äºæˆ‘ä»¬åœ¨åšä¹˜æ³•æ—¶ï¼Œå¯¹åŠ æ³•çš„å»¶è¿Ÿæ ‡è®°ä¹Ÿè¦ä¹˜ valï¼Œå³ add = add * valï¼Œå› ä¸ºæ»¡è¶³ç»“åˆå¾‹ã€‚æå®Œè¿™ç‚¹å‰©ä¸‹å°±æ˜¯å†™èµ·æ¥æ¯”è¾ƒéº»çƒ¦è€Œå·²ï¼Œæ²¡åˆ«çš„éš¾ç‚¹äº†</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> l,r;</span><br><span class="line">ll add,mul,sum;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) t[x].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) t[x].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mul(x) t[x].mul</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> add(x) t[x].add</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(x) t[x].sum</span></span><br><span class="line">&#125;t[N*<span class="number">4</span>];</span><br><span class="line"><span class="keyword">int</span> n,m,P;</span><br><span class="line">ll a[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">l(rt) = l, r(rt) = r, add(rt) = <span class="number">0</span>, mul(rt) = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">sum(rt) = a[l]; <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">BuildTree(rt*<span class="number">2</span>,l,mid); BuildTree(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">sum(rt) = sum(rt*<span class="number">2</span>) + sum(rt*<span class="number">2</span>+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spread_add</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å°†ç´¯åŠ æ ‡è®°å‘ä¸‹ä¼ ä¸€å±‚*/</span></span><br><span class="line"><span class="keyword">if</span>(!add(p)) <span class="keyword">return</span>;</span><br><span class="line">sum(p*<span class="number">2</span>) = (sum(p*<span class="number">2</span>) + (r(p*<span class="number">2</span>) - l(p*<span class="number">2</span>)+<span class="number">1</span>)*add(p)%P)%P;</span><br><span class="line">sum(p*<span class="number">2</span>+<span class="number">1</span>) = (sum(p*<span class="number">2</span>+<span class="number">1</span>) + (r(p*<span class="number">2</span>+<span class="number">1</span>) - l(p*<span class="number">2</span>+<span class="number">1</span>)+<span class="number">1</span>)*add(p)%P)%P;</span><br><span class="line">add(p*<span class="number">2</span>) = (add(p*<span class="number">2</span>) + add(p))%P; </span><br><span class="line">add(p*<span class="number">2</span>+<span class="number">1</span>) = (add(p*<span class="number">2</span>+<span class="number">1</span>)+add(p))%P; </span><br><span class="line">add(p) = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spread_mul</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å°†ç´¯ä¹˜æ ‡è®°å‘ä¸‹ä¼ ä¸€å±‚,ç´¯ä¹˜æ ‡è®°å¯¹ç´¯åŠ æ ‡è®°ä¹Ÿæœ‰å½±å“*/</span> </span><br><span class="line"><span class="keyword">if</span>(mul(p) == <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">sum(p*<span class="number">2</span>) = sum(p*<span class="number">2</span>)*mul(p)%P;</span><br><span class="line">sum(p*<span class="number">2</span>+<span class="number">1</span>) = sum(p*<span class="number">2</span>+<span class="number">1</span>)*mul(p)%P;</span><br><span class="line">mul(p*<span class="number">2</span>) = mul(p*<span class="number">2</span>)*mul(p)%P;</span><br><span class="line">mul(p*<span class="number">2</span>+<span class="number">1</span>) = mul(p*<span class="number">2</span>+<span class="number">1</span>)*mul(p)%P;</span><br><span class="line"><span class="comment">/*æ›´æ–°addæ ‡è®°*/</span> </span><br><span class="line">add(p*<span class="number">2</span>) = add(p*<span class="number">2</span>)*mul(p)%P;</span><br><span class="line">add(p*<span class="number">2</span>+<span class="number">1</span>) = add(p*<span class="number">2</span>+<span class="number">1</span>)*mul(p)%P; </span><br><span class="line">mul(p) = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,ll val)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r)&#123;</span><br><span class="line">add(rt) = add(rt)*val%P;<span class="comment">//æ›´æ–°addæ ‡è®°ï¼ </span></span><br><span class="line">sum(rt) = sum(rt)*val%P;</span><br><span class="line">mul(rt) = mul(rt)*val%P;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">spread_mul(rt);spread_add(rt); </span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) Mul(rt*<span class="number">2</span>,l,r,val);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) Mul(rt*<span class="number">2</span>+<span class="number">1</span>,l,r,val);</span><br><span class="line">sum(rt) = (sum(rt*<span class="number">2</span>) + sum(rt*<span class="number">2</span>+<span class="number">1</span>))%P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,ll val)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r)&#123;</span><br><span class="line">sum(rt) = (sum(rt) + (r(rt)-l(rt)+<span class="number">1</span>)*val % P)%P;</span><br><span class="line">add(rt) = (add(rt)+val)%P; <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">spread_mul(rt); spread_add(rt);</span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) Add(rt*<span class="number">2</span>,l,r,val);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) Add(rt*<span class="number">2</span>+<span class="number">1</span>,l,r,val);</span><br><span class="line">sum(rt) = (sum(rt*<span class="number">2</span>) + sum(rt*<span class="number">2</span>+<span class="number">1</span>))%P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= l(rt) &amp;&amp; r(rt) &lt;= r) <span class="keyword">return</span> sum(rt)%P;</span><br><span class="line">spread_mul(rt); spread_add(rt) ;</span><br><span class="line">ll res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) res += ask(rt*<span class="number">2</span>,l,r);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) res += ask(rt*<span class="number">2</span>+<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">return</span> res%P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;P);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,a+i), a[i] %= P;</span><br><span class="line">BuildTree(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,op,t,g,c;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;op);</span><br><span class="line"><span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;t,&amp;g,&amp;c);</span><br><span class="line">Mul(<span class="number">1</span>,t,g,c);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;t,&amp;g,&amp;c);</span><br><span class="line">Add(<span class="number">1</span>,t,g,c);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;t,&amp;g);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ask(<span class="number">1</span>,t,g));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ç»´RMQé—®é¢˜é¢˜é›†</title>
      <link href="/2019/10/07/st-problems/"/>
      <url>/2019/10/07/st-problems/</url>
      
        <content type="html"><![CDATA[<p><a href="http://ybt.ssoier.cn:8088/index.php" target="_blank" rel="noopener">ä¹¦æœ¬é…å¥—OJ</a><br><a href="http://www.mfstem.org/" target="_blank" rel="noopener">æœ¬æ ¡OJ</a></p><p>STè¡¨ä½¿ç”¨è¯´æ˜ï¼š</p><ul><li>å¸¸ç”¨äºç¦»çº¿é—®é¢˜ï¼Œæˆ–å½“ä½œè¾…åŠ©æ•°æ®ç»“æ„ï¼ŒæŸ¥è¯¢æ—¶é—´éå¸¸ä¼˜ç§€ï¼ŒO(1)</li><li>äºŒç»´stè¡¨ä¹Ÿå¾ˆå¥½å®ç°ï¼Œä¸è¿‡æœ¬é¢˜é›†ä¸­æœªæ¶‰åŠ</li><li>stè¡¨å†…ä¹Ÿå¯ä»¥ç»´æŠ¤çš„æ˜¯ä¸‹æ ‡è€Œéå€¼ï¼Œåœ¨æŸäº›æ—¶å€™å¾ˆæœ‰ç”¨</li></ul><h4 id="æ•°åˆ—åŒºé—´æœ€å¤§å€¼"><a href="#æ•°åˆ—åŒºé—´æœ€å¤§å€¼" class="headerlink" title="æ•°åˆ—åŒºé—´æœ€å¤§å€¼"></a>æ•°åˆ—åŒºé—´æœ€å¤§å€¼</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>è¾“å…¥ä¸€ä¸²æ•°å­—ï¼Œç»™ä½  M ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®å°±ç»™ä½ ä¸¤ä¸ªæ•°å­— X,Yï¼Œè¦æ±‚ä½ è¯´å‡º X åˆ° Y è¿™æ®µåŒºé—´å†…çš„æœ€å¤§æ•°ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>stè¡¨æ¨¡æ¿é¢˜ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> st[N][<span class="number">22</span>] ,Log[N];</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c!=<span class="string">'-'</span> &amp;&amp; (c &lt;<span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>,c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) ans = ans*<span class="number">10</span>+c-<span class="string">'0'</span>,c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg?-ans:ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n+<span class="number">1</span>;i++) Log[i]= Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) st[i][<span class="number">0</span>] = a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j) &lt;= n;j++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>) &lt;= n;i++)&#123;</span><br><span class="line">st[i][j] = max(st[i][j<span class="number">-1</span>],st[i+(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = Log[r-l+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> max(st[l][k],st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line">n = getInt(); m = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) a[i] = getInt();</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line">x = getInt(); y = getInt();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(x,y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="æœ€æ•æ·çš„æœºå™¨äºº"><a href="#æœ€æ•æ·çš„æœºå™¨äºº" class="headerlink" title="æœ€æ•æ·çš„æœºå™¨äºº"></a>æœ€æ•æ·çš„æœºå™¨äºº</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>Wind è®¾è®¡äº†å¾ˆå¤šæœºå™¨äººã€‚ä½†æ˜¯å®ƒä»¬éƒ½è®¤ä¸ºè‡ªå·±æ˜¯æœ€å¼ºçš„ï¼Œäºæ˜¯ï¼Œä¸€åœºæ¯”èµ›å¼€å§‹äº†â€¦â€¦</p><p>æœºå™¨äººä»¬éƒ½æƒ³çŸ¥é“è°æ˜¯æœ€æ•æ·çš„ï¼Œäºæ˜¯å®ƒä»¬è¿›è¡Œäº†å¦‚ä¸‹ä¸€ä¸ªæ¯”èµ›ã€‚é¦–å…ˆï¼Œä»–ä»¬é¢å‰ä¼šæœ‰ä¸€æ’å…± n ä¸ªæ•°ï¼Œå®ƒä»¬æ¯”èµ›çœ‹è°èƒ½æœ€å…ˆæŠŠæ¯è¿ç»­ k ä¸ªæ•°ä¸­æœ€å¤§å’Œæœ€å°å€¼å†™ä¸‹æ¥ï¼Œå½“ç„¶ï¼Œè¿™äº›æœºå™¨äººè¿ç®—é€Ÿåº¦éƒ½å¾ˆå¿«ï¼Œå®ƒä»¬æ¯”èµ›çš„æ˜¯è°å†™å¾—å¿«ã€‚</p><p>ä½†æ˜¯ Wind ä¹Ÿæƒ³çŸ¥é“ç­”æ¡ˆï¼Œä½ èƒ½å¸®åŠ©ä»–å—ï¼Ÿ<br><strong>è§£é¢˜æ€è·¯</strong><br>stè¡¨æ¨¡æ¿é¢˜ï¼Œä¸è¿‡è¿˜è¦ç»´æŠ¤ä¸€ä¸‹æœ€å°å€¼ï¼Œå¤šå¼€ä¸€ä¸ªæ•°ç»„å³å¯ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> st[N][<span class="number">22</span>] ,Log[N], st2[N][<span class="number">22</span>];</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c!=<span class="string">'-'</span> &amp;&amp; (c &lt;<span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>,c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) ans = ans*<span class="number">10</span>+c-<span class="string">'0'</span>,c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg?-ans:ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n+<span class="number">1</span>;i++) Log[i]= Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) st2[i][<span class="number">0</span>] = st[i][<span class="number">0</span>] = a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j) &lt;= n;j++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>) &lt;= n;i++)&#123;</span><br><span class="line">st[i][j] = max(st[i][j<span class="number">-1</span>],st[i+(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)][j<span class="number">-1</span>]);</span><br><span class="line">st2[i][j] = min(st2[i][j<span class="number">-1</span>],st2[i+(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = Log[r-l+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> mx = max(st[l][k],st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line"><span class="keyword">int</span> mi = min(st2[l][k],st2[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,mx,mi);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line">n = getInt(); m = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) a[i] = getInt();</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n-m+<span class="number">1</span>;i++) ask(i,i+m<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ä¸ä¼—ä¸åŒ"><a href="#ä¸ä¼—ä¸åŒ" class="headerlink" title="ä¸ä¼—ä¸åŒ*"></a>ä¸ä¼—ä¸åŒ*</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>A æ˜¯æŸå…¬å¸çš„ CEOï¼Œæ¯ä¸ªæœˆéƒ½ä¼šæœ‰å‘˜å·¥æŠŠå…¬å¸çš„ç›ˆåˆ©æ•°æ®é€ç»™ Aï¼ŒA æ˜¯ä¸ªä¸ä¼—ä¸åŒçš„æ€ªäººï¼ŒA ä¸æ³¨é‡ç›ˆåˆ©è¿˜æ˜¯äºæœ¬ï¼Œè€Œæ˜¯å–œæ¬¢ç ”ç©¶ã€Œå®Œç¾åºåˆ—ã€ï¼šä¸€æ®µè¿ç»­çš„åºåˆ—æ»¡è¶³åºåˆ—ä¸­çš„æ•°äº’ä¸ç›¸åŒã€‚<br>A æƒ³çŸ¥é“åŒºé—´ [L,R] ä¹‹é—´æœ€é•¿çš„å®Œç¾åºåˆ—é•¿åº¦ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ ‡è®°æ•°ç»„åœ¨O(N)æ—¶é—´å†…æ±‚å‡ºæ¯ä¸ªä½ç½®â€œä½œä¸ºç»“æŸä½ç½®â€æ—¶çš„æœ€é•¿å®Œç¾åºåˆ—é•¿åº¦ï¼Œä»¥åŠå®ƒçš„èµ·ç‚¹ã€‚<br>è®¾last[ x ] è¡¨ç¤º x ä¸Šæ¬¡å‡ºç°çš„ä½ç½®ï¼›bgn[ p ]è¡¨ç¤ºä»¥ä½ç½® p ä¸ºæœ«å°¾çš„å®Œç¾åºåˆ—çš„èµ·ç‚¹ä½ç½®ï¼›len[p] è¡¨ç¤ºä»¥ä½ç½® p ä¸ºæœ«å°¾çš„å®Œç¾åºåˆ—çš„é•¿åº¦ã€‚æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥åœ¨ä¸€æ¬¡éå†å†…æ›´æ–°å®Œæ¯•ä¸Šè¿°ä¸‰ä¸ªæ•°ç»„ï¼ŒO(N)ã€‚<br>é‚£ä¹ˆå¯¹äºä»»æ„åŒºé—´[ L , R ]ï¼Œå…¶å†…çš„æœ€é•¿å®Œç¾åºåˆ—é•¿åº¦ä»…æœ‰ 2 ç§å¯èƒ½ï¼Œä¸€ç§æ˜¯ç»ˆç‚¹åœ¨åŒºé—´å†…ï¼Œèµ·ç‚¹ä¸åœ¨ï¼›å¦ä¸€ç§æ˜¯èµ·ç‚¹å’Œç»ˆç‚¹éƒ½åœ¨åŒºé—´å†…ã€‚æ­¤æ—¶æˆ‘ä»¬å·²ç»å¯ä»¥é€šè¿‡ä¸€æ¬¡éå†æ¥æ±‚ç­”æ¡ˆäº†ï¼Œä½†æ˜¯å¤æ‚åº¦æœ€å·®O(N)ï¼Œä¸å¯å–ã€‚ç”±äºbgn[]æ˜¯å•è°ƒé€’å¢çš„ï¼Œæ‰€ä»¥å¯¹äºæŸä¸ªä½ç½® posï¼Œ[ L , pos-1] æ‰€æœ‰ä½ç½®ä¸Šçš„èµ·ç‚¹éƒ½å°äº Lï¼Œ[pos , R]ä¸Šæ‰€æœ‰ä½ç½®ä¸Šçš„èµ·ç‚¹éƒ½å¤§äºLï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡STè¡¨ç»´æŠ¤ [pos ,R] ä¸Šçš„æœ€å¤§çš„ len å€¼ï¼Œåœ¨O(1)æ—¶é—´å†…æ±‚å‡ºï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯max(pos-L , ask(pos , R) )ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡äºŒåˆ†æœç´¢æ¥æŸ¥æ‰¾ pos ,å¤æ‚åº¦ O(log N)ï¼Œæ ¹æ®lenæ•°ç»„æ„é€ stè¡¨ï¼ŒO(NlogN)ï¼Œæ€»æ—¶é—´å¤æ‚åº¦O( (N+M)logN )ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">2e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> B = <span class="number">1e6</span>;</span><br><span class="line"><span class="comment">/*last[x]ä¸ºxä¸Šä¸€æ¬¡å‡ºç°çš„ä½ç½®;</span></span><br><span class="line"><span class="comment">bgn[p]ä¸ºä»¥ä½ç½®pç»“å°¾çš„èµ·ç‚¹ä½ç½®;len[p]ä¸ºä»¥pç»“å°¾çš„å®Œç¾åºåˆ—é•¿åº¦*/</span></span><br><span class="line"><span class="keyword">int</span> last[SZ],bgn[N],len[N];</span><br><span class="line"><span class="keyword">int</span> a[N],Log[N],st[N][<span class="number">22</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_st</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n+<span class="number">1</span>;i++) Log[i] = Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) st[i][<span class="number">0</span>] = len[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;<span class="number">1</span>&lt;&lt;j &lt;= n;j++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>) &lt;= n;i++)</span><br><span class="line">st[i][j] = max(st[i][j<span class="number">-1</span>],st[i+(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = Log[r-l+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> max(st[l][k],st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bsearch</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(bgn[mid] &gt;= x) r = mid<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">else</span> l = mid+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">bgn[i] = max(bgn[i<span class="number">-1</span>],last[a[i]+B]+<span class="number">1</span>);<span class="comment">//èµ·å§‹ä½ç½®å¿…é¡»åˆæ³• </span></span><br><span class="line">len[i] = i - bgn[i] + <span class="number">1</span>;</span><br><span class="line">last[a[i]+B] = i;</span><br><span class="line">&#125;</span><br><span class="line">init_st();<span class="comment">//å»ºç«‹lenæ•°ç»„çš„stè¡¨ </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,p,res;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);x++,y++; </span><br><span class="line">p = bsearch(x,y,x);<span class="comment">//æ‰¾åˆ°[x,y]å†…ç¬¬ä¸€ä¸ªbgnå¤§äºç­‰äºxçš„ä½ç½® </span></span><br><span class="line"><span class="keyword">if</span>(p &lt;= y) res = max(p-x,ask(p,y));</span><br><span class="line"><span class="keyword">else</span> res = p-x;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,res);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å¤©æ‰çš„è®°å¿†"><a href="#å¤©æ‰çš„è®°å¿†" class="headerlink" title="å¤©æ‰çš„è®°å¿†"></a>å¤©æ‰çš„è®°å¿†</h4><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong> æ¨¡æ¿æ¨¡æ¿ï¼Œé¢˜é¢å’Œæ€è·¯ä¸è¯´äº†ã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> st[N][<span class="number">22</span>] ,Log[N];</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c!=<span class="string">'-'</span> &amp;&amp; (c &lt;<span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>,c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) ans = ans*<span class="number">10</span>+c-<span class="string">'0'</span>,c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg?-ans:ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n+<span class="number">1</span>;i++) Log[i]= Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) st[i][<span class="number">0</span>] = a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j) &lt;= n;j++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>) &lt;= n;i++)&#123;</span><br><span class="line">st[i][j] = max(st[i][j<span class="number">-1</span>],st[i+(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = Log[r-l+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> max(st[l][k],st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line">n = getInt();;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) a[i] = getInt();</span><br><span class="line">init(); m = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line">x = getInt(); y = getInt();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(x,y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Balanced-Lineup"><a href="#Balanced-Lineup" class="headerlink" title="Balanced Lineup"></a>Balanced Lineup</h4><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong> å’Œâ€œæ•æ·çš„æœºå™¨äººâ€ä¸€æ ·ï¼Œéƒ½æ˜¯è¦ç»´æŠ¤æœ€å¤§ä»¥åŠæœ€å°å€¼ã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> st[N][<span class="number">22</span>] ,Log[N], st2[N][<span class="number">22</span>];</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c!=<span class="string">'-'</span> &amp;&amp; (c &lt;<span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>,c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) ans = ans*<span class="number">10</span>+c-<span class="string">'0'</span>,c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg?-ans:ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n+<span class="number">1</span>;i++) Log[i]= Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) st2[i][<span class="number">0</span>] = st[i][<span class="number">0</span>] = a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j) &lt;= n;j++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>) &lt;= n;i++)&#123;</span><br><span class="line">st[i][j] = max(st[i][j<span class="number">-1</span>],st[i+(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)][j<span class="number">-1</span>]);</span><br><span class="line">st2[i][j] = min(st2[i][j<span class="number">-1</span>],st2[i+(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = Log[r-l+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> mx = max(st[l][k],st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line"><span class="keyword">int</span> mi = min(st2[l][k],st2[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,mx-mi);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line">n = getInt(); m = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) a[i] = getInt();</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line">x = getInt(); y = getInt();</span><br><span class="line">ask(x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="é€‰æ‹©å®¢æ ˆ"><a href="#é€‰æ‹©å®¢æ ˆ" class="headerlink" title="é€‰æ‹©å®¢æ ˆ*"></a>é€‰æ‹©å®¢æ ˆ*</h4><p><strong>é¢˜æ„æè¿°</strong><br>ä¸½æ±Ÿæ²³è¾¹æœ‰ n å®¶å¾ˆæœ‰ç‰¹è‰²çš„å®¢æ ˆï¼Œå®¢æ ˆæŒ‰ç…§å…¶ä½ç½®é¡ºåºä» 1 åˆ° n ç¼–å·ã€‚</p><p>æ¯å®¶å®¢æ ˆéƒ½æŒ‰ç…§æŸä¸€ç§è‰²è°ƒè¿›è¡Œè£…é¥°ï¼ˆæ€»å…± k ç§ï¼Œç”¨æ•´æ•° 0 kâˆ’1 è¡¨ç¤ºï¼‰ï¼Œä¸”æ¯å®¶å®¢æ ˆéƒ½è®¾æœ‰ä¸€å®¶å’–å•¡åº—ï¼Œæ¯å®¶å’–å•¡åº—å‡æœ‰å„è‡ªçš„æœ€ä½æ¶ˆè´¹ã€‚</p><p>ä¸¤ä½æ¸¸å®¢ä¸€èµ·å»ä¸½æ±Ÿæ—…æ¸¸ï¼Œä»–ä»¬å–œæ¬¢ç›¸åŒçš„è‰²è°ƒï¼Œåˆæƒ³å°è¯•ä¸¤ä¸ªä¸åŒçš„å®¢æ ˆï¼Œå› æ­¤å†³å®šåˆ†åˆ«ä½åœ¨è‰²è°ƒç›¸åŒçš„ä¸¤å®¶å®¢æ ˆä¸­ã€‚</p><p>æ™šä¸Šï¼Œä»–ä»¬æ‰“ç®—é€‰æ‹©ä¸€å®¶å’–å•¡åº—å–å’–å•¡ï¼Œè¦æ±‚å’–å•¡åº—ä½äºä¸¤äººä½çš„ä¸¤å®¶å®¢æ ˆä¹‹é—´ï¼ˆåŒ…æ‹¬ä»–ä»¬ä½çš„å®¢æ ˆï¼‰ï¼Œä¸”å’–å•¡åº—çš„æœ€ä½æ¶ˆè´¹ä¸è¶…è¿‡ p ã€‚</p><p>ä»–ä»¬æƒ³çŸ¥é“æ€»å…±æœ‰å¤šå°‘ç§é€‰æ‹©ä½å®¿çš„æ–¹æ¡ˆï¼Œä¿è¯æ™šä¸Šå¯ä»¥æ‰¾åˆ°ä¸€å®¶æœ€ä½æ¶ˆè´¹ä¸è¶…è¿‡ p å…ƒçš„å’–å•¡åº—å°èšã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æ²¡çœ‹æ­£è§£æ˜¯å•¥ï¼Œæˆ‘æ²¡ç”¨åˆ°stè¡¨ï¼Œä¸è¿‡å€’æ˜¯ç”¨åˆ°äº†æ±‚RMQçš„æ­¥éª¤ã€‚<br>å…±ä¸‰ä¸ªè¾…åŠ©æ•°ç»„ï¼Œcol[k] è¡¨ç¤ºå½“å‰ç¬¬kç§é¢œè‰²å®¢æ ˆçš„æ•°é‡ï¼›val[x]è¡¨ç¤ºå®¢æ ˆxçš„æœ€ä½æ¶ˆè´¹ï¼›mip[x]è¡¨ç¤º [x, n] å†…ç¬¬ä¸€ä¸ªæœ€ä½æ¶ˆè´¹å°äºç­‰äº p å…ƒçš„å®¢æ ˆä½ç½®ã€‚<br>å¦‚æœç¬¬ä¸€ä¸ªäººå…¥ä½å®¢æ ˆxï¼Œç¬¬äºŒä¸ªäººèƒ½å¤Ÿå…¥ä½çš„æ—…åº—çš„ä½ç½®ä¸€å®šæ˜¯å¤§äºç­‰äºmip[x]çš„ï¼Œå¹¶ä¸”è¦é¢œè‰²å’Œ x ç›¸åŒï¼Œå³col[ a[i] ]ç§é€‰æ‹©æ–¹æ¡ˆã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä»å‰å¾€åé¡ºåºéå†ä¸€éå¹¶ç»Ÿè®¡ç­”æ¡ˆå³å¯ï¼Œå¤æ‚åº¦O(N)ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> K = <span class="number">1e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> col[K];</span><br><span class="line"><span class="keyword">int</span> n,m,p;</span><br><span class="line"><span class="keyword">int</span> a[N],val[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c!=<span class="string">'-'</span> &amp;&amp; (c &lt;<span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span>(c == <span class="string">'-'</span>) neg = <span class="literal">true</span>,c = getchar();</span><br><span class="line"><span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) ans = ans*<span class="number">10</span>+c-<span class="string">'0'</span>,c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg?-ans:ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mip[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">mip[n+<span class="number">1</span>] = n+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = n;i &gt; <span class="number">0</span>;i--)&#123;</span><br><span class="line"><span class="keyword">if</span>(val[i] &gt; p) mip[i] = mip[i+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">else</span> mip[i] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> pre = <span class="number">1</span>; ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> now = mip[i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = pre;j &lt; now;j++) col[a[j]]--;</span><br><span class="line"><span class="comment">//printf("%d %d %d\n",pre,now,col[a[i]]);</span></span><br><span class="line">ans += col[a[i]]; pre = now;</span><br><span class="line"><span class="keyword">if</span>(now == i) ans--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line">n = getInt(); m = getInt(); p = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x;i &lt;= n;i++)&#123;</span><br><span class="line">a[i] = getInt(); val[i] = getInt(); </span><br><span class="line">col[a[i]]++;</span><br><span class="line">&#125;</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> stè¡¨ </tag>
            
            <tag> RMQé—®é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‘çŠ¶æ•°ç»„é¢˜é›†</title>
      <link href="/2019/10/06/BIT-problems/"/>
      <url>/2019/10/06/BIT-problems/</url>
      
        <content type="html"><![CDATA[<p><a href="http://ybt.ssoier.cn:8088/index.php" target="_blank" rel="noopener">ä¹¦æœ¬é…å¥—OJ</a><br><a href="http://www.mfstem.org/contests" target="_blank" rel="noopener">æˆ‘æ ¡OJ</a><br><strong>æ ‘çŠ¶æ•°ç»„çŸ¥è¯†ç‚¹ï¼š</strong></p><ul><li>å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æ±‚å’Œï¼ŒO(logN)ã€‚</li><li>åŒºé—´ä¿®æ”¹ï¼ŒåŒºé—´æ±‚å’Œï¼ŒO(logN)ã€‚</li><li>äºŒç»´æ ‘çŠ¶æ•°ç»„å•ç‚¹ä¿®æ”¹ï¼Œå­çŸ©é˜µæ±‚å’Œï¼Œæ—¶é—´å¤æ‚åº¦O(logN * logN)ï¼Œç©ºé—´O(N^2)ã€‚</li></ul><p>ä¸çº¿æ®µæ ‘ç›¸æ¯”åŠŸèƒ½æ¯”è¾ƒå•ä¸€ï¼Œä¸å¤Ÿçµæ´»ï¼Œä½†èƒœåœ¨ç®€çŸ­æ˜“å†™ï¼Œå¯ä»¥ç”¨æ¥æ‰“è¾…åŠ©ã€‚</p><p><strong>æ³¨æ„äº‹é¡¹</strong></p><ul><li>æ ‘çŠ¶æ•°ç»„ä¿®æ”¹çš„ä¸‹æ ‡ä¸èƒ½ä¸º0ï¼Œå› ä¸º lowbit(0) = 0ï¼Œè¿™å°±æ­»å¾ªç¯äº†ã€‚</li><li>æ³¨æ„æ ‘çŠ¶æ•°ç»„çš„ç©ºé—´ï¼Œè¿™æ˜¯ç”±å€¼åŸŸæ¥å†³å®šçš„ï¼Œè€Œä¸æ˜¯å®šä¹‰åŸŸã€‚</li></ul><h4 id="æ•°åˆ—æ“ä½œ"><a href="#æ•°åˆ—æ“ä½œ" class="headerlink" title="æ•°åˆ—æ“ä½œ"></a>æ•°åˆ—æ“ä½œ</h4><p><strong>é¢˜ç›®æè¿°</strong><br>ç»™å®šnä¸ªæ•°åˆ—,è§„å®šæœ‰ä¸¤ç§æ“ä½œï¼Œä¸€æ˜¯ä¿®æ”¹æŸä¸ªå…ƒç´ ï¼ŒäºŒæ˜¯æ±‚å­æ•°åˆ—[a,b]çš„è¿ç»­å’Œã€‚æ•°åˆ—å…ƒç´ ä¸ªæ•°æœ€å¤š10ä¸‡ä¸ªï¼Œè¯¢é—®æ“ä½œæœ€å¤š10ä¸‡æ¬¡ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>æ¨¡æ¿é¢˜ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n,m; </span><br><span class="line">ll A[N],c[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="comment">/*æŠŠç¬¬xä½ç½®ä¸Šçš„æ•°+y*/</span></span><br><span class="line"><span class="keyword">for</span>(;x &lt;= n;x += x&amp;-x) c[x] += y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">/*è¿”å›[1,x]å…ƒç´ å’Œ*/</span></span><br><span class="line">ll res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x -= x&amp;-x) res += c[x];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">int</span> k,a,b;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,A+i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Add(i,A[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;k,&amp;a,&amp;b);</span><br><span class="line"><span class="keyword">if</span>(k) Add(a,b);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ask(b)-ask(a<span class="number">-1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="æ•°æ˜Ÿæ˜Ÿ-Stars"><a href="#æ•°æ˜Ÿæ˜Ÿ-Stars" class="headerlink" title="æ•°æ˜Ÿæ˜Ÿ Stars"></a>æ•°æ˜Ÿæ˜Ÿ Stars</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™å®š n ä¸ªç‚¹ï¼Œå®šä¹‰æ¯ä¸ªç‚¹çš„ç­‰çº§æ˜¯åœ¨è¯¥ç‚¹å·¦ä¸‹æ–¹ï¼ˆå«æ­£å·¦ã€æ­£ä¸‹ï¼‰çš„ç‚¹çš„æ•°ç›®ï¼Œè¯•ç»Ÿè®¡æ¯ä¸ªç­‰çº§æœ‰å¤šå°‘ä¸ªç‚¹ã€‚<br>(è¯¦ç»†æè¿°è§åŸé¢˜é¢)</p><p><strong>è§£é¢˜æ€è·¯</strong><br>ç”±äºyæ˜¯å‡åºçš„ï¼Œæˆ‘ä»¬åªéœ€è¦è®°å½•æ¯”å½“å‰xå°çš„staræœ‰å¤šå°‘ä¸ªå³å¯å¾—çŸ¥å…¶ç­‰çº§ x ï¼Œç„¶åç”¨num[x]è¡¨ç¤ºç­‰çº§ä¸ºxçš„æ˜Ÿæ˜Ÿä¸ªæ•°ï¼Œæœ€ç»ˆç­”æ¡ˆå°±æ˜¯numæ•°ç»„ã€‚<br>CDQåˆ†æ²»ä¹Ÿå¯ä»¥å†™ï¼Œéƒ½æ˜¯å…ˆå°†ä¸€ç»´ç»™å˜çš„æœ‰åºï¼Œå†ç»Ÿè®¡å¦ä¸€ç»´åº¦ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> c[N],n;</span><br><span class="line"><span class="keyword">int</span> ans[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123; <span class="comment">//è‹¥x=0åˆ™æ­»å¾ªç¯ </span></span><br><span class="line"><span class="keyword">for</span>(;x &lt; N;x += x&amp;-x) c[x] += y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x -= x&amp;-x) res += c[x];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">ans[ask(x+<span class="number">1</span>)]++;<span class="comment">//è¦æ³¨æ„x = 0è¿™ç§æƒ…å†µ </span></span><br><span class="line">Add(x+<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="æ ¡é—¨å¤–çš„æ ‘"><a href="#æ ¡é—¨å¤–çš„æ ‘" class="headerlink" title="æ ¡é—¨å¤–çš„æ ‘*"></a>æ ¡é—¨å¤–çš„æ ‘*</h4><p><strong>é¢˜æ„ç®€è¿°</strong></p><p>åŸé¢˜æ¥è‡ªï¼šVijos P1448<br>æ ¡é—¨å¤–æœ‰å¾ˆå¤šæ ‘ï¼Œå­¦æ ¡å†³å®šåœ¨æŸä¸ªæ—¶åˆ»åœ¨æŸä¸€æ®µç§ä¸Šä¸€ç§æ ‘ï¼Œä¿è¯ä»»ä¸€æ—¶åˆ»ä¸ä¼šå‡ºç°ä¸¤æ®µç›¸åŒç§ç±»çš„æ ‘ï¼Œç°æœ‰ä¸¤ç§æ“ä½œï¼š</p><ul><li>K=1ï¼Œè¯»å…¥ l,r è¡¨ç¤ºåœ¨ l åˆ° r ä¹‹é—´ç§ä¸Šä¸€ç§æ ‘ï¼Œæ¯æ¬¡æ“ä½œç§çš„æ ‘çš„ç§ç±»éƒ½ä¸åŒï¼›</li><li>K=2ï¼Œè¯»å…¥ l,r è¡¨ç¤ºè¯¢é—® l åˆ° r ä¹‹é—´æœ‰å¤šå°‘ç§æ ‘ã€‚</li></ul><p><strong>è§£é¢˜æ€è·¯</strong><br>åˆšå¼€å§‹ä»¥ä¸ºæ˜¯åŒºé—´ä¿®æ”¹çš„é¢˜ï¼Œåæ¥å‘ç°ä¸æ˜¯ã€‚è¿™é¢˜åˆ©ç”¨äº†å·®åˆ†æ•°ç»„çš„æ€æƒ³ã€‚å¦‚æœæˆ‘ä»¬å‡è®¾c0[ x ] å­˜æ”¾ [1, x] çš„å·¦ç«¯ç‚¹æ•°é‡ï¼Œc1[]å­˜æ”¾å³ç«¯ç‚¹æ•°é‡ï¼›å¦‚æœæ‰€æ±‚åŒºé—´ä¸º[l , r]ï¼Œé‚£ä¹ˆä¸€å…±åªå¯èƒ½æœ‰ 6 ç§ä¸åŒçš„çº¿æ®µï¼š</p><ul><li>ç¬¬ä¸€ç§æ˜¯å…¨åœ¨rå³ä¾§ï¼›</li><li>ç¬¬äºŒç§æ˜¯å·¦ç«¯ç‚¹åœ¨ [l ,r] å†…ï¼Œå³ç«¯ç‚¹åœ¨rå³ä¾§ï¼›</li><li>ç¬¬ä¸‰ç§æ˜¯å·¦å³ç«¯ç‚¹éƒ½åœ¨[l ,r] å†…ï¼›</li><li>ç¬¬å››ç§æ˜¯å³ç«¯ç‚¹åœ¨[l ,r]å†…ï¼Œå·¦ç«¯ç‚¹åœ¨ l å·¦ä¾§ï¼›</li><li>ç¬¬äº”ç§æ˜¯å·¦å³ç«¯ç‚¹å…¨åœ¨ l å·¦ä¾§ï¼›</li><li>ç¬¬å…­ç§æ˜¯å·¦ç«¯ç‚¹åœ¨ l å·¦ä¾§ï¼Œå³ç«¯ç‚¹åœ¨ r å³ä¾§ã€‚</li></ul><p>é‚£ä¹ˆæˆ‘ä»¬ç”¨ l å³ä¾§æ‰€æœ‰çš„å³ç«¯ç‚¹çš„æ•°é‡ï¼Œå‡å» r å³ä¾§å·¦ç«¯ç‚¹çš„æ•°é‡ï¼Œå¯ä»¥ç”»å›¾ç†è§£ï¼Œç®€å•ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n,m; </span><br><span class="line">ll A[N],c[<span class="number">2</span>][N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> ty,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="comment">/*æŠŠç¬¬xä½ç½®ä¸Šçš„æ•°+y*/</span></span><br><span class="line"><span class="keyword">for</span>(;x &lt; N;x += x&amp;-x) c[ty][x] += y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> ty,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">/*è¿”å›[1,x]å…ƒç´ å’Œ*/</span></span><br><span class="line">ll res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x -= x&amp;-x) res += c[ty][x];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">int</span> k,a,b;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;k,&amp;a,&amp;b);</span><br><span class="line"><span class="keyword">if</span>(k == <span class="number">1</span>)&#123;</span><br><span class="line">Add(<span class="number">0</span>,a,<span class="number">1</span>); Add(<span class="number">1</span>,b,<span class="number">1</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">/*åˆ†ç±»è®¨è®º,æ‰€æœ‰çº¿æ®µå…±6ç§æƒ…å†µ */</span> </span><br><span class="line"><span class="keyword">int</span> t1 = ask(<span class="number">1</span>,N<span class="number">-1</span>) - ask(<span class="number">1</span>,a<span class="number">-1</span>); </span><br><span class="line"><span class="keyword">int</span> t2 = ask(<span class="number">0</span>,N<span class="number">-1</span>) - ask(<span class="number">0</span>,b);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,t1-t2);</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="æ¸…ç‚¹äººæ•°"><a href="#æ¸…ç‚¹äººæ•°" class="headerlink" title="æ¸…ç‚¹äººæ•°"></a>æ¸…ç‚¹äººæ•°</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>NK ä¸­å­¦ç»„ç»‡åŒå­¦ä»¬å»äº”äº‘å±±å¯¨å‚åŠ ç¤¾ä¼šå®è·µæ´»åŠ¨ï¼ŒæŒ‰æƒ¯ä¾‹è¦ä¹˜åç«è½¦å»ã€‚ç”±äº NK ä¸­å­¦çš„å­¦ç”Ÿå¾ˆå¤šï¼Œåœ¨ç«è½¦å¼€ä¹‹å‰å¿…é¡»æ¸…ç‚¹å¥½äººæ•°ã€‚<br>åˆå§‹æ—¶ï¼Œç«è½¦ä¸Šæ²¡æœ‰å­¦ç”Ÿã€‚å½“åŒå­¦ä»¬å¼€å§‹ä¸Šç«è½¦æ—¶ï¼Œå¹´çº§ä¸»ä»»ä»ç¬¬ä¸€èŠ‚è½¦å¢å‡ºå‘èµ°åˆ°æœ€åä¸€èŠ‚è½¦å¢ï¼Œæ¯èŠ‚è½¦å¢éšæ—¶éƒ½æœ‰å¯èƒ½æœ‰åŒå­¦ä¸Šä¸‹ã€‚å¹´çº§ä¸»ä»»èµ°åˆ°ç¬¬ m èŠ‚è½¦å¢æ—¶ï¼Œä»–æƒ³çŸ¥é“å‰ m èŠ‚è½¦å¢ä¸Šä¸€å…±æœ‰å¤šå°‘å­¦ç”Ÿï¼Œä½†æ˜¯ä»–æ²¡æœ‰è°ƒå¤´å¾€å›èµ°çš„ä¹ æƒ¯ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡å½“ä»–æé—®æ—¶ï¼Œm æ€»ä¼šæ¯”å‰ä¸€æ¬¡å¤§ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>ä¹Ÿæ˜¯æ¨¡æ¿é¢˜ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> c[N] ,n,k;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x &lt; N;x += x&amp;-x) c[x] += y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x -= x&amp;-x) res += c[x];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="keyword">char</span> op[<span class="number">5</span>];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= k;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,op);</span><br><span class="line"><span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">'A'</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x); <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(x));</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">'B'</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y); Add(x,y);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y); Add(x,-y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ç®€å•é¢˜"><a href="#ç®€å•é¢˜" class="headerlink" title="ç®€å•é¢˜"></a>ç®€å•é¢˜</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>é¢˜ç›®æ¥æºï¼šCQOI 2006<br>æœ‰ä¸€ä¸ª n ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ åˆå§‹å‡ä¸º 0ã€‚æœ‰ m æ¡æŒ‡ä»¤ï¼Œè¦ä¹ˆè®©å…¶ä¸­ä¸€æ®µè¿ç»­åºåˆ—æ•°å­—åè½¬â€”â€”0 å˜ 1ï¼Œ1 å˜ 0ï¼ˆæ“ä½œ 1ï¼‰ï¼Œè¦ä¹ˆè¯¢é—®æŸä¸ªå…ƒç´ çš„å€¼ï¼ˆæ“ä½œ 2ï¼‰ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>ä¸€ä¸ªä½ç½®å¦‚æœåè½¬å¶æ•°æ¬¡ï¼Œé‚£ä¹ˆå®ƒè¿˜æ˜¯0ï¼Œå¦åˆ™æ˜¯1ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦ç»Ÿè®¡æ¯ä¸ªä½ç½®è¢«åè½¬äº†å‡ æ¬¡å³å¯ï¼Œç”¨åˆ°äº†æ ‘çŠ¶æ•°ç»„åŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢ã€‚æ ‘çŠ¶æ•°ç»„åŒºé—´ä¿®æ”¹çš„æ¨å¯¼å°±ä¸å†™äº†ï¼Œä¹¦ä¸Šæœ‰ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> c[<span class="number">2</span>][N],n,m ,num[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c!=<span class="string">'-'</span> &amp;&amp; (c&lt;<span class="string">'0'</span> || c&gt;<span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span> (c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c&gt;=<span class="string">'0'</span> &amp;&amp; c&lt;=<span class="string">'9'</span>)</span><br><span class="line">ans = ans*<span class="number">10</span> + c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg ? -ans : ans; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> ty,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x &lt;= n;x += x&amp;-x) c[ty][x] += y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> ty,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x -= x&amp;-x) res += c[ty][x];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin); </span></span><br><span class="line">n = getInt(); m = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt;= m;i++)&#123;</span><br><span class="line">z = getInt();</span><br><span class="line"><span class="keyword">if</span>(z == <span class="number">1</span>)&#123;</span><br><span class="line">x = getInt(); y = getInt();</span><br><span class="line">Add(<span class="number">0</span>,x,<span class="number">1</span>); Add(<span class="number">0</span>,y+<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">Add(<span class="number">1</span>,x,x); Add(<span class="number">1</span>,y+<span class="number">1</span>,-y<span class="number">-1</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">y = getInt(); x = y;</span><br><span class="line"><span class="keyword">int</span> res = (y+<span class="number">1</span>)*ask(<span class="number">0</span>,y) - ask(<span class="number">1</span>,y) - x*ask(<span class="number">0</span>,x<span class="number">-1</span>) + ask(<span class="number">1</span>,x<span class="number">-1</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,res&amp;<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="æ‰“é¼¹é¼ "><a href="#æ‰“é¼¹é¼ " class="headerlink" title="æ‰“é¼¹é¼ *"></a>æ‰“é¼¹é¼ *</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>è¿™æ˜¯ä¸€é“æ¨¡æ¿é¢˜ã€‚<br>ç»™å‡ºä¸€ä¸ª nÃ—m çš„é›¶çŸ©é˜µ Aï¼Œä½ éœ€è¦å®Œæˆå¦‚ä¸‹æ“ä½œï¼š<br>1 x y kï¼šè¡¨ç¤ºå…ƒç´  Ax,yè‡ªå¢ kï¼›<br>2 a b c dï¼šè¡¨ç¤ºè¯¢é—®å·¦ä¸Šè§’ä¸º (a,b)ï¼Œå³ä¸‹è§’ä¸º (c,d) çš„å­çŸ©é˜µå†…æ‰€æœ‰æ•°çš„å’Œã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æ˜¯äºŒç»´æ ‘çŠ¶æ•°ç»„æ¨¡æ¿é¢˜ï¼Œä½†æ˜¯ç©ºé—´å¡çš„å¾ˆç´§ï¼Œå¼€åˆ°N = 5000å°±é™©è¿‡ï¼Œå¼€åˆ°N = (1&lt;&lt;12)+10å°±å¥½äº†ä¸€ç‚¹ã€‚<br>å’Œvijosé‚£ä¸ªåŸé¢˜ä¸åŒï¼Œæ•°æ®ä¸ä¸€æ ·ï¼ŒèŒƒå›´ä¹Ÿä¸ä¸€æ ·ï¼Œè¿™é¢˜ä¸ä¼šå‡ºç°ä¸‹æ ‡ä¸º0çš„æƒ…å†µã€‚å°±æ³¨æ„ä¸€ä¸‹äºŒç»´æ›´æ–°å’ŒæŸ¥è¯¢æ—¶ï¼Œæ¯æ¬¡çš„yéœ€è¦æ¢å¤åŸå€¼å³å¯ï¼Œå› æ­¤éœ€è¦ç”¨ä¸ªå˜é‡å­˜æ”¾ä¸€ä¸‹yåˆå€¼ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = (<span class="number">1</span>&lt;&lt;<span class="number">12</span>)+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll c[N][N]; </span><br><span class="line"><span class="keyword">int</span> n ,m;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c!=<span class="string">'-'</span> &amp;&amp; (c&lt;<span class="string">'0'</span> || c&gt;<span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span> (c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c&gt;=<span class="string">'0'</span> &amp;&amp; c&lt;=<span class="string">'9'</span>)</span><br><span class="line">ans = ans*<span class="number">10</span> + c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg ? -ans : ans; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line"><span class="comment">//printf("%d %d %d\n",x,y,z);</span></span><br><span class="line"><span class="keyword">for</span>(;x &lt;= n;x += x&amp;-x)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> ty = y;ty &lt;= m;ty += ty&amp;-ty) c[x][ty] += z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">ll res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x -= x&amp;-x)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> ty = y;ty;ty -= ty&amp;-ty) res += c[x][ty];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a,b,c,d,x,y,k,op;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line">n = getInt(); m = getInt();</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;op) != EOF)&#123;</span><br><span class="line"><span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">x = getInt(); y = getInt(); k = getInt();</span><br><span class="line">Add(x,y,k);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">a = getInt(); b = getInt(); c = getInt();d = getInt();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ask(c,d)-ask(c,b<span class="number">-1</span>)-ask(a<span class="number">-1</span>,d)+ask(a<span class="number">-1</span>,b<span class="number">-1</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘çŠ¶æ•°ç»„ </tag>
            
            <tag> äºŒç»´æ ‘çŠ¶æ•°ç»„ </tag>
            
            <tag> æ ‘çŠ¶æ•°ç»„åŒºé—´ä¿®æ”¹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ACè‡ªåŠ¨æœºé¢˜é›†</title>
      <link href="/2019/10/06/ac-problems/"/>
      <url>/2019/10/06/ac-problems/</url>
      
        <content type="html"><![CDATA[<h4 id="Keywords-Search"><a href="#Keywords-Search" class="headerlink" title="Keywords Search"></a>Keywords Search</h4><p><strong>é¢˜æ„æè¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šHDU 2222<br>ç»™å®š n ä¸ªé•¿åº¦ä¸è¶…è¿‡ 50 çš„ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å•è¯å‡†å¤‡æŸ¥è¯¢ï¼Œä»¥åŠä¸€ç¯‡é•¿ä¸º m çš„æ–‡ç« ï¼Œé—®ï¼šæ–‡ä¸­å‡ºç°äº†å¤šå°‘ä¸ªå¾…æŸ¥è¯¢çš„å•è¯ã€‚å¤šç»„æ•°æ®ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>æ¨¡æ¿é¢˜<br><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span>+<span class="number">10</span>;<span class="comment">//æ¨¡å¼ä¸²ä¸ªæ•° </span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e6</span>+<span class="number">10</span>;<span class="comment">//æ–‡æœ¬ä¸²é•¿åº¦ </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> str[N][<span class="number">50</span>],s[M];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">50</span>*N;<span class="comment">//trieèŠ‚ç‚¹æ•° </span></span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">30</span>],End[SZ],tot ;</span><br><span class="line"><span class="keyword">int</span> fail[SZ];<span class="comment">//å¤±é…æŒ‡é’ˆ,ç±»ä¼¼äºnex</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(trie,<span class="number">0</span>,<span class="keyword">sizeof</span> trie);</span><br><span class="line"><span class="built_in">memset</span>(End,<span class="number">0</span>,<span class="keyword">sizeof</span> End); tot = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line"><span class="comment">/* å‘trieæ ‘ä¸­æ’å…¥å­—ç¬¦ä¸²s */</span> </span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">End[p]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getFail</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*åˆ©ç”¨bfsæ›´æ–°failæ•°ç»„*/</span> </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++) trie[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">q.push(<span class="number">1</span>); fail[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> p = q.front(); q.pop();</span><br><span class="line"><span class="comment">//printf("%d\n",q.size());</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][i]) trie[p][i] = trie[fail[p]][i];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">q.push(trie[p][i]);</span><br><span class="line">fail[trie[p][i]] = trie[fail[p]][i];</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ask</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="comment">/* ç»Ÿè®¡åŒ¹é…æˆåŠŸçš„æ¨¡å¼ä¸²ä¸ªæ•°å¹¶ç´¯åŠ åˆ°ansä¸Š */</span> </span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">int</span> k = trie[p][ch];</span><br><span class="line"><span class="keyword">while</span>(k &gt; <span class="number">1</span>)&#123;</span><br><span class="line">ans += End[k]; End[k] = <span class="number">0</span>;</span><br><span class="line">k = fail[k];</span><br><span class="line">&#125;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> t,n;<span class="comment">//æ•°ç»„ç»„æ•°, æ¨¡å¼ä¸²ä¸ªæ•° </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Insert(str[i]);</span><br><span class="line">getFail(); ans = <span class="number">0</span>;</span><br><span class="line">ask(s);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line">init();<span class="comment">//å¤šç»„æ•°æ®ä¸è¦å¿˜äº†åˆå§‹åŒ–ï¼ </span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%s"</span>,str[i]);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,s);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç„æ­¦å¯†ç "><a href="#ç„æ­¦å¯†ç " class="headerlink" title="ç„æ­¦å¯†ç "></a>ç„æ­¦å¯†ç </h4><p><strong>é¢˜æ„æè¿°</strong></p><p>åŸé¢˜æ¥è‡ªï¼šJSOI 2012<br>åœ¨ç¾ä¸½çš„ç„æ­¦æ¹–ç•”ï¼Œé¸¡é¸£å¯ºè¾¹ï¼Œé¸¡ç¬¼å±±å‰ï¼Œæœ‰ä¸€å—å¯Œé¥¶è€Œç§€ç¾çš„åœŸåœ°ï¼Œäººä»¬å”¤ä½œè¿›é¦™æ²³ã€‚ç›¸ä¼ ä¸€æ—¥ï¼Œä¸€ç¼•ç´«æ°”ä»å¤©è€Œè‡³ï¼Œåªä¸€ç¬é—´ä¾¿æ¶ˆå¤±åœ¨äº†è¿›é¦™æ²³ä¸­ã€‚è€äººä»¬è¯´ï¼Œè¿™æ˜¯ç„æ­¦ç¥çµå°†å¤©ä¹¦è—åŒ¿åœ¨æ­¤ã€‚å¾ˆå¤šå¹´åï¼Œäººä»¬ç»ˆäºåœ¨è¿›é¦™æ²³åœ°åŒºå‘ç°äº†å¸¦æœ‰ç„æ­¦å¯†ç çš„æ–‡å­—ã€‚æ›´åŠ ç¥å¥‡çš„æ˜¯ï¼Œè¿™ä»½å¸¦æœ‰ç„æ­¦å¯†ç çš„æ–‡å­—ï¼Œä¸ç„æ­¦æ¹–å—å²¸å°åŸçš„ç»“æ„æœ‰å¾®å¦™çš„å…³è”ã€‚äºæ˜¯ï¼Œæ¼«é•¿çš„ç ´è¯‘å·¥ä½œå¼€å§‹äº†ã€‚<br>ç»è¿‡åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸œå—è¥¿åŒ—å››ä¸ªæ–¹å‘æ¥æè¿°å°åŸåŸç –çš„æ‘†æ”¾ï¼Œä¸å¦¨ç”¨ä¸€ä¸ªé•¿åº¦ä¸º N çš„åºåˆ—æ¥æè¿°ï¼Œåºåˆ—ä¸­çš„å…ƒç´ åˆ†åˆ«æ˜¯ Eï¼ŒSï¼ŒWï¼ŒNï¼Œä»£è¡¨äº†ä¸œå—è¥¿åŒ—å››å‘ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ¯ä¸²ã€‚è€Œç¥ç§˜çš„ç„æ­¦å¯†ç æ˜¯ç”±å››è±¡çš„å›¾æ¡ˆæè¿°è€Œæˆçš„ M æ®µæ–‡å­—ã€‚<br>ç°åœ¨ï¼Œè€ƒå¤å·¥ä½œè€…é‡åˆ°äº†ä¸€ä¸ªéš¾é¢˜ã€‚å¯¹äºæ¯ä¸€æ®µæ–‡å­—ï¼Œå…¶å‰ç¼€åœ¨æ¯ä¸²ä¸Šçš„æœ€å¤§åŒ¹é…é•¿åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿ</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æ±‚æ¯ä¸ªå­ä¸²åœ¨æ¯ä¸²ä¸Šçš„æœ€å¤§åŒ¹é…é•¿åº¦ã€‚å¦‚æœæŒ¨ä¸ªç”¨å­ä¸²æ¥åŒ¹é…æ¯ä¸²ï¼Œå¤æ‚åº¦å¤ªé«˜ï¼Œæ‰€ä»¥è¦ç”¨ACè‡ªåŠ¨æœºï¼Œä»¥æ¯ä¸²æ¥åŒ¹é…å­ä¸²ã€‚<br>å°†æ¯ä¸²åœ¨å»ºç«‹å¥½çš„ACè‡ªåŠ¨æœºä¸Šè¿›è¡ŒåŒ¹é…ï¼Œé‚£ä¹ˆå…¶æ‰€èƒ½åˆ°è¾¾çš„èŠ‚ç‚¹ï¼Œå°±æ˜¯å¯ä»¥å’Œæ¯ä¸²åŒ¹é…çš„é•¿åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±å¯¹å…¶è¿›è¡Œæ ‡è®°ï¼Œé¡ºä¾¿ä¹Ÿå¯¹å…¶failæŒ‡é’ˆæ‰€æŒ‡å‘çš„èŠ‚ç‚¹æ ‡è®°ï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ªè¢«æ ‡è®°çš„èŠ‚ç‚¹ï¼Œå°±æ˜¯è¯¥å­ä¸²æ‰€èƒ½åŒ¹é…çš„æœ€å¤§é•¿åº¦ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°æœ€åä¸€ä¸ªè¢«æ ‡è®°çš„èŠ‚ç‚¹å‘¢ï¼Ÿé€šè¿‡paræ•°ç»„ï¼Œpar[x]å­˜æ”¾xçš„çˆ¶äº²èŠ‚ç‚¹çš„ç¼–å·ï¼Œå¦‚æ­¤å°±å¯ä»¥ä»åå‘å‰éå†äº†ï¼ˆä¸‹è¿°ä»£ç ä¸­æ˜¯nexæ•°ç»„ï¼‰ã€‚</p><p>æ‰€ä»¥å…·ä½“æ­¥éª¤æœ‰ä¸‰æ­¥ï¼š</p><ul><li>æ ¹æ®æ‰€æœ‰å­ä¸²å»ºç«‹ACè‡ªåŠ¨æœºï¼ŒåŒæ—¶æ›´æ–°paræ•°ç»„(ä»£ç ä¸­æ˜¯nexæ•°ç»„)</li><li>åˆ©ç”¨æ¯ä¸²å¯¹è‡ªåŠ¨æœºä¸ŠèŠ‚ç‚¹è¿›è¡Œæ ‡è®°</li><li>åˆ©ç”¨paræ•°ç»„è‡ªåº•å‘ä¸ŠæŸ¥æ‰¾æœ€åä¸€ä¸ªè¢«æ ‡è®°çš„èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„é•¿åº¦å°±æ˜¯ä¸æ¯ä¸²æœ€å¤§åŒ¹é…ï¼Œä¸ºæ­¤æˆ‘ä»¬è¿˜éœ€è¦è®°å½•æ¯ä¸ªå­—ä¸²ç»“æŸæ—¶çš„èŠ‚ç‚¹ç¼–å·End[id]ï¼Œä»¥åŠé•¿åº¦Len[id]</li></ul><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e7</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> s[N],str[M][<span class="number">110</span>];</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = M*<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">5</span>], tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> fail[SZ],vis[SZ],End[SZ],nex[SZ];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getIdx</span><span class="params">(<span class="keyword">char</span> ch)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(ch == <span class="string">'E'</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">'S'</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">'W'</span>) <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Insert</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = getIdx(s[i]);</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot,nex[tot] = p;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getFail</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++) trie[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">q.push(<span class="number">1</span>); fail[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> p = q.front(); q.pop();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][i]) trie[p][i] = trie[fail[p]][i];</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">q.push(trie[p][i]);</span><br><span class="line">fail[trie[p][i]] = trie[fail[p]][i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Mark</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = getIdx(s[i]);</span><br><span class="line"><span class="keyword">int</span> k = trie[p][ch];</span><br><span class="line"><span class="keyword">while</span>(k &gt; <span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(vis[k]) <span class="keyword">break</span>;</span><br><span class="line">vis[k] = <span class="number">1</span>; k = fail[k];</span><br><span class="line">&#125;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(str[x]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = End[x];i &gt; <span class="number">1</span>;i = nex[i],len--) <span class="keyword">if</span>(vis[i]) <span class="keyword">break</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,len);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++) End[i] = Insert(str[i]);</span><br><span class="line">getFail();</span><br><span class="line">Mark(s);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++) search(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,s);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++) <span class="built_in">scanf</span>(<span class="string">"%s"</span>,str[i]);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Censoring"><a href="#Censoring" class="headerlink" title="Censoring"></a>Censoring</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šUSACO 2015 Feb. Gold<br>æœ‰ä¸€ä¸ªé•¿åº¦ä¸è¶…è¿‡ 105 çš„å­—ç¬¦ä¸² Sã€‚Farmer John å¸Œæœ›åœ¨ S ä¸­åˆ æ‰ n ä¸ªå±è”½è¯ï¼ˆä¸€ä¸ªå±è”½è¯å¯èƒ½å‡ºç°å¤šæ¬¡ï¼‰ï¼Œè¿™äº›è¯è®°ä¸º t1âˆ¼tnã€‚FJ åœ¨ S ä¸­ä»å¤´å¼€å§‹å¯»æ‰¾å±è”½è¯ï¼Œä¸€æ—¦æ‰¾åˆ°ä¸€ä¸ªå±è”½è¯ï¼ŒFJ å°±åˆ é™¤å®ƒï¼Œç„¶ååˆä»å¤´å¼€å§‹å¯»æ‰¾ï¼ˆè€Œä¸æ˜¯æ¥ç€å¾€ä¸‹æ‰¾ï¼‰ã€‚<br>FJ ä¼šé‡å¤è¿™ä¸€è¿‡ç¨‹ï¼Œç›´åˆ° S ä¸­æ²¡æœ‰å±è”½è¯ä¸ºæ­¢ã€‚æ³¨æ„åˆ é™¤ä¸€ä¸ªå•è¯åå¯èƒ½ä¼šå¯¼è‡´ S ä¸­å‡ºç°å¦ä¸€ä¸ªå±è”½è¯ã€‚<br>è¿™ n ä¸ªå±è”½è¯ä¸ä¼šå‡ºç°ä¸€ä¸ªå•è¯æ˜¯å¦ä¸€ä¸ªå•è¯å­ä¸²çš„æƒ…å†µï¼Œè¿™æ„å‘³ç€æ¯ä¸ªå±è”½è¯åœ¨ S ä¸­å‡ºç°çš„å¼€å§‹ä½ç½®æ˜¯äº’ä¸ç›¸åŒçš„ï¼Œè¯·å¸®åŠ© FJ å®Œæˆè¿™äº›æ“ä½œå¹¶è¾“å‡ºæœ€åçš„ Sã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>å¯ä»¥ç”¨KM+æ ˆæ¥è§£å†³ï¼Œè¿™é‡Œç”¨ACè‡ªåŠ¨æœºè§£å†³ã€‚<br>å¾ˆå®¹æ˜“æƒ³åˆ°çš„ä¸€ä¸ªæ€è·¯å°±æ˜¯ï¼Œå»ºç«‹å¥½ACè‡ªåŠ¨æœºåï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹åŒ¹é…ï¼Œå¦‚æœåŒ¹é…åˆ°å¶å­èŠ‚ç‚¹ï¼Œå³æœ‰Endæ ‡è®°çš„èŠ‚ç‚¹ï¼Œå°±è¯´æ˜å½“å‰å­—ä¸²æ˜¯å±è”½è¯ï¼Œåˆ æ‰å®ƒï¼Œå‡è®¾è¯¥å­ä¸²é•¿ä¸º len ï¼Œé‚£å°±å°†æŒ‡é’ˆ p å›é€€åˆ° len æ­¥ä¹‹å‰ï¼Œç»§ç»­åŒ¹é…ã€‚<br>å¦‚æ­¤ä¸€æ¥æˆ‘ä»¬éœ€è¦è®°å½•æ¯ä¸ªæ—¶åˆ»çš„pæŒ‡é’ˆï¼Œä»¥åŠæ¯ä¸²ä¸­ä¿ç•™çš„å­—ç¬¦ï¼Œç”¨æ ˆå°±å¯ä»¥å¾ˆå¥½çš„ç»´æŠ¤ã€‚å¦‚æœå±è”½è¯åŒ¹é…æˆåŠŸï¼Œé•¿åº¦ä¸º lenï¼Œé‚£ä¹ˆæ¯ä¸²ä¸­ä¿ç•™çš„å­—ç¬¦ä»æ ˆé¡¶å¼¹å‡º len ä¸ªï¼ŒåŒæ—¶ä¿å­˜ p çš„æ ˆä¹Ÿå¼¹å‡º len ä¸ªå…ƒç´ ï¼Œæ ˆé¡¶å…ƒç´ å°±æ˜¯ len æ­¥ä¹‹å‰çš„æŒ‡é’ˆã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N], s[N];</span><br><span class="line"><span class="keyword">int</span> n, fail[SZ];</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">30</span>],tot = <span class="number">1</span>,End[SZ];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">End[p] = len;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getFail</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++) trie[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">q.push(<span class="number">1</span>); fail[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> p = q.front(); q.pop();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][i]) trie[p][i] = trie[fail[p]][i];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">q.push(trie[p][i]); </span><br><span class="line">fail[trie[p][i]] = trie[fail[p]][i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">char</span> path[N];</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>,Stack[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">getFail();<span class="comment">//ä¸ºä»€ä¹ˆéè¦æ›´æ–°Failæ•°ç»„å‘¢ </span></span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(str);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>,p = <span class="number">1</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = str[i]-<span class="string">'a'</span>;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">Stack[++top] = p; path[top] = str[i];</span><br><span class="line"><span class="keyword">if</span>(End[p]) top -= End[p], p = Stack[top];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= top;i++) <span class="built_in">putchar</span>(path[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,s); Insert(s);</span><br><span class="line">&#125;</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å•è¯"><a href="#å•è¯" class="headerlink" title="å•è¯"></a>å•è¯</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šTJOI 2013<br>æŸäººè¯»è®ºæ–‡ï¼Œä¸€ç¯‡è®ºæ–‡æ˜¯ç”±è®¸å¤šå•è¯ç»„æˆã€‚ä½†ä»–å‘ç°ä¸€ä¸ªå•è¯ä¼šåœ¨è®ºæ–‡ä¸­å‡ºç°å¾ˆå¤šæ¬¡ï¼Œç°åœ¨æƒ³çŸ¥é“æ¯ä¸ªå•è¯åˆ†åˆ«åœ¨è®ºæ–‡ä¸­å‡ºç°å¤šå°‘æ¬¡ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>è¿™ä¸ªæ–‡ç« æ˜¯ç”±è¿™ n ä¸ªå•è¯ç»„æˆçš„ï¼Œç°åœ¨é—®æ¯ä¸ªå•è¯å‡ºç°å¤šå°‘æ¬¡ã€‚ç›´æ¥ç”¨æ¯ä¸²åœ¨failæ ‘ä¸ŠåŒ¹é…ç»Ÿè®¡ç›¸åŒå‰ç¼€ä¸ªæ•°æ˜¯ä¸å¯¹çš„ï¼Œå› ä¸ºè¿™æ ·å¯èƒ½å‡ºç°ä¸¤ä¸ªå­ä¸²çš„é‡å ã€‚æ ¹æ®ACè‡ªåŠ¨æœºçš„ç‰¹ç‚¹å•Šï¼Œå¦‚æœæœ‰ä¸ªèŠ‚ç‚¹ x çš„ fail æŒ‡é’ˆæŒ‡å‘ yï¼Œé‚£ä¹ˆè¯´æ˜ y æ˜¯ x çš„å‰ç¼€ï¼Œå³ y æ˜¯ x çš„å­ä¸²ï¼Œé‚£ä¹ˆè‡ªç„¶æœ‰å¤šå°‘ä¸ª fail æŒ‡é’ˆæŒ‡å‘ yï¼Œyå°±å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œè€Œè¿™ä¸ªæ¬¡æ•°å°±æ˜¯æˆ‘ä»¬è¦æ±‚çš„å•è¯å‡ºç°çš„æ¬¡æ•°ã€‚</p><p>é‚£ä¹ˆé¦–å…ˆè¦è®°å½•ACè‡ªåŠ¨æœºä¸Šæ¯ä¸ªèŠ‚ç‚¹å‡ºç°çš„æ¬¡æ•°ï¼Œå› ä¸ºå•è¯å¯èƒ½å‡ºç°é‡å¤ã€‚ç„¶åè¦è®°å½•ç»“æŸæ—¶è¯¥å­ä¸²å¯¹åº”çš„èŠ‚ç‚¹ç¼–å·ï¼ŒEnd[id] = pï¼›ç”±äºæˆ‘ä»¬ fail æŒ‡é’ˆæ˜¯ä»ä¸Šåˆ°ä¸‹æ›´æ–°çš„ï¼Œè€Œæˆ‘ä»¬è¦ç»Ÿè®¡æ¬¡æ•°éœ€è¦ä»ä¸‹åˆ°ä¸Šè½¬ç§»ï¼Œäºæ˜¯åˆ©ç”¨æ ˆæ¥å­˜å‚¨ fail æŒ‡é’ˆè½¬ç§»æ—¶çš„èŠ‚ç‚¹ç¼–å·ï¼Œè€Œåå†æ›´æ–° num æ•°ç»„å³å¯ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">220</span>;</span><br><span class="line"><span class="built_in">string</span> str[N], s;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">30</span>],End[SZ],tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> num[SZ];<span class="comment">// num[x] ä¸ºç»è¿‡èŠ‚ç‚¹xçš„æ•°é‡ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s,<span class="keyword">const</span> <span class="keyword">int</span>&amp; id)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = s.length(), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">num[p]++;</span><br><span class="line">&#125;</span><br><span class="line">End[id] = p; </span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="keyword">int</span> fail[SZ];</span><br><span class="line"><span class="keyword">int</span> Stack[SZ], top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getFail</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++) trie[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">q.push(<span class="number">1</span>); fail[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> p = q.front(); q.pop(); </span><br><span class="line">Stack[++top] = p;<span class="comment">//å€’åºè®°å½•ç¼–å· </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][i]) trie[p][i] = trie[fail[p]][i];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">q.push(trie[p][i]);</span><br><span class="line">fail[trie[p][i]] = trie[fail[p]][i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Insert(str[i],i);</span><br><span class="line">getFail();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = top;i &gt; <span class="number">0</span>;--i)&#123;</span><br><span class="line">num[fail[Stack[i]]] += num[Stack[i]];</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">cout</span> &lt;&lt; num[End[i]] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">cin</span> &gt;&gt; str[i];</span><br><span class="line">solve(); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æœ€çŸ­æ¯ä¸²"><a href="#æœ€çŸ­æ¯ä¸²" class="headerlink" title="æœ€çŸ­æ¯ä¸²"></a>æœ€çŸ­æ¯ä¸²</h4><p><strong>é¢˜æ„æè¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šHNOI 2006<br>ç»™å®š n ä¸ªå­—ç¬¦ä¸² S1,S2,â‹¯,Snï¼Œè¦æ±‚æ‰¾åˆ°ä¸€ä¸ªæœ€çŸ­çš„å­—ç¬¦ä¸² Tï¼Œä½¿å¾—è¿™ n ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯ T çš„å­ä¸²ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>æ ¹æ®ç»éªŒå®¹æ˜“æƒ³åˆ°ï¼Œæ¯ä¸²è¦èµ°å®ŒACè‡ªåŠ¨æœºä¸Šæ‰€æœ‰ æœ‰ç»“æŸæ ‡è®°ï¼ˆEndæ ‡è®°ï¼‰çš„èŠ‚ç‚¹ï¼Œè€Œæœ¬é¢˜çš„ç­”æ¡ˆå°±æ˜¯æ‰¾åˆ°æœ€çŸ­çš„&amp;å­—å…¸åºæœ€å°çš„æ¯ä¸²ã€‚<br>é‚£æåˆ°ç»“æŸæ ‡è®° Endï¼Œå°±åº”è¯¥æƒ³åˆ° End æ ‡è®°çš„è½¬ç§»ï¼Œæˆ‘ä»¬åœ¨æ±‚failæ•°ç»„æ—¶é¡ºä¾¿è½¬ç§»ã€‚å¦‚æœæ¯ä¸ªç»“æŸæ ‡è®°éƒ½ç”¨ä¸åŒidæ ‡è¯†ï¼Œé‚£ä¹ˆæ¯ä¸²åªè¦èƒ½åŒ…å«æ‰€æœ‰ä¸åŒçš„ç»“æŸæ ‡è®°å³å¯ã€‚</p><p>æ—¢ç„¶åªæœ‰æœ€å¤š12ä¸ªå­ä¸²ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ç”¨çŠ¶æ€å‹ç¼©èŠ‚çœç©ºé—´ã€‚æˆ‘ä»¬ç”¨ bfs æ¥æ±‚æœ€çŸ­&amp;å­—å…¸åºæœ€å°æ¯ä¸²ã€‚<br>ç”±äºæ¯ä¸²æœ€é•¿600ï¼Œè€ŒACè‡ªåŠ¨æœºä¸ŠèŠ‚ç‚¹ä¸ªæ•°æœ€å¤š600ï¼Œä½†æ˜¯æ¯ä¸ªèŠ‚ç‚¹çŠ¶æ€æœ‰1&lt;&lt;12ç§ï¼Œå› æ­¤ <code>vis[606][(1&lt;&lt;12)+1]</code> ç”¨äºè¡¨ç¤ºè¯¥èŠ‚ç‚¹çš„å¯¹åº”çŠ¶æ€æ˜¯å¦è¢«è®¿é—®è¿‡ï¼› path[(1&lt;&lt;12)+1]ç”¨äºå­˜æ”¾ç”±ä¸Šä¸€ä¸ªçŠ¶æ€è½¬ç§»è€Œæ¥éœ€è¦æ·»åŠ çš„å­—ç¬¦ï¼›s[606]è‡ªç„¶å°±æ˜¯å­˜æ”¾æœ€ç»ˆæ¯ä¸²ã€‚<br>å½“ç„¶è¿˜éœ€è¦ä¸€äº›è¾…åŠ©æ•°ç»„ï¼Œpar[ ip ]è®°å½• ip çš„ä¸Šä¸€ä¸ªçŠ¶æ€çš„ç¼–å·ï¼Œç”¨äºæŸ¥æ‰¾è·¯å¾„ï¼›å½“ç„¶ç†è®ºä¸Šè®²pathä¹Ÿç®—è¾…åŠ©æ•°ç»„ã€‚<br>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡bfsæ¥å®ç°ä¸åŒçŠ¶æ€é—´çš„è½¬ç§»äº†ï¼Œå®è´¨ä¸Šæ˜¯bfs+çŠ¶æ€å‹ç¼©ï¼Œå®ç°èµ·æ¥è¿˜æ˜¯æœ‰äº›éš¾åº¦çš„ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">60</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">600</span>+<span class="number">10</span>;<span class="comment">//ä¸€å®šè¦æƒ³å¥½å¤§å°å•Š </span></span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> n, fail[SZ];</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">30</span>], End[<span class="number">30</span>], tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">bool</span> vis[<span class="number">605</span>][(<span class="number">1</span>&lt;&lt;<span class="number">12</span>)+<span class="number">1</span>]; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s,<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'A'</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch]; </span><br><span class="line">&#125;</span><br><span class="line">End[p] |= <span class="number">1</span>&lt;&lt;id;<span class="comment">//çŠ¶å‹å¸¸ç”¨ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getFail</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++) trie[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">q.push(<span class="number">1</span>); fail[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> p = q.front(); q.pop();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][i]) trie[p][i] = trie[fail[p]][i];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">q.push(trie[p][i]);</span><br><span class="line">fail[trie[p][i]] = trie[fail[p]][i];</span><br><span class="line">End[trie[p][i]] |= End[fail[trie[p][i]]];<span class="comment">//å¸¸ç”¨æŠ€å·§ </span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*ç”¨æ¥bfsè®¡ç®—æœ€çŸ­æ¯ä¸²*/</span></span><br><span class="line"><span class="keyword">char</span> path[<span class="number">606</span>*(<span class="number">1</span>&lt;&lt;<span class="number">12</span>)] ,s[<span class="number">606</span>];</span><br><span class="line"><span class="keyword">int</span> par[<span class="number">606</span>*(<span class="number">1</span>&lt;&lt;<span class="number">12</span>)],len = <span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="comment">/*åˆ†åˆ«æ˜¯èŠ‚ç‚¹ç¼–å·,å½“å‰çŠ¶æ€,å½“å‰å­—ç¬¦ä½ç½® */</span> </span><br><span class="line"><span class="keyword">int</span> p,now,ip;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">queue</span>&lt;Node&gt; q2; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">q2.push(Node&#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;);</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q2.empty())&#123;</span><br><span class="line">Node x = q2.front(); q2.pop();</span><br><span class="line"><span class="keyword">int</span> p = x.p,now = x.now,ip = x.ip;</span><br><span class="line"><span class="keyword">if</span>(now == (<span class="number">1</span>&lt;&lt;n)<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="comment">/*æ‰€æœ‰å­ä¸²éƒ½åŒ…å«äº†,å¯ä»¥è¾“å‡ºç­”æ¡ˆäº†*/</span> </span><br><span class="line"><span class="keyword">for</span>(;ip;ip = par[ip]) s[len++] = path[ip];</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>,nex;i &lt; <span class="number">26</span>;i++)</span><br><span class="line"><span class="keyword">if</span>(!vis[trie[p][i]][nex = now|End[trie[p][i]]])&#123;</span><br><span class="line"><span class="comment">/*å½“å‰èŠ‚ç‚¹çš„ç¬¬iä¸ªå­—ç¬¦çš„ nex çŠ¶æ€æœªè¢«è®¿é—®è¿‡,è®¿é—®å¹¶å‹å…¥é˜Ÿåˆ—*/</span> </span><br><span class="line">vis[trie[p][i]][nex] = <span class="number">1</span>;</span><br><span class="line">path[++cnt] = i+<span class="string">'A'</span>, par[cnt] = ip;</span><br><span class="line"><span class="comment">/*å‹å…¥ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„ç¼–å·,çŠ¶æ€,å­—ç¬¦ç»“æŸä½ç½®*/</span> </span><br><span class="line">q2.push(Node&#123;trie[p][i],nex,cnt&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">getFail(); bfs();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = len<span class="number">-1</span>;i &gt;= <span class="number">0</span>;i--) <span class="built_in">putchar</span>(s[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str); Insert(str,i<span class="number">-1</span>); </span><br><span class="line">&#125;</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="POI-2000-ç—…æ¯’"><a href="#POI-2000-ç—…æ¯’" class="headerlink" title="POI 2000 ç—…æ¯’"></a>POI 2000 ç—…æ¯’</h4><p><strong>é¢˜æ„ç®€è¿°</strong></p><p>äºŒè¿›åˆ¶ç—…æ¯’å®¡æŸ¥å§”å‘˜ä¼šæœ€è¿‘å‘ç°äº†å¦‚ä¸‹çš„è§„å¾‹ï¼šæŸäº›ç¡®å®šçš„äºŒè¿›åˆ¶ä¸²æ˜¯ç—…æ¯’çš„ä»£ç ã€‚å¦‚æœæŸæ®µä»£ç ä¸­ä¸å­˜åœ¨ä»»ä½•ä¸€æ®µç—…æ¯’ä»£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç§°è¿™æ®µä»£ç æ˜¯å®‰å…¨çš„ã€‚ç°åœ¨å§”å‘˜ä¼šå·²ç»æ‰¾å‡ºäº†æ‰€æœ‰çš„ç—…æ¯’ä»£ç æ®µï¼Œè¯•é—®ï¼Œæ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ— é™é•¿çš„å®‰å…¨çš„äºŒè¿›åˆ¶ä»£ç ã€‚<br>ç¤ºä¾‹ï¼šä¾‹å¦‚å¦‚æœ {011,11,00000} ä¸ºç—…æ¯’ä»£ç æ®µï¼Œé‚£ä¹ˆä¸€ä¸ªå¯èƒ½çš„æ— é™é•¿å®‰å…¨ä»£ç å°±æ˜¯ 010101â‹¯ã€‚å¦‚æœ {01,11,000000} ä¸ºç—…æ¯’ä»£ç æ®µï¼Œé‚£ä¹ˆå°±ä¸å­˜åœ¨ä¸€ä¸ªæ— é™é•¿çš„å®‰å…¨ä»£ç ã€‚<br>è¯·å†™ä¸€ä¸ªç¨‹åºï¼Œè¯»å…¥ç—…æ¯’ä»£ç ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ— é™é•¿çš„å®‰å…¨ä»£ç ï¼Œå°†ç»“æœè¾“å‡ºã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æœ¬é¢˜è¦æ±‚æ‰¾å‡ºä¸€ä¸ªæ— é™é•¿çš„å®‰å…¨çš„ä»£ç ï¼Œæ— é™é•¿ï¼Œå½“ä¸”ä»…å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªå®‰å…¨çš„å­ä¸²å¯ä»¥å¾ªç¯ä½¿ç”¨æ—¶æ‰èƒ½æ„æˆã€‚æˆ‘ä»¬å°†ACè‡ªåŠ¨æœºçœ‹ä½œæ ‘ï¼Œä»æ ¹å‡ºå‘ï¼Œé‚£ä¹ˆå¶å­èŠ‚ç‚¹ï¼Œå³æœ‰Endæ ‡è®°çš„èŠ‚ç‚¹æ˜¯ä¸èƒ½èµ°çš„ï¼Œå› ä¸ºè¯¥è·¯å¾„æ„æˆäº†ç—…æ¯’ã€‚åŒæ ·çš„é“ç†ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹failæŒ‡é’ˆæ‰€æŒ‡å‘çš„èŠ‚ç‚¹æœ‰Endæ ‡è®°ï¼Œé‚£ä¹ˆå½“å‰èŠ‚ç‚¹ä¹Ÿä¸èƒ½èµ°ï¼Œå› ä¸ºå®ƒçš„å­ä¸²æ˜¯ç—…æ¯’ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ›´æ–°failæŒ‡é’ˆæ—¶é¡ºä¾¿è½¬ç§»Endæ ‡è®°ï¼ˆå¸¸ç”¨æŠ€å·§ï¼‰ã€‚<br>æ‰€ä»¥å¦‚æœæœ‰ä¸€æ¡è·¯å¾„ï¼Œå®ƒä¸Šé¢çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æ²¡æœ‰Endæ ‡è®°ï¼Œä¸”è¯¥è·¯å¾„æ„æˆç¯ï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥æ„æˆä¸€ä¸ªæ— é™é•¿çš„å®‰å…¨å­—ç¬¦ä¸²ã€‚</p><p>äºæ˜¯æˆ‘ä»¬å°±åªéœ€è¦åœ¨ACè‡ªåŠ¨æœºä¸Šé€šè¿‡dfsæ¥æ‰¾æ˜¯å¦å­˜åœ¨æ»¡è¶³æ¡ä»¶çš„ç¯å³å¯ï¼Œè€Œç”¨æ‹“æ‰‘æ’åºä¸å¤ªå¥½å†™ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2100</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="built_in">string</span> str[N];</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">3</span>],End[SZ],fail[SZ],tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = s.length(), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">End[p]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="keyword">bool</span> f[SZ];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getFail</span><span class="params">()</span></span>&#123;</span><br><span class="line">trie[<span class="number">0</span>][<span class="number">0</span>] = trie[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">q.push(<span class="number">1</span>); fail[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> p = q.front(); q.pop();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">2</span>;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][i]) trie[p][i] = trie[fail[p]][i];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">q.push(trie[p][i]);</span><br><span class="line">fail[trie[p][i]] = trie[fail[p]][i];</span><br><span class="line">End[trie[p][i]] |= End[trie[fail[p]][i]];<span class="comment">//è½¬ç§»æ ‡è®°</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">int</span> vis[SZ],ins[SZ];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">vis[p] = ins[p] = <span class="number">1</span>;    <span class="comment">//insåˆ¤æ–­ç¯,visè®¿é—®æ ‡è®°</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">2</span>;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> k = trie[p][i];</span><br><span class="line"><span class="keyword">if</span>(ins[k]) flag = <span class="literal">true</span>;<span class="comment">//æ„æˆç¯äº†,è¿™é‡Œä¹Ÿå¯ä»¥return</span></span><br><span class="line"><span class="keyword">if</span>(!End[k] &amp;&amp; !vis[k]) dfs(k);<span class="comment">//ä¸‹ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„èŠ‚ç‚¹,é€’å½’è®¿é—®å®ƒ</span></span><br><span class="line">&#125;</span><br><span class="line">ins[p] = <span class="number">0</span>;<span class="comment">//é‡Šæ”¾pèŠ‚ç‚¹çš„æ ‡è®°</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Insert(str[i]);</span><br><span class="line">getFail();</span><br><span class="line">dfs(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(flag) <span class="built_in">cout</span> &lt;&lt; <span class="string">"TAK"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="string">"NIE"</span> &lt;&lt; <span class="built_in">endl</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">cin</span> &gt;&gt; str[i];</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="æ–‡æœ¬ç”Ÿæˆå™¨"><a href="#æ–‡æœ¬ç”Ÿæˆå™¨" class="headerlink" title="æ–‡æœ¬ç”Ÿæˆå™¨"></a>æ–‡æœ¬ç”Ÿæˆå™¨</h4><p><strong>é¢˜æ„ç®€è¿°</strong></p><p>åŸé¢˜æ¥è‡ªï¼šJSOI 2007JSOI<br>äº¤ç»™é˜Ÿå‘˜ ZYX ä¸€ä¸ªä»»åŠ¡ï¼Œç¼–åˆ¶ä¸€ä¸ªç§°ä¹‹ä¸ºã€Œæ–‡æœ¬ç”Ÿæˆå™¨ã€çš„ç”µè„‘è½¯ä»¶ï¼šè¯¥è½¯ä»¶çš„ä½¿ç”¨è€…æ˜¯ä¸€äº›ä½å¹¼äººç¾¤ï¼Œä»–ä»¬ç°åœ¨ä½¿ç”¨çš„æ˜¯ GW æ–‡æœ¬ç”Ÿæˆå™¨ v6 ç‰ˆã€‚è¯¥è½¯ä»¶å¯ä»¥éšæœºç”Ÿæˆä¸€äº›æ–‡ç« â€•â€•æ€»æ˜¯ç”Ÿæˆä¸€ç¯‡é•¿åº¦å›ºå®šä¸”å®Œå…¨éšæœºçš„æ–‡ç« â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œç”Ÿæˆçš„æ–‡ç« ä¸­æ¯ä¸ªå­—èŠ‚éƒ½æ˜¯å®Œå…¨éšæœºçš„ã€‚<br>å¦‚æœä¸€ç¯‡æ–‡ç« ä¸­è‡³å°‘åŒ…å«ä½¿ç”¨è€…ä»¬äº†è§£çš„ä¸€ä¸ªå•è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´è¿™ç¯‡æ–‡ç« æ˜¯å¯è¯»çš„ï¼ˆæˆ‘ä»¬ç§°æ–‡ç«  a åŒ…å«å•è¯ bï¼Œå½“ä¸”ä»…å½“å•è¯ b æ˜¯æ–‡ç«  a çš„å­ä¸²ï¼‰ã€‚ä½†æ˜¯ï¼Œå³ä½¿æŒ‰ç…§è¿™æ ·çš„æ ‡å‡†ï¼Œä½¿ç”¨è€…ç°åœ¨ä½¿ç”¨çš„ GW æ–‡æœ¬ç”Ÿæˆå™¨ v6 ç‰ˆæ‰€ç”Ÿæˆçš„æ–‡ç« ä¹Ÿæ˜¯å‡ ä¹å®Œå…¨ä¸å¯è¯»çš„ã€‚<br>ZYX éœ€è¦æŒ‡å‡º GW æ–‡æœ¬ç”Ÿæˆå™¨ v6 ç”Ÿæˆçš„æ‰€æœ‰æ–‡æœ¬ä¸­å¯è¯»æ–‡æœ¬çš„æ•°é‡ï¼Œä»¥ä¾¿èƒ½å¤ŸæˆåŠŸè·å¾— v7 æ›´æ–°ç‰ˆã€‚ä½ èƒ½å¸®åŠ©ä»–å—ï¼Ÿ</p><p><strong>è§£é¢˜æ€è·¯</strong><br>é¦–å…ˆæ˜“å¾—æ‰€æœ‰ä¸åŒçš„æ–‡æœ¬æ€»æ•°ä¸º$26^m$ç§ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§å®¹æ˜“æƒ³åˆ°çš„æ€è·¯æ¥æ±‚è§£ï¼Œä¸€ä¸ªæ˜¯åˆ©ç”¨å®¹æ–¥åŸç†ç›´æ¥è®¡ç®—å¯è¯»çš„æ–‡ç« æ€»æ•°ï¼Œå¦ä¸€ç§æ˜¯æƒ³åŠæ³•è®¡ç®—ä¸å¯è¯»çš„æ–‡ç« æ•°ï¼Œå†ç”¨ä¸åŒçš„æ–‡ç« æ€»æ•°å‡å»å®ƒã€‚ç¬¬ä¸€ç§æ€è·¯å¾ˆéš¾å®ç°ï¼Œä¸»è¦æ¥çœ‹ç¬¬äºŒç§æ€è·¯å¦‚ä½•å®ç°ã€‚<br>ç±»ä¼¼ä¸Šä¸€é¢˜ï¼Œå¦‚æœä¸€ä¸ªæ–‡ç« æ˜¯ä¸å¯è¯»çš„ï¼Œé‚£ä¹ˆä»æ ¹å‡ºå‘ï¼Œå®ƒä¸èƒ½ç»è¿‡æœ‰Endæ ‡è®°çš„èŠ‚ç‚¹ï¼Œä¹Ÿä¸èƒ½ç»è¿‡â€œfailæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹æœ‰Endæ ‡è®°â€çš„èŠ‚ç‚¹ã€‚æ‰€ä»¥ä¸å¯è¯»çš„æ–‡ç« æ€»æ•°å°±ç­‰äºé•¿åº¦ä¸ºmçš„<strong>åˆæ³•è·¯å¾„</strong>æ•°ã€‚æ‰€è°“çš„åˆæ³•è·¯å¾„å°±æ˜¯ä¸Šé¢æåˆ°çš„ï¼Œè·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹éƒ½æ²¡æœ‰Endæ ‡è®°ï¼Œä¸”å…¶failæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ä¹Ÿæ²¡Endæ ‡è®°ã€‚<br>æˆ‘ä»¬é€šè¿‡åŠ¨æ€è§„åˆ’æ¥æ±‚<strong>æ–¹æ¡ˆæ€»æ•°</strong>ï¼Œè®¾f(i,j)è¡¨ç¤ºä»æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œèµ°äº† i æ­¥åˆ°è¾¾èŠ‚ç‚¹ j æ—¶çš„åˆæ³•æ–¹æ¡ˆæ€»æ•°ï¼Œé‚£ä¹ˆæ˜¾ç„¶ f(0 , 1) = 1ï¼Œå› ä¸ºèŠ‚ç‚¹ 1 æ˜¯ACè‡ªåŠ¨æœºçš„æ ¹èŠ‚ç‚¹ã€‚<br>çŠ¶æ€è½¬ç§»æ–¹ç¨‹è¯·ç»“åˆä»£ç ç†è§£ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1e4</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">6000</span>*<span class="number">30</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">65</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">char</span> str[N][<span class="number">110</span>];</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">30</span>],End[SZ],fail[SZ],tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'A'</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">End[p]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getFail</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++) trie[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">q.push(<span class="number">1</span>); fail[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> p = q.front(); q.pop();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][i]) trie[p][i] = trie[fail[p]][i];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">q.push(trie[p][i]);</span><br><span class="line">fail[trie[p][i]] = trie[fail[p]][i];</span><br><span class="line">End[trie[p][i]] |= End[trie[fail[p]][i]];<span class="comment">//æ ‡è®°è½¬ç§» </span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">110</span>][SZ] ,ans ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getAns</span><span class="params">()</span></span>&#123;</span><br><span class="line">f[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= tot;j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(End[j]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt; <span class="number">26</span>;k++)&#123;</span><br><span class="line"><span class="comment">/*f[i][trie[j][k]]çš„æ–¹æ¡ˆæ€»æ•°æ˜¾ç„¶ç­‰äºå®ƒæ‰€æœ‰çˆ¶äº²çš„æ–¹æ¡ˆæ€»æ•°çš„å’Œ*/</span></span><br><span class="line">f[i][trie[j][k]] = (f[i][trie[j][k]]+f[i<span class="number">-1</span>][j])%P;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>,tmp = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= tot;i++) </span><br><span class="line"><span class="keyword">if</span>(!End[i]) res = (res+f[m][i])%P;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++) tmp = tmp*<span class="number">26</span>%P;</span><br><span class="line">ans = (tmp-res+P)%P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Insert(str[i]);</span><br><span class="line">getFail();</span><br><span class="line">getAns();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%s"</span>,str[i]);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ACè‡ªåŠ¨æœº </tag>
            
            <tag> çŠ¶æ€å‹ç¼© </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ACè‡ªåŠ¨æœºæ¨¡æ¿</title>
      <link href="/2019/10/02/acji/"/>
      <url>/2019/10/02/acji/</url>
      
        <content type="html"><![CDATA[<h4 id="ACè‡ªåŠ¨æœº"><a href="#ACè‡ªåŠ¨æœº" class="headerlink" title="ACè‡ªåŠ¨æœº"></a>ACè‡ªåŠ¨æœº</h4><p>ACè‡ªåŠ¨æœºæ˜¯ç”¨æ¥å¤„ç†å­—ç¬¦ä¸²åŒ¹é…é—®é¢˜ã€‚KMPæ˜¯å¤„ç†å•æ¨¡å¼ä¸²åŒ¹é…é—®é¢˜ï¼Œè€ŒACè‡ªåŠ¨æœºæ˜¯ç”¨äºå¤„ç†å¤šæ¨¡å¼ä¸²åŒ¹é…é—®é¢˜ï¼Œä¾‹å¦‚ï¼šç»™å‡º n ä¸ªå•è¯ï¼Œå†ç»™å‡ºä¸€æ®µåŒ…å« m ä¸ªå­—ç¬¦çš„æ–‡ç« ï¼Œé—®æœ‰å¤šå°‘ä¸ªå•è¯åœ¨æ–‡ç« ä¸­å‡ºç°è¿‡ï¼Ÿä»¥ä¸‹æ¨¡æ¿å°±æ˜¯æ ¹æ®è¯¥é—®é¢˜æ•´ç†ã€‚</p><p><strong>ä½¿ç”¨è¯´æ˜</strong><br>å…¶ä¸­çš„trieæ ‘ç¼–å·æ˜¯ä» 1 å¼€å§‹ï¼Œæ¯æ¬¡ä½¿ç”¨å‰éƒ½è¦åˆå§‹åŒ– tot = 1ï¼Œä»¥åŠtrieæ•°ç»„ã€Endæ•°ç»„éƒ½è¦åˆå§‹åŒ–ã€‚<br>SZè®¾è®¡è¦åˆç†ï¼ŒSZè¡¨ç¤ºå­—å…¸æ ‘ä¸­çš„èŠ‚ç‚¹æ•°ç›®ä¸Šé™ï¼Œå¤ªå¤šæˆ–å¤ªå°‘éƒ½ä¼šè¿è¡Œé”™è¯¯ã€‚<br>æœ¬æ–‡åˆ©ç”¨queueæ¥å®ç°bfsï¼Œå«Œæ…¢å¯ä»¥æ‰‹å†™æ¨¡æ‹Ÿï¼Œä¸ä¼šéº»çƒ¦å¤šå°‘ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><a href="http://ybt.ssoier.cn:8088/problem_show.php?pid=1479" target="_blank" rel="noopener">Keywords Search</a><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span>+<span class="number">10</span>;<span class="comment">//æ¨¡å¼ä¸²ä¸ªæ•° </span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e6</span>+<span class="number">10</span>;<span class="comment">//æ–‡æœ¬ä¸²é•¿åº¦ </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> str[N][<span class="number">50</span>],s[M];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">50</span>*N;<span class="comment">//trieèŠ‚ç‚¹æ•° </span></span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">30</span>],End[SZ],tot ;</span><br><span class="line"><span class="keyword">int</span> fail[SZ];<span class="comment">//å¤±é…æŒ‡é’ˆ,ç±»ä¼¼äºnex</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(trie,<span class="number">0</span>,<span class="keyword">sizeof</span> trie);</span><br><span class="line"><span class="built_in">memset</span>(End,<span class="number">0</span>,<span class="keyword">sizeof</span> End); tot = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line"><span class="comment">/* å‘trieæ ‘ä¸­æ’å…¥å­—ç¬¦ä¸²s */</span> </span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">End[p]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getFail</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*åˆ©ç”¨bfsæ›´æ–°failæ•°ç»„*/</span> </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++) trie[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">q.push(<span class="number">1</span>); fail[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> p = q.front(); q.pop();</span><br><span class="line"><span class="comment">//printf("%d\n",q.size());</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][i]) trie[p][i] = trie[fail[p]][i];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">q.push(trie[p][i]);</span><br><span class="line">fail[trie[p][i]] = trie[fail[p]][i];</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ask</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="comment">/* ç»Ÿè®¡åŒ¹é…æˆåŠŸçš„æ¨¡å¼ä¸²ä¸ªæ•°å¹¶ç´¯åŠ åˆ°ansä¸Š */</span> </span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">int</span> k = trie[p][ch];</span><br><span class="line"><span class="keyword">while</span>(k &gt; <span class="number">1</span>)&#123;</span><br><span class="line">ans += End[k]; End[k] = <span class="number">0</span>;</span><br><span class="line">k = fail[k];</span><br><span class="line">&#125;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> t,n;<span class="comment">//æ•°ç»„ç»„æ•°, æ¨¡å¼ä¸²ä¸ªæ•° </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Insert(str[i]);</span><br><span class="line">getFail(); ans = <span class="number">0</span>;</span><br><span class="line">ask(s);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line">init();<span class="comment">//å¤šç»„æ•°æ®ä¸è¦å¿˜äº†åˆå§‹åŒ–ï¼ </span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%s"</span>,str[i]);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,s);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h5 id="å¯¹getFail-å‡½æ•°çš„ä¸€äº›è§£é‡Š"><a href="#å¯¹getFail-å‡½æ•°çš„ä¸€äº›è§£é‡Š" class="headerlink" title="å¯¹getFail()å‡½æ•°çš„ä¸€äº›è§£é‡Š"></a>å¯¹getFail()å‡½æ•°çš„ä¸€äº›è§£é‡Š</h5><p>fail æ•°ç»„å°±åƒæ˜¯ kmp ç®—æ³•ä¸­çš„ nex æ•°ç»„ä¸€æ ·ï¼Œæ˜¯åœ¨å¤±é…æ—¶è½¬ç§»æŒ‡é’ˆç”¨çš„ï¼Œåˆ©ç”¨å®ƒå¯ä»¥ä½¿å¾—æ—¶é—´æ§åˆ¶åœ¨O(N)ã€‚<br>å°±ä¸Šè¿°ä»£ç è€Œè¨€ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•æ›´æ–°failæ•°ç»„çš„å‘¢ï¼Ÿ</p><ul><li>é¦–å…ˆæ ¹èŠ‚ç‚¹è‹¥å¤±é…ï¼Œåˆ™æ— æ³•åŒ¹é…å­—ç¬¦ï¼Œå³ fail[1] = 0ã€‚</li><li>è‹¥å½“å‰ä½ç½®æœ‰å­—ç¬¦ï¼Œåˆ™å®ƒçš„å¤±é…æŒ‡é’ˆæŒ‡å‘â€œå®ƒçˆ¶äº²èŠ‚ç‚¹å¤±é…æŒ‡é’ˆæ‰€æŒ‡å‘èŠ‚ç‚¹ çš„ ä¸‹ä¸€ä¸ªèŠ‚ç‚¹â€ï¼Œå³ <code>fail[ trie[p][i] ]  = fail[ fail[p] ][i]</code>ï¼Œå…¶æ€æƒ³ç±»ä¼¼kmpä¸­nexè½¬ç§»ã€‚</li><li>è‹¥å½“å‰ä½ç½®æ— å­—ç¬¦ï¼Œå³<code>trie[p][i] = 0</code>ï¼Œé‚£ä¹ˆå°±è®©å½“å‰èŠ‚ç‚¹æŒ‡å‘å…¶å¤±é…æŒ‡é’ˆçš„å­èŠ‚ç‚¹ï¼Œå³<code>trie[p][i] = trie[ fail[p] ][i]</code>ã€‚</li></ul><p>ç¬¬ 3 æ­¥ç ´åäº† trie çš„ç»“æ„ï¼Œä½†è¿™æ ·å¯ä»¥ä¼˜åŒ–æ—¶é—´ã€‚è‹¥ä¸å­˜åœ¨<code>trie[p][i]</code> çš„è½¬ç§»è¾¹åˆ™æŒ‡å‘ <code>trie[ fail[p] ][i]</code>ï¼Œå› ä¸ºåœ¨å…·ä½“é—®é¢˜ä¸­ï¼Œè‹¥ä¸å­˜åœ¨<code>trie[p][i]</code> åˆ™éœ€è¦æ²¿ç€ p çš„å‰ç¼€æŒ‡é’ˆèµ°åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³å­˜åœ¨ i å­—ç¬¦çš„è½¬ç§»è¾¹çš„ç‚¹ vï¼Œå¾—åˆ°<code>trie[v][i]</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥ä»¤ <code>trie[p][i] = trie[v][i]</code> å³å¯ä½¿å¾—è¯¥æƒ…å†µå¾—åˆ°ä¼˜åŒ–ï¼Œç±»ä¼¼è®°å¿†åŒ– &amp; è·¯å¾„å‹ç¼©ã€‚<br>ä¹Ÿæ­£æ˜¯è¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬åœ¨æ„å»º fail æ•°ç»„æ—¶ï¼Œæ²¡æœ‰å¤„ç† v çš„è½¬ç§»è¾¹ i ä¸å­˜åœ¨çš„æƒ…å†µï¼Œè€Œæ˜¯ç›´æ¥<code>fail[ trie[p][i] = trie[v][i]</code>ï¼ˆå…¶ä¸­ <code>trie[v][i]</code> åœ¨ä¹‹å‰å·²ç»å¤„ç†å¥½äº†ï¼‰ã€‚</p><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>è‘£æ°¸å»ºï¼Œä¿¡æ¯å­¦ç«èµ›ä¸€æœ¬é€šæé«˜ç‰ˆï¼Œç¦å·ï¼šç¦å»ºæ•™è‚²å‡ºç‰ˆç¤¾ï¼Œ2018.6ï¼Œ93-97</li><li><a href="https://bestsort.cn/2019/04/28/402/" target="_blank" rel="noopener">bestsort</a>çš„åšå®¢</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> ACè‡ªåŠ¨æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Trieå­—å…¸æ ‘ç»ƒä¹ é¢˜é›†</title>
      <link href="/2019/09/30/trie-problems/"/>
      <url>/2019/09/30/trie-problems/</url>
      
        <content type="html"><![CDATA[<p><a href="http://ybt.ssoier.cn:8088/index.php" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a></p><h4 id="Phone-List"><a href="#Phone-List" class="headerlink" title="Phone List"></a>Phone List</h4><p>åŸé¢˜æ¥è‡ªï¼šPOJ 3630<br>ç»™å®š n ä¸ªé•¿åº¦ä¸è¶…è¿‡ 10 çš„æ•°å­—ä¸²ï¼Œé—®å…¶ä¸­æ˜¯å¦å­˜åœ¨ä¸¤ä¸ªæ•°å­—ä¸² S,Tï¼Œä½¿å¾— S æ˜¯ T çš„å‰ç¼€ï¼Œå¤šç»„æ•°æ®ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>Trieçš„ç»å…¸åº”ç”¨ï¼Œå¯ä»¥ä½œä¸ºæ¨¡æ¿é¢˜ç»ƒæ‰‹ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">30</span>], tot;</span><br><span class="line"><span class="keyword">int</span> End[SZ];</span><br><span class="line"><span class="keyword">int</span> n,t;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N][<span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="comment">/* å°†å­—ä¸²sæ’å…¥trieæ ‘ */</span></span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s) ,p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">if</span>(trie[p][ch] == <span class="number">0</span>) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">End[p]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">search</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="comment">/* å­—ä¸²sæ˜¯å¦æœ‰å‰ç¼€ */</span> </span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">if</span>(End[p]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Insert(str[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">if</span>(search(str[i])) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n); </span><br><span class="line"><span class="comment">/* åˆå§‹åŒ–trieç›¸å…³å˜é‡ */</span></span><br><span class="line"><span class="built_in">memset</span>(End,<span class="number">0</span>,<span class="keyword">sizeof</span> End); tot = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">memset</span>(trie,<span class="number">0</span>,<span class="keyword">sizeof</span> trie);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%s"</span>,str[i]);</span><br><span class="line"><span class="keyword">if</span>(solve()) <span class="built_in">puts</span>(<span class="string">"NO"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="The-XOR-Largest-Pair"><a href="#The-XOR-Largest-Pair" class="headerlink" title="The XOR Largest Pair"></a>The XOR Largest Pair</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åœ¨ç»™å®šçš„ N ä¸ªæ•´æ•° A1,A2,â€¦,AN ä¸­é€‰å‡ºä¸¤ä¸ªè¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¾—åˆ°çš„ç»“æœæœ€å¤§æ˜¯å¤šå°‘ï¼Ÿ</p><p><strong>è§£é¢˜æ€è·¯</strong><br>å°±æ˜¯å°†æ¯ä¸ªæ•´æ•°çœ‹ä½œ31ä½çš„01å­—ç¬¦ä¸²ï¼Œç„¶åå…¨éƒ¨æ’å…¥åˆ°Trieä¸Šï¼Œå†åˆ†åˆ«å¯¹æ¯ä¸ªæ•´æ•°ä»é«˜ä½åˆ°ä½ä½ä¼˜å…ˆåœ¨Trieä¸Šèµ°å’Œè¯¥ä½ç›¸åçš„èŠ‚ç‚¹ã€‚01å­—å…¸æ ‘ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">5e6</span>+<span class="number">10</span>;<span class="comment">//å¤§å°è¦åˆç†ï¼ï¼ï¼ </span></span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">3</span>], End[SZ], tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">31</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = (x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(trie[p][ch] == <span class="number">0</span>) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">End[p]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>, p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">31</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = (x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(trie[p][!ch]) p = trie[p][!ch], res |= <span class="number">1</span>&lt;&lt;i;</span><br><span class="line"><span class="keyword">else</span> p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">ans = max(ans,res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Insert(a[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) calc(a[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Codechef-REBXOR"><a href="#Codechef-REBXOR" class="headerlink" title="Codechef REBXOR*"></a>Codechef REBXOR*</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br><img src="/2019/09/30/trie-problems/1.png" alt="trie-problems/1.png"><br><strong>è§£é¢˜æ€è·¯</strong><br>è¿™é¢˜ç”¨çš„æ˜¯ â€œTrieç»´æŠ¤å¼‚æˆ–å‰ç¼€å’Œâ€ï¼Œæ ¹æ®å¼‚æˆ–çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬ä»å·¦åˆ°å³ä¾æ¬¡å°†å…ƒç´ æ’å…¥åï¼Œå†åˆ©ç”¨ x^y^x = y è¿™ä¸ªç‰¹æ€§åœ¨å¸¸æ•°æ—¶é—´åˆ©ç”¨ Trie æ‰¾æœ€å¤§åŒºé—´å¼‚æˆ–å’Œã€‚æœ¬é¢˜è¿˜æ˜¯å¾ˆæœ‰å‚è€ƒæ„ä¹‰çš„ï¼Œå°¤å…¶æ˜¯å¼‚æˆ–å‰ç¼€å’Œè¿™ä¸€æŠ€å·§ã€‚<br>å½“ç„¶ç”±äºOJä¸Šç»™å®šçš„ç©ºé—´è¿‡å°ï¼Œæœ¬ä»£ç æ²¡è¿‡ï¼Œå¾…è§£å†³ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">20</span>*N;</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">3</span>], tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],lmx[N],rmx[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">32</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = (x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">1</span>, res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">32</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = (x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(trie[p][!ch]) p = trie[p][!ch],res |= <span class="number">1</span>&lt;&lt;i;</span><br><span class="line"><span class="keyword">else</span> p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> x = <span class="number">0</span>;Insert(<span class="number">0</span>);</span><br><span class="line"><span class="comment">/* x ç”¨äºç´¯è®¡å¼‚æˆ–å‰ç¼€å’Œ,Trieç”¨äºæ±‚æœ€å¤§å¼‚æˆ–åŒºé—´*/</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">x ^= a[i]; Insert(x);</span><br><span class="line">lmx[i] = max(search(x),lmx[i<span class="number">-1</span>]);</span><br><span class="line"><span class="comment">//åŒ…å«xçš„æœ€å¤§åŒºé—´å¼‚æˆ–å’Œ ä¸  ä¸åŒ…å«xçš„åŒºé—´çš„æœ€å¤§å¼‚æˆ–å’Œ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">memset</span>(trie,<span class="number">0</span>,<span class="keyword">sizeof</span> trie); tot = <span class="number">1</span>;</span><br><span class="line">Insert(<span class="number">0</span>); x = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = n;i &gt; <span class="number">0</span>;i--)&#123;</span><br><span class="line">x ^= a[i]; Insert(x);</span><br><span class="line">rmx[i] = max(search(x),rmx[i+<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) ans = max(ans,lmx[i]+rmx[i+<span class="number">1</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c!=<span class="string">'-'</span> &amp;&amp; (c&lt;<span class="string">'0'</span> || c&gt;<span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span> (c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c&gt;=<span class="string">'0'</span> &amp;&amp; c&lt;=<span class="string">'9'</span>)</span><br><span class="line">ans = ans*<span class="number">10</span> + c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg ? -ans : ans; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line">n = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) a[i] = getInt();</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Immediate-Decodability"><a href="#Immediate-Decodability" class="headerlink" title="Immediate Decodability"></a>Immediate Decodability</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šACM Pacific NW Region 1998<br>ç»™å‡ºä¸€äº›æ•°å­—ä¸²ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ä¸€ä¸ªæ•°å­—ä¸²æ˜¯å¦ä¸€ä¸ªä¸²çš„å‰ç¼€ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>å’Œç¬¬1é¢˜ä¸€æ ·ï¼Œæ¨¡æ¿é¢˜ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">30</span>], tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> End[SZ];</span><br><span class="line"><span class="keyword">int</span> n,t,cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N][<span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="comment">/* å°†å­—ä¸²sæ’å…¥trieæ ‘ */</span></span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s) ,p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">if</span>(trie[p][ch] == <span class="number">0</span>) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">End[p]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">search</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="comment">/* å­—ä¸²sæ˜¯å¦æœ‰å‰ç¼€ */</span> </span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">if</span>(End[p]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Insert(str[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">if</span>(search(str[i])) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str[++n]) != EOF)&#123;</span><br><span class="line"><span class="comment">/* åˆå§‹åŒ–trieç›¸å…³å˜é‡ */</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">strlen</span>(str[n]) == <span class="number">1</span> &amp;&amp; str[n][<span class="number">0</span>] == <span class="string">'9'</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(!solve()) <span class="built_in">printf</span>(<span class="string">"Set %d is immediately decodable\n"</span>,++cnt);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"Set %d is not immediately decodable\n"</span>,++cnt);</span><br><span class="line"><span class="built_in">memset</span>(End,<span class="number">0</span>,<span class="keyword">sizeof</span> End); tot = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">memset</span>(trie,<span class="number">0</span>,<span class="keyword">sizeof</span> trie); n = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Lè¯­è¨€"><a href="#Lè¯­è¨€" class="headerlink" title="Lè¯­è¨€*"></a>Lè¯­è¨€*</h4><p><strong>é¢˜æ„ç®€è¿°</strong></p><p>åŸé¢˜æ¥è‡ªï¼šHNOI 2004<br>æ ‡ç‚¹ç¬¦å·çš„å‡ºç°æ™šäºæ–‡å­—çš„å‡ºç°ï¼Œæ‰€ä»¥ä»¥å‰çš„è¯­è¨€éƒ½æ˜¯æ²¡æœ‰æ ‡ç‚¹çš„ã€‚ç°åœ¨ä½ è¦å¤„ç†çš„å°±æ˜¯ä¸€æ®µæ²¡æœ‰æ ‡ç‚¹çš„æ–‡ç« ã€‚<br>ä¸€æ®µæ–‡ç«  T æ˜¯ç”±è‹¥å¹²å°å†™å­—æ¯æ„æˆã€‚ä¸€ä¸ªå•è¯ W ä¹Ÿæ˜¯ç”±è‹¥å¹²å°å†™å­—æ¯æ„æˆã€‚ä¸€ä¸ªå­—å…¸ D æ˜¯è‹¥å¹²ä¸ªå•è¯çš„é›†åˆã€‚<br>æˆ‘ä»¬ç§°ä¸€æ®µæ–‡ç«  T åœ¨æŸä¸ªå­—å…¸ D ä¸‹æ˜¯å¯ä»¥è¢«ç†è§£çš„ï¼Œæ˜¯æŒ‡å¦‚æœæ–‡ç«  T å¯ä»¥è¢«åˆ†æˆè‹¥å¹²éƒ¨åˆ†ï¼Œä¸”æ¯ä¸€ä¸ªéƒ¨åˆ†éƒ½æ˜¯å­—å…¸ D ä¸­çš„å•è¯ã€‚ä¾‹å¦‚å­—å…¸ D ä¸­åŒ…æ‹¬å•è¯ is , your , what , name ï¼Œåˆ™æ–‡ç«  whatisyourname æ˜¯åœ¨å­—å…¸ D ä¸‹å¯ä»¥è¢«ç†è§£çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥åˆ†æˆ 4 ä¸ªå•è¯ï¼š what , is , your , name ï¼Œä¸”æ¯ä¸ªå•è¯éƒ½å±äºå­—å…¸ Dï¼Œè€Œæ–‡ç«  whatisyouname åœ¨å­—å…¸ D ä¸‹ä¸èƒ½è¢«ç†è§£ï¼Œä½†å¯ä»¥åœ¨å­—å…¸ Dâ€²=D+you ä¸‹è¢«ç†è§£ã€‚è¿™æ®µæ–‡ç« çš„ä¸€ä¸ªå‰ç¼€ whatis ï¼Œä¹Ÿå¯ä»¥åœ¨å­—å…¸ D ä¸‹è¢«ç†è§£ è€Œä¸”æ˜¯åœ¨å­—å…¸ D ä¸‹èƒ½å¤Ÿè¢«ç†è§£çš„æœ€é•¿çš„å‰ç¼€ã€‚<br>ç»™å®šä¸€ä¸ªå­—å…¸ D ï¼Œä½ çš„ç¨‹åºéœ€è¦åˆ¤æ–­è‹¥å¹²æ®µæ–‡ç« åœ¨å­—å…¸ D ä¸‹æ˜¯å¦èƒ½å¤Ÿè¢«ç†è§£ã€‚ å¹¶ç»™å‡ºå…¶åœ¨å­—å…¸ D ä¸‹èƒ½å¤Ÿè¢«ç†è§£çš„æœ€é•¿å‰ç¼€çš„ä½ç½®ã€‚<br><strong>è§£é¢˜æ€è·¯</strong><br>è¿™é¢˜æœ‰ç‚¹éš¾çš„åœ°æ–¹æ˜¯  æ–‡ç« ä¸­æŸä¸ªå‰ç¼€å¯èƒ½ç”±å¤šä¸ªå•è¯ç»„åˆå‡ºæ¥ï¼Œäºæ˜¯æˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªå¯èƒ½æ˜¯å•è¯æœ«å°¾çš„ä½ç½®å†è¿›è¡Œä¸‹ä¸€æ¬¡åŒ¹é…ï¼Œæ£€æŸ¥å…¶åæ˜¯å¦æœ‰å­—å…¸Dä¸­çš„å•è¯ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆå°†æ‰€æœ‰å•è¯æ’å…¥å­—å…¸æ ‘ï¼Œç”±äºå•è¯é•¿åº¦å°äº10ï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸ªå•è¯ï¼Œæˆ‘ä»¬æœ€å¤šæ¯”è¾ƒ10æ¬¡å°±èƒ½çŸ¥é“è¯¥å­—ä¸²æ˜¯å¦ä¸ºå­—å…¸Dä¸­çš„å•è¯ã€‚æ¯æ¬¡åŒ¹é…éƒ½è¦ä»å­—å…¸æ ‘çš„æ ¹å¼€å§‹åŒ¹é…ã€‚<br>æˆ‘ä»¬è®¾f[i]è¡¨ç¤º â€œæ–‡ç« ä¸­ç¬¬ i ä½æ˜¯å¦ä¸ºå¯ä»¥è¢«Dç†è§£çš„æŸä¸ªå‰ç¼€çš„æœ«å°¾â€ï¼›å¦‚æœ f[i] ä¸º 1 ï¼Œé‚£ä¹ˆè¯´æ˜[1, i]éƒ½å¯ä»¥è¢«Dç†è§£ï¼Œæ¥ä¸‹æ¥åªè¦å†ä» i+1 ä½å¼€å§‹å°è¯•åœ¨å­—å…¸æ ‘åŒ¹é…å•è¯å³å¯ã€‚<br>è¿™æ˜¯å­˜åœ¨æ€§DPï¼ŒçŠ¶æ€è½¬ç§»å¾ˆç®€å•ï¼Œåœ¨å­—å…¸æ ‘æŸ¥æ‰¾å•è¯æ—¶ï¼Œè‹¥å½“å‰ä½ç½®æ˜¯æŸä¸ªå•è¯çš„æœ«å°¾ï¼Œå³End[ p ] = 1ï¼Œé‚£ä¹ˆf[ pos ] = 1ï¼ˆposä¸ºå½“å‰å­—ç¬¦ä½ç½®ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(10N)ã€‚</p><p><strong>ä¼˜åŒ–</strong><br>åœ¨ æŸ¥æ‰¾/åŒ¹é… å•è¯æ—¶ï¼Œæˆ‘ä¹ æƒ¯å°†å…¶å°è£…ä¸ºä¸€ä¸ªå‡½æ•°search(char * s)ï¼Œä½†æ˜¯æœ€å·®æƒ…å†µæˆ‘ä»¬ä¼šè°ƒç”¨1e6æ¬¡è¯¥å‡½æ•°ï¼Œè™½ç„¶è¯¥å‡½æ•°å†…æœ€å¤šåªæ¯”è¾ƒ10æ¬¡ï¼Œä½†æ˜¯å‡½æ•°ä¼ å‚ä»¥åŠä¿æŠ¤ç°åœºä»¥åŠæ¢å¤ç­‰æ­¥éª¤è¿˜æ˜¯ä¼šå¤§å¤§å¢åŠ èŠ±è´¹çš„æ—¶é—´ã€‚ç»è¿‡æµ‹è¯•ï¼Œå†™æˆå‡½æ•°è°ƒç”¨å½¢å¼åœ¨1e6æ•°æ®ä¸‹å¤§æ¦‚ä¼šæ¯”ç›´æ¥å±•å¼€æ…¢å‡ åç§’ï¼Œå½“ç„¶è¿˜æ˜¯å¯ä»¥é€šè¿‡ä¸€äº›æ­¥éª¤ä¼˜åŒ–å‡½æ•°è°ƒç”¨çš„ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">1e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">30</span>],End[SZ], tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">char</span> str[N],s[<span class="number">30</span>];</span><br><span class="line"><span class="keyword">bool</span> f[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">End[p] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(str)<span class="number">-1</span>, ans;</span><br><span class="line"><span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span> f); f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="comment">//printf("%d\n",len);</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!f[i]) <span class="keyword">continue</span>;</span><br><span class="line">ans = i;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = i+<span class="number">1</span>,p = <span class="number">1</span>;j &lt;= len;j++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = str[j]-<span class="string">'a'</span>;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line"><span class="keyword">if</span>(!p) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span>(End[p]) f[j] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,s); Insert(s);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str+<span class="number">1</span>);</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">'#'</span>; solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Secret-Message-ç§˜å¯†ä¿¡æ¯"><a href="#Secret-Message-ç§˜å¯†ä¿¡æ¯" class="headerlink" title="Secret Message ç§˜å¯†ä¿¡æ¯"></a>Secret Message ç§˜å¯†ä¿¡æ¯</h4><p><strong>é¢˜æ„æè¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šUSACO 2008 Dec. Gold<br>è´èŒœæ­£åœ¨é¢†å¯¼å¥¶ç‰›ä»¬é€ƒè·‘ã€‚ä¸ºäº†è”ç»œï¼Œå¥¶ç‰›ä»¬äº’ç›¸å‘é€ç§˜å¯†ä¿¡æ¯ã€‚ä¿¡æ¯æ˜¯äºŒè¿›åˆ¶çš„ï¼Œå…±æœ‰ M æ¡ã€‚åé—´è°èƒ½åŠ›å¾ˆå¼ºçš„çº¦ç¿°å·²ç»éƒ¨åˆ†æ‹¦æˆªäº†è¿™äº›ä¿¡æ¯ï¼ŒçŸ¥é“äº†ç¬¬ i æ¡äºŒè¿›åˆ¶ä¿¡æ¯çš„å‰ bi ä½ã€‚<br>ä»–åŒæ—¶çŸ¥é“ï¼Œå¥¶ç‰›ä½¿ç”¨ N æ¡å¯†ç ã€‚ä½†æ˜¯ï¼Œä»–ä»…ä»…äº†è§£ç¬¬ j æ¡å¯†ç çš„å‰ cjä½ã€‚å¯¹äºæ¯æ¡å¯†ç  j ï¼Œä»–æƒ³çŸ¥é“æœ‰å¤šå°‘æˆªå¾—çš„ä¿¡æ¯èƒ½å¤Ÿå’Œå®ƒåŒ¹é…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰å¤šå°‘ä¿¡æ¯å’Œè¿™æ¡å¯†ç æœ‰ç€ç›¸åŒçš„å‰ç¼€ã€‚å½“ç„¶ï¼Œè¿™ä¸ªå‰ç¼€é•¿åº¦å¿…é¡»ç­‰äºå¯†ç å’Œé‚£æ¡ä¿¡æ¯é•¿åº¦çš„è¾ƒå°è€…ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æ ¹æ®æ‰€ç»™æ ·ä¾‹å‘¢ï¼Œå¯ä»¥æ›´åŠ æ˜ç¡®é¢˜æ„ã€‚é¦–å…ˆæˆ‘ä»¬å°†Mæ¡ä¿¡æ¯çœ‹ä½œ01å­—ç¬¦ä¸²ï¼ŒåŒç†Næ¡å¯†ç ä¹Ÿçœ‹ä½œ01å­—ç¬¦ä¸²ï¼Œé¢˜æ„é—®çš„å°±æ˜¯å¯¹äºæ¯ä¸ªå¯†ç ï¼Œæœ‰å¤šå°‘æ¡ä¿¡æ¯å¯èƒ½å’Œè¯¥å¯†ç åŒ¹é…ï¼Œå¦‚æœä¸€æ¡ä¿¡æ¯ A å’Œå¯†ç  B åŒ¹é…ï¼Œé‚£ä¹ˆæœ‰ A æ˜¯ B çš„å‰ç¼€æˆ– B æ˜¯ A çš„å‰ç¼€ã€‚<br>äºæ˜¯æˆ‘ä»¬å°±åªéœ€è¦å…ˆæŠŠ01æ•°ç»„è½¬åŒ–ä¸º01å­—ç¬¦ä¸²ï¼Œå†ç”¨trieç»Ÿè®¡å³å¯ï¼Œå½“ç„¶ç”±äºåŒä¸€ä¿¡æ¯å¯èƒ½ä¼šé‡å¤å‡ºç°ï¼Œæ‰€ä»¥ End[p] è®°å½•çš„æ˜¯ä»¥ p ç»“å°¾çš„å­—ä¸²ä¸ªæ•°ã€‚<br>åœ¨æœ¬æœºä¸æ´›è°·ä¸Šéƒ½æ˜¯å¯ä»¥ACçš„ï¼Œå¤æ‚åº¦å¤§æ¦‚O(5e5)ï¼Œä½†æ˜¯åœ¨ä¸€æœ¬é€šOJå°±è¿‡ä¸å»ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯ä¸æ”¯æŒå…³é—­ scanf åŒæ­¥æµï¼Ÿå¾…ä¿®æ”¹ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">5e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="built_in">string</span> str[N],s[N];</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">2</span>],End[SZ],tot = <span class="number">1</span>,tc[SZ];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = s.length(), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">tc[p]++;</span><br><span class="line">&#125;</span><br><span class="line">End[p]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s)</span></span>&#123;</span><br><span class="line"><span class="comment">//cout &lt;&lt; s &lt;&lt; "-" &lt;&lt; endl;</span></span><br><span class="line"><span class="keyword">int</span> len = s.length(), p = <span class="number">1</span>,res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'0'</span>;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line"><span class="keyword">if</span>(!p) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span>(End[p] &amp;&amp; i != len<span class="number">-1</span>) res += End[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res + tc[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Insert(str[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++) <span class="built_in">cout</span> &lt;&lt; search(s[i]) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="comment">//freopen("222.txt","w",stdout);</span></span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,k;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; k;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>,x;j &lt;= k;j++) <span class="built_in">cin</span> &gt;&gt; x, str[i] += x+<span class="string">'0'</span>;</span><br><span class="line"><span class="comment">//cout &lt;&lt; str[i] &lt;&lt; endl;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,k;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; k;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>,x;j &lt;= k;j++) <span class="built_in">cin</span> &gt;&gt; x, s[i] += x+<span class="string">'0'</span>;</span><br><span class="line"><span class="comment">//cout &lt;&lt; s[i] &lt;&lt; endl;</span></span><br><span class="line">&#125;</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ã€SCOI2016ã€‘èƒŒå•è¯"><a href="#ã€SCOI2016ã€‘èƒŒå•è¯" class="headerlink" title="ã€SCOI2016ã€‘èƒŒå•è¯*"></a>ã€SCOI2016ã€‘èƒŒå•è¯*</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>Lweb é¢å¯¹å¦‚å±±çš„è‹±è¯­å•è¯ï¼Œé™·å…¥äº†æ·±æ·±çš„æ²‰æ€ï¼Œã€Œæˆ‘æ€ä¹ˆæ ·æ‰èƒ½å¿«ç‚¹å­¦å®Œï¼Œç„¶åå»ç©ä¸‰å›½æ€å‘¢ï¼Ÿã€ã€‚<br>è¿™æ—¶å€™ç¿æ™ºçš„å‡¤è€å¸ˆä»è¿œå¤„é£˜æ¥ï¼Œä»–é€ç»™äº† Lweb ä¸€æœ¬è®¡åˆ’å†Œå’Œä¸€å¤§ç¼¸æ³¡æ¤’ï¼Œç„¶åå‡¤è€å¸ˆå‘Šè¯‰ Lweb ï¼Œæˆ‘çŸ¥é“ä½ è¦å­¦ä¹ çš„å•è¯æ€»å…±æœ‰ n ä¸ªï¼Œç°åœ¨æˆ‘ä»¬ä»ä¸Šå¾€ä¸‹å®Œæˆè®¡åˆ’è¡¨ï¼Œå¯¹äºä¸€ä¸ªåºå·ä¸º x çš„å•è¯ï¼ˆåºå· 1â€¦xâˆ’1 éƒ½å·²ç»è¢«å¡«å…¥ï¼‰ï¼š</p><ul><li>å¦‚æœå­˜åœ¨ä¸€ä¸ªå•è¯æ˜¯å®ƒçš„åç¼€ï¼Œå¹¶ä¸”å½“å‰æ²¡æœ‰è¢«å¡«å…¥è¡¨å†…ï¼Œé‚£ä»–éœ€è¦åƒ nÃ—n é¢—æ³¡æ¤’æ‰èƒ½å­¦ä¼šï¼›</li><li>å½“å®ƒçš„æ‰€æœ‰åç¼€éƒ½è¢«å¡«å…¥è¡¨å†…çš„æƒ…å†µä¸‹ï¼Œå¦‚æœåœ¨ 1â€¦xâˆ’1 çš„ä½ç½®ä¸Šçš„å•è¯éƒ½ä¸æ˜¯å®ƒçš„åç¼€ï¼Œé‚£ä¹ˆä»–åƒ x é¢—æ³¡æ¤’å°±èƒ½è®°ä½å®ƒï¼›</li><li>å½“å®ƒçš„æ‰€æœ‰åç¼€éƒ½è¢«å¡«å…¥è¡¨å†…çš„æƒ…å†µä¸‹ï¼Œå¦‚æœ 1â€¦xâˆ’1 çš„ä½ç½®ä¸Šå­˜åœ¨æ˜¯å®ƒåç¼€çš„å•è¯ï¼Œæ‰€æœ‰æ˜¯å®ƒåç¼€çš„å•è¯ä¸­ï¼Œåºå·æœ€å¤§ä¸º yï¼Œé‚£ä¹ˆä½ åªè¦åƒ xâˆ’y é¢—æ³¡æ¤’å°±èƒ½æŠŠå®ƒè®°ä½ã€‚</li></ul><p>Lweb æ˜¯ä¸€ä¸ªåƒåˆ°è¾£è¾£çš„ä¸œè¥¿ä¼šæš´èµ°çš„å¥‡æ€ªå°æœ‹å‹ï¼Œæ‰€ä»¥è¯·ä½ å¸®åŠ© Lwebï¼Œå¯»æ‰¾ä¸€ç§æœ€ä¼˜çš„å¡«å†™å•è¯æ–¹æ¡ˆï¼Œä½¿å¾—ä»–è®°ä½è¿™  n ä¸ªå•è¯çš„æƒ…å†µä¸‹ï¼Œåƒæœ€å°‘çš„æ³¡æ¤’ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>é¦–å…ˆæŠŠæ‰€æœ‰å­—ç¬¦ä¸²åè½¬ï¼Œé‚£ä¹ˆåç¼€å°±å˜æˆå‰ç¼€äº†ï¼Œå°±å¯ä»¥ç”¨trieç»´æŠ¤ã€‚<br>åˆšå¼€å§‹æˆ‘æ˜¯æƒ³è®°å½•æ¯ä¸ªå­—ç¬¦ä¸²çš„å‰ç¼€ä¸ªæ•°ï¼Œç„¶åæ ¹æ®ä¸ªæ•°ä»å°åˆ°å¤§åˆ†é…ç¼–å·ï¼Œä½†æ˜¾ç„¶ä¸è¡Œã€‚<br>æ­£è§£æ˜¯å°†æ‰€æœ‰å­—ç¬¦ä¸²æ„æˆä¸€æ£µæ ‘ï¼Œä¸€ä¸ªèŠ‚ç‚¹çš„çˆ¶äº²å°±æ˜¯å®ƒçš„å‰ç¼€ï¼Œè€Œæ²¡æœ‰å‰ç¼€çš„å­—ç¬¦ä¸²çˆ¶äº²ä¸º 0 å·èŠ‚ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ trieä¸­çš„ search æ—¶å¡«è¾¹å»ºæ ‘ã€‚<br>è¿™æ ·æˆ‘ä»¬å°±æœ‰ä¸€æ£µæœ‰å‘æ ‘äº†ï¼Œå‡è®¾æˆ‘ä»¬ç»™èŠ‚ç‚¹ x åˆ†é…çš„åºå·æ˜¯ f[x] ï¼Œé‚£ä¹ˆæ˜¾ç„¶ ans += f[x] - f[par[x] ]ï¼Œå…¶ä¸­ par[x] ä»£è¡¨ x çš„çˆ¶äº²èŠ‚ç‚¹ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è®©æ¯ä¸ªèŠ‚ç‚¹å’Œå®ƒçˆ¶äº²èŠ‚ç‚¹çš„ç¼–å·ç›¸å·®å°½é‡å°ï¼Œé‚£ä¹ˆè‡ªç„¶æ˜¯ä¼˜å…ˆç»™èŠ‚ç‚¹æ•°å°‘çš„å­æ ‘åˆ†é…ç¼–å·å’¯ï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ x ï¼Œæˆ‘ä»¬é€‰æ‹©èŠ‚ç‚¹æœ€å°çš„ä¸€æ£µå­æ ‘ï¼Œä¸ºå®ƒä»¬åˆ†é…ç¼–å·ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">6e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> tc[N];<span class="comment">//è®°å½•åç¼€ä¸ªæ•°</span></span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">30</span>],End[SZ], tot = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> par[N], head[N], ver[N], nex[N],tot2 = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">ver[++tot2] = y, nex[tot2] = head[x], head[x] = tot2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s,<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line"><span class="comment">//cout &lt;&lt; s &lt;&lt; endl;</span></span><br><span class="line"><span class="keyword">int</span> len = s.length(), p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">End[p] = id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">search</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s,<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line"><span class="comment">//cout &lt;&lt; s &lt;&lt; endl;</span></span><br><span class="line"><span class="keyword">int</span> len = s.length(), p = <span class="number">1</span> ,res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = s[i]-<span class="string">'a'</span>;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line"><span class="keyword">if</span>(End[p] &amp;&amp; i != len<span class="number">-1</span>) par[id] = End[p];</span><br><span class="line">&#125;</span><br><span class="line">addEdge(par[id],id);<span class="comment">//é¡ºä¾¿å»ºæ ‘å•¦ </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="built_in">string</span> str[N];</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> num[N];<span class="comment">//è®°å½•å­æ ‘xçš„èŠ‚ç‚¹ä¸ªæ•° </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i != <span class="number">-1</span>;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i];</span><br><span class="line">num[x] += dfs(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> num[x]+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll ans = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">priority_queue&lt; pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt; q;</span><br><span class="line"><span class="keyword">int</span> f[N]; <span class="comment">//è®°å½•xç¼–å· </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">ans += cnt - f[par[x]]; f[x] = cnt; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i != <span class="number">-1</span>;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i];</span><br><span class="line">q.push(make_pair(-num[y],y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> nnex[q.size()],tt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> y = q.top().second;q.pop();</span><br><span class="line">nnex[tt++] = y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; tt;i++) cnt++, calc(nnex[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span> head);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Insert(str[i],i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) search(str[i],i);</span><br><span class="line">num[<span class="number">0</span>] = dfs(<span class="number">0</span>); calc(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line">ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">cin</span> &gt;&gt; str[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) reverse(str[i].begin(),str[i].end());</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="The-xor-longest-Path"><a href="#The-xor-longest-Path" class="headerlink" title="The xor-longest Path*"></a>The xor-longest Path*</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šPOJ 3764<br>ç»™å®šä¸€æ£µ n ä¸ªç‚¹çš„å¸¦æƒæ ‘ï¼Œæ±‚æ ‘ä¸Šæœ€é•¿çš„å¼‚æˆ–å’Œè·¯å¾„ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>è®¾ d[x] è¡¨ç¤º x åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„å¼‚æˆ–å’Œï¼Œé‚£ä¹ˆæ˜¾ç„¶ç”±äºå¼‚æˆ–çš„ç‰¹æ€§ï¼Œx^y^x = yï¼Œæˆ‘ä»¬ä»»é€‰ä¸¤ä¸ªç‚¹ x å’Œ y ï¼Œé‚£ä¹ˆd[x] ^ d[y]å°±æ˜¯ x å’Œ y ä¹‹é—´çš„è·¯å¾„å¼‚æˆ–å’Œï¼Œå› ä¸ºä»LCA(x , y)åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„éƒ½è¢«æŠµæ¶ˆäº†ã€‚<br>æ‰€ä»¥åŸé—®é¢˜å°±æˆäº†ä» d[1,n] ä¸­é€‰ä¸¤ä¸ªæ•°ï¼Œä½¿å®ƒä»¬çš„å¼‚æˆ–å’Œæœ€å¤§ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[N],nex[N],edge[N],tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> n,d[N];<span class="comment">//d[x]:xåˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„å¼‚æˆ–å’Œ </span></span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">ver[++tot] = y, nex[tot] = head[x];</span><br><span class="line">edge[tot] = z, head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c!=<span class="string">'-'</span> &amp;&amp; (c&lt;<span class="string">'0'</span> || c&gt;<span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span> (c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c&gt;=<span class="string">'0'</span> &amp;&amp; c&lt;=<span class="string">'9'</span>)</span><br><span class="line">ans = ans*<span class="number">10</span> + c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg ? -ans : ans; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">vis[x] = <span class="literal">true</span>; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(vis[y]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="comment">//printf("%d %d %d\n",x,y,z);</span></span><br><span class="line">d[y] = d[x]^z;</span><br><span class="line">dfs(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">32</span>*N;</span><br><span class="line"><span class="keyword">int</span> trie[SZ][<span class="number">2</span>], tot2 = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">31</span>,p = <span class="number">1</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = (x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(!trie[p][ch]) trie[p][ch] = ++tot2;</span><br><span class="line">p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">/*è¿”å›xä¸é›†åˆä¸­å¼‚æˆ–å’Œæœ€å¤§çš„ ç»“æœ*/</span></span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>,p = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">31</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line"><span class="keyword">int</span> ch = (x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(trie[p][!ch]) p = trie[p][!ch],res |= <span class="number">1</span>&lt;&lt;i;</span><br><span class="line"><span class="keyword">else</span> p = trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/* è®¡ç®—å¹¶è¾“å‡ºç­”æ¡ˆ */</span></span><br><span class="line">dfs(<span class="number">1</span>); <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) Insert(d[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) ans = max(ans,search(d[i]));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line">n = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt; n;i++)&#123;</span><br><span class="line">x = getInt(); y = getInt(); z = getInt();</span><br><span class="line">addEdge(x,y,z); addEdge(y,x,z);</span><br><span class="line">&#125;</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Trie </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>KMPç®—æ³•ç»ƒä¹ é¢˜é›†</title>
      <link href="/2019/09/29/kmp-problems/"/>
      <url>/2019/09/29/kmp-problems/</url>
      
        <content type="html"><![CDATA[<p><a href="http://ybt.ssoier.cn:8088/index.php" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a></p><h4 id="å‰ªèŠ±å¸ƒæ¡"><a href="#å‰ªèŠ±å¸ƒæ¡" class="headerlink" title="å‰ªèŠ±å¸ƒæ¡"></a>å‰ªèŠ±å¸ƒæ¡</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼šHDU 2087<br>ä¸€å—èŠ±å¸ƒæ¡ï¼Œé‡Œé¢æœ‰äº›å›¾æ¡ˆï¼Œå¦æœ‰ä¸€å—ç›´æ¥å¯ç”¨çš„å°é¥°æ¡ï¼Œé‡Œé¢ä¹Ÿæœ‰ä¸€äº›å›¾æ¡ˆã€‚å¯¹äºç»™å®šçš„èŠ±å¸ƒæ¡å’Œå°é¥°æ¡ï¼Œè®¡ç®—ä¸€ä¸‹èƒ½ä»èŠ±å¸ƒæ¡ä¸­å°½å¯èƒ½å‰ªå‡ºå‡ å—å°é¥°æ¡æ¥å‘¢ï¼Ÿ</p><p><strong>è§£é¢˜æ€è·¯</strong><br>å°±æ˜¯æ™®é€šçš„kmpç®—æ³•ï¼Œåªä¸è¿‡è¿™é‡Œçš„ä¸¤ä¸ªæ¨¡å¼ä¸²ä¸èƒ½é‡å ï¼Œæˆ‘ä»¬åŸºäºè´ªå¿ƒç­–ç•¥é‡åˆ°ä¸€ä¸ªé€‰ä¸€ä¸ªå³å¯ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> f[N],nex[N];</span><br><span class="line"><span class="keyword">char</span> S[N],T[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(nex,<span class="number">0</span>,<span class="keyword">sizeof</span> nex);</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>,j = <span class="number">0</span>;i &lt;= len;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; s[i] != s[j+<span class="number">1</span>]) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(s[i] == s[j+<span class="number">1</span>]) j++;</span><br><span class="line">nex[i] = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getF</span><span class="params">(<span class="keyword">char</span> *s,<span class="keyword">char</span> *t)</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line"><span class="keyword">int</span> n = <span class="built_in">strlen</span>(s)<span class="number">-1</span>, m = <span class="built_in">strlen</span>(t)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,j = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; (j == m || s[i] != t[j+<span class="number">1</span>])) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(s[i] == t[j+<span class="number">1</span>]) j++;</span><br><span class="line">f[i] = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">getNex(T);</span><br><span class="line">getF(S,T);</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>,r = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> n = <span class="built_in">strlen</span>(S)<span class="number">-1</span>, m = <span class="built_in">strlen</span>(T)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(i &gt; r &amp;&amp; f[i] == m) ans++ ,r = i+m<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>,S+<span class="number">1</span>) &amp;&amp; S[<span class="number">1</span>] != <span class="string">'#'</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,T+<span class="number">1</span>); S[<span class="number">0</span>] = T[<span class="number">0</span>] = <span class="string">'#'</span>;</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Power-Strings"><a href="#Power-Strings" class="headerlink" title="Power Strings"></a>Power Strings</h4><p>åœ¨ä¹‹å‰çš„å­—ç¬¦ä¸²ä¸Hashé¢˜é›†ä¸­åšè¿‡ï¼Œè€Œä¸”åˆšè¿‡å»ä¸ä¹…ï¼Œä¸æ•´ç†äº†ã€‚</p><h4 id="Radio-Transmission"><a href="#Radio-Transmission" class="headerlink" title="Radio Transmission"></a>Radio Transmission</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒæ˜¯ç”±æŸä¸ªå­—ç¬¦ä¸²ä¸æ–­è‡ªæˆ‘è¿æ¥å½¢æˆçš„ã€‚ä½†æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸ç¡®å®šçš„ï¼Œç°åœ¨åªæƒ³çŸ¥é“å®ƒçš„æœ€çŸ­é•¿åº¦æ˜¯å¤šå°‘ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>æ±‚æœ€çŸ­å¾ªç¯èŠ‚ï¼Œç»™å®šçš„å­—ç¬¦ä¸²å¯èƒ½æ˜¯ç”±å¾ªç¯èŠ‚å¾ªç¯æ„æˆçš„å­—ä¸²çš„ä¸€ä¸ªå­ä¸²ï¼Œæ‰€ä»¥å°±ç›´æ¥ç”¨æ±‚æœ€çŸ­å¾ªç¯èŠ‚å°±å¯ä»¥äº†ï¼Œçœå»ç”¨å­—ç¬¦ä¸²hashåˆ¤æ–­è¯¥ä¸²æ˜¯å¦æ»¡è¶³äº†ã€‚<br><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> n,nex[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>,j = <span class="number">0</span>;i &lt;= len;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; s[i] != s[j+<span class="number">1</span>]) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(s[i] == s[j+<span class="number">1</span>]) j++;</span><br><span class="line">nex[i] = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">getNex(str);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,n - nex[n]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str+<span class="number">1</span>);</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">'#'</span>;</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="OKR-Periods-of-Words"><a href="#OKR-Periods-of-Words" class="headerlink" title="OKR-Periods of Words"></a>OKR-Periods of Words</h4><p><strong>é¢˜æ„ç®€è¿°</strong></p><p>åŸé¢˜æ¥è‡ªï¼šPOI 2006<br>ä¸²æ˜¯æœ‰é™ä¸ªå°å†™å­—ç¬¦çš„åºåˆ—ï¼Œç‰¹åˆ«çš„ï¼Œä¸€ä¸ªç©ºåºåˆ—ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªä¸²ã€‚ä¸€ä¸ªä¸² P æ˜¯ä¸² A çš„å‰ç¼€ï¼Œå½“ä¸”ä»…å½“å­˜åœ¨ä¸² Bï¼Œä½¿å¾— A=PBã€‚å¦‚æœPâ‰ Aå¹¶ä¸” P ä¸æ˜¯ä¸€ä¸ªç©ºä¸²ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´ P æ˜¯ A çš„ä¸€ä¸ª proper å‰ç¼€ã€‚<br>å®šä¹‰ Q æ˜¯ A çš„å‘¨æœŸï¼Œå½“ä¸”ä»…å½“ Q æ˜¯ A çš„ä¸€ä¸ª proper å‰ç¼€å¹¶ä¸” A æ˜¯ QQ çš„å‰ç¼€ï¼ˆä¸ä¸€å®šè¦æ˜¯ proper å‰ç¼€ï¼‰ã€‚æ¯”å¦‚ä¸² abab å’Œ ababab éƒ½æ˜¯ä¸² abababa çš„å‘¨æœŸã€‚ä¸² A çš„æœ€å¤§å‘¨æœŸå°±æ˜¯å®ƒæœ€é•¿çš„ä¸€ä¸ªå‘¨æœŸæˆ–è€…æ˜¯ä¸€ä¸ªç©ºä¸²ï¼ˆå½“ A æ²¡æœ‰å‘¨æœŸçš„æ—¶å€™ï¼‰ï¼Œæ¯”å¦‚è¯´ï¼Œababab çš„æœ€å¤§å‘¨æœŸæ˜¯ ababã€‚ä¸² abc çš„æœ€å¤§å‘¨æœŸæ˜¯ç©ºä¸²ã€‚<br>ç»™å‡ºä¸€ä¸ªä¸²ï¼Œæ±‚å‡ºå®ƒæ‰€æœ‰å‰ç¼€çš„æœ€å¤§å‘¨æœŸé•¿åº¦ä¹‹å’Œã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>é¢˜æ„æœ‰ä¸€äº›ç»•ï¼Œä½†æ˜¯è¿˜å¥½ç»™çš„æ˜¯ä¸­æ–‡é¢˜é¢ï¼Œå°šå¯ç†è§£ã€‚å°±æ˜¯è¯´Pæ˜¯Açš„ä¸€ä¸ªçœŸå­ä¸²ï¼Œä¸”æ˜¯Açš„å‰ç¼€ï¼Œé‚£ä¹ˆPå°±æ˜¯Açš„properå‰ç¼€ã€‚è‹¥Qæ˜¯Açš„properå‰ç¼€ï¼Œä¸”Aæ˜¯QQï¼ˆä¸¤ä¸ªQæ‹¼æ¥åœ¨ä¸€èµ·ï¼‰çš„å‰ç¼€ï¼ˆå‰ç¼€ä¸å¿…è¦æ˜¯çœŸå­ä¸²ï¼‰ï¼Œé‚£ä¹ˆQå°±æ˜¯Açš„å‘¨æœŸã€‚<br>ç°åœ¨è¦æ±‚çš„æ˜¯Açš„ æ‰€æœ‰å‰ç¼€çš„ æœ€é•¿å‘¨æœŸçš„é•¿åº¦ä¹‹å’Œã€‚</p><p>å¦‚æœè¦æ˜¯æ±‚æœ€çŸ­å‘¨æœŸçš„é•¿åº¦ï¼Œé‚£ä¹ˆç›´æ¥å°±æ˜¯æ±‚æœ€çŸ­å¾ªç¯èŠ‚ï¼Œè·‘ä¸€énexå°±è§£å†³äº†ï¼›ç°åœ¨è¦æ±‚æœ€é•¿å‘¨æœŸçš„é•¿åº¦ï¼Œç›¸å½“äºæ±‚æœ€é•¿çš„å¾ªç¯èŠ‚ï¼ˆè¯¥å¾ªç¯èŠ‚ä¸èƒ½ç­‰äºåŸä¸²ï¼å¦åˆ™å°±ä¸æ˜¯properå‰ç¼€äº†ï¼‰ï¼Œé‚£ä¹ˆå°±ä¸æ–­çš„ä»¤ j = nex[j]ï¼Œæ‰¾åˆ°éé›¶çš„æœ€å° nex[j] ï¼ˆå°†nexæ•°ç»„çœ‹ä½œfatheræ•°ç»„ï¼Œä¸€æ£µfatheræ ‘ï¼‰ï¼Œé‚£ä¹ˆæœ€é•¿å¾ªç¯èŠ‚å°±æ˜¯ i - j äº†ã€‚</p><p>è¿™æ ·ä¼šè¶…æ—¶ï¼Œå› ä¸ºæˆ‘ä»¬æ¯æ¬¡ä»¤j = nex[j]ç›¸å½“äºä»å¶å­èŠ‚ç‚¹èµ°åˆ°æ ¹èŠ‚ç‚¹ï¼Œæœ€åæƒ…å†µæ˜¯O(N)æ‰èƒ½æ‰¾åˆ°æœ€å°çš„éé›¶ nex[j]ï¼Œæ€»æ—¶é—´å¤æ‚åº¦å°±æ˜¯O(N^2)ã€‚</p><p><strong>ä¼˜åŒ–</strong><br>æˆ‘ä»¬ä»¤ f[j] è¡¨ç¤ºæ ¹åˆ° j è·¯å¾„ä¸Šæœ€å°éé›¶çš„å€¼ã€‚ï¼ˆæˆ‘ä»¬æŠŠnexæ•°ç»„çœ‹ä½œä¸€æ£µæ ‘ï¼ï¼ï¼ï¼‰<br>é‚£ä¹ˆå¯¹äºä»»æ„çš„nex[p]ï¼Œè‹¥nex[p] != 0ï¼Œé‚£ä¹ˆæœ€é•¿å‘¨æœŸå°±æ˜¯ p - f[nex[p] ]ã€‚<br>æˆ‘ä»¬åœ¨æ±‚nexæ•°ç»„æ—¶é¡ºä¾¿æ›´æ–° f æ•°ç»„ï¼Œå’Œè®°å¿†åŒ–ç±»ä¼¼ï¼Œæ€è·¯ä¸éš¾ç†è§£ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> n,nex[N],f[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s)<span class="number">-1</span>; f[<span class="number">0</span>] = INF;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>,j = <span class="number">0</span>;i &lt;= len;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; s[i] != s[j+<span class="number">1</span>]) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(s[i] == s[j+<span class="number">1</span>]) j++;</span><br><span class="line">nex[i] = j;</span><br><span class="line"><span class="keyword">if</span>(j) f[j] = min(j,f[nex[j]]);</span><br><span class="line"><span class="comment">//printf("%d %d\n",j,f[j]);</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">getNex(str);</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(nex[i]) ans += i - f[nex[i]];</span><br><span class="line"><span class="comment">//printf("%d %c\n",ans,str[i]);</span></span><br><span class="line"><span class="comment">//printf("%d %d\n",nex[i],f[i]);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str+<span class="number">1</span>);</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">'#'</span>;</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ä¼¼ä¹åœ¨æ¢¦ä¸­è§è¿‡çš„æ ·å­"><a href="#ä¼¼ä¹åœ¨æ¢¦ä¸­è§è¿‡çš„æ ·å­" class="headerlink" title="ä¼¼ä¹åœ¨æ¢¦ä¸­è§è¿‡çš„æ ·å­"></a>ä¼¼ä¹åœ¨æ¢¦ä¸­è§è¿‡çš„æ ·å­</h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>åŸé¢˜æ¥è‡ªï¼š2014 å¹´æ¹–åŒ—çœé˜Ÿäº’æµ‹ Week2<br>ã€ŒMadokaï¼Œä¸è¦ç›¸ä¿¡ QBï¼ã€ä¼´éšç€ Homura çš„å¤±æœ›åœ°å–Šå«ï¼ŒMadoka ä¸ QB ç­¾è®¢äº†å¥‘çº¦ã€‚<br>è¿™æ˜¯ Modoka çš„ä¸€ä¸ªå™©æ¢¦ï¼Œä¹ŸåŒæ—¶æ˜¯ä¸Šä¸ªè½®å›ä¸­æ‰€å‘ç”Ÿçš„äº‹ã€‚ä¸ºäº†ä½¿è¿™ä¸€æ¬¡ Madoka ä¸å†ä¸ QB ç­¾è®¢å¥‘çº¦ï¼ŒHomura å†³å®šåœ¨åˆšåˆ°å­¦æ ¡çš„ç¬¬ä¸€å¤©å°±è§£å†³ QBã€‚ç„¶è€Œï¼ŒQB ä¹Ÿæ˜¯æœ‰è®¸å¤šæ›¿èº«çš„ï¼ˆä½†åœ¨ç¬¬å…«è¯ä¸­çš„å‰§æƒ…æ˜¾ç¤ºå®ƒä¹Ÿæœ‰å¯èƒ½æ˜¯æ— é™é‡ç”Ÿçš„ï¼‰ï¼Œä¸è¿‡ï¼Œæ„å¿—åšå®šçš„ Homura æ˜¯ä¸ä¼šæ”¾å¼ƒçš„â€”â€”å¥¹å†³å®šæ¶ˆç­æ‰€æœ‰å¯èƒ½æ˜¯ QB çš„ä¸œè¥¿ã€‚ç°åœ¨ï¼Œå¥¹å·²æ„Ÿå—åˆ°é™„è¿‘çš„çŠ¶æ€ï¼Œå¹¶ä¸”æŠŠå®ƒè½¬åŒ–ä¸ºä¸€ä¸ªé•¿åº¦ä¸º n çš„å­—ç¬¦ä¸²äº¤ç»™äº†å­¦ OI çš„ä½ ã€‚<br>ç°åœ¨ä½ ä»å¥¹çš„è¯ä¸­çŸ¥é“ï¼Œæ‰€æœ‰å½¢ä¼¼äº A+B+A çš„å­—ä¸²éƒ½æ˜¯ QB æˆ–å®ƒçš„æ›¿èº«ï¼Œä¸” âˆ£Aâˆ£â‰¥k,âˆ£Bâˆ£â‰¥1ï¼ˆä½ç½®ä¸åŒå…¶ä»–æ€§è´¨ç›¸åŒçš„å­ä¸²ç®—ä¸åŒå­ä¸²ï¼Œä½ç½®ç›¸åŒä½†æ‹†åˆ†ä¸åŒçš„å­ä¸²ç®—åŒä¸€å­ä¸²ï¼‰ï¼Œç„¶åä½ å¿…é¡»å°½å¿«å‘Šè¯‰ Homura è¿™ä¸ªç­”æ¡ˆâ€”â€”QB ä»¥åŠå®ƒçš„æ›¿èº«çš„æ•°é‡ã€‚<br>æ³¨ï¼šå¯¹äºä¸€ä¸ªå­—ç¬¦ä¸² Sï¼Œâˆ£Sâˆ£ è¡¨ç¤º S çš„é•¿åº¦ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong><br>è¿™é¢˜éœ€è¦å¯¹ç…§æ ·ä¾‹æ¥ç†è§£é¢˜æ„ï¼Œç»è¿‡åˆ†æåï¼Œå‘ç°é¢˜æ„æ˜¯å¦‚æœæœ‰ä¸€ä¸ªå­ä¸²æ»¡è¶³ABAå½¢å¼ï¼Œå…¶ä¸­ |A|&gt;=k ä¸” B ä¸æ˜¯ç©ºä¸²ï¼Œé‚£ä¹ˆè¯¥å­ä¸²å°±æ˜¯QBå¤§é­”ç‹ã€‚ç°åœ¨é—®æœ‰å¤šå°‘ä¸ªè¿™æ ·çš„å­ä¸²ã€‚</p><p>é¦–å…ˆçœ‹æ€è·¯ï¼Œå¯¹äºä¸€ä¸ªå­—ç¬¦ä¸²(s[1,n])ï¼Œæˆ‘ä»¬é€šè¿‡æ±‚å®ƒçš„nexæ•°ç»„ï¼Œå¦‚æœnex[n] &gt;= k å¹¶ä¸” nex[n] å°äº n/2ï¼Œé‚£ä¹ˆè¯¥ä¸²å°±æ˜¯QBï¼›å¦‚æœnex[n] &gt;= n/2ï¼Œé‚£ä¹ˆnex[ nex[n] ] ï¼Œä¸€ç›´åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šï¼Œåªè¦æœ‰ä¸€ä¸ªnexå¤§äºkä¸”å°äºn/2ï¼Œè¯¥ä¸²å°±ä¹Ÿæ˜¯QBã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¯¹äºä¸€ä¸ªä¸‹æ ‡ä¸º[1, p]çš„å­—ç¬¦ä¸²ï¼Œéœ€è¦æ‰¾åˆ°nex[p]åˆ°æ ¹èŠ‚ç‚¹ï¼ˆå°†nexæ•°ç»„çœ‹ä½œä¸€æ£µæ ‘ï¼‰è·¯å¾„ä¸Šå¤§äºç­‰äº k çš„æœ€å° nexå€¼ï¼ˆè´ªå¿ƒæ€æƒ³ï¼‰ã€‚æˆ‘ä»¬ç”¨ f æ•°ç»„æ¥å­˜æ”¾è¯¥å€¼ã€‚ä¹‹æ‰€ä»¥ç”¨ f æ•°ç»„å­˜æ”¾ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢æœ€åæƒ…å†µO(N^2)éå†ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯¹åŸå­—ç¬¦ä¸² S çš„æ¯ä¸€ä¸ªåç¼€éƒ½è¿›è¡Œä¸Šè¿°æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦å…±O(N^2)ï¼Œå‹‰å¼ºè¿‡ã€‚ä½†æ˜¯å¸¸æ•°ç¨å¾®å¤§ä¸€äº›å°±è¿‡ä¸äº†äº†ï¼Œæ‰€ä»¥ç»Ÿè®¡ç­”æ¡ˆä¹Ÿè¦åœ¨æ±‚ nex å’Œæ›´æ–° f æ•°ç»„æ—¶é¡ºä¾¿ç´¯åŠ ï¼Œå¦‚æœè§‰å¾—è¿™æ ·å¤ªæ€‚äº†ï¼Œè¿˜å¯ä»¥è¿›è¡Œåˆ«çš„ä¼˜åŒ–ï¼Œä¸è¿‡æˆ‘æ‡’å¾—æ”¹äº†ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">15000</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> nex[N],k, f[N], ans = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//f[i]ä¸ºnex[i]åˆ°æ ¹ä¸­,å¤§äºkçš„æœ€å°çš„ä¸€ä¸ª </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s)<span class="number">-1</span>;</span><br><span class="line"><span class="built_in">memset</span>(nex,<span class="number">0</span>,<span class="keyword">sizeof</span> nex); f[<span class="number">0</span>] = INF;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>,j = <span class="number">0</span>;i &lt;= len;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; s[i] != s[j+<span class="number">1</span>]) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(s[i] == s[j+<span class="number">1</span>]) j++;</span><br><span class="line">nex[i] = j;</span><br><span class="line"><span class="keyword">if</span>(j &lt; k) f[j] = INF; </span><br><span class="line"><span class="keyword">else</span> f[j] = min(j,f[nex[j]]);</span><br><span class="line"><span class="keyword">if</span>(f[j]&lt;&lt;<span class="number">1</span> &lt; i) ans++;</span><br><span class="line"><span class="comment">//printf("%d %d %d %d\n",i,j,f[j],nex[j]);</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="built_in">strlen</span>(str)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line">getNex(str+i<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;k);</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">'#'</span>;</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Censoring"><a href="#Censoring" class="headerlink" title="Censoring"></a>Censoring</h4><p>è¿™ä¸ªæˆ‘ä¸€çœ‹å°±çŸ¥é“KMPå¾ˆéš¾å†™ï¼Œåº”è¯¥ç”¨è‡ªåŠ¨æœºï¼Œæ‰€ä»¥æ”¾åœ¨è‡ªåŠ¨æœºä¸“é¢˜æ•´ç†ï¼Œå¦å¤–åæ§½ä¸€ä¸‹ä¹¦ä¸Šçš„ç¿»è¯‘æ˜¯è°å†™çš„ï¼Œå¤ªæ•·è¡äº†å§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> KMP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å“ˆå¸Œä¸å“ˆå¸Œè¡¨</title>
      <link href="/2019/09/28/hash/"/>
      <url>/2019/09/28/hash/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>å“ˆå¸Œç®—æ³•æ˜¯é€šè¿‡ä¸€ä¸ªå“ˆå¸Œå‡½æ•° Hï¼Œå°†ä¸€ç§æ•°æ®ï¼ˆå­—ç¬¦ä¸²ã€å¤§æ•°ç­‰ï¼‰è½¬åŒ–ä¸ºèƒ½å¤Ÿç”¨å˜é‡è¡¨ç¤ºæˆ–è€…èƒ½ç›´æ¥ä½œä¸ºæ•°ç»„ä¸‹æ ‡çš„æ•°ï¼Œé€šè¿‡å“ˆå¸Œå‡½æ•°è½¬åŒ–å¾—åˆ°çš„æ•°å€¼æˆ‘ä»¬æˆä¸ºå“ˆå¸Œå€¼ã€‚é€šè¿‡å“ˆå¸Œå€¼å¯ä»¥å®ç°å¿«é€ŸæŸ¥æ‰¾å’ŒåŒ¹é…ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»ä¸¤ç§å“ˆå¸Œç®—æ³•çš„åº”ç”¨ï¼šå­—ç¬¦ä¸² Hash å’Œå“ˆå¸Œè¡¨ã€‚</p><h4 id="å­—ç¬¦ä¸²Hash"><a href="#å­—ç¬¦ä¸²Hash" class="headerlink" title="å­—ç¬¦ä¸²Hash"></a>å­—ç¬¦ä¸²Hash</h4><p>å­—ç¬¦ä¸²Hashæœ‰å‡ ç§ä¸åŒçš„ç”¨é€”ï¼Œä½†æ˜¯åŸºäºåŒä¸€ä¸ªåŸç†ï¼Œå°±æ˜¯é€šè¿‡hashå€¼åŒ¹é…ã€‚<br>é¦–å…ˆå°±æ˜¯æ¨¡å¼ä¸²åŒ¹é…é—®é¢˜ï¼Œn = |S| , m = |T| ï¼Œå¯ä»¥é€šè¿‡ç»´æŠ¤åŸä¸²ä¸­æ‰€æœ‰é•¿åº¦ä¸º m çš„å­ä¸²çš„å“ˆå¸Œå€¼ï¼Œå®ç°åœ¨O(1)æ—¶é—´å†…è½¬ç§»ï¼Œå¹¶åœ¨O(1)æ—¶é—´å†…ä¸ T ä¸²çš„ hashå€¼åˆ¤ç­‰ï¼Œè‹¥ç›¸ç­‰åˆ™æœ‰å¯èƒ½åŒ¹é…æˆåŠŸã€‚<br>å¤§éƒ¨åˆ†æ¨¡å¼ä¸²åŒ¹é…é—®é¢˜æ˜¯ç”¨KMPæ±‚è§£ï¼Œä½†æ˜¯å¦‚æœè¦æ˜¯ä»ä¸»ä¸²ä¸­æ¯æ¬¡é€‰å‡ºä¸¤ä¸ªå­ä¸²åˆ¤æ–­æ˜¯å¦åŒ¹é…çš„é—®é¢˜ï¼Œè¿˜æ˜¯éœ€è¦ç”¨å­—ç¬¦ä¸² Hash æ±‚è§£ã€‚</p><p><strong>å…·ä½“æµç¨‹</strong><br>æˆ‘ä»¬è®¾è®¡çš„å“ˆå¸Œå‡½æ•° H åº”å½“èƒ½åœ¨O(1)æ—¶é—´å†…å®ç°ç›¸é‚»å­ä¸²é—´çš„è½¬ç§»ï¼Œæˆ–åœ¨é¢„å¤„ç†åï¼Œå¯¹ä¸åŒçš„å­ä¸²åº”è¯¥èƒ½åœ¨O(1)æ—¶é—´å†…æ±‚å‡ºå…¶å“ˆå¸Œå€¼ï¼›è¿™é‡Œç”¨åˆ°å«åš æ»šåŠ¨å“ˆå¸Œ çš„ä¼˜åŒ–æŠ€å·§ã€‚</p><p>æˆ‘ä»¬é€‰å–ä¸¤ä¸ªåˆé€‚çš„äº’è´¨çš„å¸¸æ•° b å’Œ h(b &lt; h)ï¼Œå‡è®¾å­—ç¬¦ä¸² $C = c_1c_2â€¦c_m$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®šä¹‰å‡½æ•°ï¼š$H(C) = (c_1b^{m-1} + c_2b^{m-2} + â€¦ + c_mb^0)\:mod\:h$ã€‚</p><p>è¿™é‡Œçš„bæ˜¯åŸºæ•°ï¼Œç›¸å½“äºæŠŠå­—ç¬¦ä¸²çœ‹ä½œæ˜¯ b è¿›åˆ¶æ•°ã€‚<br>è¿™ä¸€è¿‡ç¨‹æ˜¯é€’æ¨è®¡ç®—çš„ï¼Œè®¾H(C , k+1)æ˜¯å‰ k ä¸ªå­—ç¬¦æ„æˆçš„å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ï¼Œåˆ™ï¼ˆä¸è€ƒè™‘å–æ¨¡ï¼‰ï¼š$H(C , k+1) = H(C, k) * b + c_{k+1}$ã€‚</p><p>å¦‚æœæˆ‘ä»¬è¦<strong>æ±‚ C ä¸­ä» k å‡ºå‘é•¿åº¦ä¸º m çš„å­ä¸²çš„å“ˆå¸Œå€¼</strong>ï¼Œé‚£ä¹ˆ$hsh = H(C , k+m) - H(C, k) * b^m$ï¼Œhshå³ä¸ºæ‰€æ±‚ã€‚</p><p><strong>é¢„å¤„ç†</strong></p><p>æˆ‘ä»¬é€šè¿‡é¢„å¤„ç†æ±‚å‡ºæ‰€æœ‰C[a1, k]ï¼ˆk &lt;= nï¼‰çš„å“ˆå¸Œå€¼å¹¶å­˜å‚¨åœ¨hashæ•°ç»„ä¸­ï¼ˆhash[i] = H(C,i) ï¼‰ï¼Œå¹¶é¢„å¤„ç† base æ•°ç»„ï¼ˆbase[i] = $b^i$ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨O(1)æ—¶é—´å†…æ±‚å‡ºä»»æ„ä¸€ä¸ªå­ä¸²çš„å“ˆå¸Œå€¼ã€‚</p><p>åœ¨å®ç°ç®—æ³•æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸åˆ©ç”¨32ä½æˆ–è€…64ä½æ— ç¬¦å·æ•´æ•°è®¡ç®—å“ˆå¸Œå€¼ï¼Œå¹¶å– $h = 2^{32}$ æˆ– $h = 2^{64}$ï¼Œé€šè¿‡è‡ªç„¶æº¢å‡ºçœå»å–æ¨¡è¿ç®—ã€‚é€šå¸¸ b å–131 æˆ– 13331æ—¶æ•ˆæœè¾ƒå¥½ã€‚</p><p><strong>ä»£ç å®ç°</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* bse[i] = b^i , hsh[i] = H(str, i) */</span></span><br><span class="line">bse[<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//bseå’Œhshéƒ½æ˜¯unsigned long long </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">    hsh[i] = hsh[i<span class="number">-1</span>]*b + str[i]-<span class="string">'a'</span>;</span><br><span class="line">    bse[i] = bse[i<span class="number">-1</span>]*b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>æ­£ç¡®æ€§è¯æ˜</strong><br>ä¸Šè¿°åšæ³•å¯ä»¥ä¿è¯ç›¸åŒçš„å­—ç¬¦ä¸²æ‰€äº§ç”Ÿçš„å“ˆå¸Œå€¼ä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯ä¸åŒçš„å­—ç¬¦ä¸²æ‰€äº§ç”Ÿçš„å“ˆå¸Œå€¼ä¸€å®šæ˜¯ä¸åŒçš„å—ï¼Ÿ<br>å¹¶ä¸ä¸€å®šï¼Œä½†æ˜¯å†²çªçš„å‡ ç‡å¾ˆå°ï¼Œæˆ‘ä»¬é€šå¸¸è®¤ä¸ºç®—æ³•ç«èµ›ä¸ä¼šå‡ºç°ä¸åŒå­—ç¬¦ä¸²å“ˆå¸Œå€¼å†²çªçš„æƒ…å†µã€‚å®é™…ä¸Šæ ¹æ®ç”Ÿæ—¥æ‚–è®ºï¼Œå¯¹äºå“ˆå¸Œå€¼åœ¨[0 , n)å†…å‡åŒ€åˆ†å¸ƒçš„å“ˆå¸Œå‡½æ•°ï¼Œå‡ºç°ä¸åŒå­—ç¬¦ä¸²å“ˆå¸Œå€¼ç›¸ç­‰çš„æœŸæœ›æ­¥æ•°æ˜¯ $O(\sqrt N)$ï¼Œå¯ä»¥ä½œä¸ºä¸€ä¸ªå‚è€ƒã€‚<br>æ›´è¿›ä¸€æ­¥çš„ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ <strong>â€œåŒå“ˆå¸Œâ€</strong> é™ä½å†²çªçš„æ¦‚ç‡ï¼Œå³å–ç”¨ä¸åŒçš„æ¨¡æ•°ï¼ŒæŠŠä¸åŒçš„æ¨¡æ•°ç®—å‡ºçš„å“ˆå¸Œå€¼è®°ä¸‹æ¥ï¼Œåªæœ‰å‡ ä¸ªå“ˆå¸Œå€¼éƒ½ä¸€æ ·ï¼Œæ‰åˆ¤å®šå­—ç¬¦ä¸²åŒ¹é…ã€‚æˆ‘ä»¬é€šå¸¸ç”¨åŒå“ˆå¸Œå°±å¯ä»¥å°†å†²çªçš„æ¦‚ç‡é™åˆ°å¾ˆä½ï¼Œå¦‚æœåˆ†åˆ«å– h = 1e9+7 å’Œ h = 1e9+9ï¼Œå°±å‡ ä¹ä¸å¯èƒ½å‘ç”Ÿå†²çªï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸€å¯¹â€œå­ªç”Ÿç´ æ•°â€ã€‚</p><h4 id="å“ˆå¸Œè¡¨ä¸å“ˆå¸Œå‡½æ•°"><a href="#å“ˆå¸Œè¡¨ä¸å“ˆå¸Œå‡½æ•°" class="headerlink" title="å“ˆå¸Œè¡¨ä¸å“ˆå¸Œå‡½æ•°"></a>å“ˆå¸Œè¡¨ä¸å“ˆå¸Œå‡½æ•°</h4><p>å“ˆå¸Œè¡¨æ˜¯ä¸€ç§é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼ŒæŸ¥æ‰¾æ—¶é—´æ•ˆç‡æ˜¯å¸¸æ•°æ—¶é—´ï¼ŒåŒæ—¶ä¹Ÿå¾ˆå®¹æ˜“å®ç°ï¼Œéœ€è¦ä»˜å‡ºçš„ä»£ä»·æ˜¯æ¶ˆè€—å†…å­˜ï¼Œä½†åœ¨å¦‚ä»Šè¿™ç‚¹å†…å­˜å·²ä¸æˆé—®é¢˜ã€‚</p><p><strong>é—®é¢˜æ¨¡å‹</strong><br>ç»™å®š n ä¸ªæ•°ï¼Œè¿™äº›æ•°å¯èƒ½å¾ˆå¤§ï¼Œåˆ¤æ–­æ¯ä¸ªæ•°åœ¨ä¹‹å‰æœ‰æ— å‡ºç°è¿‡ï¼Œå‡ºç°äº†å‡ æ¬¡ï¼Ÿ</p><p><strong>ç®—æ³•æµç¨‹</strong><br>è¿™é‡Œå…·ä½“åˆ†ä¸ºä¸‰æ­¥ï¼šæ„é€ å“ˆå¸Œå‡½æ•° H()ï¼›å°†å…ƒç´ æ˜ å°„åˆ°å“ˆå¸Œè¡¨ï¼›è§£å†³å†²çªã€‚<br>é¦–å…ˆè¦è§£å†³å­˜å‚¨é—®é¢˜ï¼Œæˆ‘ä»¬å…ˆç”¨çº¿æ€§è¡¨ï¼Œå³ä¸€ç»´æ•°ç»„æ¥å­˜æ”¾å…ƒç´ ã€‚å¯¹äºæ¯ä¸ªå…ƒç´ valï¼Œkey = H(val)ï¼ˆè¿™é‡Œçš„ key æ˜¯å°äº 1e7 çš„ï¼Œå¯ä»¥å½“ä½œæ•°ç»„çš„ä¸‹æ ‡ï¼‰ï¼Œäºæ˜¯æˆ‘ä»¬å°±å°†valå­˜æ”¾åœ¨æ•°ç»„ä¸‹æ ‡ä¸º key çš„ä½ç½®ä¸Šã€‚</p><p>è€Œä¸åŒçš„å…ƒç´ å®ƒä»¬keyå€¼æ˜¯ä¸åŒçš„ï¼ˆç†æƒ³æƒ…å†µï¼‰ï¼Œç›¸åŒçš„å…ƒç´ keyå€¼ä¸€å®šæ˜¯ç›¸åŒçš„ï¼ˆä»»ä½•æƒ…å†µï¼‰ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡O(1)æ—¶é—´çš„H()è½¬åŒ–ï¼Œè¯»å–æ•°ç»„å†…å¯¹åº”ä½ç½®ä¸Šçš„å…ƒç´ ã€‚</p><p>ä¸ºäº†å‡å°‘å†²çªå‘¢ï¼Œæˆ‘ä»¬å¿…é¡»æ„é€ ä¸€ä¸ªå¥½çš„å“ˆå¸Œå‡½æ•°Hï¼Œè¿™åœ¨åé¢ä¼šå•ç‹¬ä»‹ç»å¸¸ç”¨çš„æ„é€ æ–¹æ³•ã€‚ä½†æ˜¯ä¸ç®¡å¤šä¹ˆä¼˜ç§€çš„å“ˆå¸Œå‡½æ•°ï¼Œéƒ½ä¸å¯é¿å…å­˜åœ¨å†²çªï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦æœ‰è§£å†³å†²çªçš„å¯¹ç­–ã€‚æˆ‘ä»¬æƒ³åˆ°å¯ä»¥ç”¨é“¾è¡¨æ¥è§£å†³å†²çªï¼Œå³è¯¥ä¸€ç»´è¡¨çš„æ¯ä¸€ä¸ªä½ç½®éƒ½æ˜¯ä¸€æ¡é“¾è¡¨ï¼Œå…·æœ‰ç›¸åŒå“ˆå¸Œå€¼çš„å…ƒç´ éƒ½æ”¾åœ¨åŒä¸€æ¡é“¾ä¸Šï¼Œå½“æŸ¥æ‰¾æ—¶åªéœ€è¦éå†è¿™æ¡é“¾å³å¯ã€‚è¿™å°±å«å“ˆå¸Œï¼ˆé“¾ï¼‰è¡¨ã€‚</p><h5 id="å“ˆå¸Œå‡½æ•°çš„æ„é€ "><a href="#å“ˆå¸Œå‡½æ•°çš„æ„é€ " class="headerlink" title="å“ˆå¸Œå‡½æ•°çš„æ„é€ "></a>å“ˆå¸Œå‡½æ•°çš„æ„é€ </h5><p>å“ˆå¸Œå‡½æ•°æ˜¯å†³å®šå“ˆå¸Œè¡¨æŸ¥æ‰¾æ•ˆç‡çš„å…³é”®ï¼Œåªæœ‰å“ˆå¸Œå€¼åˆ†é…çš„è¶³å¤Ÿå‡åŒ€æ—¶ï¼Œå•è¯æŸ¥æ‰¾çš„å¤æ‚åº¦æ‰ä¼šå°½é‡å°ã€‚ä»¥ä¸‹ä»‹ç»å‡ ç§æ•ˆæœå¥½çš„ã€å®¹æ˜“å®ç°çš„å“ˆå¸Œå‡½æ•°ã€‚<br><strong>ï¼ˆ1ï¼‰åŸºæ•°è½¬æ¢æ³•</strong><br>åŸºæ•°è½¬æ¢æ³•å°±æ˜¯å¼€å¤´çš„å­—ç¬¦ä¸²Hashæ‰€é‡‡ç”¨çš„è½¬æ¢æ–¹æ³•ï¼šå°† val å€¼çœ‹ä½œå¦ä¸€ç§è¿›åˆ¶æ•°ï¼Œç„¶åå†æŠŠå®ƒè½¬åŒ–æˆå¯¹åº”çš„åè¿›åˆ¶æ•°ï¼Œå†ç”¨é™¤ä½™æ³•å¯¹å…¶å–ä½™ã€‚ä¸€èˆ¬å–å¤§äº10çš„æ•°ä½œä¸ºè½¬æ¢çš„åŸºæ•°ï¼Œå¹¶ä¸”ä¸¤ä¸ªåŸºæ•°æ˜¯äº’è´¨çš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå– 131 æˆ– 13331è¾ƒå¥½ã€‚</p><p>å¦‚ val = 236075 åŸæœ¬æ˜¯åè¿›åˆ¶æ•°ï¼Œç°åœ¨å°†å®ƒçœ‹ä½œåä¸‰è¿›åˆ¶æ•°$(236075) _ {13}$ç„¶åå†å°†å®ƒè½¬æ¢ä¸ºåè¿›åˆ¶æ•°ã€‚<br>$(236075)_ {13} = 2 <em> 13^5 + 3 </em> 13^4 + 6 <em> 13^3 + 7 </em> 13 + 5 = (841547) _ {10}$</p><p><strong>ï¼ˆ2ï¼‰é™¤ä½™æ³•</strong><br>é€‰æ‹©ä¸€ä¸ªé€‚å½“çš„æ­£æ•´æ•° bï¼Œç”¨å…¶å¯¹ b å–æ¨¡çš„ä½™æ•°ä½œä¸ºå“ˆå¸Œå€¼ï¼Œå³ï¼šH(val) = val mod bï¼Œè¿™ä¸ªæ–¹æ³•åº”ç”¨çš„æœ€å¤šï¼Œå¹¶ä¸”å¤šæ•°æƒ…å†µä¸‹æ€§ä»·æ¯”ä¹Ÿæ˜¯æœ€é«˜çš„ã€‚å…³é”®åœ¨äº b çš„é€‰å–ï¼Œä¸€èˆ¬é€‰ b æ˜¯æ•°ç»„ä¸‹æ ‡èƒ½å­˜å‚¨å¾—ä¸‹å¹¶ä¸”å°½é‡å¤§çš„è´¨æ•°ï¼ˆä¸€èˆ¬æ ¹æ®ç©ºé—´å–1e6å·¦å³çš„è´¨æ•°ï¼‰ã€‚é€‰è´¨æ•°æ˜¯å› ä¸º é€šå¸¸bçš„çº¦æ•°è¶Šå¤šï¼Œå†²çªçš„å‡ ç‡å°±è¶Šå¤§ã€‚</p><p><strong>ï¼ˆ3ï¼‰ä¹˜ç§¯å–æ•´æ³•</strong><br>æˆ‘ä»¬ç”¨å€¼ val ä¹˜ä»¥ä¸€ä¸ªåœ¨(0,1)ä¸­çš„å®æ•° Aï¼ˆæœ€å¥½æ˜¯æ— ç†æ•°ï¼Œ$(\sqrt 5 - 1)/2$æ˜¯ä¸€ä¸ªå®é™…æ•ˆæœå¾ˆå¥½çš„æ•°ï¼‰ï¼Œå¾—åˆ°ä¸€ä¸ª(0 , k)ä¹‹é—´å®æ•°ï¼›å–å…¶å°æ•°éƒ¨åˆ†ï¼Œä¹˜ä»¥å“ˆå¸Œè¡¨çš„å¤§å° M å†å‘ä¸‹å–æ•´ï¼Œå³å¾— val åœ¨Hashè¡¨ä¸­çš„ä½ç½®ã€‚å‡½æ•°è¡¨è¾¾å¼å¯ä»¥å†™æˆï¼šH(val) = { M( val * A mod 1 ) }ã€‚</p><h5 id="æ•£åˆ—è¡¨æ¨¡æ¿"><a href="#æ•£åˆ—è¡¨æ¨¡æ¿" class="headerlink" title="æ•£åˆ—è¡¨æ¨¡æ¿"></a>æ•£åˆ—è¡¨æ¨¡æ¿</h5><p>ä¾‹é¢˜ï¼šé—¨ç¥¨(tickets)<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">2181271</span>; </span><br><span class="line"><span class="keyword">int</span> nex[N],num[N],head[N],tot = <span class="number">1</span>;<span class="comment">// ç”¨é‚»æ¥è¡¨æ–¹å¼å®ç°å“ˆå¸Œè¡¨ </span></span><br><span class="line"><span class="keyword">int</span> top , stk[N];<span class="comment">//æ•°ç»„æ¨¡æ‹Ÿå †æ ˆ,ç”¨äºå“ˆå¸Œè¡¨çš„åˆå§‹åŒ– </span></span><br><span class="line">ll a,b,c;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">tot = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">while</span>(top) head[stk[top--]] = <span class="number">0</span>;<span class="comment">//åªæ¸…ç©ºç”¨äº†çš„è¡¨,èŠ‚çœæ—¶é—´ </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å°†xæ’å…¥å“ˆå¸Œè¡¨*/</span></span><br><span class="line"><span class="keyword">int</span> h = x % P;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[h] ;i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">if</span>(num[i] == x) <span class="keyword">return</span>; <span class="comment">//ç›¸åŒçš„å€¼å·²ç»å­˜æ”¾è¿‡äº† </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span>(!head[h]) stk[++top] = h; <span class="comment">//ç¬¬ä¸€æ¬¡å‡ºç°çš„å“ˆå¸Œå€¼å…¥æ ˆ</span></span><br><span class="line"><span class="comment">/* é‚»æ¥è¡¨æ·»åŠ å…ƒç´ åŸºæœ¬å¥—è·¯ */</span></span><br><span class="line">nex[++tot] = head[h]; head[h] = tot; num[tot] = x; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ask</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line"><span class="comment">/* è¿”å› x æ˜¯å¦å­˜åœ¨*/</span></span><br><span class="line"><span class="keyword">int</span> h = x%P;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[h];i;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">if</span>(num[i] == x) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">ll x = <span class="number">1</span>; Insert(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; <span class="number">2e6</span>;i++)&#123;</span><br><span class="line">x = (x*a + x%b)%c;</span><br><span class="line"><span class="keyword">if</span>(ask(x)) <span class="keyword">return</span> i;</span><br><span class="line">Insert(x); </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*å¤šç»„æ ·ä¾‹è¦è°ƒç”¨init()*/</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve());</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>è‘£æ°¸å»ºï¼Œä¿¡æ¯å­¦ç«èµ›ä¸€æœ¬é€šæé«˜ç‰ˆï¼Œç¦å·ï¼šç¦å»ºæ•™è‚²å‡ºç‰ˆç¤¾ï¼Œ2018.6ï¼Œ63-69</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
            <tag> hash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­—ç¬¦ä¸²å¾ªç¯èŠ‚é—®é¢˜</title>
      <link href="/2019/09/27/xhj/"/>
      <url>/2019/09/27/xhj/</url>
      
        <content type="html"><![CDATA[<p><strong>å¾ªç¯èŠ‚ä¸æœ€çŸ­å¾ªç¯èŠ‚ï¼š</strong><br>è‹¥æŸä¸ªå­—ç¬¦ä¸²æ˜¯ç”±æŸä¸ªå­ä¸²å¾ªç¯æ„æˆçš„ï¼Œé‚£ä¹ˆå°±ç§°è¯¥å­ä¸²ä¸ºåŸä¸²çš„å¾ªç¯èŠ‚ï¼Œé•¿åº¦æœ€çŸ­çš„å¾ªç¯èŠ‚å°±æ˜¯æœ€çŸ­å¾ªç¯èŠ‚ã€‚<br>å¦‚ababababï¼Œababå’Œabéƒ½æ˜¯åŸä¸²çš„å¾ªç¯èŠ‚ï¼Œè€Œæœ€çŸ­å¾ªç¯èŠ‚æ˜¯abã€‚</p><p><strong>ç»“è®ºï¼š</strong><br>å¦‚æœå­—ç¬¦ä¸² s æœ‰ä¸ªå¾ªç¯èŠ‚ sonï¼Œn = |s| , x = |son|ï¼Œå­—ç¬¦æ•°ç»„ä¸‹æ ‡ä»1å¼€å§‹ï¼Œé‚£ä¹ˆï¼š</p><ol><li>x ä¸€å®šæ˜¯ n çš„çº¦æ•°ã€‚</li><li>é‚£ä¹ˆs[1,n-x] = s[x, n] = sonã€‚</li></ol><p><strong>è¯æ˜ï¼š</strong><br>ç»“è®º1ï¼šå¦‚æœ x ä¸æ˜¯ n çš„çº¦æ•°ï¼Œé‚£ä¹ˆè‡ªç„¶ n å°±ä¸å¯èƒ½ç”± è‹¥å¹²ä¸ª x ç›¸åŠ æ„æˆï¼Œå³ä¸æ»¡è¶³ n = k * x ï¼Œå…¶ä¸­ k æ˜¯æ­£æ•´æ•°ã€‚<br>ç»“è®º2ï¼šè‹¥æƒ³s[1 ,n-x] = s[x, n] ï¼Œå¿…é¡»s[1, x] = s[ x ,2x] = s[2x , 3x] = â€¦ = s[n-x , n]ï¼Œåˆšå¥½ç¬¦åˆå¾ªç¯èŠ‚å®šä¹‰ï¼Œå› æ­¤ ç»“è®º2 æˆç«‹ã€‚</p><h4 id="æ±‚å•ä¸ªå­—ç¬¦ä¸²çš„æœ€çŸ­å¾ªç¯èŠ‚"><a href="#æ±‚å•ä¸ªå­—ç¬¦ä¸²çš„æœ€çŸ­å¾ªç¯èŠ‚" class="headerlink" title="æ±‚å•ä¸ªå­—ç¬¦ä¸²çš„æœ€çŸ­å¾ªç¯èŠ‚"></a>æ±‚å•ä¸ªå­—ç¬¦ä¸²çš„æœ€çŸ­å¾ªç¯èŠ‚</h4><p><strong>ä¾‹1ï¼š</strong> POJ 2406 Power Strings (KMP)<br><a href="http://poj.org/problem?id=2406" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong> ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œæ±‚å‡ºå®ƒæœ€å¤šç”±æŸä¸ªå­ä¸² å¾ªç¯å‡ æ¬¡ æ„æˆã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>é¦–å…ˆ s å¿…é¡»æ˜¯ç”±æŸä¸ªå¾ªç¯èŠ‚å¾ªç¯è‹¥å¹²æ¬¡æ„æˆçš„ï¼Œå¦åˆ™æ— è§£ã€‚é¢˜æ„è®©æ±‚æœ€å¤šå¾ªç¯å‡ æ¬¡æ„æˆï¼Œé‚£ä¹ˆæ—¢ç„¶ s çš„é•¿åº¦å›ºå®šæ˜¯ nï¼Œè‡ªç„¶æ˜¯å¾ªç¯èŠ‚è¶ŠçŸ­ï¼Œé‚£ä¹ˆå¾ªç¯æ¬¡æ•°è¶Šå¤šäº†ã€‚<br>æˆ‘ä»¬å…ˆæ±‚å‡ºKMPç®—æ³•ä¸­çš„nexæ•°ç»„ã€‚<br><strong>ç»“è®º3ï¼š</strong> æ­¤æ—¶è‹¥ s æœ‰è§£ï¼Œé‚£ä¹ˆæœ€çŸ­å¾ªç¯èŠ‚é•¿åº¦ä¸º x = n - nex[n] ã€‚</p><p><strong>è¯æ˜ï¼šåè¯æ³•</strong> </p><ol><li>é¦–å…ˆæ ¹æ®ç»“è®º2ï¼Œå› ä¸º s[1,nex[n] ] = s[n - nex[n] , n]ï¼Œæ‰€ä»¥å¿…ç„¶å­˜åœ¨é•¿åº¦ä¸º x = n - nex[n]çš„å¾ªç¯èŠ‚ï¼Œé—®é¢˜å°±åœ¨äºå®ƒæ˜¯ä¸æ˜¯æœ€çŸ­çš„ã€‚</li><li>å‡è®¾å­˜åœ¨å¾ªç¯èŠ‚ï¼Œé•¿åº¦ä¸º yï¼ˆy &lt; xï¼‰ ï¼Œé‚£ä¹ˆæ ¹æ®ç»“è®º2ï¼Œä¸€å®šæœ‰ï¼š s[1, n-y] = s[y , n]ï¼›å¦‚æ­¤ä¸€æ¥nex[n] = n-y &gt; n-xï¼Œè¿™å’Œnexæ•°ç»„å®šä¹‰çŸ›ç›¾ï¼Œå› æ­¤ä¸å­˜åœ¨y &lt; xã€‚</li><li>ç»¼ä¸Šæ‰€è¿°ï¼Œn - nex[n] ä¸€å®šä¸ºæœ€çŸ­å¾ªç¯èŠ‚çš„é•¿åº¦ã€‚</li></ol><p>å› æ­¤æœ¬é¢˜çš„ç­”æ¡ˆå°±æ˜¯ n/(n-nex[n])ï¼Œè‹¥ä¸èƒ½æ•´é™¤ï¼Œåˆ™æ— è§£ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong> è§é™„å½•éƒ¨åˆ† code-1ï¼šPower Strings</p><h4 id="æ±‚ä»»æ„å­ä¸²çš„æœ€çŸ­å¾ªç¯èŠ‚"><a href="#æ±‚ä»»æ„å­ä¸²çš„æœ€çŸ­å¾ªç¯èŠ‚" class="headerlink" title="æ±‚ä»»æ„å­ä¸²çš„æœ€çŸ­å¾ªç¯èŠ‚"></a>æ±‚ä»»æ„å­ä¸²çš„æœ€çŸ­å¾ªç¯èŠ‚</h4><p><strong>ä¾‹2ï¼š</strong> bzoj2795 Horrible Poem<br><a href="http://www.mfstem.org/contest/57/problem/F" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å‡ºä¸€ä¸ªç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² Sï¼Œå†ç»™å‡º q ä¸ªè¯¢é—®ï¼Œè¦æ±‚å›ç­” S æŸä¸ªå­ä¸²çš„æœ€çŸ­å¾ªç¯èŠ‚é•¿åº¦ã€‚å¦‚æœå­—ç¬¦ä¸² B æ˜¯å­—ç¬¦ä¸² A çš„å¾ªç¯èŠ‚ï¼Œé‚£ä¹ˆ A å¯ä»¥ç”± B é‡å¤è‹¥å¹²æ¬¡å¾—åˆ°ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>æ­¤é¢˜çš„ q å¾ˆå¤§ï¼Œæˆ‘ä»¬ä¸å¯èƒ½å¯¹æ¯ä¸€ä¸ªå­ä¸²éƒ½O(n)æ±‚å‡º nex æ•°ç»„å†å›ç­”ã€‚æˆ‘ä»¬åˆ©ç”¨ æ»šåŠ¨å“ˆå¸Œ ï¼Œåœ¨O(1)æ—¶é—´å†…åˆ©ç”¨ ç»“è®º2 åˆ¤æ–­æŸä¸ªé•¿åº¦æ˜¯å¦ä¸ºå¾ªç¯èŠ‚ã€‚<br>å†æ ¹æ®ç»“è®º1ï¼Œå¯ä»¥å¾—çŸ¥å¾ªç¯èŠ‚é•¿åº¦ä¸€å®šæ˜¯å­ä¸²é•¿åº¦ m çš„çº¦æ•°ï¼Œå› æ­¤æˆ‘ä»¬$O(\sqrt m)$åˆ†è§£çº¦æ•°ï¼Œå†ç”¨O(1)å¤æ‚åº¦ç”¨hashåˆ¤æ–­ï¼Œæœ¬é¢˜æ€»å¤æ‚åº¦å°±æ˜¯ $O(q \sqrt m)$ã€‚</p><p>ä¸€èˆ¬åˆ°è¿™é‡Œå°±è¯¥ç»“æŸäº†ï¼Œæˆ‘ä»¬åˆ©ç”¨äº† ç»“è®º1 å’Œ ç»“è®º2 å¤§å¤§å‡å°‘äº†æ±‚å¾ªç¯èŠ‚çš„æ—¶é—´ã€‚ä½†æ˜¯åœ¨æœ¬é¢˜è¿˜æ˜¯ä¸å¤Ÿï¼Œè¿˜éœ€è¦ä¼˜åŒ–ã€‚è¿˜èƒ½ä¼˜åŒ–çš„åœ°æ–¹å°±åªæœ‰æ±‚çº¦æ•°çš„$O(\sqrt m)$å¤æ‚åº¦äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è´¨å› æ•°åˆ†è§£åœ¨$O(log_2^m)$æ—¶é—´å†…åˆ†è§£çº¦æ•°ï¼Œäºæ˜¯æœ€ç»ˆå¤æ‚åº¦å°±æ˜¯ $O(q\:log_2^n)$ï¼Œå¯ä»¥é€šè¿‡äº†ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong> è§é™„å½•éƒ¨åˆ†code-2ï¼šHorrible Poem</p><h4 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h4><p><strong>code-1ï¼šPower Strings</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> nex[N]; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">char</span>* str)</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(nex,<span class="number">0</span>,<span class="keyword">sizeof</span> nex);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>,j = <span class="number">0</span>;str[i];i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; str[i] != str[j+<span class="number">1</span>]) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(str[i] == str[j+<span class="number">1</span>]) j++;</span><br><span class="line">nex[i] = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*è®¡ç®—ç­”æ¡ˆå¹¶è¾“å‡º*/</span></span><br><span class="line">getNex(str);</span><br><span class="line"><span class="keyword">int</span> n = <span class="built_in">strlen</span>(str)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">if</span>(n%(n-nex[n])) <span class="built_in">puts</span>(<span class="string">"1"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,n/(n-nex[n]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str+<span class="number">1</span>) &amp;&amp; str[<span class="number">1</span>] != <span class="string">'.'</span>)&#123;</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">'*'</span>;</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>code-2ï¼šHorrible Poem</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Q = <span class="number">2e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> n,q;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line">ull hsh[N],bse[N] , b = <span class="number">31</span>; <span class="comment">//é‡‡ç”¨æ— ç¬¦å·é•¿æ•´å½¢,é€šè¿‡è‡ªç„¶æº¢å‡ºçœå»å–æ¨¡ </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">/*åˆ¤æ–­xæ˜¯å¦ä¸ºå­ä¸²s[l,r]çš„æœ€çŸ­å¾ªç¯èŠ‚é•¿åº¦*/</span> </span><br><span class="line">ull h1 = hsh[r-x] - hsh[l<span class="number">-1</span>]*bse[r-x+<span class="number">1</span>-l];</span><br><span class="line">ull h2 = hsh[r] - hsh[l<span class="number">-1</span>+x]*bse[r-x+<span class="number">1</span>-l];</span><br><span class="line"><span class="keyword">return</span> h1 == h2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> v[N],primes[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getPri</span><span class="params">()</span></span>&#123;<span class="comment">//çº¿æ€§ç­› </span></span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!v[i])&#123;</span><br><span class="line">primes[cnt++] = i;</span><br><span class="line">v[i] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; cnt;j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(primes[j] &gt; v[i] || primes[j]*i &gt; N)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">v[i*primes[j]] = primes[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å›ç­”å­ä¸²s[l,r]çš„æœ€çŸ­å¾ªç¯èŠ‚é•¿åº¦*/</span> </span><br><span class="line"><span class="keyword">int</span> len = r-l+<span class="number">1</span>, ans = len, d = len;</span><br><span class="line"><span class="keyword">while</span>(d != <span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">int</span> tmp = v[d];</span><br><span class="line"><span class="keyword">while</span>(d%tmp == <span class="number">0</span> &amp;&amp; check(l,r,ans/tmp)) d /= tmp,ans /= tmp;</span><br><span class="line"><span class="keyword">while</span>(d%tmp == <span class="number">0</span>) d /= tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*é¢„å¤„ç†å‡ºhashæ•°ç»„,væ•°ç»„*/</span></span><br><span class="line">getPri(); bse[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">hsh[i] = hsh[i<span class="number">-1</span>]*b + str[i]-<span class="string">'a'</span>;</span><br><span class="line">bse[i] = bse[i<span class="number">-1</span>]*b;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>; <span class="keyword">char</span> c=getchar();</span><br><span class="line">    <span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>) &#123; <span class="keyword">if</span>(c==<span class="string">'-'</span>) f=<span class="number">-1</span>; c=getchar(); &#125;</span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>) &#123; x=x*<span class="number">10</span>+c-<span class="string">'0'</span>; c=getchar(); &#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">n = read();</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str+<span class="number">1</span>); str[<span class="number">0</span>] = <span class="string">'#'</span>;</span><br><span class="line">q = read();</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,l,r;i &lt;= q;i++)&#123;</span><br><span class="line">l = read(); r = read();</span><br><span class="line">ask(l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> KMP </tag>
            
            <tag> å¾ªç¯èŠ‚ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­—ç¬¦ä¸²ä¸å“ˆå¸Œé¢˜é›†</title>
      <link href="/2019/09/26/hash-and-kmp/"/>
      <url>/2019/09/26/hash-and-kmp/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘æ ¡OJï¼š<a href="http://www.mfstem.org/contest/57/problems" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br>å›¾ä¹¦é…å¥—OJï¼š<a href="http://ybt.ssoier.cn:8088/index.php" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a></p><h4 id="A-Oulipo"><a href="#A-Oulipo" class="headerlink" title="A. Oulipo"></a>A. Oulipo</h4><p><strong>Description</strong><br>ç»™å‡ºä¸¤ä¸ªå­—ç¬¦ä¸²s1,s2ï¼ˆåªæœ‰å¤§å†™å­—æ¯ï¼‰ï¼Œæ±‚s1åœ¨s2ä¸­å‡ºç°å¤šå°‘æ¬¡ã€‚ä¾‹å¦‚ï¼šs1=â€ABAâ€,s2=â€ABAABAâ€,ç­”æ¡ˆä¸º2ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>KMPç®—æ³•çš„æ¨¡æ¿ï¼Œä¹Ÿå¯ä»¥ç”¨æ‹“å±•KMPè§£å†³ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt; </span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>; </span><br><span class="line"><span class="keyword">int</span> nex[N];<span class="comment">//nex[i] = T[i,n-1]ä¸T[0,n-1]æœ€é•¿å…¬å…±å‰ç¼€ </span></span><br><span class="line"><span class="keyword">char</span> S[N],T[N]; <span class="comment">//Sä¸ºç›®æ ‡ä¸²,Tä¸ºæ¨¡å¼ä¸² </span></span><br><span class="line"><span class="keyword">int</span> extend[N]; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">char</span>* str)</span></span>&#123;</span><br><span class="line"><span class="comment">/*è®¡ç®—nexæ•°ç»„*/</span></span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(str) ,i = <span class="number">0</span>, j, p0 ;</span><br><span class="line">nex[<span class="number">0</span>] = len;</span><br><span class="line"><span class="keyword">while</span>(i+<span class="number">1</span> &lt; len &amp;&amp; str[i] == str[i+<span class="number">1</span>]) i++;</span><br><span class="line">nex[<span class="number">1</span>] = i; p0 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(nex[i-p0]+i &lt; nex[p0]+p0) nex[i] = nex[i-p0];</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">j = nex[p0]+p0-i;</span><br><span class="line"><span class="keyword">if</span>(j &lt; <span class="number">0</span>) j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(i+j &lt; len &amp;&amp; str[j] == str[j+i]) j++;</span><br><span class="line">nex[i] = j; p0 = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exKMP</span><span class="params">(<span class="keyword">char</span>* str1,<span class="keyword">char</span> *str2)</span></span>&#123;</span><br><span class="line"><span class="comment">/*è®¡ç®—str2ä¸str1çš„æ‰€æœ‰åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦,å­˜æ”¾åœ¨extendæ•°ç»„ä¸­*/</span> </span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>,j,p0,l1 = <span class="built_in">strlen</span>(S), l2 = <span class="built_in">strlen</span>(T);</span><br><span class="line">getNex(str2);</span><br><span class="line"><span class="keyword">while</span>(i &lt; l1 &amp;&amp; i &lt; l2 &amp;&amp; str1[i] == str2[i]) i++;</span><br><span class="line">extend[<span class="number">0</span>] = i;p0 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; l1;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(nex[i-p0]+i &lt; extend[p0]+p0) extend[i] = nex[i-p0];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">j = extend[p0]+p0-i;</span><br><span class="line"><span class="keyword">if</span>(j &lt; <span class="number">0</span>) j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(i+j &lt; l1 &amp;&amp; j &lt; l2 &amp;&amp; str1[j+i] == str2[j]) j++;</span><br><span class="line">extend[i] = j; p0 = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*è®¡ç®—å¹¶è¾“å‡ºç­”æ¡ˆ*/</span></span><br><span class="line"><span class="keyword">int</span> l1 = <span class="built_in">strlen</span>(S), l2 = <span class="built_in">strlen</span>(T), ans = <span class="number">0</span>;</span><br><span class="line">exKMP(S,T); <span class="keyword">int</span> len = <span class="built_in">strlen</span>(T);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; l1;i++)</span><br><span class="line"><span class="keyword">if</span>(extend[i] == len) ans++;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s%s"</span>,T,S);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="B-å›¾ä¹¦ç®¡ç†"><a href="#B-å›¾ä¹¦ç®¡ç†" class="headerlink" title="B. å›¾ä¹¦ç®¡ç†"></a>B. å›¾ä¹¦ç®¡ç†</h4><p><strong>Description</strong><br>å›¾ä¹¦ç®¡ç†æ˜¯ä¸€ä»¶ååˆ†ç¹æ‚çš„å·¥ä½œï¼Œåœ¨ä¸€ä¸ªå›¾ä¹¦é¦†ä¸­æ¯å¤©éƒ½ä¼šæœ‰è®¸å¤šæ–°ä¹¦åŠ å…¥ã€‚ä¸ºäº†æ›´æ–¹ä¾¿çš„ç®¡ç†å›¾ä¹¦ï¼ˆä»¥ä¾¿äºå¸®åŠ©æƒ³è¦å€Ÿä¹¦çš„å®¢äººå¿«é€ŸæŸ¥æ‰¾ä»–ä»¬æ˜¯å¦æœ‰ä»–ä»¬æ‰€éœ€è¦çš„ä¹¦ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªå›¾ä¹¦æŸ¥æ‰¾ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿéœ€è¦æ”¯æŒ 2 ç§æ“ä½œï¼š</p><ol><li>add(s) è¡¨ç¤ºæ–°åŠ å…¥ä¸€æœ¬ä¹¦åä¸º s çš„å›¾ä¹¦ã€‚</li><li>find(s) è¡¨ç¤ºæŸ¥è¯¢æ˜¯å¦å­˜åœ¨ä¸€æœ¬ä¹¦åä¸º s çš„å›¾ä¹¦ã€‚</li></ol><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è¯¥é¢˜æœ¬æ„æ˜¯ç”¨hashè§£å†³ï¼Œä½†æ˜¯æˆ‘å·æ‡’ç›´æ¥ç”¨mapäº†ã€‚ã€‚ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span> ,<span class="keyword">int</span>&gt; mp;</span><br><span class="line"><span class="built_in">string</span> str;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="built_in">string</span> s)</span></span>&#123;</span><br><span class="line"><span class="built_in">string</span> tmp = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">4</span>;s[i];i++) tmp += s[i];</span><br><span class="line">mp[tmp] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Find</span><span class="params">(<span class="built_in">string</span> s)</span></span>&#123;</span><br><span class="line"><span class="built_in">string</span> tmp = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">5</span>;s[i];i++) tmp += s[i];</span><br><span class="line"><span class="keyword">if</span>(mp.count(tmp)) <span class="built_in">cout</span> &lt;&lt; <span class="string">"yes"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="string">"no"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">getline(<span class="built_in">cin</span>,str);</span><br><span class="line"><span class="keyword">if</span>(str[<span class="number">0</span>] == <span class="string">'a'</span>) add(str);</span><br><span class="line"><span class="keyword">else</span> Find(str);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="C-Power-Strings"><a href="#C-Power-Strings" class="headerlink" title="C. Power Strings"></a>C. Power Strings</h4><p><strong>Description</strong><br>ç»™å®šè‹¥å¹²ä¸ªé•¿åº¦ â‰¤10^6çš„å­—ç¬¦ä¸²ï¼Œè¯¢é—®æ¯ä¸ªå­—ç¬¦ä¸²æœ€å¤šæ˜¯ç”±å¤šå°‘ä¸ªç›¸åŒçš„å­å­—ç¬¦ä¸²é‡å¤è¿æ¥è€Œæˆçš„ã€‚å¦‚ï¼šababab åˆ™æœ€å¤šæœ‰ 3 ä¸ª ab è¿æ¥è€Œæˆã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>æœ¬é¢˜æ˜¯å¾ªç¯èŠ‚é—®é¢˜ï¼Œæœ‰ä¸ªç»“è®ºï¼šè‹¥å­—ç¬¦ä¸² s æ˜¯ç”±æŸä¸ªé•¿åº¦ä¸º x çš„å­ä¸²å¾ªç¯æ„æˆï¼Œé‚£ä¹ˆå¿…å®šæœ‰s[1,n-x] = s[x, n]ã€‚è€Œæ ¹æ®nexæ•°ç»„çš„å®šä¹‰ï¼Œnex[n] å°±æ˜¯ s[x, n] çš„é•¿åº¦n-xã€‚<br>å› æ­¤å¦‚æœè¯¥é¢˜æœ‰è§£ï¼Œåˆ™n % (n-nex[n])ä¸º0ï¼Œç­”æ¡ˆå°±æ˜¯n/(n-nex[n)ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> nex[N]; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">char</span>* str)</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(nex,<span class="number">0</span>,<span class="keyword">sizeof</span> nex);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>,j = <span class="number">0</span>;str[i];i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; str[i] != str[j+<span class="number">1</span>]) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(str[i] == str[j+<span class="number">1</span>]) j++;</span><br><span class="line">nex[i] = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*è®¡ç®—ç­”æ¡ˆå¹¶è¾“å‡º*/</span></span><br><span class="line">getNex(str);</span><br><span class="line"><span class="keyword">int</span> n = <span class="built_in">strlen</span>(str)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">if</span>(n%(n-nex[n])) <span class="built_in">puts</span>(<span class="string">"1"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,n/(n-nex[n]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str+<span class="number">1</span>) &amp;&amp; str[<span class="number">1</span>] != <span class="string">'.'</span>)&#123;</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">'*'</span>;</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="D-Seek-the-Name-Seek-the-Fame"><a href="#D-Seek-the-Name-Seek-the-Fame" class="headerlink" title="D. Seek the Name, Seek the Fame"></a>D. Seek the Name, Seek the Fame</h4><p><strong>Description</strong><br>ç»™å®šè‹¥å¹²å­—ç¬¦ä¸²ï¼ˆè¿™äº›å­—ç¬¦ä¸²æ€»é•¿ â‰¤4Ã—10^5 ï¼‰ï¼Œåœ¨æ¯ä¸ªå­—ç¬¦ä¸²ä¸­æ±‚å‡ºæ‰€æœ‰æ—¢æ˜¯å‰ç¼€åˆæ˜¯åç¼€çš„å­ä¸²é•¿åº¦ã€‚ä¾‹å¦‚ï¼šababcababababcababï¼Œæ—¢æ˜¯å‰ç¼€åˆæ˜¯åç¼€çš„ï¼šabï¼Œababï¼Œababcababï¼Œababcababababcababã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>ä¾ç„¶æ˜¯åˆ©ç”¨KMPç®—æ³•ä¸­çš„nexæ•°ç»„æ±‚è§£ã€‚é¦–å…ˆè¯¥ä¸²æœ¬èº«æ˜¯æœ€é•¿çš„â€œæ—¢æ˜¯å‰ç¼€åˆæ˜¯åç¼€â€çš„å­ä¸²ï¼Œä¸‹ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å­ä¸²æ˜¯s[1,nex[n] ] ï¼Œä¸‹ä¸‹ä¸ªæ˜¯s[1, nex[ nex[n] ] ]ï¼Œâ€¦ ã€‚</p><p>é“ç†å¾ˆç®€å•ï¼Œå°±æ˜¯æƒ³èµ·æ¥æœ‰ç‚¹ç»•ï¼›å¦‚æœå­˜åœ¨ä¸€ä¸ªé•¿åº¦ä¸º x çš„å­ä¸² sonâ€œæ—¢æ˜¯å‰ç¼€åˆæ˜¯åç¼€â€ï¼Œé‚£ä¹ˆæœ‰s[1,x] = s[n-x,n] = sonï¼Œé‚£ä¹ˆå®ƒçš„é•¿åº¦ä¸è¿˜æ˜¯ä¸è¶…è¿‡ nex[n] å—ï¼Ÿæ‰€ä»¥ä¸Šè¿°æ–¹æ³•å¯ä»¥ä»å¤§åˆ°å°éå†æ‰€æœ‰å¯èƒ½çš„é•¿åº¦ï¼ˆä¸æ˜¯æ‰€æœ‰å­ä¸²ï¼ï¼‰ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> nex[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(nex,<span class="number">0</span>,<span class="keyword">sizeof</span> nex);</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>,j = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; s[i] != s[j+<span class="number">1</span>]) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(s[i] == s[j+<span class="number">1</span>]) j++;</span><br><span class="line">nex[i] = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">getNex(str); <span class="keyword">int</span> n = <span class="built_in">strlen</span>(str)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>; ans[++cnt] = n;</span><br><span class="line"><span class="keyword">while</span>(nex[n])&#123;</span><br><span class="line">ans[++cnt] = nex[n];</span><br><span class="line">n = nex[n];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = cnt;i &gt; <span class="number">1</span>;i--) <span class="built_in">printf</span>(<span class="string">"%d "</span>,ans[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str+<span class="number">1</span>))&#123;</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">'#'</span>;</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="E-friends"><a href="#E-friends" class="headerlink" title="E. friends"></a>E. friends</h4><p><strong>Description</strong><br>æœ‰ä¸‰ä¸ªå¥½æœ‹å‹å–œæ¬¢åœ¨ä¸€èµ·ç©æ¸¸æˆï¼ŒA å›å†™ä¸‹ä¸€ä¸ªå­—ç¬¦ä¸² Sï¼ŒB å›å°†å…¶å¤åˆ¶ä¸€éå¾—åˆ° Tï¼ŒC å›åœ¨ T çš„ä»»æ„ä½ç½®ï¼ˆåŒ…æ‹¬é¦–å°¾ï¼‰æ’å…¥ä¸€ä¸ªå­—ç¬¦å¾—åˆ° Uã€‚ç°åœ¨ä½ å¾—åˆ°äº† Uï¼Œè¯·ä½ æ‰¾å‡º Sã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>æœ¬é¢˜å¦‚æœç”¨nexæˆ–è€…hashæ±‚è§£ï¼Œç»†èŠ‚æœ‰ç‚¹å¤šï¼Œå½“ç„¶ç»†å¿ƒç‚¹åº”è¯¥æ˜¯èƒ½å†™å‡ºæ¥çš„ã€‚æˆ‘çš„è§£é¢˜æ€è·¯å¾ˆç®€å•ï¼ŒO(N)å¤æ‚åº¦ï¼Œä¸»è¦åŸºäºå¦‚ä¸‹åŸºæœ¬æ¨è®ºï¼š</p><ol><li>å¦‚æœnä¸ºå¶æ•°ï¼Œæ— è§£ã€‚</li><li>å¦‚æœå‰n/2+1ä¸ªå­—ç¬¦é€šè¿‡åˆ å»ä¸€ä¸ªï¼Œå¯ä»¥ç­‰åŒäºån/2ä¸ªå­—ç¬¦ï¼Œåˆ™åŒ¹é…æˆåŠŸã€‚</li><li>å¦‚æœån/2+1ä¸ªå­—ç¬¦é€šè¿‡åˆ å»ä¸€ä¸ªï¼Œå¯ä»¥ç­‰åŒäºå‰n/2ä¸ªå­—ç¬¦ï¼Œåˆ™åŒ¹é…æˆåŠŸã€‚</li><li>å¦‚æœ 2 å’Œ 3 éƒ½åŒ¹é…æˆåŠŸï¼Œä¸”ä¸¤ä¸ªå¾—åˆ°çš„åŸä¸²ä¸åŒï¼Œåˆ™è¯´æ˜è§£ä¸å”¯ä¸€ã€‚</li></ol><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N],tmp[N],s1[N],s2[N];</span><br><span class="line"><span class="keyword">int</span> n,nex[N],tot;</span><br><span class="line"><span class="keyword">char</span> ans1[N],ans2[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">char</span> *s1,<span class="keyword">char</span> *s2)</span></span>&#123;</span><br><span class="line">tot = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>,j = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(i &lt;= n/<span class="number">2</span> &amp;&amp; j &lt;= n/<span class="number">2</span>+<span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(s1[i] != s2[j])&#123;</span><br><span class="line"><span class="keyword">if</span>(flag) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">flag = <span class="literal">true</span>; j++;</span><br><span class="line"><span class="keyword">if</span>(s1[i] != s2[j]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">tmp[tot++] = s1[i];</span><br><span class="line">i++ , j++;</span><br><span class="line">&#125;</span><br><span class="line">tmp[tot] = <span class="string">'\0'</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(n%<span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"NOT POSSIBLE"</span>); <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n/<span class="number">2</span>;i++) s1[i] = str[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n/<span class="number">2</span>+<span class="number">1</span>;i++) s2[i] = str[i+n/<span class="number">2</span>];</span><br><span class="line"><span class="keyword">bool</span> flag1,flag2;</span><br><span class="line">flag1 = check(s1,s2);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n/<span class="number">2</span>;i++) ans1[i] = tmp[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n/<span class="number">2</span>+<span class="number">1</span>;i++) s1[i] = str[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n/<span class="number">2</span>;i++) s2[i] = str[i+n/<span class="number">2</span>+<span class="number">1</span>];</span><br><span class="line">flag2 = check(s2,s1);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n/<span class="number">2</span>;i++) ans2[i] = tmp[i];</span><br><span class="line"><span class="keyword">if</span>(flag1 &amp;&amp; flag2)&#123;</span><br><span class="line"><span class="keyword">bool</span> f = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n/<span class="number">2</span>;i++) </span><br><span class="line"><span class="keyword">if</span>(ans1[i] != ans2[i]) f = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span>(!f)&#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"NOT UNIQUE"</span>); <span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(flag1 || flag2)&#123;</span><br><span class="line"><span class="keyword">if</span>(flag1) <span class="built_in">puts</span>(ans1);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">puts</span>(ans2);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"NOT POSSIBLE"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%s"</span>,&amp;n,str+<span class="number">1</span>);</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">'#'</span>; solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="F-A-Horrible-Poem"><a href="#F-A-Horrible-Poem" class="headerlink" title="F. A Horrible Poem"></a>F. A Horrible Poem</h4><p><strong>Description</strong><br>ç»™å‡ºä¸€ä¸ªç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² Sï¼Œå†ç»™å‡º q ä¸ªè¯¢é—®ï¼Œè¦æ±‚å›ç­” S æŸä¸ªå­ä¸²çš„æœ€çŸ­å¾ªç¯èŠ‚ã€‚å¦‚æœå­—ç¬¦ä¸² B æ˜¯å­—ç¬¦ä¸² A çš„å¾ªç¯èŠ‚ï¼Œé‚£ä¹ˆ A å¯ä»¥ç”± B é‡å¤è‹¥å¹²æ¬¡å¾—åˆ°ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è¿™ä¸ªæ˜¯æœ€çŸ­å¾ªç¯èŠ‚é—®é¢˜ï¼Œå¦å¤–æœ¬é¢˜å¡å¸¸ååˆ†ä¸¥æ ¼ã€‚ä¸ºäº†å¿«é€Ÿæ±‚è§£ï¼Œæœ¬é¢˜è¿˜ç”¨åˆ°äº†çº¿æ€§ç­›ã€æ»šåŠ¨å“ˆå¸Œä¼˜åŒ–ç­‰ç­–ç•¥ã€‚</p><p>é¦–å…ˆæ˜¯åŸºç¡€çš„å­—ç¬¦ä¸²å¾ªç¯èŠ‚çŸ¥è¯†ã€‚å¦‚æœå­—ç¬¦ä¸² s æ˜¯ç”±æŸä¸ªå­ä¸²å¾ªç¯å¾—åˆ°ï¼Œ|s| = nï¼Œé‚£ä¹ˆ<br>å¾ªç¯èŠ‚çš„é•¿åº¦ä¸€å®šæ˜¯ len çš„çº¦æ•°ï¼ŒåŒ…æ‹¬æœ€çŸ­å¾ªç¯èŠ‚ã€‚å› æ­¤ä¸€ä¸ªç­–ç•¥å°±æ˜¯å¯¹äº n çš„æ‰€æœ‰çº¦æ•°ï¼ŒæŒ¨ä¸ªåˆ¤æ–­æ˜¯å¦ä¸ºæœ€çŸ­å¾ªç¯èŠ‚çš„é•¿åº¦ï¼Œè€Œåˆ¤æ–­åŸç†å¦‚ä¸‹ï¼š</p><ul><li>å¦‚æœå­—ç¬¦ä¸² s çš„æœ€çŸ­å¾ªç¯èŠ‚é•¿åº¦ä¸º x ï¼Œé‚£ä¹ˆå¿…ç„¶æœ‰ s[1, x] = s[n-x, n] ã€‚</li></ul><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ»šåŠ¨å“ˆå¸ŒæŠ€å·§æ¥åœ¨O(1)æ—¶é—´å®Œæˆåˆ¤æ–­ã€‚é‚£ä¹ˆç°åœ¨ä¸»è¦èŠ±è´¹çš„æ—¶é—´åœ¨äºæ‰¾å¯» n çš„çº¦æ•°ä¸Šï¼Œä¸€èˆ¬åšæ³•$O(\sqrt n)$ï¼Œäºæ˜¯è¿™ç§åšæ³•æ€»å¤æ‚åº¦ä¸º$O(q \sqrt n)$ã€‚</p><p>ä½†æ˜¯è¿™é¢˜å¡å¸¸å¾ˆä¸¥é‡ï¼Œè¿™æ ·è¿˜æ˜¯ä¼šè¶…æ—¶ã€‚äºæ˜¯å°±è¦åˆ©ç”¨è´¨å› æ•°åˆ†è§£å®šç†åœ¨$O(log_2^n)$æ—¶é—´å†…å®Œæˆçº¦æ•°åˆ†è§£ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸º$O(q log_2^n)$ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Q = <span class="number">2e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> n,q;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line">ull hsh[N],bse[N] , b = <span class="number">31</span>; <span class="comment">//é‡‡ç”¨æ— ç¬¦å·é•¿æ•´å½¢,é€šè¿‡è‡ªç„¶æº¢å‡ºçœå»å–æ¨¡ </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">/*åˆ¤æ–­xæ˜¯å¦ä¸ºå­ä¸²s[l,r]çš„æœ€çŸ­å¾ªç¯èŠ‚é•¿åº¦*/</span> </span><br><span class="line">ull h1 = hsh[r-x] - hsh[l<span class="number">-1</span>]*bse[r-x+<span class="number">1</span>-l];</span><br><span class="line">ull h2 = hsh[r] - hsh[l<span class="number">-1</span>+x]*bse[r-x+<span class="number">1</span>-l];</span><br><span class="line"><span class="keyword">return</span> h1 == h2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> v[N],primes[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getPri</span><span class="params">()</span></span>&#123;<span class="comment">//çº¿æ€§ç­› </span></span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!v[i])&#123;</span><br><span class="line">primes[cnt++] = i;</span><br><span class="line">v[i] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; cnt;j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(primes[j] &gt; v[i] || primes[j]*i &gt; N)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">v[i*primes[j]] = primes[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å›ç­”å­ä¸²s[l,r]çš„æœ€çŸ­å¾ªç¯èŠ‚é•¿åº¦*/</span> </span><br><span class="line"><span class="keyword">int</span> len = r-l+<span class="number">1</span>, ans = len, d = len;</span><br><span class="line"><span class="keyword">while</span>(d != <span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">int</span> tmp = v[d];</span><br><span class="line"><span class="keyword">while</span>(d%tmp == <span class="number">0</span> &amp;&amp; check(l,r,ans/tmp)) d /= tmp,ans /= tmp;</span><br><span class="line"><span class="keyword">while</span>(d%tmp == <span class="number">0</span>) d /= tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*é¢„å¤„ç†å‡ºhashæ•°ç»„,væ•°ç»„*/</span></span><br><span class="line">getPri(); bse[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">hsh[i] = hsh[i<span class="number">-1</span>]*b + str[i]-<span class="string">'a'</span>;</span><br><span class="line">bse[i] = bse[i<span class="number">-1</span>]*b;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>; <span class="keyword">char</span> c=getchar();</span><br><span class="line">    <span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>) &#123; <span class="keyword">if</span>(c==<span class="string">'-'</span>) f=<span class="number">-1</span>; c=getchar(); &#125;</span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>) &#123; x=x*<span class="number">10</span>+c-<span class="string">'0'</span>; c=getchar(); &#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">n = read();</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str+<span class="number">1</span>); str[<span class="number">0</span>] = <span class="string">'#'</span>;</span><br><span class="line">q = read();</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,l,r;i &lt;= q;i++)&#123;</span><br><span class="line">l = read(); r = read();</span><br><span class="line">ask(l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="G-Beads"><a href="#G-Beads" class="headerlink" title="G. Beads"></a>G. Beads</h4><p><strong>Description</strong><br>Zxlæœ‰ä¸€æ¬¡å†³å®šåˆ¶é€ ä¸€æ¡é¡¹é“¾ï¼Œå¥¹ä»¥éå¸¸ä¾¿å®œçš„ä»·æ ¼ä¹°äº†ä¸€é•¿æ¡é²œè‰³çš„çŠç‘šç å­ï¼Œå¥¹ç°åœ¨ä¹Ÿæœ‰ä¸€ä¸ªæœºå™¨ï¼Œèƒ½æŠŠè¿™æ¡ç å­åˆ‡æˆå¾ˆå¤šå—ï¼ˆå­ä¸²ï¼‰ï¼Œæ¯å—æœ‰kï¼ˆk&gt;0ï¼‰ä¸ªç å­ï¼Œå¦‚æœè¿™æ¡ç å­çš„é•¿åº¦ä¸æ˜¯kçš„å€æ•°ï¼Œæœ€åä¸€å—å°äºkçš„å°±ä¸è¦æ‹‰ï¼ˆncçœŸæµªè´¹ï¼‰ï¼Œä¿è¯ç å­çš„é•¿åº¦ä¸ºæ­£æ•´æ•°ã€‚ Zxlå–œæ¬¢å¤šæ ·çš„é¡¹é“¾ï¼Œä¸ºå¥¹åº”è¯¥æ€æ ·é€‰æ‹©æ•°å­—kæ¥å°½å¯èƒ½å¾—åˆ°æ›´å¤šçš„ä¸åŒçš„å­ä¸²æ„Ÿåˆ°å¥½å¥‡ï¼Œå­ä¸²éƒ½æ˜¯å¯ä»¥åè½¬çš„ï¼Œæ¢å¥è¯è¯´ï¼Œå­ä¸²ï¼ˆ1ï¼Œ2ï¼Œ3ï¼‰å’Œï¼ˆ3,2,1ï¼‰æ˜¯ä¸€æ ·çš„ã€‚å†™ä¸€ä¸ªç¨‹åºï¼Œä¸ºZxlå†³å®šæœ€é€‚åˆçš„kä»è€Œè·å¾—æœ€å¤šä¸åŒçš„å­ä¸²ã€‚ä¾‹å¦‚ï¼šè¿™ä¸€ä¸²ç å­æ˜¯ï¼š (1,1,1,2,2,2,3,3,3,1,2,3,3,1,2,2,1,3,3,2,1)ã€‚<br>k=1çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—åˆ°3ä¸ªä¸åŒçš„å­ä¸²ï¼š(1),(2),(3)<br>k=2çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—åˆ°6ä¸ªä¸åŒçš„å­ä¸²ï¼š (1,1),(1,2),(2,2),(3,3),(3,1),(2,3)<br>k=3çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—åˆ°5ä¸ªä¸åŒçš„å­ä¸²ï¼š  (1,1,1),(2,2,2),(3,3,3),(1,2,3),(3,1,2)<br>k=4çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—åˆ°5ä¸ªä¸åŒçš„å­ä¸²ï¼š (1,1,1,2),(2,2,3,3),(3,1,2,3),(3,1,2,2),(1,3,3,2)</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>åˆšå¼€å§‹æ—¶é—´å¤æ‚åº¦ç®—é”™äº†ï¼Œn + n/2 + n/3 + n/4 + â€¦ + 1æ˜¯è°ƒå’Œçº§æ•°ï¼Œæ—¶é—´å¤æ‚åº¦å¹¶ä¸é«˜ï¼Œå› æ­¤ä¸¤å±‚å¾ªç¯åŠ ä¸Š æ»šåŠ¨å“ˆå¸Œ O(1)çš„åˆ¤æ–­æ˜¯å¯ä»¥å¾ˆå¿«é€šè¿‡çš„ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"><span class="keyword">int</span> col[N] , n;</span><br><span class="line">ull hsh[N],hsh2[N],bse[N] , B = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="built_in">map</span>&lt;ull,<span class="keyword">int</span>&gt; vis;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line"><span class="keyword">int</span> tc , mx , k;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">bse[<span class="number">0</span>] = <span class="number">1</span>; <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) </span><br><span class="line">hsh[i] = hsh[i<span class="number">-1</span>]*B+col[i], bse[i] = bse[i<span class="number">-1</span>]*B;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = n;i &gt;= <span class="number">1</span>;i--) </span><br><span class="line">hsh2[i] = hsh2[i+<span class="number">1</span>]*B+col[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">vis.clear(); cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = i;j &lt;= n;j += i)&#123;</span><br><span class="line">ull h1 = hsh[j] - hsh[j-i]*bse[i];</span><br><span class="line">ull h2 = hsh2[j-i+<span class="number">1</span>] - hsh2[j+<span class="number">1</span>]*bse[i];</span><br><span class="line"><span class="keyword">if</span>(vis.count(h1*h2) == <span class="number">0</span>)&#123;</span><br><span class="line">vis[h1*h2] = <span class="number">1</span>; cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//printf("%llu %llu\n",h1,h2);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//printf("%d %d\n",cnt,mx);</span></span><br><span class="line"><span class="keyword">if</span>(cnt == mx) ans.push_back(i);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(cnt &gt; mx) &#123;</span><br><span class="line">ans.clear(); ans.push_back(i); mx = cnt;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,mx,ans.size());</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; ans.size();i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>,ans[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,col+i);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="H-Antisymmetry"><a href="#H-Antisymmetry" class="headerlink" title="H. Antisymmetry"></a>H. Antisymmetry</h4><p><strong>Description</strong><br>å¯¹äºä¸€ä¸ª01å­—ç¬¦ä¸²ï¼Œå¦‚æœå°†è¿™ä¸ªå­—ç¬¦ä¸²0å’Œ1å–ååï¼Œå†å°†æ•´ä¸ªä¸²åè¿‡æ¥å’ŒåŸä¸²ä¸€æ ·ï¼Œå°±ç§°ä½œâ€œåå¯¹ç§°â€å­—ç¬¦ä¸²ã€‚æ¯”å¦‚00001111å’Œ010101å°±æ˜¯åå¯¹ç§°çš„ï¼Œ1001å°±ä¸æ˜¯ã€‚<br>ç°åœ¨ç»™å‡ºä¸€ä¸ªé•¿åº¦ä¸ºNçš„01å­—ç¬¦ä¸²ï¼Œæ±‚å®ƒæœ‰å¤šå°‘ä¸ªå­ä¸²æ˜¯åå¯¹ç§°çš„ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>01ä¸²çš„é¢˜ç›®çœŸæ˜¯å˜åŒ–å¤šç«¯å•Šã€‚è¦æƒ³è§£å†³æœ¬é¢˜é¦–å…ˆè¦å¾—å‡ºå‡ ä¸ªæ¨è®ºï¼š</p><ol><li>â€œåå¯¹ç§°â€çš„ä¸²é•¿åº¦ä¸€å®šæ˜¯å¶æ•°ã€‚</li><li>å¦‚æœä¸€ä¸ªå­ä¸²æ˜¯â€œåå¯¹ç§°â€çš„ï¼Œé‚£ä¹ˆå®ƒä¸€å®šå…³äºä¸­è½´çº¿ï¼Œå·¦å³01å¯¹åº”ï¼ˆå¦‚0101ï¼‰ã€‚</li><li>å¦‚æœä¸€ä¸ªä¸²æ˜¯â€œåå¯¹ç§°â€çš„ï¼Œé‚£ä¹ˆå’Œå®ƒå…±ä¸­è½´çº¿çš„å­ä¸²ä¹Ÿæ˜¯â€œåå¯¹ç§°â€çš„ã€‚</li></ol><p>ç„¶åå°±å‘ç°å’Œå›æ–‡ä¸²çš„æ€§è´¨æœ‰äº›ç›¸ä¼¼ï¼Œä»…æœ‰ 2 ç‚¹ä¸åŒï¼Œå°±æ˜¯å›æ–‡ä¸²é•¿åº¦å¯ä»¥ä¸ºå¥‡ï¼Œä»¥åŠå›æ–‡ä¸²æ˜¯å…³äºä¸­è½´å¯¹ç§°è€Œä¸æ˜¯ç›¸åã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬ä¾ç„¶å¯ä»¥åˆ©ç”¨Manacherç®—æ³•ï¼Œåªä¸è¿‡å°†åˆ¤ç­‰ æ”¹ä¸ºåˆ¤â€œåâ€å³å¯ã€‚å½“ç„¶ä¹Ÿè¦ç”¨é€šé…ç¬¦â€œ#â€æ¥å¡«å……ï¼Œå› ä¸ºæ‰€æœ‰â€œåå¯¹ç§°â€ çš„ä¸²é•¿åº¦å¿…é¡»ä¸ºå¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨â€œ#â€ä¸Šè¿›è¡Œè®¡ç®—ï¼Œä»¥æ­¤æ¥ä¿è¯é•¿åº¦ä¸ºå¶æ•°ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N],s2[<span class="number">2</span>*N];</span><br><span class="line"><span class="keyword">int</span> n,len[<span class="number">2</span>*N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">char</span> a,<span class="keyword">char</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(a == <span class="string">'#'</span> &amp;&amp; b == <span class="string">'#'</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span>(a == <span class="string">'1'</span> &amp;&amp; b == <span class="string">'0'</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span>(a == <span class="string">'0'</span> &amp;&amp; b == <span class="string">'1'</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">s2[<span class="number">0</span>] = <span class="string">'$'</span>,s2[<span class="number">1</span>] = <span class="string">'#'</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">s2[i&lt;&lt;<span class="number">1</span>] = str[i<span class="number">-1</span>];</span><br><span class="line">s2[(i&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>] = <span class="string">'#'</span>;</span><br><span class="line">&#125;</span><br><span class="line">s2[n*<span class="number">2</span>+<span class="number">2</span>] = <span class="string">'\0'</span>;</span><br><span class="line"><span class="keyword">int</span> mx = <span class="number">0</span>, mid;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; <span class="number">2</span>*n+<span class="number">2</span>;i += <span class="number">2</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(i &lt; mx) len[i] = min(len[<span class="number">2</span>*mid-i],mx-i);</span><br><span class="line"><span class="keyword">else</span> len[i] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>( check(s2[i-len[i]], s2[i+len[i]]) ) len[i]++;</span><br><span class="line"><span class="keyword">if</span>(len[i]+i &gt; mx)&#123;</span><br><span class="line">mx = len[i] + i;</span><br><span class="line">mid = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; <span class="number">2</span>*n+<span class="number">2</span>;i++) ans += len[i]&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str); </span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="I-é—¨ç¥¨-tickets"><a href="#I-é—¨ç¥¨-tickets" class="headerlink" title="I. é—¨ç¥¨(tickets)"></a>I. é—¨ç¥¨(tickets)</h4><p><strong>Description</strong><br>å·²çŸ¥æ•°åˆ—$a_n, a_0 = 1$, $a_{i+1} = (a_i * A + a_i \:mod \:B ) \:mod \:C$ï¼Œè¯·é—®ç»™å®šAï¼ŒBå’ŒCï¼Œè¯¥æ•°åˆ—åœ¨ç¬¬å‡ é¡¹ç¬¬ä¸€æ¬¡å‡ºç°é‡å¤ï¼Ÿ</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>mapå¤ªæ…¢äº†å•Šï¼Œæˆ‘æµ‹è¯•äº†è¯»å…¥è¾“å‡ºï¼Œæµ‹è¯•äº†ä¹˜æ³•å’Œå–æ¨¡ï¼Œå°±æ˜¯æ²¡æœ‰æ€€ç–‘mapï¼Œæµªè´¹å¾ˆå¤šæ—¶é—´ã€‚<br>æ‰‹å†™hashå‡½æ•°ï¼Œåˆ©ç”¨é‚»æ¥è¡¨æ¥æ¶ˆé™¤å†²çªï¼Œå¦‚æ­¤ä¸€æ¥å¿«äº†å¾ˆå¤šã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">2181271</span>; </span><br><span class="line"><span class="keyword">int</span> nex[N],num[N],head[N],tot = <span class="number">1</span>;<span class="comment">// ç”¨é‚»æ¥è¡¨æ–¹å¼å®ç°å“ˆå¸Œè¡¨ </span></span><br><span class="line"><span class="keyword">int</span> top , stk[N];<span class="comment">//æ•°ç»„æ¨¡æ‹Ÿå †æ ˆ,ç”¨äºå“ˆå¸Œè¡¨çš„åˆå§‹åŒ– </span></span><br><span class="line">ll a,b,c;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">tot = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">while</span>(top) head[stk[top--]] = <span class="number">0</span>;<span class="comment">//åªæ¸…ç©ºç”¨äº†çš„è¡¨,èŠ‚çœæ—¶é—´ </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å°†xæ’å…¥å“ˆå¸Œè¡¨*/</span></span><br><span class="line"><span class="keyword">int</span> h = x % P;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[h] ;i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">if</span>(num[i] == x) <span class="keyword">return</span>; <span class="comment">//ç›¸åŒçš„å€¼å·²ç»å­˜æ”¾è¿‡äº† </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span>(!head[h]) stk[++top] = h; <span class="comment">//ç¬¬ä¸€æ¬¡å‡ºç°çš„å“ˆå¸Œå€¼å…¥æ ˆ</span></span><br><span class="line"><span class="comment">/* é‚»æ¥è¡¨æ·»åŠ å…ƒç´ åŸºæœ¬å¥—è·¯ */</span></span><br><span class="line">nex[++tot] = head[h]; head[h] = tot; num[tot] = x; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ask</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line"><span class="comment">/* è¿”å› x æ˜¯å¦å­˜åœ¨*/</span></span><br><span class="line"><span class="keyword">int</span> h = x%P;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[h];i;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">if</span>(num[i] == x) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">ll x = <span class="number">1</span>; Insert(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; <span class="number">2e6</span>;i++)&#123;</span><br><span class="line">x = (x*a + x%b)%c;</span><br><span class="line"><span class="keyword">if</span>(ask(x)) <span class="keyword">return</span> i;</span><br><span class="line">Insert(x); </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*å¤šç»„æ ·ä¾‹è¦è°ƒç”¨init()*/</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve());</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="J-æ”¶é›†é›ªèŠ±-snowflakes"><a href="#J-æ”¶é›†é›ªèŠ±-snowflakes" class="headerlink" title="J. æ”¶é›†é›ªèŠ±(snowflakes)"></a>J. æ”¶é›†é›ªèŠ±(snowflakes)</h4><p><strong>Description</strong><br>ä¸åŒçš„é›ªèŠ±å¾€å¾€æœ‰ä¸åŒçš„å½¢çŠ¶ã€‚åœ¨åŒ—æ–¹çš„åŒå­¦æƒ³å°†é›ªèŠ±æ”¶é›†èµ·æ¥ï¼Œä½œä¸ºç¤¼ç‰©é€ç»™åœ¨å—æ–¹çš„åŒå­¦ä»¬ã€‚ä¸€å…±æœ‰ n ä¸ªæ—¶åˆ»ï¼Œç»™å‡ºæ¯ä¸ªæ—¶åˆ»ä¸‹è½é›ªèŠ±çš„å½¢çŠ¶ï¼Œç”¨ä¸åŒçš„æ•´æ•°è¡¨ç¤ºä¸åŒçš„å½¢çŠ¶ã€‚åœ¨æ”¶é›†çš„è¿‡ç¨‹ä¸­ï¼ŒåŒå­¦ä»¬ä¸å¸Œæœ›æœ‰é‡å¤çš„é›ªèŠ±ã€‚ä½ å¯ä»¥ä»ä»»æ„  a æ—¶åˆ»å¼€å§‹ï¼Œåœ¨ b æ—¶åˆ»åœæ­¢ã€‚a åˆ° b æ—¶åˆ»ä¸­é—´çš„é›ªèŠ±ä¹Ÿéƒ½å°†è¢«æ”¶é›†ã€‚ä»–ä»¬å¸Œæœ›æ”¶é›†çš„é›ªèŠ±æœ€å¤šã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è¿™ä¸ªç”¨hashæœ‰ç‚¹éš¾å†™ï¼Œéš¾åœ¨é‡ç½®å“ˆå¸Œè¡¨ã€‚æˆ‘ç”¨çš„æ˜¯ç¦»æ•£åŒ–+åŒæŒ‡é’ˆï¼Œåªéœ€è¦ç»´æŠ¤å·¦è¾¹ç•Œå³å¯ã€‚å¦‚æœå½“å‰é›ªèŠ±ç¬¬äºŒæ¬¡å‡ºç°ï¼Œé‚£ä¹ˆçŸ¥é“å®ƒä¸Šä¸€æ¬¡å‡ºç°ä½ç½®æ˜¯v[p] ï¼Œæ‰€ä»¥å…ˆç”¨å½“å‰åŒºé—´é•¿åº¦æ›´æ–°ç­”æ¡ˆï¼Œå†å°†å·¦è¾¹ç•Œæ›´æ–°ä¸º v[p] + 1ã€‚<br>æ­£ç¡®æ€§è¯æ˜å°±ä¸å†™äº†ï¼Œå¾ˆæ˜¾ç„¶ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> a[N], b[N], n, v[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("123.txt","r",stdin);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i),b[i] = a[i];</span><br><span class="line">sort(a+<span class="number">1</span>,a+<span class="number">1</span>+n);</span><br><span class="line"><span class="keyword">int</span> tot = unique(a+<span class="number">1</span>,a+<span class="number">1</span>+n)-a<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>,l = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> p = lower_bound(a+<span class="number">1</span>,a+tot+<span class="number">1</span>,b[i])-a;</span><br><span class="line"><span class="keyword">if</span>(v[p] &gt;= l)&#123;</span><br><span class="line">ans = max(ans,i-l);</span><br><span class="line">l = v[p]+<span class="number">1</span>; </span><br><span class="line">&#125;</span><br><span class="line">v[p] = i;</span><br><span class="line"><span class="keyword">if</span>(i == n) ans = max(ans,i-l+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‹“å±•KMP </tag>
            
            <tag> å“ˆå¸Œ </tag>
            
            <tag> KMP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>KMPç®—æ³•</title>
      <link href="/2019/09/26/kmp/"/>
      <url>/2019/09/26/kmp/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>KMPç®—æ³•ï¼Œåˆç§°æ¨¡å¼åŒ¹é…ç®—æ³•ï¼Œèƒ½å¤Ÿåœ¨çº¿æ€§æ—¶é—´å†…åˆ¤å®šå­—ç¬¦ä¸² T æ˜¯å¦ä¸º S çš„å­ä¸²ï¼Œå¹¶æ±‚å‡ºå­—ç¬¦ä¸² T åœ¨ S ä¸­å„æ¬¡å‡ºç°çš„ä½ç½®ã€‚<br>KMPç®—æ³•æ¯”è¾ƒæ™¦æ¶©éš¾æ‡‚ã€‚æœ¬æ–‡å¯¹äºæ€æƒ³ä»‹ç»ç•¥ç®€ï¼Œä¾§é‡äºå®ç°ã€‚</p><h4 id="é—®é¢˜æ¨¡å‹ä¸ç®—æ³•æ€è·¯"><a href="#é—®é¢˜æ¨¡å‹ä¸ç®—æ³•æ€è·¯" class="headerlink" title="é—®é¢˜æ¨¡å‹ä¸ç®—æ³•æ€è·¯"></a>é—®é¢˜æ¨¡å‹ä¸ç®—æ³•æ€è·¯</h4><p><strong>é—®é¢˜æ¨¡å‹ï¼š</strong> ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² S å’Œ T ï¼Œè¯•æ±‚å‡º T åœ¨ S ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚</p><p>ä¸Šè¿°é—®é¢˜æ¨¡å‹æ˜¯æ¨¡å¼ä¸²åŒ¹é…æœ€åŸºç¡€çš„æ¨¡å‹ï¼Œå³å•æ¨¡å¼ä¸²åŒ¹é…é—®é¢˜ï¼Œè¿™ç±»é—®é¢˜æ˜¯KMPç®—æ³•ä»¥åŠå­—ç¬¦ä¸²Hashå¤§å±•èº«æ‰‹çš„é¢˜å‹ã€‚</p><p><strong>ç®—æ³•æ€è·¯1ï¼šHash</strong><br>è®¾|S| = n , |T| = mã€‚å¦‚æœä¸è€ƒè™‘å†²çªï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°† S çš„æ‰€æœ‰é•¿åº¦ä¸º m çš„å­ä¸²hashå€¼éƒ½æ±‚å‡ºæ¥ï¼Œå¤æ‚åº¦ä¸ºO(N)ã€‚å°†è¿™ n-m+1 ä¸ªå­ä¸²ä¸Tçš„hashå€¼åœ¨O(1)çš„æ—¶é—´å†…ä¸€ä¸€æ¯”å¯¹ï¼Œå³å¯é€šè¿‡hashå€¼æ˜¯å¦ç›¸åŒæ¥åˆ¤æ–­æ˜¯å¦åŒ¹é…æˆåŠŸã€‚<br>ä½†å®é™…ä¸Šå¦‚æœnå’Œmå¾ˆå¤§(1e6)ï¼Œé‚£ä¹ˆæ•£åˆ—å€¼å†²çªæ˜¯ä¸å¯é¿å…çš„ï¼Œæ­¤æ—¶éœ€è¦äºŒæ¬¡åˆ¤æ–­æˆ–è€…é€šè¿‡å…¶ä»–æ–¹æ³•ï¼ˆæ„é€ æ›´å¥½çš„æ•£åˆ—å‡½æ•°ï¼‰æ¥åœ¨ä¿è¯é€Ÿåº¦çš„æƒ…å†µä¸‹æå‡æ­£ç¡®æ€§ã€‚</p><p><strong>ç®—æ³•æ€è·¯2ï¼šKMP</strong><br>è®¾|S| = n , |T| = mã€‚é¦–å…ˆè€ƒè™‘ä¸€ä¸ªæœ´ç´ ç®—æ³•ï¼Œé‚£å°±æ˜¯å°†å­—ç¬¦ä¸² S ä¸­çš„æ¯ä¸€ä¸ªé•¿åº¦ä¸ºmçš„å­ä¸²éƒ½ä¸ T è¿›è¡Œä¸€æ¬¡åŒ¹é…ï¼Œå¤±é…åå†åŒ¹é…ä¸‹ä¸€ä¸ªï¼Œå¤æ‚åº¦O(NM)ã€‚<br>æ‰‹åŠ¨æ¨¡æ‹Ÿä¸€ä¸‹å¯ä»¥å‘ç°ï¼Œä¸Šè¿°åšæ³•ä¸­æŒ‡å‘å­—ç¬¦ä¸² S çš„æŒ‡é’ˆå’Œ T çš„æŒ‡é’ˆéƒ½æœ‰å›é€€$^{[1]}$ï¼Œä½†å®é™…ä¸Šæˆ‘ä»¬å¹¶ä¸éœ€è¦å‘ç”Ÿå›é€€ï¼ŒKMPç®—æ³•å°±æ˜¯é€šè¿‡é˜²æ­¢æŒ‡é’ˆå›é€€æ¥æå‡æœ´ç´ ç®—æ³•æ•ˆç‡çš„ã€‚</p><p>å‡è®¾æˆ‘ä»¬ S[i] å’Œ T[j+1] å‘ç”Ÿäº†å¤±é…ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“ â€œT ä¸­ä»¥ j ä¸ºæœ«å°¾çš„çœŸå­ä¸²â€ å’Œ T[1, j] çš„æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦ï¼ˆå‡è®¾ä¸ºlenï¼Œlenä¸€å®šå°äº j ï¼‰ï¼Œé‚£ä¹ˆæ˜¾ç„¶ T[1, len] = S[i-len+1, i]ï¼›äºæ˜¯æ­¤æ—¶çš„ j = lenï¼Œæ¥ç€åŒ¹é…å³å¯ã€‚æˆ‘ä»¬ç”¨nexæ•°ç»„ï¼ˆè§ä¸‹æ–‡ï¼‰æ¥å­˜æ”¾ T å¯¹åº”ä½ç½®çš„â€œlenâ€ã€‚</p><p>è¯¦ç»†çš„è®²ï¼Œ<strong>KMPç®—æ³•åˆ†ä¸ºä¸¤æ­¥ï¼š</strong></p><ol><li>å¯¹å­—ç¬¦ä¸² T è¿›è¡Œè‡ªæˆ‘â€œåŒ¹é…â€ï¼Œæ±‚å‡ºä¸€ä¸ªæ•°ç»„ nexï¼Œå…¶ä¸­ nex[i] è¡¨ç¤ºâ€œ T ä¸­ä»¥ i ç»“å°¾çš„éå‰ç¼€å­ä¸²â€ä¸â€œ T çš„å‰ç¼€â€èƒ½å¤ŸåŒ¹é…çš„æœ€å¤§é•¿åº¦ï¼Œå³ï¼š<br>&emsp;&emsp;nex[i] = max{j}ï¼Œå…¶ä¸­j &lt; i å¹¶ä¸” T[i-j+1, i] = T[1 ,j]ã€‚</li><li>å¯¹å­—ç¬¦ä¸² T ä¸ S è¿›è¡ŒåŒ¹é…ï¼Œæ±‚å‡ºä¸€ä¸ªæ•°ç»„ f ï¼Œå…¶ä¸­ f[i] è¡¨ç¤ºâ€œS ä¸­ä»¥ i ç»“å°¾çš„å­ä¸²â€ä¸â€œ T çš„å‰ç¼€â€èƒ½å¤ŸåŒ¹é…çš„æœ€é•¿é•¿åº¦ã€‚å³ï¼š<br>&emsp;&emsp;f[i] = max{j}ï¼Œå…¶ä¸­j &lt;= iå¹¶ä¸” S[i-j+1, i] = T[1, j]</li></ol><p><em>[1] æŒ‡é’ˆå›é€€ï¼šåœ¨æœ´ç´ åšæ³•ä¸­ï¼Œå¦‚æœå‘ç”Ÿå¤±é…ï¼Œåˆ™è¦å°†æŒ‡å‘ S ä¸²çš„æŒ‡é’ˆå›é€€åˆ°å½“å‰å­ä¸²èµ·å§‹ä½ç½®ï¼Œå¹¶å³ç§»è‡³ä¸‹ä¸€ä¸ªå­ä¸²èµ·å§‹ä½ç½®ï¼ŒåŒç†æŒ‡å‘ T çš„æŒ‡é’ˆä¹Ÿè¦å›åˆ°èµ·å§‹ä½ç½®ã€‚</em></p><h4 id="Nextæ•°ç»„"><a href="#Nextæ•°ç»„" class="headerlink" title="Nextæ•°ç»„"></a>Nextæ•°ç»„</h4><p>é¦–å…ˆè¦æ˜ç™½ä»€ä¹ˆæ˜¯Nextæ•°ç»„ï¼ˆä»¥ä¸‹ç®€ç§°nexæ•°ç»„ï¼‰ã€‚<br>nex[i]è¡¨ç¤ºâ€œT ä¸­ä»¥ i ç»“å°¾çš„éå‰ç¼€å­ä¸²â€ä¸â€œT çš„å‰ç¼€â€èƒ½å¤ŸåŒ¹é…çš„æœ€é•¿é•¿åº¦ï¼Œå³ï¼šnex[i] = max{j}ï¼Œå…¶ä¸­j &lt; i å¹¶ä¸” T[i-j+1, i] = T[i, j]ã€‚</p><blockquote><p>è·³è¿‡ï¼šnexæ•°ç»„èµ·åˆ°ä»€ä¹ˆè¾…åŠ©ä½œç”¨ï¼Œä¸ºä»€ä¹ˆè¦ç”¨nexæ•°ç»„ï¼Ÿ</p></blockquote><p><strong>nex æ•°ç»„çš„æ±‚æ³•</strong></p><ol><li>åˆå§‹åŒ– nex[1] = j = 0ï¼Œå‡è®¾nex[1, i-1] å·²æ±‚å‡ºï¼Œä¸‹é¢æ±‚nex[i]ã€‚</li><li>ä¸æ–­å°è¯•æ‹“å±•åŒ¹é…é•¿åº¦ jï¼Œå¦‚æœæ‹“å±•å¤±è´¥ï¼ˆä¸‹ä¸€ä¸ªå­—ç¬¦ä¸ç›¸ç­‰ï¼‰ï¼Œä»¤ j å˜ä¸ºnex[j]ï¼Œç›´è‡³ j ä¸º0ï¼ˆåº”è¯¥ä»å¤´å¼€å§‹åŒ¹é…ï¼‰ã€‚</li><li>å¦‚æœèƒ½å¤Ÿæ‹“å±•æˆåŠŸï¼ŒåŒ¹é…é•¿åº¦ j å°±å¢åŠ 1ã€‚nex[i] çš„å€¼å°±æ˜¯ j ã€‚</li></ol><p><strong>ä»£ç å—</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="comment">/*æ›´æ–°æ¨¡å¼ä¸²sçš„nexæ•°ç»„*/</span></span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line"><span class="built_in">memset</span>(nex,<span class="number">0</span>,<span class="keyword">sizeof</span> nex);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>,j = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; s[i] != s[j+<span class="number">1</span>]) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(s[i] == s[j+<span class="number">1</span>]) j++;</span><br><span class="line">nex[i] = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="f-æ•°ç»„"><a href="#f-æ•°ç»„" class="headerlink" title="f æ•°ç»„"></a>f æ•°ç»„</h4><p>æŒ‰ç…§å‰é¢çš„å®šä¹‰ï¼Œ f[i] è¡¨ç¤ºâ€œS ä¸­ä»¥ i ç»“å°¾çš„å­ä¸²â€ä¸â€œ T çš„å‰ç¼€â€èƒ½å¤ŸåŒ¹é…çš„æœ€é•¿é•¿åº¦ã€‚å¯ä»¥å‘ç° f æ•°ç»„å’Œ nex æ•°ç»„å®šä¹‰æ˜¯ä¸€è‡´çš„ï¼Œå› æ­¤ä»–ä»¬çš„æ±‚è§£è¿‡ç¨‹ä¹ŸåŸºæœ¬ä¸€è‡´ã€‚</p><p><strong>ä»£ç å—</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getF</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">const</span> <span class="keyword">char</span> *T)</span></span>&#123;</span><br><span class="line"><span class="comment">/*æ±‚è§£ f æ•°ç»„,Sæ˜¯ç›®æ ‡ä¸²,Tæ˜¯æ¨¡å¼ä¸²*/</span> </span><br><span class="line"><span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line"><span class="keyword">int</span> len1 = <span class="built_in">strlen</span>(S),len2 = <span class="built_in">strlen</span>(T);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,j = <span class="number">0</span>;i &lt; len1;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; (j == len2 || S[i] != T[j+<span class="number">1</span>])) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(S[i] == T[j+<span class="number">1</span>]) j++;</span><br><span class="line">f[i] = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¾‹é¢˜è®²è§£"><a href="#ä¾‹é¢˜è®²è§£" class="headerlink" title="ä¾‹é¢˜è®²è§£"></a>ä¾‹é¢˜è®²è§£</h4><p><a href="https://www.luogu.org/problem/P3375" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>ä»£ç æ¨¡æ¿</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">KMPç®—æ³•æ¨¡æ¿-ValenShi</span></span><br><span class="line"><span class="comment">æœ€åä¿®æ”¹ï¼š2019/9/26</span></span><br><span class="line"><span class="comment">ä½¿ç”¨è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">1.å­—ç¬¦ä¸²èµ·å§‹ä½ç½®æ˜¯1è€Œä¸æ˜¯0,ä¿®æ”¹å¯èƒ½ä¼šå‡ºé”™.</span></span><br><span class="line"><span class="comment">2.è®°å¾—åˆå§‹åŒ–nexä¸fæ•°ç»„</span></span><br><span class="line"><span class="comment">3.åŸä¸²é•¿åº¦ä¸æ¨¡å¼ä¸²é•¿åº¦éƒ½åœ¨å‡½æ•°ä¸­ç”¨strlenæ›´æ–°,æ— éœ€ä¿®æ”¹å…¨å±€å˜é‡ </span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> s1[N],s2[N];</span><br><span class="line"><span class="keyword">int</span> nex[N],f[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line"><span class="comment">/*æ›´æ–°æ¨¡å¼ä¸²sçš„nexæ•°ç»„*/</span></span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line"><span class="built_in">memset</span>(nex,<span class="number">0</span>,<span class="keyword">sizeof</span> nex);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>,j = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; s[i] != s[j+<span class="number">1</span>]) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(s[i] == s[j+<span class="number">1</span>]) j++;</span><br><span class="line">nex[i] = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getF</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* S,<span class="keyword">const</span> <span class="keyword">char</span> *T)</span></span>&#123;</span><br><span class="line"><span class="comment">/*æ±‚è§£ f æ•°ç»„,Sæ˜¯ç›®æ ‡ä¸²,Tæ˜¯æ¨¡å¼ä¸²*/</span> </span><br><span class="line"><span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line"><span class="keyword">int</span> len1 = <span class="built_in">strlen</span>(S),len2 = <span class="built_in">strlen</span>(T);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,j = <span class="number">0</span>;i &lt; len1;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; (j == len2 || S[i] != T[j+<span class="number">1</span>])) j = nex[j];</span><br><span class="line"><span class="keyword">if</span>(S[i] == T[j+<span class="number">1</span>]) j++;</span><br><span class="line">f[i] = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*æ±‚è§£nexæ•°ç»„ä¸fæ•°ç»„,å¹¶ æŒ‰è¦æ±‚ è¾“å‡ºç­”æ¡ˆ*/</span></span><br><span class="line">getNex(s2);</span><br><span class="line">getF(s1,s2);</span><br><span class="line"><span class="keyword">int</span> len1 = <span class="built_in">strlen</span>(s1)<span class="number">-1</span>,len2 = <span class="built_in">strlen</span>(s2)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= len1;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(f[i] == len2) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i-len2+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= len2;i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>,nex[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s%s"</span>,s1+<span class="number">1</span>,s2+<span class="number">1</span>);</span><br><span class="line">s1[<span class="number">0</span>] = s2[<span class="number">0</span>] = <span class="string">'#'</span>;<span class="comment">//ä¸ç„¶strlenå‡½æ•°æ— æ³•ä½¿ç”¨ </span></span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>è‘£æ°¸å»ºï¼Œä¿¡æ¯å­¦ç«èµ›ä¸€æœ¬é€šæé«˜ç‰ˆï¼Œç¦å·ï¼šç¦å»ºæ•™è‚²å‡ºç‰ˆç¤¾ï¼Œ2018.6ï¼Œ74-81</li><li>æç…œä¸œï¼Œç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ï¼Œéƒ‘å·ï¼šæ²³å—ç”µå­éŸ³åƒå‡ºç‰ˆç¤¾ï¼Œ2017.10ï¼Œ65-67</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fish eating fruits</title>
      <link href="/2019/09/22/fish-eating-fruit/"/>
      <url>/2019/09/22/fish-eating-fruit/</url>
      
        <content type="html"><![CDATA[<p><a href>æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>æ ‘ä¸Šä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„è·¯å¾„æŒ‰ç…§æ¨¡ 3 ä¸º 012 åˆ†ç±»ï¼Œå°†ä¸¤ç‚¹é—´è·ç¦»åŠ å’Œï¼Œä¹˜ 2 å³ä¸ºç­”æ¡ˆã€‚ </p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>å¯ä»¥é‡‡ç”¨æ ‘ä¸Šdpè§£å†³ï¼Œä¹Ÿå¯ä»¥ç‚¹åˆ†æ²»ï¼Œè¿™é‡Œå…ˆç»™å‡ºä¸€ç§æ ‘ä¸Šdpåšæ³•ï¼š<br><code>dp[i][k]</code> è¡¨ç¤ºè· i æ¨¡ 3 ä¸º k çš„èŠ‚ç‚¹è·ç¦»å’Œã€‚<br><code>tc[i][k]</code> è¡¨ç¤ºè· i æ¨¡ 3 ä¸º k çš„èŠ‚ç‚¹æ•°ç›®ã€‚<br><code>ans[k]</code>  è¡¨ç¤ºæ‰€æœ‰è·¯å¾„ä¸­æ¨¡ 3 ä¸º k çš„è·¯å¾„çš„æ€»é•¿åº¦ã€‚<br>ç›®æ ‡ç­”æ¡ˆæ˜¯<code>ans[k]</code> ã€‚<br>åˆå§‹çŠ¶æ€ <code>tc[i][0] = 1</code> ã€‚</p><p>å¦‚æœæ¯æ¬¡åªè€ƒè™‘æ‰€æœ‰ç»è¿‡æ ¹ x çš„è·¯å¾„ï¼Œå¹¶ä¸”è·¯å¾„ä¸Šçš„ä¸€ä¸ªç«¯ç‚¹åœ¨xçš„ä¸€ä¸ªå­æ ‘ä¸Šï¼Œå¦ä¸€ä¸ªç«¯ç‚¹åœ¨å¦ä¸€ä¸ªå­æ ‘ä¸Šï¼ˆå…¶ä»–æ‰€æœ‰æƒ…å†µéƒ½å¯ä»¥åœ¨xçš„ç¥–å…ˆæˆ–è€…å­èŠ‚ç‚¹è¢«è€ƒè™‘åˆ°ï¼Œæ‰€ä»¥è¿™æ ·å¯ä»¥åŒ…å«æ‰€æœ‰æƒ…å†µï¼‰ã€‚<br>å‡è®¾å½“å‰æšä¸¾åˆ°xçš„å­èŠ‚ç‚¹yï¼Œä¹‹å‰éå†çš„å­èŠ‚ç‚¹å·²ç»ä½¿å¾—dpå’Œtcæ•°ç»„æ›´æ–°å®Œæˆï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦è®¡ç®—çš„è·¯å¾„èµ·ç‚¹åœ¨yï¼Œç»ˆç‚¹åœ¨ä¹‹å‰éå†è¿‡çš„æ‰€æœ‰å­èŠ‚ç‚¹ä¸­ã€‚<br><strong>åˆ†ç±»è®¨è®ºç­”æ¡ˆè´¡çŒ®ï¼š</strong></p><ol><li>è¾¹ x-y å¯¹ç­”æ¡ˆçš„è´¡çŒ®ï¼šè®¾ jï¼Œkå±äº{0,1,2}ï¼Œx åˆ° y çš„è¾¹æƒä¸º z ï¼Œé‚£ä¹ˆzå¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸º<code>tc[x][j] * tc[y][k] * z</code>ã€‚</li><li>ç»ˆç‚¹æ˜¯ y çš„æ‰€æœ‰è·¯å¾„é•¿åº¦çš„è´¡çŒ®ï¼š<code>dp[y][k] * tc[x][j] * z</code>ã€‚</li><li>èµ·ç‚¹æ˜¯ x çš„æ‰€æœ‰è·¯å¾„é•¿åº¦çš„è´¡çŒ®ï¼š<code>dp[x][j] * tc[y][k] * z</code>ã€‚</li></ol><p><strong>äºæ˜¯çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</strong><br><code>dp[x][(j+z)%3] += dp[y][j] + z * tc[y][j]</code><br><code>tc[x][(j+z)%3] += tc[y][j]</code></p><p>å½“ç„¶ï¼Œåœ¨çŠ¶æ€è½¬ç§»å‰ä¹Ÿè¦æ›´æ–°ansæ•°ç»„ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[N],ver[N],edge[N],nex[N];</span><br><span class="line"><span class="keyword">int</span> tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">ver[++tot] = y; edge[tot] = z;</span><br><span class="line">nex[tot] = head[x]; head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">ll tc[N][<span class="number">4</span>], dp[N][<span class="number">4</span>], ans[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line"><span class="comment">/* åˆ©ç”¨dfsè¿›è¡ŒçŠ¶æ€è½¬ç§»,xä¸ºå½“å‰å­æ ‘æ ¹èŠ‚ç‚¹ */</span> </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i != <span class="number">-1</span>;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(y == fa) <span class="keyword">continue</span>;<span class="comment">//yæ˜¯çˆ¶èŠ‚ç‚¹åˆ™è·³è¿‡ </span></span><br><span class="line">dfs(y,x);</span><br><span class="line"><span class="comment">/* è¿™é‡Œç»Ÿè®¡ç­”æ¡ˆ */</span> </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">3</span>;j++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt; <span class="number">3</span>;k++)&#123;</span><br><span class="line">ans[(j+k+z)%<span class="number">3</span>] += (dp[x][j]*tc[y][k]%P+dp[y][k]*tc[x][j]%P)%P;</span><br><span class="line">ans[(j+k+z)%<span class="number">3</span>] += z*tc[x][j]%P*tc[y][k]%P;</span><br><span class="line">ans[(j+k+z)%<span class="number">3</span>] %= P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* åœ¨è¿™é‡Œè½¬ç§»çŠ¶æ€ */</span> </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">3</span>;j++)&#123;</span><br><span class="line">dp[x][(j+z)%<span class="number">3</span>] = (dp[x][(j+z)%<span class="number">3</span>] + dp[y][j] + z*tc[y][j])%P;</span><br><span class="line">tc[x][(j+z)%<span class="number">3</span>] = (tc[x][(j+z)%<span class="number">3</span>] + tc[y][j])%P;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(dp,<span class="number">0</span>,<span class="keyword">sizeof</span> dp);</span><br><span class="line"><span class="built_in">memset</span>(tc,<span class="number">0</span>,<span class="keyword">sizeof</span> tc);</span><br><span class="line"><span class="built_in">memset</span>(ans,<span class="number">0</span>,<span class="keyword">sizeof</span> ans);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) tc[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="comment">/* ç»Ÿè®¡ç­”æ¡ˆå¹¶è¾“å‡º */</span> </span><br><span class="line">dfs(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">2</span>;i++) <span class="built_in">printf</span>(<span class="string">"%lld "</span>,ans[i]*<span class="number">2</span>%P);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans[<span class="number">2</span>]*<span class="number">2</span>%P);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n))&#123;</span><br><span class="line"><span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span> head); tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt; n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">addEdge(x+<span class="number">1</span>,y+<span class="number">1</span>,z); addEdge(y+<span class="number">1</span>,x+<span class="number">1</span>,z);</span><br><span class="line">&#125;</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘ä¸ŠDP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CodeForces Round 586(Div1+Div2)</title>
      <link href="/2019/09/21/cf-586/"/>
      <url>/2019/09/21/cf-586/</url>
      
        <content type="html"><![CDATA[<h4 id="A-Cards"><a href="#A-Cards" class="headerlink" title="A. Cards"></a>A. Cards</h4><p><a href="https://codeforces.com/contest/1220/problem/A" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º n çš„å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²å¯ä»¥ç»„åˆå‡ºæ¥å‡ ä¸ªoneå’Œå‡ ä¸ªzeroï¼Œæ¯ä¸ªå­—ç¬¦åªèƒ½ç”¨ä¸€æ¬¡ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> nn;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n,z,e,r,o;</span><br><span class="line">n = z = e = r = o = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= nn;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(str[i] == <span class="string">'o'</span>) o++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(str[i] == <span class="string">'z'</span>) z++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(str[i] == <span class="string">'r'</span>) r++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(str[i] == <span class="string">'e'</span>) e++;</span><br><span class="line"><span class="keyword">else</span> n++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> one,zero;</span><br><span class="line">one = min(n,min(o,e));</span><br><span class="line">n -= one, o -= one, e -= one;</span><br><span class="line">zero = min(o,min(e,min(z,r)));</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= one;i++) <span class="built_in">printf</span>(<span class="string">"1 "</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= zero;i++) <span class="built_in">printf</span>(<span class="string">"0 "</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;nn);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str+<span class="number">1</span>);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="B-Multiplication-Table"><a href="#B-Multiplication-Table" class="headerlink" title="B. Multiplication Table"></a>B. Multiplication Table</h4><p><a href="https://codeforces.com/contest/1220/problem/B" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®šä¸€ä¸ªn <em> nè¡¨æ ¼ï¼Œå…¶ä¸­$M_{i,j} = a_i </em> a_j$ï¼Œç°åœ¨æœ‰ä¸ªåè›‹æŠŠåºåˆ—aç»™æ‰”äº†ï¼ŒåŒæ—¶æŠŠM_{i,i}éƒ½ç»™æ‰£èµ°äº†ï¼Œç°åœ¨è¯·ä½ åˆ©ç”¨å‰©ä¸‹çš„ä¿¡æ¯æ±‚å‡ºaåºåˆ—ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>ä¸æ˜¯é«˜æ–¯æ¶ˆå…ƒé¢˜ï¼Œå…¶å®æ˜¯ä¸ªæ‰¾è§„å¾‹é¢˜ã€‚å¦‚æœæˆ‘ä»¬èƒ½æ±‚å‡ºæ¥$a_1$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®ç¬¬ä¸€åˆ—æ±‚å‡ºæ‰€æœ‰ç­”æ¡ˆã€‚è€Œæˆ‘ä»¬åˆå¯ä»¥æ ¹æ®$a_1a_2 = x$ , $a_1a_3 = y$ , $a_2a_3 = z$æ¥æ±‚å‡º$a_1$ï¼Œäºæ˜¯å°±å¯ä»¥åœ¨æ±‚å‡ºå…¶ä»–æ‰€æœ‰ç»“æœäº†ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> __int64 ll;</span><br><span class="line">ll mat[N][N],ans[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">ans[<span class="number">1</span>] = mat[<span class="number">1</span>][<span class="number">2</span>]*mat[<span class="number">1</span>][<span class="number">3</span>]/mat[<span class="number">2</span>][<span class="number">3</span>];</span><br><span class="line">ans[<span class="number">1</span>] = (ll)<span class="built_in">sqrt</span>(ans[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)</span><br><span class="line">ans[i] = mat[<span class="number">1</span>][i]/ans[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">printf</span>(<span class="string">"%I64d "</span>,ans[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++) <span class="built_in">scanf</span>(<span class="string">"%I64d"</span>,&amp;mat[i][j]);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="C-Substring-Game-in-the-Lesson"><a href="#C-Substring-Game-in-the-Lesson" class="headerlink" title="C. Substring Game in the Lesson"></a>C. Substring Game in the Lesson</h4><p><a href="https://codeforces.com/contest/1220/problem/C" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>Annå’ŒMikeåœ¨ç©æ¸¸æˆï¼Œæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²sï¼Œåˆå§‹æ—¶æœ‰l  = r = k ï¼Œæ¯ä¸ªäººè½®æµæ“ä½œï¼š</p><ul><li>é€‰æ‹©lâ€™ &lt; l , râ€™ &lt; rï¼Œä¸”s[lâ€™,râ€™] å­—å…¸åºå°äº s[l,r]ï¼Œç„¶åä»¤l = lâ€™, r = râ€™ã€‚</li><li>è‹¥ä¸èƒ½åšä»»ä½•æ“ä½œï¼Œåˆ™å¤±è´¥ã€‚</li></ul><p>Annå…ˆæ‰‹ï¼Œå¯¹äºæ¯ä¸ªä½ç½®kï¼Œè¾“å‡ºè°å¿…èƒœã€‚</p><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç®€å•çš„åšå¼ˆè®ºï¼Œé¦–å…ˆå¿…è´¥æ€æ˜¯â€œåœ¨ l ä¹‹å‰ä¸å­˜åœ¨lâ€™ &lt; l ï¼Œ ä¸”s[lâ€™ , r] å­—å…¸åºå°äº s[l ,r] â€ï¼Œè€Œè‹¥å½“å‰ä¸æ˜¯å¿…è´¥æ€ï¼Œåˆ™ä¸€å®šå¯ä»¥ä½¿å¾—ä¸‹ä¸€ä¸ªçŠ¶æ€ä¸€å®šæ˜¯å¿…è´¥æ€ï¼Œäºæ˜¯åªéœ€è¦åˆ¤æ–­æ¯ä¸ªä½ç½®å‰é¢æ˜¯å¦æœ‰å­—å…¸åºæ¯”å…¶å°çš„å­—ç¬¦å³å¯ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> mi = (<span class="keyword">int</span>)str[<span class="number">0</span>],n = <span class="built_in">strlen</span>(str);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(mi &lt; (<span class="keyword">int</span>)str[i]) vis[i] = <span class="number">1</span>;</span><br><span class="line">mi = min(mi,(<span class="keyword">int</span>)str[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line"><span class="keyword">if</span>(vis[i]) <span class="built_in">printf</span>(<span class="string">"Ann\n"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"Mike"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="D-Alex-and-Julian"><a href="#D-Alex-and-Julian" class="headerlink" title="D. Alex and Julian"></a>D. Alex and Julian</h4><p><a href="https://codeforces.com/contest/1220/problem/D" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®šä¸€ä¸ªæ­£æ•´æ•°é›†åˆBï¼Œä»¤å…¨é›†Z(æ‰€æœ‰æ•´æ•°)å†…çš„å…ƒç´ ä½œä¸ºæ— å‘å›¾çš„é¡¶ç‚¹ï¼Œå¯¹äºå›¾ä¸­å†…ä»»æ„ä¸¤ç‚¹i å’Œ jï¼Œè‹¥abs(i - j)å±äºé›†åˆBï¼Œåˆ™ i å’Œ j ä¹‹é—´æœ‰ä¸€æ¡æ— å‘è¾¹ã€‚ç°åœ¨è¯·é—®æœ€å°‘åˆ é™¤Bä¸­å‡ ä¸ªé¡¶ç‚¹å¯ä»¥ä½¿å¾—å‰©ä¸‹çš„å›¾æ˜¯äºŒåˆ†å›¾ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>ä¸æ˜¯äºŒåˆ†å›¾é—®é¢˜ï¼Œåªç”¨åˆ°äº†â€œä¸€å¼ å›¾æ˜¯äºŒåˆ†å›¾ï¼Œå½“ä¸”ä»…å½“å›¾ä¸­ä¸å­˜åœ¨å¥‡ç¯â€è¿™ä¸€äºŒåˆ†å›¾åˆ¤å®šå®šç†ã€‚<br>è‡³äºä¸ºå•¥ä¸èƒ½ç”¨äºŒåˆ†å›¾ç®—æ³•æ¥è§£å†³å‘¢ï¼Œä»é—®é¢˜è§„æ¨¡å°±å¯ä»¥çŒœåˆ°ï¼Œå› ä¸ºè¦æ„é€ å›¾éœ€è¦$O((1e18)^2)$ï¼Œæ˜¾ç„¶nçš„è§„æ¨¡ä¸å…è®¸è¿™æ ·åšã€‚</p><p>é‚£ä¹ˆä»æ•°å­¦è§’åº¦è€ƒè™‘ï¼ˆæ‰¾è§„å¾‹ï¼‰ï¼Œè‹¥æœ‰èŠ‚ç‚¹0å’ŒèŠ‚ç‚¹aï¼Œé‚£ä¹ˆ0 åˆ° aæœ‰è¾¹ï¼Œè‹¥è¿˜å­˜åœ¨èŠ‚ç‚¹2 <em> a ï¼Œé‚£ä¹ˆa å’Œ2 </em> aä¹Ÿæœ‰è¾¹ï¼Œä¸”2 <em> aä¸ 0ä¹Ÿæœ‰è¾¹ï¼Œè¿™å°±æ˜¯å¥‡ç¯äº†ï¼ˆå“ªæ€•è¿˜æœ‰3 </em> aï¼Œä¹Ÿè¿˜æ˜¯å¥‡ç¯+ä¸€ä¸ªå¶ç¯ï¼‰ï¼Œå› æ­¤ä¸èƒ½æœ‰2 <em> aï¼ŒåŒç†ä¹Ÿä¸èƒ½æœ‰4 </em> aï¼Œå› æ­¤è‹¥æƒ³ä¿ç•™aï¼Œé‚£ä¹ˆ2 <em> aï¼Œ4 </em> aï¼Œ 8 * aï¼Œ â€¦ éƒ½è¦åˆ å»ã€‚<br>ä½†æ˜¯è¿™æ ·åšæ³•å¤æ‚åº¦è¿‡é«˜ï¼Œå› ä¸ºé¡¶ç‚¹é›†åˆæ˜¯[1, 1e18]ï¼ŒæŒ¨ä¸ªè®¡ç®—æ˜¾ç„¶ä¸ç°å®ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¯¹é›†åˆBä¸­æ¯ä¸ªå…ƒç´ bï¼ŒBä¸­æœ‰å“ªäº›å…ƒç´ å¯ä»¥å’Œbä¸€èµ·è¢«ä¿ç•™ã€‚</p><p>è‹¥aä¸­æœ‰xä¸ªå› æ•°2ï¼Œbä¸­æœ‰yä¸ªå› æ•°2ï¼ˆx != yï¼‰ï¼Œé‚£ä¹ˆaå’Œbä¸€å®šä¸èƒ½åŒæ—¶å­˜åœ¨ï¼›å‡è®¾c = lcm(a ,b)é‚£ä¹ˆ0 -&gt; a -&gt; 2 <em> a -&gt; â€¦ -&gt; c -&gt; â€¦ -&gt; 2 </em> b -&gt; b -&gt; 0ä¸€å®šå¯ä»¥æ„æˆä¸€ä¸ªå¥‡ç¯ ï¼Œå› æ­¤aå’Œbä¸èƒ½åŒæ—¶å­˜åœ¨ã€‚æ‰€ä»¥è‹¥æ˜¯x != yï¼Œåˆ™aå’Œbä¸èƒ½åŒæ—¶å­˜åœ¨ï¼ˆaå’Œbéƒ½æ˜¯é›†åˆBå†…å…ƒç´ ï¼‰ã€‚</p><p>è‹¥æ˜¯x = yï¼Œé‚£ä¹ˆaå’Œbå¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œå› ä¸ºå®ƒä»¬ä¸å­˜åœ¨aæ˜¯bçš„å€æ•°ï¼Œæˆ–è€…bæ˜¯açš„å€æ•°è¿™ç§æƒ…å†µï¼Œä¹Ÿå°±ä¸èƒ½åˆ å»0ï¼Œå› æ­¤è‹¥æœ‰ç¯åˆ™ä¸€å®šæ˜¯å¶ç¯ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬é€šè¿‡ç»Ÿè®¡Bé›†åˆä¸­æ¯ä¸ªå…ƒç´ æœ‰å¤šå°‘ä¸ªå› å­2å³å¯åˆ¤æ–­æœ€å¤šåŒæ—¶å­˜åœ¨å¤šå°‘ä¸ªå…ƒç´ ï¼Œå³æœ€å°‘åˆ å»å¤šå°‘ä¸ªå…ƒç´ ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> __int64 ll;</span><br><span class="line">ll a[N];</span><br><span class="line"><span class="keyword">int</span> tc[N],num[N],n;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">ll tmp = a[i];</span><br><span class="line"><span class="keyword">while</span>(tmp &amp;&amp; tmp%<span class="number">2</span> == <span class="number">0</span>) tc[i]++,tmp/=<span class="number">2</span>;</span><br><span class="line">num[tc[i]]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">64</span>;i++)</span><br><span class="line"><span class="keyword">if</span>(num[p] &lt; num[i]) p = i;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,n-num[p]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) </span><br><span class="line"><span class="keyword">if</span>(tc[i] != p) <span class="built_in">printf</span>(<span class="string">"%I64d "</span>,a[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%I64d"</span>,a+i);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="E-Tourism"><a href="#E-Tourism" class="headerlink" title="E. Tourism"></a>E. Tourism</h4><p><a href="https://codeforces.com/contest/1220/problem/E" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ä¸€å…±æœ‰nä¸ªç‚¹å’Œmæ¡æ— å‘è¾¹ï¼Œæ¯ä¸ªç‚¹æœ‰æƒå€¼ï¼ŒåŒä¸€æ¡è¾¹ä¸èƒ½<strong>è¿ç»­ç»è¿‡</strong>ä¸¤æ¬¡ï¼›æ¯ä¸ªç‚¹çš„æƒå€¼æœ€å¤šåªèƒ½åŠ ä¸€æ¬¡ï¼›ç»™å‡ºæ¯ä¸ªç‚¹çš„æƒå€¼ä»¥åŠæ— å‘å›¾çš„è¾¹ï¼Œç»™å‡ºèµ·ç‚¹ç¼–å·sï¼Œæ±‚å‡ºæ€æ ·æ‰èƒ½èµ°æ‰èƒ½ä½¿å¾—æƒå€¼å’Œæœ€å¤§ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>å¾ˆå®¹æ˜“å‘ç°å¦‚æœç»è¿‡ä¸€ä¸ªç¯ï¼Œé‚£ä¹ˆè¯¥ç¯ä¸Šæ‰€æœ‰ç‚¹çš„æƒå€¼éƒ½å¯ä»¥æ‹¿åˆ°ï¼Œä¸”å¯ä»¥ä»ç¯ä¸Šä»»æ„ä¸€ç‚¹å‡ºç¯ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥å°†ä¸€ä¸ªç¯ç¼©ä¸ºä¸€ä¸ªç‚¹ï¼Œå°†å›¾ä¸­æ‰€æœ‰ç¯éƒ½ç¼©ä¸ºç‚¹åï¼Œæ— å‘å›¾å°±æˆäº†æ— æ ¹æ ‘ã€‚é¢˜ç›®å°±æˆäº†æ±‚æ— æ ¹æ ‘ä¸Šä»så‡ºå‘çš„æœ€è¿œè·¯å¾„ã€‚äºæ˜¯è¯¥æ–¹æ³•éœ€è¦Tarjanç¼©ç‚¹+æ ‘ä¸Šdpï¼ŒåŒæ—¶éœ€è¦æ³¨æ„å¶å­èŠ‚ç‚¹ä¸èƒ½ç¼©ï¼ˆä¸€å®šä¸æ˜¯ç¯ï¼‰ã€‚</p><p>å¦ä¸€ç§æ–¹æ³•å°±æ˜¯åˆ©ç”¨æ‹“æ‰‘æ’åºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç”»å›¾ç­‰æ¨¡æ‹Ÿå‘ç°ï¼Œæœ€ç»ˆç­”æ¡ˆä¸€å®šæ˜¯ä¸€äº›ç¯ä¸ä»ç¯ä¸Šå‡ºå‘çš„ä¸€æ¡æœ€é•¿é“¾ã€‚<br>äºæ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘å¦‚ä¸‹ç®—æ³•ï¼š</p><ol><li>åˆ©ç”¨æ‹“æ‰‘æ’åºï¼Œæ¯æ¬¡éƒ½ä»å¶å­èŠ‚ç‚¹å‡ºå‘ï¼Œå°†è·¯å¾„ä¸Šçš„æƒå€¼ç´¯åŠ åˆ°ç¯ä¸Šçš„å¯¹åº”èŠ‚ç‚¹ï¼ˆå¦å¼€æ•°ç»„å­˜æ”¾ï¼‰å¹¶ç»ˆæ­¢ï¼Œå¹¶æ ‡è®°è·¯å¾„ä¸Šçš„æ‰€æœ‰ç‚¹ã€‚</li><li>ç”±äºç¯ä¸Šæ‰€æœ‰ç‚¹å¯äº’ç›¸åˆ°è¾¾ï¼Œå› æ­¤å°†æ‰€æœ‰æœªè¢«æ ‡è®°çš„ç‚¹çš„æƒå€¼ç´¯åŠ ï¼ˆæœ‰å¯èƒ½å¥½å‡ ä¸ªç¯ï¼Œä½†æ˜¯ç¯ä¸ç¯ä¹‹é—´çš„è·¯å¾„æœªè¢«æ ‡è®°ï¼Œå¹¶ä¸”å¯è¾¾ï¼‰ï¼Œå³ä¸ºå¯è·å¾—çš„ç¯ä¸Šæœ€å¤§æƒå€¼å’Œã€‚</li><li>æ‰¾ä»ç¯ä¸ŠæŸç‚¹å‡ºå‘çš„æœ€é•¿é“¾ï¼Œä¸ä¸Šè¿°ç»“æœç›¸åŠ å³ä¸ºæœ€ç»ˆç­”æ¡ˆã€‚</li></ol><p>å¾ˆæ˜¾ç„¶ä¸Šè¿°ç®—æ³•æ˜¯æ­£ç¡®çš„ï¼Œæˆ‘ä»¬å°†ç­”æ¡ˆåˆ†ä¸ºäº†ä¸¤éƒ¨åˆ†ï¼šå¯äº’è¾¾çš„â€œè¿é€šç¯â€ä»¥åŠâ€œä»ç¯ä¸Šå‡ºå‘çš„æœ€é•¿é“¾â€ã€‚åˆç”±äºæˆ‘ä»¬æ˜¯ä»så‡ºå‘çš„ï¼Œä¸Šè¿°ç®—æ³•æˆ‘ä»¬æ˜¯ç´¯åŠ æœªè¢«æ ‡è®°çš„èŠ‚ç‚¹ï¼Œå› æ­¤å¦‚æœæ ‡è®°çš„æ—¶å€™é‡åˆ°äº†sï¼Œé‚£ä¹ˆå°±å°†ç»“æœç´¯åŠ åˆ°sçš„é™„åŠ åŸŸå¹¶ç»ˆæ­¢ï¼›æœ€ç»ˆç´¯åŠ æ—¶å€™å› ä¸ºä» s å‡ºå‘çš„é“¾æœªè¢«æ ‡è®°ï¼Œå› æ­¤ä¾ç„¶ä¼šè¢«ç´¯åŠ ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">4e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> __int64 ll;</span><br><span class="line"><span class="keyword">int</span> head[N],edge[M],ver[M],nex[M];</span><br><span class="line"><span class="keyword">int</span> tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> deg[N];<span class="comment">//å…¥åº¦,åˆå§‹å€¼ä¸º0 </span></span><br><span class="line">ll w[N],cnt[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">ver[++tot] = y; nex[tot] = head[x]; </span><br><span class="line">head[x] = tot; deg[y]++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="keyword">int</span> n,m,s;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) </span><br><span class="line"><span class="keyword">if</span>(deg[i] == <span class="number">1</span> &amp;&amp; i != s) q.push(i);</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> x = q.front(); q.pop();</span><br><span class="line">deg[x] = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i];</span><br><span class="line"><span class="keyword">if</span>(deg[y] &lt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">deg[y]--;</span><br><span class="line">cnt[y] = max(cnt[y],cnt[x]+w[x]);</span><br><span class="line"><span class="keyword">if</span>(deg[y] == <span class="number">1</span> &amp;&amp; y != s) q.push(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ll s1 = <span class="number">0</span>,s2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(deg[i] &lt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">s1 += w[i];</span><br><span class="line">s2 = max(s2,cnt[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%I64d\n"</span>,s1+s2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,w+i); </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">addEdge(x,y); addEdge(y,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;s);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾è®º </tag>
            
            <tag> åšå¼ˆè®º </tag>
            
            <tag> æ•°è®º </tag>
            
            <tag> æ‹“æ‰‘æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5 è¿ç»­å†…å­˜åˆ†é…</title>
      <link href="/2019/09/20/os5/"/>
      <url>/2019/09/20/os5/</url>
      
        <content type="html"><![CDATA[<h3 id="è®¡ç®—æœºä½“ç³»ç»“æ„å’Œå†…å­˜å±‚æ¬¡"><a href="#è®¡ç®—æœºä½“ç³»ç»“æ„å’Œå†…å­˜å±‚æ¬¡" class="headerlink" title="è®¡ç®—æœºä½“ç³»ç»“æ„å’Œå†…å­˜å±‚æ¬¡"></a>è®¡ç®—æœºä½“ç³»ç»“æ„å’Œå†…å­˜å±‚æ¬¡</h3><ul><li>è®¡ç®—æœºä½“ç³»ç»“æ„</li><li>å†…å­˜å±‚æ¬¡</li><li>æ“ä½œç³»ç»Ÿçš„å†…å­˜ç®¡ç†æ–¹å¼</li></ul><h4 id="è®¡ç®—æœºä½“ç³»ç»“æ„"><a href="#è®¡ç®—æœºä½“ç³»ç»“æ„" class="headerlink" title="è®¡ç®—æœºä½“ç³»ç»“æ„"></a>è®¡ç®—æœºä½“ç³»ç»“æ„</h4><p>åŸºæœ¬çš„åˆ†é…å’Œé‡Šæ”¾çš„ç®¡ç†è¦æ±‚ã€‚cpué«˜é€Ÿç¼“å­˜ï¼Œå­˜å‚¨ç®¡ç†å•å…ƒï¼ˆMMUï¼‰ï¼Œå†…å­˜æœ€å°è®¿é—®å•ä½8bitï¼›32ä½çš„æ„æ€æ˜¯ä¸€æ¬¡å¯ä»¥è¯»å†™32ä½ï¼›é«˜é€Ÿç¼“å­˜ç”¨æ¥å­˜æ”¾ä¼šé‡å¤ä½¿ç”¨çš„æ•°æ®ï¼Œç”¨æ¥æé«˜æ•ˆç‡ï¼›</p><h4 id="å†…å­˜å±‚æ¬¡"><a href="#å†…å­˜å±‚æ¬¡" class="headerlink" title="å†…å­˜å±‚æ¬¡"></a>å†…å­˜å±‚æ¬¡</h4><p>ç¼“å­˜é€Ÿåº¦æœ€å¿«ï¼Œé¦–å…ˆå»ç¼“å­˜æ‰¾æ•°æ®ï¼Œè‹¥æœªå‘½ä¸­åˆ™å»å†…å­˜ä¸­æ‰¾ï¼Œè‹¥ä»æœªå‘½ä¸­åˆ™å»å¤–å­˜ï¼ˆè™šæ‹Ÿå†…å­˜ï¼‰ä¸­æ‰¾ï¼Œè¿™ä¸‰è€…é€Ÿåº¦å·®åˆ«å¾ˆå¤§ã€‚</p><h4 id="æ“ä½œç³»ç»Ÿçš„å†…å­˜ç®¡ç†"><a href="#æ“ä½œç³»ç»Ÿçš„å†…å­˜ç®¡ç†" class="headerlink" title="æ“ä½œç³»ç»Ÿçš„å†…å­˜ç®¡ç†"></a>æ“ä½œç³»ç»Ÿçš„å†…å­˜ç®¡ç†</h4><p>çŸ¥è¯†ç‚¹ï¼šæˆ‘ä»¬å¸Œæœ›çš„ç†æƒ³çŠ¶æ€ã€‚é€»è¾‘å­˜å‚¨å•å…ƒã€‚<br><strong>å­˜å‚¨ç®¡ç†è¦è¾¾åˆ°çš„æ•ˆæœï¼š</strong></p><ul><li>æŠ½è±¡ï¼šé€»è¾‘åœ°å€ç©ºé—´</li><li>ä¿æŠ¤ï¼šç‹¬ç«‹åœ°å€ç©ºé—´</li><li>å…±äº«ï¼šè®¿é—®ç›¸åŒå†…å­˜</li><li>è™šæ‹ŸåŒ–ï¼šæ›´å¤§çš„åœ°å€ç©ºé—´</li></ul><h4 id="æ“ä½œç³»ç»Ÿä¸­é‡‡ç”¨çš„å†…å­˜ç®¡ç†æ–¹å¼ï¼š"><a href="#æ“ä½œç³»ç»Ÿä¸­é‡‡ç”¨çš„å†…å­˜ç®¡ç†æ–¹å¼ï¼š" class="headerlink" title="æ“ä½œç³»ç»Ÿä¸­é‡‡ç”¨çš„å†…å­˜ç®¡ç†æ–¹å¼ï¼š"></a>æ“ä½œç³»ç»Ÿä¸­é‡‡ç”¨çš„å†…å­˜ç®¡ç†æ–¹å¼ï¼š</h4><ul><li>é‡å®šä½ï¼ˆrelocationï¼‰</li><li>åˆ†æ®µï¼ˆsegmentationï¼‰</li><li>åˆ†é¡µï¼ˆpagingï¼‰</li><li>è™šæ‹Ÿå­˜å‚¨ï¼ˆç›®å‰å¤šæ•°ç³»ç»Ÿï¼Œå¦‚Linuxï¼Œé‡‡ç”¨æŒ‰éœ€é¡µå¼è™šæ‹Ÿå­˜å‚¨ï¼‰</li></ul><p><strong>å®ç°é«˜åº¦ä¾èµ–ç¡¬ä»¶ï¼š</strong></p><ul><li>ä¸è®¡ç®—æœºå­˜å‚¨æ¶æ„ç´§è€¦åˆ</li><li>MMUï¼ˆå†…å­˜ç®¡ç†å•å…ƒï¼‰ï¼šå¤„ç†CPUå­˜å‚¨è®¿é—®è¯·æ±‚çš„ç¡¬ä»¶</li></ul><h3 id="åœ°å€ç©ºé—´å’Œåœ°å€ç”Ÿæˆ"><a href="#åœ°å€ç©ºé—´å’Œåœ°å€ç”Ÿæˆ" class="headerlink" title="åœ°å€ç©ºé—´å’Œåœ°å€ç”Ÿæˆ"></a>åœ°å€ç©ºé—´å’Œåœ°å€ç”Ÿæˆ</h3><h4 id="åœ°å€ç©ºé—´çš„å®šä¹‰"><a href="#åœ°å€ç©ºé—´çš„å®šä¹‰" class="headerlink" title="åœ°å€ç©ºé—´çš„å®šä¹‰"></a>åœ°å€ç©ºé—´çš„å®šä¹‰</h4><p>ç‰©ç†åœ°å€ç©ºé—´-ç¡¬ä»¶æ”¯æŒçš„åœ°å€ç©ºé—´ï¼ˆåœ°å€æ€»çº¿æ¡æ•°ï¼‰ã€‚</p><ul><li>èµ·å§‹åœ°å€ä¸º0ï¼ŒçŸ¥é“$MAX_{sys}$</li></ul><p>é€»è¾‘åœ°å€ç©ºé—´-åœ¨CPUè¿è¡Œçš„è¿›ç¨‹çœ‹åˆ°çš„åœ°å€</p><ul><li>èµ·å§‹åœ°å€ä¸º0ï¼Œç›´åˆ°$MAX_{prog}$</li></ul><p>åœ°å€æ˜¯ä»å“ªé‡Œæ¥çš„ï¼Ÿ</p><h4 id="é€»è¾‘åœ°å€ç”Ÿæˆ"><a href="#é€»è¾‘åœ°å€ç”Ÿæˆ" class="headerlink" title="é€»è¾‘åœ°å€ç”Ÿæˆ"></a>é€»è¾‘åœ°å€ç”Ÿæˆ</h4><p><img src="/2019/09/20/os5/1.png" alt="1"></p><p><center>å›¾1ï¼šé€»è¾‘åœ°å€ç”Ÿæˆå›¾ç¤º</center></p><h4 id="åœ°å€ç”Ÿæˆæ—¶æœºå’Œé™åˆ¶"><a href="#åœ°å€ç”Ÿæˆæ—¶æœºå’Œé™åˆ¶" class="headerlink" title="åœ°å€ç”Ÿæˆæ—¶æœºå’Œé™åˆ¶"></a>åœ°å€ç”Ÿæˆæ—¶æœºå’Œé™åˆ¶</h4><p>ç¼–è¯‘æ—¶ï¼š</p><ul><li>å‡è®¾èµ·å§‹åœ°å€å·²çŸ¥</li><li>å¦‚æœèµ·å§‹åœ°å€æ”¹å˜ï¼Œå¿…é¡»é‡æ–°ç¼–è¯‘</li></ul><p>åŠ è½½æ—¶ï¼š</p><ul><li>å¦‚ç¼–è¯‘æ—¶èµ·å§‹ä½ç½®ä½ç½®ï¼Œç¼–è¯‘å™¨éœ€ç”Ÿæˆå¯é‡å®šä½çš„ä»£ç </li><li>åŠ è½½æ—¶ï¼Œç”Ÿæˆç»å¯¹åœ°å€</li></ul><p>æ‰§è¡Œæ—¶ï¼š</p><ul><li>æ‰§è¡Œæ—¶ä»£ç å¯ç§»åŠ¨</li><li>éœ€åœ°å€è½¬æ¢ï¼ˆæ˜ å°„ï¼‰ç¡¬ä»¶æ”¯æŒ</li></ul><h4 id="åœ°å€ç”Ÿæˆè¿‡ç¨‹"><a href="#åœ°å€ç”Ÿæˆè¿‡ç¨‹" class="headerlink" title="åœ°å€ç”Ÿæˆè¿‡ç¨‹"></a>åœ°å€ç”Ÿæˆè¿‡ç¨‹</h4><p>CPUï¼š</p><ul><li>ALUï¼šéœ€è¦é€»è¾‘åœ°å€çš„å†…å­˜å†…å®¹</li><li>MMUï¼šè¿›è¡Œé€»è¾‘åœ°å€å’Œç‰©ç†åœ°å€çš„è½¬æ¢</li></ul><p>å†…å­˜ï¼š</p><ul><li>å‘é€ç‰©ç†åœ°å€çš„å†…å®¹ç»™CPU</li><li>æˆ–æ¥å—CPUæ•°æ®åˆ°ç‰©ç†åœ°å€</li></ul><p>æ“ä½œç³»ç»Ÿï¼š</p><ul><li>å»ºç«‹é€»è¾‘åœ°å€LAå’Œç‰©ç†åœ°å€PAçš„æ˜ å°„</li></ul><h4 id="åœ°å€æ£€æŸ¥"><a href="#åœ°å€æ£€æŸ¥" class="headerlink" title="åœ°å€æ£€æŸ¥"></a>åœ°å€æ£€æŸ¥</h4><p>æ£€æŸ¥æ®µçš„é•¿åº¦å’Œåç§»é‡æ˜¯å¦ä¸ºæœ‰æ•ˆèŒƒå›´ã€‚</p><h3 id="è¿ç»­å†…å­˜åˆ†é…"><a href="#è¿ç»­å†…å­˜åˆ†é…" class="headerlink" title="è¿ç»­å†…å­˜åˆ†é…"></a>è¿ç»­å†…å­˜åˆ†é…</h3><h4 id="è¿ç»­å†…å­˜åˆ†é…å’Œå†…å­˜ç¢ç‰‡"><a href="#è¿ç»­å†…å­˜åˆ†é…å’Œå†…å­˜ç¢ç‰‡" class="headerlink" title="è¿ç»­å†…å­˜åˆ†é…å’Œå†…å­˜ç¢ç‰‡"></a>è¿ç»­å†…å­˜åˆ†é…å’Œå†…å­˜ç¢ç‰‡</h4><p><strong>è¿ç»­å†…å­˜åˆ†é…ï¼š</strong> ç»™è¿›ç¨‹åˆ†é…ä¸€å—ä¸å°äºæŒ‡å®šå¤§å°çš„è¿ç»­çš„ç‰©ç†å†…å­˜ã€‚<br><strong>å†…å­˜ç¢ç‰‡ï¼š</strong> ç©ºé—²å†…å­˜ä¸èƒ½è¢«åˆ©ç”¨ã€‚<br><strong>å¤–éƒ¨ç¢ç‰‡ï¼š</strong> åˆ†é…å•å…ƒä¹‹é—´çš„æœªè¢«ä½¿ç”¨çš„å†…å­˜ã€‚<br><strong>å†…éƒ¨ç¢ç‰‡ï¼š</strong> åˆ†é…å•å…ƒå†…éƒ¨çš„æœªè¢«ä½¿ç”¨çš„å†…å­˜ï¼Œå–å†³äºåˆ†é…å•å…ƒå¤§å°æ˜¯å¦è¦è°ƒæ•´ã€‚</p><h4 id="åŠ¨æ€åˆ†åŒºåˆ†é…"><a href="#åŠ¨æ€åˆ†åŒºåˆ†é…" class="headerlink" title="åŠ¨æ€åˆ†åŒºåˆ†é…"></a>åŠ¨æ€åˆ†åŒºåˆ†é…</h4><p><strong>åŠ¨æ€å†…å­˜åˆ†é…ï¼š</strong></p><ul><li>å½“ç¨‹åºè¢«åŠ è½½å¯æ‰§è¡Œæ—¶ï¼Œåˆ†é…ä¸€ä¸ªè¿›ç¨‹æŒ‡å®šå¤§å°å¯å˜çš„åˆ†åŒºï¼ˆå—ï¼Œå†…å­˜å—ï¼‰</li><li>åˆ†åŒºçš„åœ°å€æ˜¯è¿ç»­çš„</li></ul><p><strong>æ“ä½œç³»ç»Ÿéœ€è¦ç»´æŠ¤çš„æ•°æ®ç»“æ„ï¼š</strong></p><ul><li>æ‰€æœ‰è¿›ç¨‹çš„å·²åˆ†é…åˆ†åŒº</li><li>ç©ºé—²åˆ†åŒºï¼ˆEmpty-blocksï¼‰</li></ul><p><strong>åŠ¨æ€åˆ†åŒºåˆ†é…ç­–ç•¥ï¼š</strong></p><ul><li>æœ€å…ˆåŒ¹é…</li><li>æœ€ä¼˜åŒ¹é…</li><li>æœ€å·®åŒ¹é…</li></ul><h4 id="æœ€å…ˆåŒ¹é…ï¼ˆFirst-Fit-Allocationï¼‰ç­–ç•¥"><a href="#æœ€å…ˆåŒ¹é…ï¼ˆFirst-Fit-Allocationï¼‰ç­–ç•¥" class="headerlink" title="æœ€å…ˆåŒ¹é…ï¼ˆFirst Fit Allocationï¼‰ç­–ç•¥"></a>æœ€å…ˆåŒ¹é…ï¼ˆFirst Fit Allocationï¼‰ç­–ç•¥</h4><p>æ€è·¯ï¼šåˆ†é…nä¸ªå­—èŠ‚æ—¶ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªå¯ç”¨çš„ç©ºé—´æ¯”nå¤§çš„ç©ºé—²å—ã€‚<br>åŸç†&amp;å®ç°ï¼š</p><ul><li>ç©ºé—²åˆ†åŒºåˆ—è¡¨æŒ‰ç…§åœ°å€é¡ºåºæ’åº</li><li>åˆ†é…è¿‡ç¨‹ä¸­ï¼Œæœç´¢ä¸€ä¸ªåˆé€‚çš„åˆ†åŒº</li><li>é‡Šæ”¾åˆ†åŒºæ—¶ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä¸ä¸´è¿‘çš„ç©ºé—²åˆ†åŒºåˆå¹¶</li></ul><p>ä¼˜ç‚¹ï¼š</p><ul><li>ç®€å•</li><li>åœ¨é«˜åœ°å€ä¸Šæœ‰å¤§å—çš„ç©ºé—²åˆ†åŒº</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å¤–éƒ¨ç¢ç‰‡å¤š</li><li>åˆ†é…å¤§å—æ—¶è¾ƒæ…¢</li></ul><h4 id="æœ€ä½³åŒ¹é…ï¼ˆBest-Fit-Allocationï¼‰ç­–ç•¥"><a href="#æœ€ä½³åŒ¹é…ï¼ˆBest-Fit-Allocationï¼‰ç­–ç•¥" class="headerlink" title="æœ€ä½³åŒ¹é…ï¼ˆBest Fit Allocationï¼‰ç­–ç•¥"></a>æœ€ä½³åŒ¹é…ï¼ˆBest Fit Allocationï¼‰ç­–ç•¥</h4><p>æ€è·¯ï¼šåˆ†é…nä¸ªå­—èŠ‚æ—¶ï¼ŒæŸ¥æ‰¾å¹¶ä½¿ç”¨ä¸å°äºnçš„æœ€å°ç©ºé—²åˆ†åŒº<br>åŸç†&amp;å®ç°ï¼š</p><ul><li>ç©ºé—²åˆ†åŒºåˆ—è¡¨æŒ‰ç…§å¤§å°æ’åº</li><li>åˆ†é…æ—¶ï¼ŒæŸ¥æ‰¾ä¸€ä¸ªåˆé€‚çš„åˆ†åŒº</li><li>é‡Šæ”¾æ—¶ï¼ŒæŸ¥æ‰¾å¹¶åˆå¹¶ä¸´è¿‘çš„ç©ºé—²åˆ†åŒºï¼ˆå¦‚æœæ‰¾åˆ°ï¼‰</li></ul><p>ä¼˜ç‚¹ï¼š å¤§éƒ¨åˆ†åˆ†é…çš„å°ºå¯¸è¾ƒå°æ—¶ï¼Œæ•ˆæœå¾ˆå¥½</p><ul><li>å¯é¿å…å¤§çš„ç©ºé—²åˆ†åŒºè¢«æ‹†åˆ†</li><li>å¯å‡å°å¤–éƒ¨ç¢ç‰‡çš„å¤§å°</li><li>ç›¸å¯¹ç®€å•</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å¤–éƒ¨ç¢ç‰‡</li><li>é‡Šæ”¾åˆ†åŒºæ…¢</li><li>å®¹æ˜“äº§ç”Ÿå¾ˆå¤šæ— ç”¨çš„å°ç¢ç‰‡</li></ul><h4 id="æœ€å·®åŒ¹é…ï¼ˆWorst-Fit-Allocationï¼‰ç­–ç•¥"><a href="#æœ€å·®åŒ¹é…ï¼ˆWorst-Fit-Allocationï¼‰ç­–ç•¥" class="headerlink" title="æœ€å·®åŒ¹é…ï¼ˆWorst Fit Allocationï¼‰ç­–ç•¥"></a>æœ€å·®åŒ¹é…ï¼ˆWorst Fit Allocationï¼‰ç­–ç•¥</h4><p>æ€è·¯ï¼šåˆ†é…nå­—èŠ‚ï¼Œä½¿ç”¨å°ºå¯¸ä¸å°äºnçš„æœ€å¤§ç©ºé—²åˆ†åŒºã€‚<br>åŸç†&amp;å®ç°ï¼š</p><ul><li>ç©ºé—²åˆ†åŒºæŒ‰ä»å¤§åˆ°å°æ’åº</li><li>åˆ†é…æ—¶ï¼Œé€‰æœ€å¤§çš„åˆ†åŒº</li><li>é‡Šæ”¾æ—¶ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä¸ä¸´è¿‘çš„ç©ºé—²åˆ†åŒºåˆå¹¶ï¼Œè¿›è¡Œå¯èƒ½çš„åˆå¹¶ï¼Œå¹¶è°ƒæ•´ç©ºé—²åˆ†åŒºåˆ—è¡¨çš„é¡ºåº</li></ul><p>ä¼˜ç‚¹ï¼š</p><ul><li>ä¸­ç­‰å¤§å°çš„åˆ†é…è¾ƒå¤šæ—¶ï¼Œæ•ˆæœæœ€å¥½</li><li>é¿å…å‡ºç°å¤ªå¤šçš„å°ç¢ç‰‡</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>é‡Šæ”¾åˆ†åŒºè¾ƒæ…¢</li><li>å¤–éƒ¨ç¢ç‰‡</li><li>å®¹æ˜“ç ´åå¤§çš„ç©ºé—²åˆ†åŒºï¼Œå› æ­¤åç»­éš¾ä»¥åˆ†é…å¤§çš„åˆ†åŒº</li></ul>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºæ“ä½œç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…å­˜åˆ†é… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dudu&#39;s maze è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2019/09/15/dudu-maze/"/>
      <url>/2019/09/15/dudu-maze/</url>
      
        <content type="html"><![CDATA[<p><a href="https://nanti.jisuanke.com/t/41402" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>åœ¨ä¸€ä¸ªæ— å‘å›¾ä¸­ï¼Œæœ‰ k ä¸ªæ€ªç‰©ç‚¹ï¼Œn-kä¸ªç³–æœç‚¹ï¼Œæ¯ä¸ªç³–æœç‚¹æœ‰1ä¸ªç³–æœï¼Œä¸”å¯ä»¥ç§»åŠ¨åˆ°ç›¸é‚»çš„ç‚¹ï¼Œä½†æ˜¯æ¯ä¸ªç‚¹çš„ç³–æœåªèƒ½æ‹¿ä¸€æ¬¡ï¼ˆä½†æ˜¯å¯ä»¥ç»è¿‡å¤šæ¬¡ï¼‰ã€‚è€Œæ¯ä¸ªæ€ªç‰©ç‚¹æ²¡ç³–æœï¼Œä½†æ˜¯å¯ä»¥éšæœºä¼ é€åˆ°ç›¸é‚»çš„ç‚¹ï¼Œåªèƒ½ä¼ é€ä¸€æ¬¡ï¼ˆå³åªèƒ½è¿›ä¸€æ¬¡æ€ªç‰©æˆ¿ï¼‰ï¼Œè¯·é—®æœ€ç»ˆæ‹¿åˆ°ç³–æœçš„æœ€ä¼˜æœŸæœ›æ˜¯å¤šå°‘ï¼Ÿ<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>dfsæ±‚è¿é€šå—+æŸ“è‰²ï¼Œæˆ‘ç°åœ¨è¿˜æ˜¯ä¸æ˜ç™½æˆ‘å•ç‹¬æŸ“è‰²ä¸ºä»€ä¹ˆä¸€ç›´è¶…æ—¶ï¼Œæ— è¯­äº†ï¼Œå°±æŒ‰ç…§ä¸‹é¢çš„ä»£ç å†™å§ï¼Œç”¨æ ‡è®°æ•°ç»„å•ç‹¬å­˜æ”¾è¢«æŸ“è‰²çš„è¿é€šå—ç³–æœæ•°ï¼Œç›¸å½“äºè®°å¿†åŒ–ã€‚å½“ç„¶èŠ‚ç‚¹1æ‰€åœ¨çš„è¿é€šå—ç³–æœéƒ½èƒ½æ‹¿åˆ°ï¼Œç„¶åå†é€‰æ‹©èµ°å’Œ1ç›¸è¿çš„ä¸”æœŸæœ›æœ€å¤§çš„æ€ªç‰©ç‚¹å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[<span class="number">2</span>*N],nex[<span class="number">2</span>*N],tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,t,k;</span><br><span class="line"><span class="keyword">int</span> vis[N],mst[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">ver[++tot] = y;nex[tot] = head[x]; head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> vm[N],cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> num[N];</span><br><span class="line"><span class="keyword">int</span> tc[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">vis[x] = <span class="number">1</span>; ans++; tc[x]++;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i != <span class="number">-1</span>;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i];</span><br><span class="line"><span class="keyword">if</span>(vis[y]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span>(mst[y])&#123;</span><br><span class="line">vm[++cnt] = y;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">dfs1(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> col)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(num[col]) <span class="keyword">return</span> num[col];</span><br><span class="line"><span class="keyword">if</span>(vis[x] || mst[x]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> res = <span class="number">1</span>; vis[x] = col;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i != <span class="number">-1</span>;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i];</span><br><span class="line"><span class="keyword">if</span>(vis[y] || mst[y]) <span class="keyword">continue</span>;</span><br><span class="line">res += dfs2(y,col);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">ans = <span class="number">0</span>; cnt = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line"><span class="built_in">memset</span>(num,<span class="number">0</span>,<span class="keyword">sizeof</span> num);</span><br><span class="line">dfs1(<span class="number">1</span>); <span class="keyword">double</span> mx = <span class="number">0</span>; <span class="keyword">int</span> col = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++)&#123;</span><br><span class="line"><span class="keyword">double</span> pp = <span class="number">0</span>,ecnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = head[vm[i]] ;j != <span class="number">-1</span>;j = nex[j]) ecnt++;</span><br><span class="line"><span class="comment">//printf("ecnt: %f\n",ecnt);</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = head[vm[i]] ;j != <span class="number">-1</span>;j = nex[j])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[j]; <span class="keyword">double</span> tmp;</span><br><span class="line"><span class="keyword">if</span>(vis[y]) tmp = num[vis[y]];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">tmp = dfs2(y,++col);</span><br><span class="line">num[col] = tmp;</span><br><span class="line">&#125;</span><br><span class="line">pp += tmp;</span><br><span class="line"><span class="comment">//printf("%d %f\n",ver[j] ,tmp);</span></span><br><span class="line">&#125;</span><br><span class="line">pp /= ecnt;</span><br><span class="line"><span class="keyword">if</span>(mx - pp &lt; <span class="number">0</span>) mx = pp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.7f\n"</span>,mx+ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> neg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">char</span> c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c!=<span class="string">'-'</span> &amp;&amp; (c&lt;<span class="string">'0'</span> || c&gt;<span class="string">'9'</span>)) c = getchar();</span><br><span class="line"><span class="keyword">if</span> (c == <span class="string">'-'</span>) neg = <span class="literal">true</span>, c = getchar();</span><br><span class="line"><span class="keyword">while</span> (c&gt;=<span class="string">'0'</span> &amp;&amp; c&lt;=<span class="string">'9'</span>)</span><br><span class="line">ans = ans*<span class="number">10</span> + c-<span class="string">'0'</span>, c = getchar();</span><br><span class="line"><span class="keyword">return</span> neg ? -ans : ans; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">t = getInt();</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line">tot = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">memset</span>(mst,<span class="number">0</span>,<span class="keyword">sizeof</span> mst);</span><br><span class="line"><span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span> head);</span><br><span class="line">n = getInt(), m = getInt(),k = getInt();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line">x = getInt(); y = getInt();</span><br><span class="line">addEdge(x,y);addEdge(y,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x;i &lt;= k;i++) x = getInt() , mst[x] = <span class="number">1</span>;</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dfsè¿é€šå— </tag>
            
            <tag> æŸ“è‰² </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Educational Codeforces Round 72 è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2019/09/10/cf-r72/"/>
      <url>/2019/09/10/cf-r72/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1217" target="_blank" rel="noopener">é¢˜é›†é“¾æ¥</a></p><h4 id="A-Creating-a-Character"><a href="#A-Creating-a-Character" class="headerlink" title="A.Creating a Character"></a>A.Creating a Character</h4><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>æœ‰ä¸‰ä¸ªæ•°aï¼Œbï¼Œcï¼Œå°†cåˆ†é…åœ¨aå’Œbä¸Šï¼Œä½¿å¾—a&gt;bï¼Œè¯·é—®æœ‰å¤šå°‘ç§åˆ†é…æ–¹æ¡ˆï¼Ÿä¸¤ä¸ªæ–¹æ¡ˆä¸åŒï¼Œå½“ä¸”ä»…å½“å®ƒä»¬å¯¹åº”çš„aæˆ–bä¸ç›¸ç­‰ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>å‡è®¾å°†cåˆ†é…ç»™aå’Œbåä½¿å¾—a = b = resï¼Œé‚£ä¹ˆæ˜¾ç„¶è‹¥åŸå§‹çš„a &gt; resï¼Œå°±è¯´æ˜b+c &lt; aï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯c+1ï¼ˆå½“ç„¶ç‰¹åˆ¤b+c&lt;aä¹Ÿè¡Œï¼‰ï¼›å¦åˆ™a &lt;= resï¼Œæ­¤æ—¶åˆ†é…ç»™açš„å€¼ä¸€å®šè¦å¤§äºres - aï¼Œæ‰€ä»¥å…±c - (res-a) = c-res + a ç§ä¸åŒæ–¹æ¡ˆã€‚ </p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> a,b,c,t,d;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(a+c &lt;= b) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> res = a+b+c&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(a &gt; res) <span class="keyword">return</span> c+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> c-res+a; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="B-Zmei-Gorynich"><a href="#B-Zmei-Gorynich" class="headerlink" title="B.Zmei Gorynich"></a>B.Zmei Gorynich</h4><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ä¸€æ¡æ¶é¾™å…± x æ»´è¡€ï¼Œå‹‡å£«æœ‰nä»¶æ­¦å™¨ï¼Œæ¯ä»¶æ­¦å™¨æœ‰ä¼¤å®³å€¼ d å’Œ å‰¯ä½œç”¨ hï¼Œè¡¨ç¤ºç€å°†ä¼šç»™æ¶é¾™é€ æˆ d ç‚¹ä¼¤å®³ï¼Œä¹‹åä¼šç»™æ¶é¾™å› h ç‚¹è¡€ã€‚å½“æŸä¸€æ—¶åˆ»æ¶é¾™è¡€é‡ä½äº0æ—¶åˆ™ä¼šæ­»äº¡ï¼Œè¯·é—®å‹‡è€…æœ€å°‘ç å¤šå°‘æ¬¡æ‰èƒ½æ€æ­»æ¶é¾™ï¼Ÿå¦‚æœæ€ä¸æ­»è¾“å‡º-1ï¼Œä¸€ä¸ªæ­¦å™¨å¯ä»¥é‡å¤ä½¿ç”¨ã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>å¦‚æœå½“å‰æœ‰ä¸€ä¸ªæ­¦å™¨èƒ½æ€æ­»æ¶é¾™ï¼ˆd &gt;= xï¼‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¿½ç•¥ä»–çš„å‰¯ä½œç”¨ h ï¼Œç›´æ¥ç§’æ€æ¶é¾™ï¼›å¦åˆ™æˆ‘ä»¬å°±è¦é€‰æ‹©ä¸€ä¸ªd-hæœ€å¤§çš„æ¥ç æ¶é¾™ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€å¤šç”¨ä¸¤æŠŠæ­¦å™¨ï¼Œä¸€æŠŠç”¨æ¥æ¶ˆè€—ï¼Œä¸€æŠŠç”¨æ¥ç»ˆç»“æ¶é¾™ã€‚å½“æ— æ³•ç§’æ€æ¶é¾™ï¼Œä¹Ÿæ— æ³•æ¶ˆè€—æ¶é¾™æ—¶ï¼Œè¯´æ˜æ— æ³•æ€æ­»æ¶é¾™ã€‚å¦åˆ™å°±å¯ä»¥é€šè¿‡è®¡ç®—æœ€å°‘éœ€è¦æ¶ˆè€—å¤šå°‘æ¬¡æ¥O(1)è®¡ç®—ç­”æ¡ˆã€‚</p><p>ç‰¹åˆ«æ³¨æ„æ˜¯å¦èƒ½ä¸€åˆ€ç§’æ€æ¶é¾™ç­‰ç‰¹æ®Šæƒ…å†µã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> t,n,x;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">int</span> t1,t2;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">//æ¶é¾™æœ¬æ¥å°±æ­»äº†</span></span><br><span class="line"><span class="keyword">if</span>(t1 &gt;= x) <span class="keyword">return</span> <span class="number">1</span>;   <span class="comment">//ç§’æ€æ¶é¾™</span></span><br><span class="line"><span class="keyword">if</span>(t2 &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;  <span class="comment">//æ— æ³•æ€æ­»æ¶é¾™</span></span><br><span class="line">x -= t1;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x%t2) res++;</span><br><span class="line">res += x/t2;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;x); t1 = t2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,ta,tb;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;ta,&amp;tb);</span><br><span class="line">t1 = max(t1,ta);</span><br><span class="line">t2 = max(t2,ta-tb);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="C-The-Number-Of-Good-Substrings"><a href="#C-The-Number-Of-Good-Substrings" class="headerlink" title="C.The Number Of Good Substrings"></a>C.The Number Of Good Substrings</h4><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®šä¸€ä¸ª01ä¸² s ï¼Œå‡è®¾ sub æ˜¯ s çš„å­ä¸²ï¼Œå®šä¹‰f(sub) = â€œsubåè¿›åˆ¶çš„å€¼â€ã€‚è‹¥f(sub) = len(sub)ï¼Œf(sub) = å­ä¸²subçš„é•¿åº¦ï¼Œé‚£ä¹ˆç§°subä¸ºâ€œä¼˜ç§€çš„å­ä¸²â€ã€‚<br>ç°åœ¨ç»™å®šå­—ç¬¦ä¸²sï¼Œè¯•æ±‚å‡ºsçš„â€œä¼˜ç§€çš„å­ä¸²â€çš„æ•°é‡ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>åˆšå¼€å§‹æƒ³ç”¨KMPç®—æ³•ï¼šå¯¹äºæ¯ä¸€å¯èƒ½çš„é•¿åº¦ï¼ˆå…±2e5ç§å¯èƒ½çš„æƒ…å†µï¼‰è½¬åŒ–ä¸ºäºŒè¿›åˆ¶çš„01ä¸²ï¼Œå†ç”¨KMPè®¡ç®—è¯¥ä¸²åœ¨ s ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œå°†æ‰€æœ‰æƒ…å†µç´¯åŠ å³ä¸ºç­”æ¡ˆã€‚<br>ä½†æ˜¯KMPè¶…æ—¶äº†ï¼Œè¿˜æ˜¯å¯¹KMPä¸å¤ªç†Ÿæ‚‰ï¼Œä¸Šè¿°ç®—æ³•å¤æ‚åº¦åº”è¯¥æ˜¯$O(N^2)$ï¼Œæ˜¯ä¸è¡Œçš„ã€‚</p><p>å†è€ƒè™‘ç”±äº$2^{20} &gt; 2e5$ æ‰€ä»¥æˆ‘ä»¬å…¶å®å¯ä»¥é€šè¿‡å°† s æ‰€æœ‰é•¿åº¦ä¸º [1 , 20] çš„å­ä¸²æŒ¨ä¸ªåˆ¤æ–­æ˜¯å¦ä¸ºâ€œä¼˜ç§€çš„å­ä¸²â€ï¼Œå¦‚æ­¤O(20N)æ—¶é—´å†…æ±‚å‡ºç»“æœã€‚å…·ä½“åšæ³•æ˜¯ä»å·¦å‘å³ï¼Œå°†ä¸Šä¸€ä¸ª 1 ä½œä¸ºå­ä¸²å·¦ç«¯ç‚¹ï¼Œç„¶åä¾æ¬¡å‘å³å»¶ç”³ï¼Œé•¿åº¦+1ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºåè¿›åˆ¶ï¼Œå¦‚æœè¯¥åè¿›åˆ¶è¦å¤§äºåŒºé—´é•¿åº¦ï¼Œåˆ™åç»­è‚¯å®šä¹Ÿä¸å¯èƒ½æ˜¯â€œä¼˜ç§€å­ä¸²â€ï¼Œæ•…é€€å‡ºã€‚èƒ½è¿™æ ·åšæ˜¯å› ä¸ºå·¦è¾¹çš„0ä¸å½±å“åè¿›åˆ¶æ•°çš„å¤§å°ï¼Œè€Œå³è¾¹çš„0å½±å“ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">typedef</span> __int64 ll;</span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> last = <span class="number">0</span>,x,l,len = <span class="built_in">strlen</span>(str); ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;str[i];i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(str[i] == <span class="string">'0'</span>) <span class="keyword">continue</span>; x = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = i;j &lt; len &amp;&amp; j &lt;= i+<span class="number">25</span>;j++)&#123;</span><br><span class="line">x = x*<span class="number">2</span>+str[j]-<span class="string">'0'</span>;</span><br><span class="line">l = j-x+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= last) <span class="keyword">break</span>;</span><br><span class="line">ans++;</span><br><span class="line">&#125;</span><br><span class="line">last = i+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--) &#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%I64d\n"</span>,solve());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="D-Coloring-Edges"><a href="#D-Coloring-Edges" class="headerlink" title="D.Coloring Edges"></a>D.Coloring Edges</h4><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®šä¸€ä¸ªæœ‰ n ä¸ªç‚¹ m æ¡è¾¹çš„æœ‰å‘å›¾ï¼Œè¯¥æœ‰å‘å›¾æ— è‡ªç¯æ— é‡è¾¹ã€‚æˆ‘ä»¬å¯¹è¯¥æœ‰å‘å›¾è¿›è¡ŒæŸ“è‰²ï¼Œä¸€ä¸ªå¥½çš„æŸ“è‰²æ–¹æ¡ˆå½“ä¸”ä»…å½“å›¾ä¸­æ²¡æœ‰ä¸€ä¸ªç¯æ˜¯åŒä¸€ä¸ªé¢œè‰²ã€‚è¯·é—®è¦æƒ³ä½¿å¾—è¯¥æŸ“è‰²æ–¹æ¡ˆæ˜¯å¥½çš„ï¼Œæœ€å°‘éœ€è¦å¤šå°‘ç§ä¸åŒçš„é¢œè‰²ï¼Ÿå¹¶è¾“å‡ºæ¯æ¡è¾¹çš„é¢œè‰²ã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>é¦–å…ˆé€šè¿‡æ‰‹ç”»å‡ ç§æ ·ä¾‹å¯ä»¥å¾—å‡ºï¼Œæˆ‘ä»¬æœ€å¤šåªéœ€è¦2ç§ä¸åŒçš„é¢œè‰²å°±å¯ä»¥å®Œæˆå›¾çš„ç€è‰²ã€‚å› æ­¤è‹¥å›¾ä¸­æœ‰ç¯ï¼Œåˆ™k = 2ï¼Œå¦åˆ™k = 1ã€‚è€Œå½“k = 2æ—¶ï¼Œå³å›¾ä¸­æœ‰ç¯ï¼Œéœ€è¦2ç§ä¸åŒé¢œè‰²æŸ“è‰²æ—¶ï¼Œæˆ‘ä»¬çŸ¥é“æœ‰å‘å›¾ä¸­ï¼Œè‹¥å­˜åœ¨ç¯ï¼Œåˆ™å¿…ç„¶æœ‰ä»ç¼–å·å°çš„ç‚¹æŒ‡å‘ç¼–å·å¤§çš„ç‚¹ï¼Œä¹Ÿæœ‰ç¼–å·å¤§çš„ç‚¹æŒ‡å‘ç¼–å·å°çš„ç‚¹ã€‚å› æ­¤ï¼Œè‹¥è¾¹u-&gt;vï¼Œè‹¥u &lt; våˆ™æŸ“é¢œè‰²1ï¼Œå¦åˆ™æŸ“é¢œè‰²2ï¼Œè¿™æ ·å¯ä»¥ä¿è¯è¯¥ç¯è¢«æ‹†åˆ†æˆä¸¤ç§é¢œè‰²ã€‚</p><p><em>æ³¨ï¼šè‹¥æœ‰å‘å›¾ä¸­ä¸å­˜åœ¨ç¯ï¼Œåˆ™ä¸ä¸€å®šæœ‰ â€œä»ç¼–å·å°çš„ç‚¹æŒ‡å‘ç¼–å·å¤§çš„ç‚¹ï¼ŒåŒæ—¶ä¹Ÿæœ‰ä»ç¼–å·å¤§çš„ç‚¹æŒ‡å‘ç¼–å·å°çš„ç‚¹ã€‚â€</em></p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e3</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],edge[N],ver[N],nex[N];</span><br><span class="line"><span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">ver[++tot] = y; nex[tot] = head[x];</span><br><span class="line">head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m,xx[N],yy[N];</span><br><span class="line"><span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">int</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(flag) <span class="keyword">return</span>;</span><br><span class="line">vis[x] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i];</span><br><span class="line"><span class="keyword">if</span>(vis[y] == <span class="number">1</span>)&#123;</span><br><span class="line">flag = <span class="literal">true</span>; <span class="keyword">return</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!vis[y]) dfs(y);</span><br><span class="line">&#125;</span><br><span class="line">vis[x] = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="keyword">if</span>(!vis[i]) dfs(i);</span><br><span class="line"><span class="keyword">if</span>(flag) &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"2"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(xx[i] &gt; yy[i]) <span class="built_in">printf</span>(<span class="string">"2 "</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"1 "</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"1"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++) <span class="built_in">printf</span>(<span class="string">"1 "</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;xx[i],&amp;yy[i]);</span><br><span class="line">addEdge(xx[i],yy[i]);</span><br><span class="line">&#125;</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hdu6629 string matchingï¼ˆæ‹“å±•KMPï¼‰</title>
      <link href="/2019/09/06/hdu6629-String-Match/"/>
      <url>/2019/09/06/hdu6629-String-Match/</url>
      
        <content type="html"><![CDATA[<p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6629" target="_blank" rel="noopener">hdu6629string matching</a><br><strong>Description:</strong><br>ç»™å‡ºä¸€ä¸ªå­—ç¬¦ä¸²Sï¼Œæˆ‘ä»¬æ‰§è¡Œâ€œæ±‚å‡ºSæ‰€æœ‰åç¼€ä¸Sçš„æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦â€è¿™ä¸ªæ“ä½œï¼Œæˆ‘ä»¬é‡‡å–æš´åŠ›ç®—æ³•(ç®—æ³•æµç¨‹è§é¢˜é¢)ï¼Œè¯·é—®æˆ‘ä»¬åœ¨è¯¥ç®—æ³•ä¸­å…±æ‰§è¡Œäº†å¤šå°‘æ¬¡æ¯”è¾ƒæ“ä½œï¼Ÿ<br><strong>Input:</strong><br>ç¬¬ä¸€è¡Œä¸€ä¸ªæ•´æ•°tï¼Œæ¥ä¸‹æ¥å…±tç»„æµ‹è¯•ç”¨ä¾‹ï¼Œæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹è¾“å…¥ä¸€ä¸ªé•¿åº¦å°äº1e6çš„å­—ç¬¦ä¸²Sã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>å¯ä»¥ç”¨æ‹“å±•KMPåšï¼Œå…¶ä¸­Sæ˜¯åŸä¸²ï¼ŒTä¹Ÿæ˜¯åŸä¸²ã€‚æš´åŠ›ç®—æ³•çš„æ¯”è¾ƒæ¬¡æ•°å°±ç­‰åŒäºæ‰€æœ‰åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦å’Œï¼Œè‹¥æ²¡æœ‰æ¯”åˆ°å­—ç¬¦ä¸²æœ«å°¾ï¼Œåˆ™è¿˜è¦åŠ ä¸Šä¸€æ¬¡å¤±é…çš„æ“ä½œæ¯”è¾ƒã€‚ç”±äºæœ¬é¢˜Tä¹Ÿæ˜¯Sï¼Œæ•…å¯ä»¥åœ¨è®¡ç®—nexæ•°ç»„çš„åŒæ—¶ä¾¿ç»Ÿè®¡ç­”æ¡ˆã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>; </span><br><span class="line"><span class="keyword">int</span> nex[N];<span class="comment">//nex[i] = T[i,n-1]ä¸T[0,n-1]æœ€é•¿å…¬å…±å‰ç¼€ </span></span><br><span class="line"><span class="keyword">char</span> S[N];<span class="comment">//Sä¸ºç›®æ ‡ä¸²,Tä¸ºæ¨¡å¼ä¸² </span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">char</span>* str)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(str) ,i = <span class="number">0</span>,j,p0 ;</span><br><span class="line">nex[<span class="number">0</span>] = len;</span><br><span class="line"><span class="keyword">while</span>(i+<span class="number">1</span> &lt; len &amp;&amp; str[i] == str[i+<span class="number">1</span>]) i++;</span><br><span class="line">nex[<span class="number">1</span>] = i; p0 = <span class="number">1</span>; ans += nex[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span>(nex[<span class="number">1</span>] != len<span class="number">-1</span>) ans++;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(nex[i-p0]+i &lt; nex[p0]+p0) nex[i] = nex[i-p0];</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">j = nex[p0]+p0-i;</span><br><span class="line"><span class="keyword">if</span>(j &lt; <span class="number">0</span>) j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(i+j &lt; len &amp;&amp; str[j] == str[j+i]) j++;</span><br><span class="line">nex[i] = j; p0 = i;</span><br><span class="line">&#125;</span><br><span class="line">ans += nex[i];</span><br><span class="line"><span class="keyword">if</span>(nex[i] != len-i) ans++;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*è®¡ç®—å¹¶è¿”å›ç­”æ¡ˆ*/</span></span><br><span class="line">ans = <span class="number">0</span>; getNex(S);</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,S);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,solve());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‹“å±•KMP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‹“å±•KMPç®—æ³•</title>
      <link href="/2019/09/06/exkmp/"/>
      <url>/2019/09/06/exkmp/</url>
      
        <content type="html"><![CDATA[<p><strong>é—®é¢˜æ¨¡å‹ï¼š</strong><br>ç»™å®šå­—ç¬¦ä¸²Så’Œå­ä¸²Tï¼ŒSçš„é•¿åº¦ä¸ºnï¼ŒTçš„é•¿åº¦ä¸ºmï¼›æ±‚å­—ç¬¦ä¸²Tä¸å­—ç¬¦ä¸²Sçš„æ¯ä¸€ä¸ªåç¼€dçš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚</p><h4 id="æ‹“å±•KMPç®—æ³•"><a href="#æ‹“å±•KMPç®—æ³•" class="headerlink" title="æ‹“å±•KMPç®—æ³•"></a>æ‹“å±•KMPç®—æ³•</h4><p>å‡è®¾ extend[] æ•°ç»„ï¼š extend[i] è¡¨ç¤º T ä¸ S[i, n] çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼Œç›®çš„æ˜¯æ±‚å‡ºæ‰€æœ‰çš„ extend[0~n-1]ã€‚<br>ï¼ˆæ³¨æ„åˆ°ï¼Œå¦‚æœå­˜åœ¨extend[i] = mï¼Œåˆ™è¯´æ˜ T åœ¨ S ä¸­å®Œå…¨å‡ºç°è¿‡ï¼Œé‚£ä¹ˆé—®é¢˜å°±å˜æˆæ ‡å‡†KMPç®—æ³•äº†ã€‚ï¼‰<br>æˆ‘ä»¬ä¸‹é¢çš„ç›®æ ‡å°±æ˜¯å¦‚ä½•åœ¨è¾ƒçŸ­çš„æ—¶é—´å†…æ›´æ–°extendæ•°ç»„ï¼›ä¸KMPç®—æ³•ç±»ä¼¼ï¼Œæˆ‘ä»¬é€šè¿‡åˆ©ç”¨nextæ•°ç»„æ¥é˜»æ­¢æŒ‡é’ˆçš„å›é€€ã€‚</p><p><strong>ä¸‹é¢å…ˆé€šè¿‡ä¸€èˆ¬çš„ä¾‹å­æ¥çœ‹æˆ‘ä»¬æ˜¯å¦‚ä½•æ›´æ–°extendæ•°ç»„çš„ï¼š</strong></p><p>S = â€œaaaabaaâ€ , T = â€œaaaaaâ€ã€‚</p><p>æ˜¾ç„¶extend[0] = 4ï¼Œæ˜¾ç„¶å½“åŒ¹é…åˆ°ç¬¬5ä¸ªæ—¶å¤±é…ï¼Œå…±åŒ¹é…äº†5æ¬¡ã€‚<br>æˆ‘ä»¬è€ƒè™‘åˆ©ç”¨å·²çŸ¥çš„ä¿¡æ¯æ¥è®¡ç®—extend[1]ï¼Œå·²çŸ¥S[1 , 3] = T[1 , 3]ï¼Œç°åœ¨è¦ç”¨S[1 , n-1]å’ŒT[0 , n-1]è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœæˆ‘ä»¬è®¾ nex[1] å­˜æ”¾ T[1 , n-1] ä¸ T[0 , n-1] çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼Œnex[1] = 4ï¼Œè¿™å°±è¯´æ˜<strong>å¯¹äºS[1, n-1]ï¼ŒT[1 , n-1]èƒ½åŒ¹é…ä¸Šçš„å­—ç¬¦ï¼ŒT[0,n-1]çš„å‰nex[1]ä¸ªä¹Ÿèƒ½åŒ¹é…çš„ä¸Š</strong>ï¼Œç”±äºT[1,n-1]åªèƒ½åŒ¹é…S[1 , 3]å…±3ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆæ˜¾ç„¶å‰ 3 ä¸ªå­—ç¬¦éƒ½å¯ä»¥æˆåŠŸåŒ¹é…ï¼Œæˆ‘ä»¬ç›´æ¥åŒ¹é…ä¸‹ä¸€ä½å³å¯ï¼›äºæ˜¯extend[1] = 3ã€‚</p><h4 id="ç®—æ³•æ­¥éª¤"><a href="#ç®—æ³•æ­¥éª¤" class="headerlink" title="ç®—æ³•æ­¥éª¤"></a>ç®—æ³•æ­¥éª¤</h4><p><strong>å®šä¹‰extend[]æ•°ç»„ï¼š</strong> extend[i] è¡¨ç¤ºå­—ç¬¦ä¸² T ä¸å­—ç¬¦ä¸² S[i , n] çš„æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦ã€‚<br><strong>å®šä¹‰nex[]æ•°ç»„ï¼š</strong> nex[i] è¡¨ç¤º T[i , n] ä¸ T[1 , n] çš„æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬ä»å·¦åˆ°å³è®¡ç®—extendæ•°ç»„ï¼Œå‡è®¾åœ¨æŸä¸€æ—¶åˆ» extend[0 , k] å·²ç»è®¡ç®—å®Œæ¯•ï¼Œå¹¶ä¸”ä¹‹å‰åŒ¹é…è¿‡ç¨‹ä¸­æ‰€è¾¾åˆ°çš„æœ€è¿œè·ç¦»ä¸ºpï¼Œæ‰€è°“æœ€è¿œè·ç¦»å³ p = MAX{ i+extend[i]  (0 &lt;= i &lt;= k) } çš„æœ€å¤§å€¼ï¼Œpâ€™ ä¸ºè¾¾åˆ°æœ€è¿œè·ç¦»æ—¶çš„ i ã€‚</p><p><strong>ç°åœ¨æ¥åˆ©ç”¨å·²çŸ¥çš„ä¿¡æ¯æ±‚extend[k+1]ï¼š</strong><br>å·²çŸ¥S[pâ€™ , p] = T[0, p-pâ€™]ï¼Œå³S[k+1 , p] = T[k+1 - pâ€™ , p-pâ€™]ã€‚<br>è®¾ len = nex[k+1 - pâ€™] ï¼Œå³ len ä¸º T[k+1 - pâ€™ , n-1] ä¸ T[0 , n-1]çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚</p><ul><li>å¦‚æœk+len &lt; pï¼Œåˆ™extend[k+1] = lenï¼š<br>æ­¤æ—¶ç”±äºå·²çŸ¥æ¡ä»¶ ä»¥åŠ nexæ•°ç»„æ€§è´¨ï¼Œå¯ä»¥çŸ¥é“å‰ len ä¸ªå­—ç¬¦ä¸€å®šæ˜¯åŒ¹é…çš„ã€‚è‹¥S[k+ len+1] = T[len]ï¼Œåˆ™è¯´æ˜ nex æ˜¯len+1è€Œélenï¼Œäºæ˜¯ä¸nexæ•°ç»„çŸ›ç›¾ï¼Œæ•…ä¸æˆç«‹ï¼›å› æ­¤è‹¥k+len &lt; pï¼Œåˆ™extend[k+1] = lenã€‚</li></ul><p><img src="/2019/09/06/exkmp/1.png" alt="1"><br>(å›¾1ï¼šå½“k+len&lt;pæ—¶æƒ…å½¢ï¼Œå…¶ä¸­po = pâ€™ï¼Œå›¾ç‰‡æ¥è‡ª <em>dyxå¿ƒå¿ƒ</em> çš„åšå®¢)</p><ul><li>è‹¥k+len &gt;= pï¼š<br>æ­¤æ—¶å·²çŸ¥çš„æ˜¯S[k+1 , p] = T[0 , p-k-1]ï¼Œä½†æ˜¯ S[p+1] æ˜¯å¦ç­‰åŒäº T[p-k] å°šä¸”æœªçŸ¥ï¼Œå› æ­¤éœ€è¦å‘åéå†åˆ¤æ–­ï¼ŒåŒæ—¶æ›´æ–°pä¸pâ€™ã€‚</li></ul><p><img src="/2019/09/06/exkmp/2.png" alt="2"><br>(å›¾2ï¼šå½“k+len &gt;= pæ—¶æƒ…å½¢ï¼Œå…¶ä¸­po = pâ€™ï¼Œå›¾ç‰‡æ¥è‡ª <em>dyxå¿ƒå¿ƒ</em> çš„åšå®¢)</p><p>å¯¹äºnexæ•°ç»„ï¼Œå…¶æ±‚æ³•å’Œextendæ•°ç»„ç±»ä¼¼ï¼Œè¯¦æƒ…å‚è€ƒä»£ç ä¸­getNex()å‡½æ•°å®ç°æ–¹æ³•ã€‚</p><h4 id="ä¾‹é¢˜æ¨¡æ¿"><a href="#ä¾‹é¢˜æ¨¡æ¿" class="headerlink" title="ä¾‹é¢˜æ¨¡æ¿"></a>ä¾‹é¢˜æ¨¡æ¿</h4><p><a href="https://www.luogu.org/problem/P5410" target="_blank" rel="noopener">æ´›è°·P5410æ‹“å±•KMPæ¨¡æ¿</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®šå­—ç¬¦ä¸²Så’ŒTï¼Œè¾“å‡ºnextæ•°ç»„ä»¥åŠextendæ•°ç»„ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>; </span><br><span class="line"><span class="keyword">int</span> nex[N];<span class="comment">//nex[i] = T[i,n-1]ä¸T[0,n-1]æœ€é•¿å…¬å…±å‰ç¼€ </span></span><br><span class="line"><span class="keyword">char</span> S[N],T[N]; <span class="comment">//Sä¸ºç›®æ ‡ä¸²,Tä¸ºæ¨¡å¼ä¸² </span></span><br><span class="line"><span class="keyword">int</span> extend[N]; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNex</span><span class="params">(<span class="keyword">char</span>* str)</span></span>&#123;</span><br><span class="line"><span class="comment">/*è®¡ç®—nexæ•°ç»„*/</span></span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(str) ,i = <span class="number">0</span>, j, p0 ;</span><br><span class="line">nex[<span class="number">0</span>] = len;</span><br><span class="line"><span class="keyword">while</span>(i+<span class="number">1</span> &lt; len &amp;&amp; str[i] == str[i+<span class="number">1</span>]) i++;</span><br><span class="line">nex[<span class="number">1</span>] = i; p0 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; len;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(nex[i-p0]+i &lt; nex[p0]+p0) nex[i] = nex[i-p0];</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">j = nex[p0]+p0-i;</span><br><span class="line"><span class="keyword">if</span>(j &lt; <span class="number">0</span>) j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(i+j &lt; len &amp;&amp; str[j] == str[j+i]) j++;</span><br><span class="line">nex[i] = j; p0 = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exKMP</span><span class="params">(<span class="keyword">char</span>* str1,<span class="keyword">char</span> *str2)</span></span>&#123;</span><br><span class="line"><span class="comment">/*è®¡ç®—str2ä¸str1çš„æ‰€æœ‰åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦,å­˜æ”¾åœ¨extendæ•°ç»„ä¸­*/</span> </span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>,j,p0,l1 = <span class="built_in">strlen</span>(S), l2 = <span class="built_in">strlen</span>(T);</span><br><span class="line">getNex(str2);</span><br><span class="line"><span class="keyword">while</span>(i &lt; l1 &amp;&amp; i &lt; l2 &amp;&amp; str1[i] == str2[i]) i++;</span><br><span class="line">extend[<span class="number">0</span>] = i;p0 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; l1;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(nex[i-p0]+i &lt; extend[p0]+p0) extend[i] = nex[i-p0];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">j = extend[p0]+p0-i;</span><br><span class="line"><span class="keyword">if</span>(j &lt; <span class="number">0</span>) j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(i+j &lt; l1 &amp;&amp; j &lt; l2 &amp;&amp; str1[j+i] == str2[j]) j++;</span><br><span class="line">extend[i] = j; p0 = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*è®¡ç®—å¹¶è¾“å‡ºç­”æ¡ˆ*/</span></span><br><span class="line"><span class="keyword">int</span> l1 = <span class="built_in">strlen</span>(S), l2 = <span class="built_in">strlen</span>(T);</span><br><span class="line">exKMP(S,T);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; l2;i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>,nex[i]);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; l1;i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>,extend[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s%s"</span>,S,T);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li><a href="https://blog.csdn.net/dyx404514/article/details/41831947#commentBox" target="_blank" rel="noopener">dyxå¿ƒå¿ƒçš„åšå®¢</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
            <tag> æ‹“å±•KMP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hdu6638 Snowy Smile-çº¿æ®µæ ‘ç»´æŠ¤æœ€å¤§å­çŸ©é˜µ</title>
      <link href="/2019/09/03/hdu6638-Snowy-Smile/"/>
      <url>/2019/09/03/hdu6638-Snowy-Smile/</url>
      
        <content type="html"><![CDATA[<p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6638" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><h4 id="Snowy-Smile"><a href="#Snowy-Smile" class="headerlink" title="Snowy Smile"></a>Snowy Smile</h4><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å‡ºå¹³é¢ä¸Šn(n &lt;= 2000)ä¸ªç‚¹ï¼Œç‚¹çš„åæ ‡åœ¨-1e9~1e9ä¹‹é—´ï¼Œè¯•æ±‚å‡ºæœ€å¤§å­çŸ©é˜µçš„å’Œæ˜¯å¤šå°‘ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è€ƒè™‘æ•°æ®èŒƒå›´ï¼Œ2e3ä¸ªç‚¹ç¦»æ•£åŒ–åå¯èƒ½ä¼šæœ‰2e3ä¸ªï¼Œæœ¬é¢˜ä¸­å„ä¸ªç‚¹æ˜¯ç¦»æ•£çš„ï¼Œæ‰€ä»¥ç”¨æ™®é€šçš„åŠ¨æ€è§„åˆ’æ¯”è¾ƒéº»çƒ¦ï¼Œå› æ­¤æœ¬é¢˜é‡‡ç”¨$O(N^2log_2N)$çš„çº¿æ®µæ ‘+æšä¸¾ã€‚<br>æˆ‘ä»¬å¯¹xï¼Œæšä¸¾æ‰€æœ‰å¯èƒ½çš„x[i]å’Œx[j]å…¶ä¸­x[i]ä¸ºä¸Šç•Œï¼Œx[j]ä¸ºä¸‹ç•Œï¼Œè¿™ä¸ªæšä¸¾èŠ±è´¹æ—¶é—´ä¸º$O(N^2)$ï¼Œè€Œå¯¹äºæ¯ä¸€ç§å¯èƒ½çš„ç»„åˆï¼Œå†åˆ©ç”¨çº¿æ®µæ ‘$O(log_2N)$æ±‚å‡ºæœ€å¤§è¿ç»­å­æ®µå’Œï¼Œå› æ­¤æ€»æ—¶é—´$O(N^2log_2N)$ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3010</span>;</span><br><span class="line"><span class="keyword">int</span> t,n;</span><br><span class="line"><span class="keyword">int</span> tmp[N];<span class="comment">//ç¦»æ•£åŒ–ç”¨</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Chest</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> x,y,val;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> Chest &amp; B) <span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> x &lt; B.x;</span><br><span class="line">&#125;</span><br><span class="line">&#125;cs[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line"><span class="comment">/*åˆ†åˆ«ä¸ºåŒºé—´å’Œ,åŒºé—´æœ€å¤§å­æ®µå’Œ,</span></span><br><span class="line"><span class="comment">ä»å·¦ä¾§å¼€å§‹çš„æœ€å¤§å­æ®µå’Œ,ä»å³ä¾§å¼€å§‹çš„æœ€å¤§å­æ®µå’Œ*/</span></span><br><span class="line">ll sum,mx,lx,rx; </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(x) tr[x].sum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mx(x) tr[x].mx</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lx(x) tr[x].lx</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rx(x) tr[x].rx </span></span><br><span class="line">&#125;tr[N*<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">/*åœ¨åŒºé—´[l,r]ä¸Šå»ºç«‹ä¸€æ£µçº¿æ®µæ ‘*/</span></span><br><span class="line">sum(rt) = mx(rt) = lx(rt) = rx(rt) = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">BuildTree(rt*<span class="number">2</span>,l,mid);</span><br><span class="line">BuildTree(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spread</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line"><span class="comment">/*ç”¨äºæ ¹æ®rtçš„å­èŠ‚ç‚¹æ›´æ–°rtçš„4ä¸ªæ•°æ®*/</span></span><br><span class="line">sum(rt) = sum(rt*<span class="number">2</span>)+sum(rt*<span class="number">2</span>+<span class="number">1</span>);</span><br><span class="line">mx(rt) = max(rx(rt*<span class="number">2</span>)+lx(rt*<span class="number">2</span>+<span class="number">1</span>),max(mx(rt*<span class="number">2</span>),mx(rt*<span class="number">2</span>+<span class="number">1</span>)));</span><br><span class="line">lx(rt) = max(lx(rt*<span class="number">2</span>),sum(rt*<span class="number">2</span>)+lx(rt*<span class="number">2</span>+<span class="number">1</span>));</span><br><span class="line">rx(rt) = max(rx(rt*<span class="number">2</span>+<span class="number">1</span>),sum(rt*<span class="number">2</span>+<span class="number">1</span>)+rx(rt*<span class="number">2</span>));</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> p,<span class="keyword">int</span> val,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å°†çº¿æ®µæ ‘pä½ç½®çš„å€¼è®¾ä¸ºval;l,ræ˜¯è¾…åŠ©ä½œç”¨å“¦*/</span></span><br><span class="line"><span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">sum(rt) += val;</span><br><span class="line">lx(rt) = rx(rt) = mx(rt) = sum(rt); </span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(p &lt;= mid) Insert(rt*<span class="number">2</span>,p,val,l,mid);</span><br><span class="line"><span class="keyword">else</span> Insert(rt*<span class="number">2</span>+<span class="number">1</span>,p,val,mid+<span class="number">1</span>,r);</span><br><span class="line">spread(rt);<span class="comment">//åœ¨å›æº¯æ—¶æ›´æ–°èŠ‚ç‚¹çš„å€¼ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*è¿”å›å½“å‰æœ€å¤§è¿ç»­å­æ®µå’Œ*/</span></span><br><span class="line"><span class="keyword">return</span>  tr[<span class="number">1</span>].mx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">sort(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+n);</span><br><span class="line"><span class="keyword">int</span> cnt = unique(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+n)-tmp<span class="number">-1</span>;</span><br><span class="line">sort(cs+<span class="number">1</span>,cs+<span class="number">1</span>+n);</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="comment">/*æˆ‘ä»¬å¯¹æ¯ä¸€ä¸ªx[i]ä¸Šé™,æšä¸¾æ‰€æœ‰å¯èƒ½x[j]çš„ä¸‹é™,</span></span><br><span class="line"><span class="comment">å¹¶åˆ©ç”¨çº¿æ®µæ ‘æ±‚å‡ºx[i]~x[j]æœ€å¤§å­—æ®µå’Œ*/</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(cs[i].x == cs[i<span class="number">-1</span>].x &amp;&amp; i != <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">BuildTree(<span class="number">1</span>,<span class="number">1</span>,cnt);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = i;j &lt;= n;j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(cs[j].x != cs[j<span class="number">-1</span>].x &amp;&amp; i != j) ans = max(ans,ask());</span><br><span class="line"><span class="keyword">int</span> y = lower_bound(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+cnt,cs[j].y)-tmp;</span><br><span class="line">Insert(<span class="number">1</span>,y,cs[j].val,<span class="number">1</span>,cnt);</span><br><span class="line">&#125;</span><br><span class="line">ans = max(ans,ask());<span class="comment">//å¦‚æœå…¨éƒ¨ç›¸ç­‰,åœ¨æ­¤å¤„ç‰¹åˆ¤ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;cs[i].x,&amp;cs[i].y,&amp;cs[i].val);</span><br><span class="line">tmp[i] = cs[i].y;</span><br><span class="line">&#125;</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> æœ€å¤§å­çŸ©é˜µ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019èˆªç”µå¤šæ ¡7éƒ¨åˆ†é¢˜è§£</title>
      <link href="/2019/09/02/hdu7/"/>
      <url>/2019/09/02/hdu7/</url>
      
        <content type="html"><![CDATA[<h4 id="A-A-B-C"><a href="#A-A-B-C" class="headerlink" title="A. A + B = C"></a>A. <a href="http://acm.hdu.edu.cn/showproblem.php?pid=6646" target="_blank" rel="noopener">A + B = C</a></h4><p>æœ‰ç©ºå†å†™ï¼Œéº»çƒ¦æ­»äº†ã€‚</p><h4 id="F-Final-Exam"><a href="#F-Final-Exam" class="headerlink" title="F. Final Exam"></a>F. <a href="http://acm.hdu.edu.cn/showproblem.php?pid=6651" target="_blank" rel="noopener">Final Exam</a></h4><p><strong>é¢˜æ„ç®€è¿°</strong><br>é¢˜æ„æœ‰ç‚¹ç»•ï¼Œä¸€ä»½è€ƒè¯•æ€»åˆ†ä¸ºmåˆ†né“é¢˜ï¼Œæ¯é“é¢˜å¯èƒ½ä¸º n ç±»ç§‘ç›®ä¸­çš„ä¸€ç±»ã€‚å¦‚æœæˆ‘ä»¬æƒ³åšå‡ºä¸€é“åˆ†å€¼ä¸º a çš„é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‡³å°‘è¦å¤ä¹ è¯¥é¢˜æ‰€åœ¨çš„ç§‘ç›® a+1 åˆ†é’Ÿä»¥ä¸Šã€‚è¯·é—®å¦‚æœæˆ‘ä»¬è¦æƒ³æœ€å°‘åšå‡ºké¢˜ï¼Œéœ€è¦èŠ±å¤šé•¿æ—¶é—´ï¼Ÿ</p><p><strong>è§£é¢˜æ€è·¯:</strong><br>é¦–å…ˆææ¸…é¢˜æ„ï¼Œå°±æ˜¯æˆ‘ä»¬ç›®æ ‡æ˜¯æœ€å°‘åšå‡ºké¢˜éœ€è¦èŠ±è´¹çš„æœ€å°‘æ—¶é—´ï¼Œé‚£ä¹ˆæœ€åæƒ…å†µå°±æ˜¯è€å¸ˆé’ˆå¯¹æˆ‘ä»¬ï¼Œå‡ºæˆ‘ä»¬å¤ä¹ æ—¶é—´æœ€å°‘çš„n - k + 1é“é¢˜ï¼Œä»¤æ¯é“é¢˜éƒ½ç­‰äºè¯¥å­¦ç”Ÿå¤ä¹ çš„æ—¶é—´ï¼ˆå› ä¸ºæ€»åˆ†ç¡®å®šï¼Œè¿™æ ·æ‰æœ€ä¼˜ï¼‰ã€‚é‚£ä¹ˆå¦‚æœæˆ‘æƒ³é€šè¿‡ï¼Œé‚£å°±è¦ä»¤è‡ªå·±å¤ä¹ æ—¶é—´æœ€å°‘çš„n-k+1é—¨ç§‘ç›®å¤ä¹ æ€»æ—¶é—´ &gt; mï¼Œè¿™æ ·è€å¸ˆå°±æ— è®ºå¦‚ä½•ä¹Ÿé’ˆå¯¹ä¸äº†æˆ‘äº†ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line">ll n,m,k;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> tmp = n-k+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> b = m/tmp + <span class="number">1</span>;</span><br><span class="line">ll ans = (k<span class="number">-1</span>)*b + m+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>,&amp;n,&amp;m,&amp;k);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="K-Kejin-Player"><a href="#K-Kejin-Player" class="headerlink" title="K. Kejin Player"></a>K. <a href="http://acm.hdu.edu.cn/showproblem.php?pid=6656" target="_blank" rel="noopener">Kejin Player</a></h4><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>æ»¡çº§ä¸ºn+1çº§ï¼Œä»ç¬¬ i çº§å‡åˆ° i+1 çº§éœ€è¦a[i]é‡‘å¸ï¼ŒæˆåŠŸå‡ ç‡ä¸ºr[i] / s[i] ï¼Œå¦‚æœæˆåŠŸåˆ™ç­‰çº§ä»iå˜ä¸ºi+1ï¼Œå¤±è´¥åˆ™ç­‰çº§ä» i å˜ä¸º x[i] ï¼ˆx[i] &lt;= iï¼‰ã€‚<br>è¯·é—®ä»lå‡åˆ°rçº§ï¼Œéœ€è¦å¤šå°‘é‡‘å¸ï¼Ÿ<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è¿™æ˜¯ä¸€é“æ¦‚ç‡dpé¢˜ï¼Œä¸”æ¦‚ç‡å¯ä»¥åŠ å‡ï¼Œè®¾f[ x ] ä¸ºä»1çº§å‡åˆ°xçº§éœ€è¦çš„é‡‘å¸ï¼Œé‚£ä¹ˆä»lçº§å‡åˆ°rçº§éœ€è¦f[r] - f[l]é‡‘å¸ã€‚è¿™æ˜¯å› ä¸ºå‡åˆ°æŸä¸€çº§éœ€è¦çš„é‡‘å¸æ•°æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æ»¡è¶³åŠ å‡åŸåˆ™ã€‚<br>åŠ é€Ÿæˆ‘ä»¬å½“å‰åœ¨ i çº§ï¼Œæœ‰ p çš„æ¦‚ç‡èŠ±è´¹a[i]é‡‘å¸å‡åˆ° i+1 çº§ï¼Œå‡è®¾æˆ‘ä»¬å°è¯•äº†tæ¬¡æ‰å‡çº§æˆåŠŸï¼Œå³ï¼š </p><script type="math/tex; mode=display">f[i+1] = f[i] + a[i]  + (t - 1) * a[i] + (t - 1) * (f[ i ] - f[ x[i] ])</script><p>åˆå› ä¸º$\frac{t-1}{t} = p$ï¼Œå¾—$t = \frac{s[i]}{r[i]}$ï¼Œå¸¦å…¥å¾—ï¼š</p><script type="math/tex; mode=display">f[i+1] = f[i] +  \frac{s[i]}{r[i]} * a[i] + (\frac{s[i]}{r[i]} - 1) * (f[ i ] - f[ x[i] ])</script><p>é‡åˆ°è¿™ç§æ¦‚ç‡é¢˜ï¼Œè®¾è¯•äº†tæ¬¡æ‰æˆåŠŸï¼Œç„¶åç”¨æ¦‚ç‡è¡¨ç¤º t å³å¯å¾—å‡ºé€’æ¨å…¬å¼ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll r[N],s[N],x[N],a[N];<span class="comment">//p = r/s</span></span><br><span class="line"><span class="keyword">int</span> t,n,q;</span><br><span class="line"><span class="keyword">const</span> ll P = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">ll f[N];</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b,ll m)</span></span>&#123;</span><br><span class="line">ll res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(b)&#123;</span><br><span class="line"><span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = res*a%m;</span><br><span class="line">a = a*a%m;</span><br><span class="line">b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*é¢„å¤„ç†å‡ºæ‰€æœ‰ç­”æ¡ˆ*/</span> </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">ll pp = s[i]*qpow(r[i],P<span class="number">-2</span>,P)%P; <span class="comment">//s[i]/r[i]çš„é€†å…ƒ </span></span><br><span class="line">f[i+<span class="number">1</span>] = (f[i] + pp*a[i]%P </span><br><span class="line">+ (pp<span class="number">-1</span>)*(f[i]-f[x[i]])%P+P)%P;</span><br><span class="line"><span class="comment">//printf("%lld\n",f[i+1]);</span></span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;q);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) </span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld%lld"</span>,r+i,s+i,x+i,a+i);</span><br><span class="line">solve();<span class="comment">//ç¦»çº¿ </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,tl,tr;i &lt;= q;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;tl,&amp;tr);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,(f[tr]-f[tl]+P)%P);</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åšå¼ˆè®º </tag>
            
            <tag> æ¦‚ç‡dp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‹“å±•æ¬§æ‹‰å®šç†+å¹‚å¡”å‡½æ•°</title>
      <link href="/2019/09/02/exphi/"/>
      <url>/2019/09/02/exphi/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‹“å±•æ¬§æ‹‰å®šç†ä¸å¹‚å¡”å‡½æ•°"><a href="#æ‹“å±•æ¬§æ‹‰å®šç†ä¸å¹‚å¡”å‡½æ•°" class="headerlink" title="æ‹“å±•æ¬§æ‹‰å®šç†ä¸å¹‚å¡”å‡½æ•°"></a>æ‹“å±•æ¬§æ‹‰å®šç†ä¸å¹‚å¡”å‡½æ•°</h4><p><strong>æ¬§æ‹‰å®šç†ï¼š</strong> è‹¥gcd(a,p) = 1ï¼Œåˆ™ $a^p \equiv a^{b \% \varphi (p)}(mod \: p)$ï¼Œå…¶ä¸­gcd(a,p) = 1ã€‚<br><strong>æ‹“å±•æ¬§æ‹‰å®šç†ï¼š</strong> å‡è®¾aä¸ºä»»æ„æ•°ï¼Œbå’Œmä¸ºæ­£æ•´æ•°ï¼Œä¸”$b &gt; \varphi(m)$ï¼Œaå’Œmä¸ä¸€å®šè¦äº’è´¨ï¼Œé‚£ä¹ˆæœ‰å¦‚ä¸‹å…¬å¼ï¼š</p><script type="math/tex; mode=display">a^b~\equiv~\begin{cases}a^{b~Mod~\phi(m)} &\gcd(a,m)~=~1 \\a^b &\gcd(a,m)~\neq~1~\land~b~<~\phi(m) \\ a^{b~Mod~\phi(m)~+~\phi(m)} &\gcd(a,m)~\neq~1~\land~b~\geq~\phi(m)\end{cases} \:\:(Mod\: m)</script><p><em>æ³¨ï¼šæ‹“å±•æ¬§æ‹‰å®šç†çš„è¯æ˜å¯ä»¥å‚è€ƒ<a href="https://zhuanlan.zhihu.com/p/24902174" target="_blank" rel="noopener">è¯æ˜</a></em></p><p><strong>å¹‚å¡”å‡½æ•°</strong>ï¼š å½¢å¦‚</p><script type="math/tex; mode=display">a^{a^{a^{...}}} mod \: m</script><p>çš„å‡½æ•°æˆ‘ä»¬ç§°ä¸ºå¹‚å¡”å‡½æ•°ï¼Œè¯¥å‡½æ•°åº”ä»ä¸Šå‘ä¸‹è®¡ç®—ï¼Œå³$a^{a^{a^a}} = a^{(a^{({a^a})})}$ï¼Œå› æ­¤å…¶ä¸­é—´å˜é‡ä¼šæ€¥å‰§ä¸Šå‡ï¼Œæ™®é€šæ–¹æ³•æ— æ³•è®¡ç®—ã€‚</p><h4 id="ä¾‹é¢˜ï¼š2019å—äº¬icpcç½‘ç»œèµ›-B-Super-Log"><a href="#ä¾‹é¢˜ï¼š2019å—äº¬icpcç½‘ç»œèµ›-B-Super-Log" class="headerlink" title="ä¾‹é¢˜ï¼š2019å—äº¬icpcç½‘ç»œèµ› B.Super_Log"></a>ä¾‹é¢˜ï¼š2019å—äº¬icpcç½‘ç»œèµ› B.Super_Log</h4><p><a href="https://nanti.jisuanke.com/t/41299" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®šaå’Œkä»¥åŠmï¼Œè¯•æ±‚å‡º</p><script type="math/tex; mode=display">a^{a^{a^{...}}} mod \: m</script><p>å…¶ä¸­å…±kå±‚å¹‚å¡”ã€‚å…¶ä¸­aï¼Œkå’Œmå°äºç­‰äº1e6ã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>é¦–å…ˆä½¿ç”¨æ‹“å±•æ¬§æ‹‰å®šç†éœ€è¦ $b &gt; \varphi(m)$ï¼Œæ‰€ä»¥å¯¹äºä¸åŒçš„bè¦åˆ†ç±»è®¨è®ºä¸€ä¸‹ã€‚è®¾</p><script type="math/tex; mode=display">f(a,k,m) = a^{a^{a^{...}}} \% m</script><p>å…¶ä¸­aæ˜¯æœ‰kå±‚çš„å¹‚å¡”ã€‚</p><ol><li>é¦–å…ˆï¼Œå½“a = 1æˆ–è€…b = 0æ—¶ç‰¹åˆ¤ï¼Œå¾—å‡ºç­”æ¡ˆä¸º 1%mã€‚</li><li>æœ¬é¢˜ä¸­b = f(a, k-1,INF)ï¼Œå¦‚æœa &gt;= phi(m)ï¼Œé‚£ä¹ˆæ˜¾ç„¶bä¸€å®šå¤§äºphi(m)ï¼Œå³æ»¡è¶³æ‹“å±•æ¬§æ‹‰å®šç†ä¸­ç¬¬3ç§æƒ…å†µï¼›</li><li>å¦‚æœk = 1ï¼Œåˆ™b = f(a,k-1,INF) = 1ï¼Œæ­¤æ—¶åªéœ€åˆ¤æ–­phi(m)æ˜¯å¦å¤§äº1å³å¯åˆ¤æ–­å½“ç„¶æƒ…å†µç¬¦åˆæ‹“å±•æ¬§æ‹‰å®šç†ç¬¬3è¿˜æ˜¯ç¬¬2ç§æƒ…å†µã€‚</li><li>å‰©ä¸‹çš„æƒ…å†µæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡é€’å½’æ¥åˆ¤æ–­bæ˜¯å¦å¤§äºphi(m)ï¼Œå› ä¸ºè‹¥b &gt;= phi(m)ï¼Œé‚£ä¹ˆ$log_ab &gt;= log_a phi(m)$</li></ol><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b,ll m)</span></span>&#123;</span><br><span class="line">ll res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(b)&#123;</span><br><span class="line"><span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = res*a%m;</span><br><span class="line">a = a*a%m;</span><br><span class="line">b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> v[N],primes[N],phi[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; N;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!v[i])&#123;</span><br><span class="line">primes[cnt++] = i;</span><br><span class="line">v[i] = i;</span><br><span class="line">phi[i] = i<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; cnt;j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(primes[j] &gt; v[i] || primes[j]*i &gt;= N)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">v[i*primes[j]] = primes[j];</span><br><span class="line">phi[i*primes[j]] = phi[i]*(i%primes[j] ? primes[j]<span class="number">-1</span> : primes[j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(b == <span class="number">0</span>) <span class="keyword">return</span> a;</span><br><span class="line"><span class="keyword">return</span> gcd(b,a%b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(ll a,ll b,ll p)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(b == <span class="number">0</span>) <span class="keyword">return</span> p &lt;= <span class="number">1</span>;<span class="comment">//f(a,0,p) = 1</span></span><br><span class="line"><span class="keyword">if</span>(a &gt;= p) <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//f(a,b,INF) &gt; p</span></span><br><span class="line"><span class="keyword">return</span> check(a,b<span class="number">-1</span>,<span class="built_in">log</span>(p)/<span class="built_in">log</span>(a)); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll a,ll b,ll m)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(m == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//é€’å½’ç»ˆæ­¢æ¡ä»¶1,æ­¤æ—¶ä¹‹åç­”æ¡ˆæ’ä¸º0 </span></span><br><span class="line"><span class="keyword">if</span>(b &lt;= <span class="number">1</span>) <span class="keyword">return</span> qpow(a,b,m);<span class="comment">//é€’å½’ç»ˆæ­¢æ¡ä»¶2 </span></span><br><span class="line">ll ph = phi[m];</span><br><span class="line"><span class="comment">//printf("%lld\n",ph);</span></span><br><span class="line"><span class="keyword">if</span>(gcd(a,m) == <span class="number">1</span>) <span class="keyword">return</span> qpow(a,f(a,b<span class="number">-1</span>,ph),m);<span class="comment">//æ¬§æ‹‰å®šç† </span></span><br><span class="line"><span class="keyword">if</span>(check(a,b<span class="number">-1</span>,ph)) <span class="keyword">return</span> qpow(a,f(a,b<span class="number">-1</span>,ph)+ph,m);<span class="comment">//æ‹“å±•æ¬§æ‹‰å®šç†æƒ…å†µ1 </span></span><br><span class="line"><span class="keyword">return</span> qpow(a,f(a,b<span class="number">-1</span>,ph),m); <span class="comment">//æ‹“å±•æ¬§æ‹‰å®šç†æƒ…å†µ2 </span></span><br><span class="line">&#125;</span><br><span class="line">ll a,b,m;</span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>,&amp;a,&amp;b,&amp;m);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f(a,b,m));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li><a href="https://www.cnblogs.com/SovietPower/p/8353374.html" target="_blank" rel="noopener">SovietPowerçš„åšå®¢</a></li><li>ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹,æç…œä¸œ,P142-143.</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°è®º </tag>
            
            <tag> å¹‚å¡”å‡½æ•° </tag>
            
            <tag> æ‹“å±•æ¬§æ‹‰å®šç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2018å—äº¬icpcç½‘ç»œèµ›</title>
      <link href="/2019/08/30/2018nanjing/"/>
      <url>/2019/08/30/2018nanjing/</url>
      
        <content type="html"><![CDATA[<p>æœ‰å—²éš¾ï¼Œè¿˜æœ‰äº›å¡æ—¶ï¼Œæ€è·¯è¿˜æœ‰äº›éš¾æƒ³ï¼Œè™½ç„¶éƒ½æ˜¯ç»å…¸æ¨¡å‹ã€‚</p><h4 id="A-An-Olympian-Math-Problem"><a href="#A-An-Olympian-Math-Problem" class="headerlink" title="A. An Olympian Math Problem"></a>A. An Olympian Math Problem</h4><p><a href="https://nanti.jisuanke.com/t/A1947" target="_blank" rel="noopener">åŸé¢˜é“¾æ¥</a><br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>å¦‚æœæ˜¯æ¯”èµ›æ—¶æˆ‘ä¼°è®¡ä¼šæ¨å…¬å¼ï¼Œä½†åœ¨è¿™é€šè¿‡ç‡é¢å‰ï¼Œæˆ‘çŒœäº†ä¸ªå…¬å¼å°±äº¤äº†ï¼Œç„¶åè¿‡äº†ã€‚ç­”æ¡ˆå°±æ˜¯n-1ã€‚</p><h4 id="E-AC-Challenge"><a href="#E-AC-Challenge" class="headerlink" title="E. AC Challenge"></a>E. AC Challenge</h4><p><a href="https://nanti.jisuanke.com/t/A1951" target="_blank" rel="noopener">åŸé¢˜é“¾æ¥</a><br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>çŠ¶å‹dpï¼Œè¿™ç±»é¢˜åšçš„å¾ˆå°‘ï¼Œæ²¡å¿˜è¿™æ–¹é¢æƒ³ã€‚å¼€å§‹ç”¨çš„æ‹“æ‰‘æ’åºï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾æ²¡æœ‰è€ƒè™‘åˆ°æ‰€æœ‰æƒ…å†µã€‚ç”¨çŠ¶å‹çš„è¯ï¼Œå°±è¿™é¢˜è€Œè¨€ï¼Œæ˜¯éœ€è¦å…ˆåˆ¤æ–­å½“å‰çŠ¶æ€æ˜¯å¦åˆæ³•ï¼Œåˆ¤æ–­å®Œä¹‹åå†æ›´æ–°ç­”æ¡ˆæ•°ç»„dpï¼Œæœ€ç»ˆç­”æ¡ˆæ˜¯dp[(1&lt;<n+1)-2]ï¼Œè¿™ä¸æˆ‘ä»£ç è®¾è®¡æœ‰å…³ï¼Œå› ä¸ºæˆ‘æ˜¯è®¾å³è¾¹ç¬¬2ä½ï¼ˆä¹Ÿå°±æ˜¯å·¦ç§»1ï¼‰ä¸ºç¬¬ä¸€é¢˜ï¼Œè€Œæˆ‘ä»¬æ›´æ–°ç­”æ¡ˆæ—¶æ˜¯å°†æ‰€æœ‰â€œæœªåšä½†æ˜¯èƒ½åšçš„é¢˜â€æ›´æ–°æˆâ€œå·²åšè¯¥é¢˜â€ï¼Œé‚£ä¹ˆæœ€ç»ˆç­”æ¡ˆæ˜¾ç„¶å°±æ˜¯1111...1å…±nä¸ª1ï¼Œç”±äºæœ€ä½ä½æ²¡ç”¨ï¼Œå°±æ˜¯111...10å³nä¸ª1å’Œ1ä¸ª0ï¼Œæ‰€ä»¥ç­”æ¡ˆçŠ¶æ€æ˜¯(1<<n+1)-2ã€‚ ä»¥ånå°äº20è¦å¾€çŠ¶å‹dpä¸Šæƒ³ã€‚ä¸Šè¿°ä»‹ç»è¯·ç»“åˆä»£ç ä»¥åŠæ³¨é‡Šçœ‹ã€‚ **ä»£ç ç¤ºä¾‹ï¼š** ä»¥åè¿™ä¸ªçŠ¶æ€æœ€å¥½ä¸è¦ç”¨ i è¡¨ç¤ºï¼Œçœ‹èµ·æ¥å¤ªä¹±äº†ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n,a[N],b[N],s[N],p[N][N];</span><br><span class="line">ll dp[<span class="number">1</span>&lt;&lt;<span class="number">23</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= (<span class="number">1</span>&lt;&lt;n+<span class="number">1</span>);i++)&#123;</span><br><span class="line"><span class="comment">/*å…ˆåˆ¤æ–­æ˜¯å¦è¯¥çŠ¶æ€åˆæ³•,è‹¥åˆæ³•åˆ™è®¡ç®—å…¶å€¼*/</span></span><br><span class="line"><span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)&#123;</span><br><span class="line"><span class="keyword">if</span>((<span class="number">1</span>&amp;(i&gt;&gt;j)) == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= s[j];k++)</span><br><span class="line"><span class="keyword">if</span>((<span class="number">1</span>&amp;(i&gt;&gt;p[j][k])) == <span class="number">0</span>)&#123;</span><br><span class="line">flag = <span class="literal">false</span>; <span class="keyword">break</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span>(!flag) <span class="keyword">break</span>; <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!flag) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!(i&gt;&gt;j&amp;<span class="number">1</span>)) <span class="keyword">continue</span>;</span><br><span class="line">ll t = <span class="number">0</span>,s = i;</span><br><span class="line"><span class="keyword">while</span>(s)&#123;</span><br><span class="line"><span class="keyword">if</span>(s&amp;<span class="number">1</span>) t++; s &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">dp[i] = max(dp[i],dp[i^(<span class="number">1</span>&lt;&lt;j)]+t*a[j]+b[j]);</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,dp[(<span class="number">1</span>&lt;&lt;n+<span class="number">1</span>)<span class="number">-2</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,a+i,b+i,s+i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= s[i];j++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;p[i][j]);</span><br><span class="line">&#125;</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></n+1)-2]ï¼Œè¿™ä¸æˆ‘ä»£ç è®¾è®¡æœ‰å…³ï¼Œå› ä¸ºæˆ‘æ˜¯è®¾å³è¾¹ç¬¬2ä½ï¼ˆä¹Ÿå°±æ˜¯å·¦ç§»1ï¼‰ä¸ºç¬¬ä¸€é¢˜ï¼Œè€Œæˆ‘ä»¬æ›´æ–°ç­”æ¡ˆæ—¶æ˜¯å°†æ‰€æœ‰â€œæœªåšä½†æ˜¯èƒ½åšçš„é¢˜â€æ›´æ–°æˆâ€œå·²åšè¯¥é¢˜â€ï¼Œé‚£ä¹ˆæœ€ç»ˆç­”æ¡ˆæ˜¾ç„¶å°±æ˜¯1111...1å…±nä¸ª1ï¼Œç”±äºæœ€ä½ä½æ²¡ç”¨ï¼Œå°±æ˜¯111...10å³nä¸ª1å’Œ1ä¸ª0ï¼Œæ‰€ä»¥ç­”æ¡ˆçŠ¶æ€æ˜¯(1<<n+1)-2ã€‚></p><h4 id="J-Sum"><a href="#J-Sum" class="headerlink" title="J. Sum"></a>J. Sum</h4><p><a href="https://nanti.jisuanke.com/t/A1956" target="_blank" rel="noopener">åŸé¢˜é“¾æ¥</a><br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>æˆ‘æƒ³äº†ä¸€ä¸ªO(9N)çš„ç®—æ³•ï¼Œä½†æ˜¯è¶…æ—¶äº†ï¼Œæœ¬æœºå¤§æ¦‚1.6-2.5sï¼Œå¾ˆéš¾å—ï¼›æ˜¯é‡‡ç”¨å”¯ä¸€åˆ†è§£å®šç†åˆ¤æ–­æ¯ä¸€ä¸ªæ•°å¯ä»¥åˆ†è§£ä¸ºå¤šå°‘ä¸ªâ€œæ•°å¯¹â€ç›¸ä¹˜ã€‚ç„¶åæ”¹ç”¨çº¿æ€§ç­›ï¼Œæ€æƒ³å½“ç„¶æ²¡å˜ï¼Œä½†æ˜¯åˆ©ç”¨çº¿æ€§ç­›çš„O(N)å¸¸æ•°è¾ƒå°ï¼Œæœ¬æœº0.7~1.1sï¼Œé€šè¿‡ç‡å¤§æ¦‚1/4ã€‚<br>ç„¶åæ˜¯æœ‹å‹æä¾›çš„è§£æ³•æ€è·¯ï¼Œä¸»è¦æ˜¯ç»Ÿè®¡â€œå¹³æ–¹å¯¹â€ï¼Œä¸å•ç‹¬ç»Ÿè®¡æ¯ä¸ªæ•°å¯¹sçš„è´¡çŒ®ï¼Œè€Œæ˜¯ç›´æ¥è®¡ç®—sï¼Œä¹Ÿæ˜¯O(N)ï¼Œä½†æ˜¯æ›´å¿«ï¼Œç¨³è¿‡ã€‚<br><strong>ä»£ç ç¤ºä¾‹1ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> t,n;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e7</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll f[N],s[N];<span class="comment">//fæ•°ç»„è¡¨ç¤ºå•ä¸ªå…ƒç´ ç»“æœ,è¡¨ç¤ºæ‰€æ±‚ç­”æ¡ˆ </span></span><br><span class="line"><span class="keyword">int</span> v[N],primes[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*åˆ©ç”¨çº¿æ€§ç­›é¢„å¤„ç†fæ•°ç»„ä¸sæ•°ç»„*/</span> </span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; N;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!v[i]) &#123;</span><br><span class="line">primes[++cnt] = i;</span><br><span class="line">v[i] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= cnt;j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(primes[j] &gt; v[i] || primes[j]*i &gt; N) <span class="keyword">break</span>;</span><br><span class="line">v[i*primes[j]] = primes[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">s[<span class="number">1</span>] = f[<span class="number">1</span>] = <span class="number">1</span>;<span class="comment">//f[1]ä¹Ÿè¦åˆå§‹åŒ– </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; N;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(v[i] == i) f[i] = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> x = i,k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(x%v[i] == <span class="number">0</span>)&#123;</span><br><span class="line">x /= v[i];k++;</span><br><span class="line"><span class="keyword">if</span>(k &gt; <span class="number">2</span>) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(k &gt; <span class="number">2</span>) f[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(k == <span class="number">2</span>) f[i] = f[x];<span class="comment">//dpæ€æƒ³ </span></span><br><span class="line"><span class="keyword">else</span> f[i] = f[x]*<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">s[i] = s[i<span class="number">-1</span>]+f[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*ä¼šå¡å¸¸,æœ‰æ—¶è¿‡æœ‰æ—¶ä¸è¿‡,çœŸæ­£æ¯”èµ›è¿˜éœ€è¦ç¨å¾®ä¼˜åŒ–,å¤§æ¦‚1/4è¿‡*/</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">solve();</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,s[n]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>ä»£ç ç¤ºä¾‹2ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 20000070</span></span><br><span class="line"><span class="keyword">int</span> square[MAXN];</span><br><span class="line"><span class="keyword">int</span> cnt[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;MAXN;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        square[i]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i*i&lt;MAXN;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> k=i*i;</span><br><span class="line">        <span class="keyword">if</span>(!square[k]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=k;j&lt;MAXN;j+=k)</span><br><span class="line">        &#123;</span><br><span class="line">            square[j]=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;MAXN;i++)</span><br><span class="line">        cnt[i]=cnt[i<span class="number">-1</span>]+square[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> t;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">while</span>(t--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> sum=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i*i&lt;=n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!square[i])<span class="keyword">continue</span>;</span><br><span class="line">            sum+=(cnt[n/i]-cnt[i])*<span class="number">2</span>+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,sum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="L-Magical-Girl-Haze"><a href="#L-Magical-Girl-Haze" class="headerlink" title="L. Magical Girl Haze"></a>L. Magical Girl Haze</h4><p><a href="https://nanti.jisuanke.com/t/A1958" target="_blank" rel="noopener">åŸé¢˜é“¾æ¥</a><br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>å…ˆæŠŠå›¾åˆ†å±‚ï¼Œå†è¿›è¡ŒDijkstraç®—æ³•ï¼Œåšè¿‡å¥½å‡ éäº†ï¼Œä½†è¿˜æ˜¯è¶…æ—¶å¾ˆå¤šæ³•ï¼Œç©ºé—´å¤§å°æ²¡è®¡ç®—å¥½ï¼Œä»¥åä¸€å®šè¦æ³¨æ„ã€‚<br><strong>ä»£ç ç¤ºä¾‹:</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">6e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],edge[N],nex[M],ver[M],tot;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">edge[++tot] = z; ver[tot] = y;</span><br><span class="line">nex[tot] = head[x]; head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> t,n,k,m;</span><br><span class="line">ll d[N];</span><br><span class="line"><span class="keyword">int</span> vis[N];</span><br><span class="line">priority_queue&lt;pair&lt;ll,ll&gt; &gt; q;</span><br><span class="line"><span class="keyword">const</span> ll INF = <span class="number">1l</span>l&lt;&lt;<span class="number">60</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">(<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">q.push(make_pair(<span class="number">0</span>,s));</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= (k+<span class="number">1</span>)*n;i++) d[i] = INF;</span><br><span class="line">d[s] = <span class="number">0</span>;<span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> x = q.top().second; q.pop();</span><br><span class="line"><span class="keyword">if</span>(vis[x]) <span class="keyword">continue</span>;</span><br><span class="line">vis[x] = <span class="literal">true</span>; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line"><span class="keyword">if</span>(d[y] &gt; d[x]+z)&#123;</span><br><span class="line">d[y] = d[x]+z;</span><br><span class="line"><span class="keyword">if</span>(!vis[y]) q.push(make_pair(-d[y],y));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">dijkstra(<span class="number">1</span>);ll ans = INF;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= k+<span class="number">1</span>;i++) ans = min(ans,d[i*n]);</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;k); </span><br><span class="line"><span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span> head); tot = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt;= k;j++) addEdge(x+n*j,y+n*j,z);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= k;j++) addEdge(x+n*(j<span class="number">-1</span>),y+n*j,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,solve());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çŠ¶å‹dp </tag>
            
            <tag> çº¿æ€§ç­› </tag>
            
            <tag> æœ€çŸ­è·¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019èˆªç”µæš‘æœŸå¤šæ ¡10éƒ¨åˆ†é¢˜è§£</title>
      <link href="/2019/08/30/hdu10/"/>
      <url>/2019/08/30/hdu10/</url>
      
        <content type="html"><![CDATA[<h4 id="1005-Welcome-Party"><a href="#1005-Welcome-Party" class="headerlink" title="1005 Welcome Party"></a>1005 Welcome Party</h4><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6695" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ä¸€å…±æœ‰nååŒå­¦ï¼Œæ¯ä½åŒå­¦éƒ½ä¼šå”±æ­Œå’Œè·³èˆï¼Œç¬¬ i ä½åŒå­¦çš„å”±æ­Œå’Œè·³èˆçš„èƒ½åŠ›å€¼åˆ†åˆ«ä¸º$x_i,y_i$ï¼Œç°åœ¨å°†è¿™äº›åŒå­¦åˆ†ä¸ºå”±æ­Œé˜Ÿå’Œè·³èˆé˜Ÿï¼Œæ¯é˜Ÿçš„ä»·å€¼ç­‰äºè¯¥é˜Ÿä¸­è¯¥èƒ½åŠ›å€¼æœ€é«˜çš„åŒå­¦çš„èƒ½åŠ›å€¼ï¼Œè¯·é—®ä¸¤é˜Ÿä»·å€¼å·®æœ€å°æ˜¯å¤šå°‘å‘¢ï¼Ÿ</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è¿™é¢˜å…¶å®ä¸ç®—å¤ªéš¾ï¼Œä½†æ˜¯æ€è·¯å®¹æ˜“ä¹±ã€‚é¦–å…ˆç”±äºæ¯é˜Ÿçš„ä»·å€¼ç­‰äºè¯¥é˜Ÿä¸­æœ€é«˜çš„èƒ½åŠ›å€¼ï¼Œæ‰€ä»¥å¯ä»¥ä»é«˜åˆ°ä½æšä¸¾æ¯ä¸€ä½åŒå­¦çš„xï¼Œå¹¶æ›´æ–°ansï¼›å¯¹å½“å‰æšä¸¾åˆ°çš„xï¼Œæˆ‘ä»¬åœ¨æ‰€æœ‰å…¶ä»–åŒå­¦ä¸­æ‰¾åˆ°æœ€æ¥è¿‘ x çš„ y ï¼ˆå³abs(x-y)æœ€å°ï¼‰ï¼Œè¿™ä¸ªyå¿…é¡»æ˜¯ <strong>æ¯”æ‰€æœ‰è¢«æšä¸¾è¿‡çš„åŒå­¦çš„yè¦å¤§ã€‚</strong> å¦åˆ™è¯¥åŒå­¦å°±ä¸æ˜¯è·³èˆé˜Ÿä¸­æœ€å¤§èƒ½åŠ›å€¼ï¼ˆå› ä¸ºè¢«æšä¸¾è¿‡çš„åŒå­¦ä¸€å®šå»è·³èˆäº†ï¼‰ï¼Œè¯¥yå°±ä¸èƒ½æ›´æ–°ç­”æ¡ˆäº†ã€‚<br>å½“ç„¶ç»†èŠ‚åœ¨äºå¦‚ä½•æ‰¾å¯»æœ€æ¥è¿‘xçš„yã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> t,n;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">pair&lt;ll,ll&gt; a[N];</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> x first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> y second</span></span><br><span class="line"><span class="built_in">multiset</span>&lt;ll&gt; s2;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">s2.clear();</span><br><span class="line">sort(a+<span class="number">1</span>,a+<span class="number">1</span>+n); ll ans = <span class="number">1l</span>l&lt;&lt;<span class="number">60</span>, mx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) s2.insert(a[i].y);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = n;i &gt;= <span class="number">1</span>;i--)&#123;</span><br><span class="line"><span class="comment">//å…ˆæŠŠå½“å‰åŒå­¦çš„yåˆ æ‰,é˜²æ­¢é€‰åˆ°åŒä¸€ä½åŒå­¦ </span></span><br><span class="line">s2.erase(s2.find(a[i].y)); </span><br><span class="line"><span class="comment">//è¦ä¹ˆæ¯”mxå¤§çš„å€¼æ›´æ–°ans,è¦ä¹ˆå°±mxæ›´æ–°ans </span></span><br><span class="line"><span class="keyword">if</span>(mx) ans = min(ans,<span class="built_in">abs</span>(mx-a[i].x));</span><br><span class="line"></span><br><span class="line"><span class="built_in">multiset</span>&lt;ll&gt;::iterator it = s2.lower_bound(a[i].x);</span><br><span class="line"><span class="keyword">if</span>(it == s2.end()) it--;</span><br><span class="line"><span class="keyword">if</span>(*it &gt;= mx) ans = min(ans,<span class="built_in">abs</span>(*it-a[i].x));</span><br><span class="line"><span class="keyword">if</span>(it != s2.begin()) it--;</span><br><span class="line"><span class="keyword">if</span>(*it &gt;= mx) ans = min(ans,<span class="built_in">abs</span>(*it-a[i].x));</span><br><span class="line">mx = max(mx,a[i].y);</span><br><span class="line"><span class="comment">//printf("%lld %lld %lld %lld %lld\n",mx,a[i].x,a[i].y,*it,ans);</span></span><br><span class="line"></span><br><span class="line">s2.insert(a[i].y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;a[i].x,&amp;a[i].y);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1011-Make-Rounddog-Happy"><a href="#1011-Make-Rounddog-Happy" class="headerlink" title="1011 Make Rounddog Happy"></a>1011 Make Rounddog Happy</h4><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6701" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a></p><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å‡ºä¸€ä¸ªåŒ…å«nä¸ªå…ƒç´ çš„åºåˆ—aï¼Œå…¶ä¸­ $1 &lt;= a_i &lt;= n$ï¼Œå‹å¥½å­ä¸²çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><ul><li>[l , r]ä½ç½®ä¸Šçš„æ‰€æœ‰å…ƒç´ å„ä¸ç›¸åŒã€‚</li><li>$Max(a_l, a_{l+1} , â€¦ , a_r) - (r - l + 1) &lt;= k$ã€‚</li></ul><p>ç»™å‡ºä¸€ä¸ªåºåˆ—ï¼Œè¯·é—®è¯¥åºåˆ—ä¸­æœ‰å¤šå°‘å‹å¥½å­ä¸²ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è¿™é¢˜æ˜¯å¯å‘å¼åˆ†æ²»ï¼Œæ‰€è°“å¯å‘å¼ç®—æ³•ä¸»è¦æ˜¯æŒ‡åŸºäºç›´è§‚æˆ–ç»éªŒè€Œæ„é€ çš„ç®—æ³•ï¼Œå®ƒä¸ä¸€å®šæ˜¯æœ€ä¼˜çš„ï¼Œä½†ä¸€å®šæ˜¯å¯è¡Œçš„ï¼Œå¹¶ä¸”æ—¶é—´è¦åœ¨å¯æ¥å—èŒƒå›´å†…ã€‚ç°é˜¶æ®µçš„å¯å‘å¼ç®—æ³•ä¸»è¦ä»¥ä»¿è‡ªç„¶ç®—æ³•ï¼ˆæ¨¡æ‹Ÿï¼‰ä¸ºä¸»ã€‚<br>å‡è®¾ä¸€ä¸ªåŒºé—´[l,r]å†…æœ€å¤§çš„å…ƒç´ ä¸‹æ ‡ä¸ºpï¼Œé‚£ä¹ˆå¯¹äºa[p]ï¼Œåœ¨[l,r]å†…æœ‰å¤šå°‘ä¸ªå­åŒºé—´åŒ…å«pï¼Œä¸”æ»¡è¶³a[p] - k &lt;= r-l+1ï¼Œè¿™æ˜¯å­é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥å°†è¯¥é—®é¢˜åˆ†ä¸º[l , p]ä¸[p , r]æ¥çœ‹ï¼Œæˆ‘ä»¬å¯¹äºè¿™ä¸¤ä¸ªåŒºé—´ä»»é€‰å…¶ä¸€ç»Ÿè®¡å³å¯ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥é€‰å…ƒç´ è¾ƒå°‘çš„é‚£ä¸€ä¸ªåŒºé—´ï¼Œè¿™æ ·å…ƒç´ æœ€å¤šä¸è¶…è¿‡(r-l+1)/2ã€‚<br>å‡è®¾å·¦åŒºé—´ [l  , p] å…ƒç´ è¾ƒå°‘ï¼Œæˆ‘ä»¬åœ¨æœ¬æ¬¡ç»Ÿè®¡ä¸­ï¼ˆå¯¹[l , r]ä¸Šä»¥a[p]ä¸ºæœ€å¤§å€¼çš„å­åŒºé—´ä¸ªæ•°ï¼‰å¯¹äºæ¯ä¸ªä½ç½® i ï¼ˆi å±äº[l , p]ï¼‰æ¥è®¡ç®—ä»¥ i ä¸ºå·¦ç«¯ç‚¹ï¼Œæœ‰å¤šå°‘ä¸ªå­åŒºé—´æ»¡è¶³è¦æ±‚ï¼›è€Œæ»¡è¶³è¦æ±‚çš„å­åŒºé—´ä¸ªæ•°ç­‰äºtr-tl+1ï¼Œå› ä¸º[tl , tr]ä¸­ä»»æ„ä¸€ä¸ªä½ç½®éƒ½å¯ä»¥ä½œä¸ºå³ç«¯ç‚¹ï¼Œå› ä¸ºå…¶æ»¡è¶³a[p] - k &lt;= R-Lï¼ˆRä¸º[tl ,tr]å†…ä¸€ç‚¹ï¼ŒLä¸º i ï¼‰ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> a[N],st[N][<span class="number">25</span>],Log[N]; </span><br><span class="line"><span class="keyword">int</span> t,n,k;</span><br><span class="line"><span class="keyword">int</span> L[N],R[N];<span class="comment">//è®°å½•æ¯ä¸ªä½ç½®å·¦å³æœ€è¿œ ä¸é‡å¤ ä¸”æ¯”å…¶å°çš„æ•°çš„æ•°é‡ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*åˆå§‹åŒ–stè¡¨*/</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; N;i++) Log[i] = Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) st[i][<span class="number">0</span>] = i;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j) &lt;= n;j++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>)) &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> t1 = st[i][j<span class="number">-1</span>],t2 = st[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>];</span><br><span class="line">st[i][j] = a[t1] &lt; a[t2]?t2:t1;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">/*è¿”å›[l,r]å†…æœ€å¤§çš„æ•°çš„ä¸‹æ ‡*/</span> </span><br><span class="line"><span class="keyword">int</span> kk = Log[r-l+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> t1 = st[l][kk], t2 = st[r-(<span class="number">1</span>&lt;&lt;kk)+<span class="number">1</span>][kk];</span><br><span class="line"><span class="keyword">return</span> a[t1] &lt; a[t2]?t2:t1;</span><br><span class="line">&#125; </span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">/*é€’å½’ç»Ÿè®¡ç­”æ¡ˆ*/</span></span><br><span class="line"><span class="keyword">if</span>(l &gt; r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">int</span> p = ask(l,r); <span class="keyword">int</span> tt = a[p]-k;</span><br><span class="line"><span class="keyword">if</span>(p-l &lt; r-p)&#123;<span class="comment">//å·¦è¾¹ç‚¹æ›´å°‘ </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = l;i &lt;= p;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> tr = min(R[i],r), tl = max(p,i+tt<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">if</span>(tl &gt; tr) <span class="keyword">continue</span>;</span><br><span class="line">ans += tr-tl+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = r;i &gt;= p;i--)&#123;</span><br><span class="line"><span class="keyword">int</span> tl = max(l,L[i]), tr = min(i-tt+<span class="number">1</span>,p);</span><br><span class="line"><span class="keyword">if</span>(tl &gt; tr) <span class="keyword">continue</span>;</span><br><span class="line">ans += tr-tl+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">cal(l,p<span class="number">-1</span>);</span><br><span class="line">cal(p+<span class="number">1</span>,r);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">int</span> vis[N];<span class="comment">//è®°å½•iæœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® </span></span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*è¿”å›ç­”æ¡ˆ*/</span></span><br><span class="line">init(); ans = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line"><span class="comment">/*ä»¥ä¸‹ä»£ç ç”¨äºæ›´æ–°Lä¸Ræ•°ç»„,é€šè¿‡ç®€å•çš„å°ºå–æ³•æ€æƒ³*/</span> </span><br><span class="line"><span class="keyword">int</span> pre = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(vis[a[i]]) pre = max(pre,vis[a[i]]+<span class="number">1</span>);</span><br><span class="line">L[i] = pre; vis[a[i]] = i;</span><br><span class="line">&#125;</span><br><span class="line">pre = n;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) vis[i] = n+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = n;i &gt;= <span class="number">1</span>;i--)&#123;</span><br><span class="line"><span class="keyword">if</span>(vis[a[i]] != n+<span class="number">1</span>) pre = min(vis[a[i]]<span class="number">-1</span>,pre);</span><br><span class="line">R[i] = pre; vis[a[i]] = i;</span><br><span class="line">&#125;</span><br><span class="line">cal(<span class="number">1</span>,n);<span class="comment">//é€’å½’åˆ†æ²»è®¡ç®— </span></span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,solve());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> å¯å‘å¼åˆ†æ²» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯æŒä¹…åŒ–çº¿æ®µæ ‘ï¼ˆä¸»å¸­æ ‘ï¼‰</title>
      <link href="/2019/08/28/dynamic-zx/"/>
      <url>/2019/08/28/dynamic-zx/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>ä¸»å¸­æ ‘ï¼Œåˆç§°å¯æŒä¹…åŒ–çº¿æ®µæ ‘ï¼Œå±äºå¯æŒä¹…åŒ–æ•°æ®ç»“æ„ã€‚â€œä¸»å¸­â€è¿™ä¸€åè¯æ˜¯ç”±äºå‘æ˜è€…ç¼©å†™ä¸ºHJTï¼Œå’ŒæŸä½ä¸»å¸­æ‹¼éŸ³ç¼©å†™ç›¸åŒï¼ˆæœ‰äº›ç‰µå¼ºï¼‰ï¼Œæ•…å°†è¯¥æ•°æ®ç»“æ„ç§°ä¸ºä¸»å¸­æ ‘ã€‚<br>ä¸»å¸­æ ‘æ—¢ä¿ç•™äº†çº¿æ®µæ ‘çš„çµæ´»ï¼Œä¹Ÿæ‹¥æœ‰äº†å¯æŒä¹…åŒ–æ•°æ®ç»“æ„çš„ç‰¹ç‚¹ï¼Œåœ¨å¤„ç†æŸäº›ç‰¹å®šé—®é¢˜æ—¶æœ‰ç€å…¶å®ƒæ•°æ®ç»“æ„ä¸å…·æœ‰çš„ä¼˜åŠ¿ã€‚<br>æœ¬æ–‡å°†é¦–å…ˆä»‹ç»ä»€ä¹ˆæ˜¯â€œå¯æŒä¹…åŒ–æ•°æ®ç»“æ„â€ï¼Œéšåä»‹ç»ä¸»å¸­æ ‘çš„æ€æƒ³ï¼Œå…³äºä»£ç å®ç°å°†ç»“åˆä¾‹é¢˜è®²è§£ã€‚</p><h4 id="å¯æŒä¹…åŒ–æ•°æ®ç»“æ„"><a href="#å¯æŒä¹…åŒ–æ•°æ®ç»“æ„" class="headerlink" title="å¯æŒä¹…åŒ–æ•°æ®ç»“æ„"></a>å¯æŒä¹…åŒ–æ•°æ®ç»“æ„</h4><p>å¯æŒä¹…æ•°æ®ç»“æ„ä¸»è¦æŒ‡çš„æ˜¯æˆ‘ä»¬å¯ä»¥æŸ¥è¯¢å†å²ç‰ˆæœ¬çš„æƒ…å†µå¹¶æ”¯æŒæ’å…¥ï¼Œåˆ©ç”¨ä½¿ç”¨ä¹‹å‰å†å²ç‰ˆæœ¬çš„æ•°æ®ç»“æ„æ¥å‡å°‘å¯¹ç©ºé—´çš„æ¶ˆè€—ï¼ˆèƒ½å¤Ÿå¯¹å†å²è¿›è¡Œä¿®æ”¹çš„æ˜¯å‡½æ•°å¼ç¼–ç¨‹ [1]ï¼‰ã€‚</p><p>æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼šæˆ‘ä»¬éœ€è¦ç»´æŠ¤ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹å•ä¸€ç»“ç‚¹çš„å€¼ï¼ŒæŸ¥è¯¢å•ä¸€ç»“ç‚¹çš„å€¼ï¼Œä½†æ˜¯æœ€å…³é”®çš„æ˜¯æˆ‘ä»¬å¯èƒ½è¿˜éœ€è¦å›é€€ä¹‹å‰åšè¿‡çš„æŸäº›æ“ä½œã€‚è¿™é‡Œå›é€€æ˜¯æŒ‡å›åˆ°æœªåšè¿™äº›æ“ä½œä¹‹å‰çš„çŠ¶æ€ã€‚</p><p>åœ¨æ— å›é€€æ“ä½œçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰å¤§æŠŠçš„æ•°æ®ç»“æ„å¯ä¾›é€‰æ‹©æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚ä½†æ˜¯ä¸€æ—¦æ¶‰åŠåˆ°å›é€€æ“ä½œï¼Œé€‰æ‹©å°±å°‘çš„å¤šäº†ã€‚æˆ‘ä»¬å°†æ”¯æŒå›é€€æ“ä½œçš„æ•°æ®ç»“æ„ç§°ä¸ºå¯æŒä¹…åŒ–æ•°æ®ç»“æ„ã€‚</p><p>ç¨å¾®æ€è€ƒä¸€ä¸‹å¦‚ä½•å¯ä»¥åœ¨åŸæ¥æ•°æ®ç»“æ„çš„åŸºç¡€ä¸Šä½¿å…¶å˜å¾—å¯æŒä¹…åŒ–ï¼Œæœ‰ä¸€ä¸ªå¾ˆç®€å•çš„æ–¹æ¡ˆã€‚æˆ‘ä»¬æ¯æ¬¡æ“ä½œéƒ½å°†é‡æ–°å»ºç«‹ä¸€ä¸ªæ–°çš„æ•°æ®ç»“æ„ï¼Œå¹¶å°†ä¹‹å‰çš„æ“ä½œéƒ½å…ˆåœ¨å…¶ä¸Šæ‰§è¡Œä¸€æ¬¡ï¼Œä¹‹åæ‰§è¡Œè¯¥æ¬¡æ“ä½œã€‚æˆ‘ä»¬æŒ‰æ“ä½œæ‰§è¡Œé¡ºåºå°†è¿™äº›æ•°æ®ç»“æ„ç»´æŠ¤æˆä¸€ä¸ªåºåˆ—Sï¼Œæ­¤æ—¶S[0]è¡¨ç¤ºæœªç»ä»»ä½•æ“ä½œçš„åˆå§‹æ•°æ®ç»“æ„ã€‚å¯¹äºi&gt;0ï¼ŒS[i]è¡¨ç¤ºåœ¨S[0]çš„åŸºç¡€ä¸Šæ‰§è¡Œè¿‡åºå·1åˆ°içš„æ‰€æœ‰æ“ä½œåå¾—åˆ°çš„æ–°çš„æ•°æ®ç»“æ„ã€‚åœ¨è¿™æ ·çš„åšæ³•ä¸‹ï¼Œæˆ‘ä»¬ç§°S[i]ä¸ºç‰ˆæœ¬iï¼Œå›é€€æ“ä½œç­‰ä»·äºåˆ‡æ¢åˆ°æŸä¸ªç‰¹å®šç‰ˆæœ¬ã€‚è‹¥æ“ä½œiè¡¨ç¤ºåˆ‡æ¢ä¸ºç‰ˆæœ¬jï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†S[i]è®¾ç½®ä¸ºS[j]çš„å…‹éš†ã€‚</p><p>ä¸Šé¢æåˆ°çš„åšæ³•ä¸‹å¾ˆå®¹æ˜“å‘ç°å¯ä»¥ä½¿å¾—ä»»æ„æ•°æ®ç»“æ„éƒ½å¯ä»¥æ”¯æŒå›é€€æ“ä½œï¼Œä½†æ˜¯ç¼ºç‚¹ä¹Ÿæ˜¯éå¸¸æ˜æ˜¾ï¼Œç©ºé—´å’Œæ—¶é—´çš„å¤æ‚åº¦éƒ½å¥‡é«˜ã€‚æ¯ä¸€æ¬¡æ“ä½œéƒ½éœ€è¦ç´¯åŠ ä¹‹å‰æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ï¼Œç©ºé—´ä¹Ÿæ˜¯ï¼Œæˆ‘ä»¬ä¸ºäº†ä¿å­˜å„ä¸ªç‰ˆæœ¬éœ€è¦è€—è´¹å¤§é‡çš„å†…å­˜ã€‚</p><p>å…ˆè¯´æ˜æ—¶é—´å¤æ‚åº¦çš„ä¼˜åŒ–ï¼Œå¯¹äºiå·æ“ä½œï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç›´æ¥å…‹éš†ç‰ˆæœ¬S[i-1]å¹¶åœ¨å…¶ä¸Šæ‰§è¡Œiå·æ“ä½œï¼Œè¿™æ ·æ—¶é—´å¤æ‚åº¦åŸºæœ¬ä¸Šå°±å‘ç©ºé—´å¤æ‚åº¦çœ‹é½äº†ã€‚ä¸‹é¢æˆ‘ä»¬å°±å¯ä»¥ä¸“æ³¨äºç©ºé—´å¤æ‚åº¦çš„ä¼˜åŒ–ï¼ˆå¯¹åº”çš„ä¹Ÿå°±æ˜¯æ—¶é—´å¤æ‚åº¦çš„ä¼˜åŒ–ï¼‰ã€‚</p><p>æ•°æ®ç»“æ„æ˜¯ç”¨äºä¿å­˜æ•°æ®çš„ï¼Œæˆ‘ä»¬å°†å…¶ä¿å­˜æ•°æ®çš„å•å…ƒç§°ä¸ºç»“ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç»“ç‚¹æ¥åˆ»ç”»æ•´ä¸ªæ•°æ®ç»“æ„çš„éª¨æ¶ã€‚æ•°æ®ç»“æ„åŸºæœ¬åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ç¨³å®šçš„ï¼Œä¸€ç±»æ˜¯ä¸ç¨³å®šçš„ã€‚ç¨³å®šçš„æ•°æ®ç»“æ„ï¼Œå…¶ç‰¹å®šæ˜¯åœ¨ä¿®æ”¹çš„ç»“ç‚¹çš„å€¼ä¹‹åä¸ä¼šæ”¹å˜ç»“ç‚¹ä¹‹é—´çš„å…³ç³»ï¼Œè€Œä¸ç¨³å®šçš„æ•°æ®ç»“æ„åœ¨ç»“ç‚¹å€¼å˜æ›´åéœ€è¦é‡æ–°ç»´æŠ¤ç»“ç‚¹ä¹‹é—´çš„å…³è”ã€‚ç¨³å®šçš„æ•°æ®ç»“æ„æœ‰çº¿æ®µæ ‘ï¼Œåç¼€æ•°ç»„ï¼Œå‰ç¼€æ ‘ç­‰ç­‰ï¼Œä¸ç¨³å®šçš„æ•°æ®ç»“æ„ä¸»è¦å°±æ˜¯å„ç§äºŒå‰å¹³è¡¡æ ‘ã€‚å¯¹äºç¨³å®šçš„æ ‘çŠ¶ç»“æ„ï¼Œè‹¥å­©å­æ²¡æœ‰ä¿å­˜æŒ‡å‘çˆ¶ç»“ç‚¹çš„æŒ‡é’ˆï¼Œå³ç”±çˆ¶äº²è´Ÿè´£è®°å½•æ‰€æœ‰çš„å­©å­ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å‘ç°ï¼Œå½“æˆ‘ä»¬å¯¹æŸä¸ªç»“ç‚¹æ›´æ”¹æ—¶ï¼ˆä¿®æ”¹å€¼ï¼Œæ–°å¢ï¼Œåˆ é™¤ç­‰æ“ä½œï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦åŒæ—¶ä¿®æ”¹è¯¥ç»“ç‚¹çš„æ‰€æœ‰ç¥–å…ˆç»“ç‚¹å³å¯ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥åªå…‹éš†è¿™äº›ç»“ç‚¹è€Œéæ•´ä¸ªæ•°æ®ç»“æ„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚ç”±äºçˆ¶äº²ç»´æŠ¤å­©å­ï¼Œå› æ­¤ä¸€ä¸ªå­©å­å…è®¸æœ‰å¤šä¸ªçˆ¶äº²ï¼Œæ•…æ‰€æœ‰æ²¡æœ‰è¢«ç›´æ¥å½±å“çš„ç»“ç‚¹éƒ½å¯ä»¥ç»§ç»­å¤ç”¨ã€‚æˆ‘ä»¬å°†éƒ¨åˆ†æ ‘çŠ¶æ•°æ®ç»“æ„ï¼ˆç‰¹å®šæ˜¯ç¨³å®šå’Œçˆ¶äº²ç»´æŠ¤çˆ¶å­å…³ç³»ï¼‰çš„ä¸€æ¬¡æ“ä½œçš„ç©ºé—´å¤æ‚åº¦ä¼˜åŒ–åˆ°äº†O(h)ï¼Œå…¶ä¸­hæ˜¯æ ‘çŠ¶æ•°æ®ç»“æ„çš„é«˜åº¦ã€‚</p><p>å½“æˆ‘ä»¬å°†ä¸Šé¢çš„æƒ³æ³•ä½œç”¨åˆ°çº¿æ®µæ ‘æ—¶ï¼Œå°±å¾—åˆ°äº†å¸¸è¯´çš„ä¸»å¸­æ ‘ã€‚å…¶é«˜åº¦ä¸º$O(log_2(n))$ï¼Œå…¶ä¸­nä¸ºçº¿æ®µæ ‘ç»´æŠ¤çš„åŒºé—´å¤§å°ï¼ŒåŒæ—¶å…¶æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦å‡ä¸º$O(log_2(n)^2)$ã€‚</p><p><em>å¼•ç”¨è‡ªï¼š<a href="https://www.cnblogs.com/dalt/p/8324781.html" target="_blank" rel="noopener">é™¶æ— è¯­çš„åšå®¢</a></em></p><h4 id="é™æ€ä¸»å¸­æ ‘"><a href="#é™æ€ä¸»å¸­æ ‘" class="headerlink" title="é™æ€ä¸»å¸­æ ‘"></a>é™æ€ä¸»å¸­æ ‘</h4><p>æˆ‘ä»¬æŒ‰ç…§â€œæ˜¯å¦æ”¯æŒä¿®æ”¹â€æ¥å°†ä¸»å¸­æ ‘åˆ’åˆ†ä¸ºé™æ€å’ŒåŠ¨æ€ã€‚é™æ€ä¸»å¸­æ ‘ä¸€æ—¦å»ºæ ‘æˆåŠŸï¼Œå°±ä¸å†æ”¯æŒä¿®æ”¹ï¼Œåªèƒ½å¤Ÿç”¨äºæŸ¥è¯¢ã€‚é™æ€ä¸»å¸­æ ‘ç»´æŠ¤å…ƒç´ å‡ºç°æ¬¡æ•°çš„å‰ç¼€å’Œã€‚</p><blockquote><p>ä¾‹é¢˜ï¼šæ´›è°·P3834ï¼ŒæŸ¥è¯¢åŒºé—´ç¬¬kå¤§å€¼<br>ç»™å®šnä¸ªå…ƒç´ ï¼Œå…±mä¸ªè¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™å‡º[l ,r]å’Œkï¼Œå›ç­”åŒºé—´[l , r]å†…ç¬¬kå¤§å…ƒç´ å€¼æ˜¯å¤šå°‘ã€‚</p></blockquote><h5 id="å»ºæ ‘ï¼š"><a href="#å»ºæ ‘ï¼š" class="headerlink" title="å»ºæ ‘ï¼š"></a>å»ºæ ‘ï¼š</h5><p>è€ƒè™‘ç”¨ä¸»å¸­æ ‘è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œç»™å‡ºå¦‚ä¸‹å»ºæ ‘æ­¥éª¤ï¼š</p><ol><li>æ–°å»ºä¸€æ£µå®Œæ•´çš„ç©ºæ ‘ï¼Œå…¶æ ¹èŠ‚ç‚¹ç¼–å·å­˜æ”¾åœ¨root[0]å†…ã€‚</li><li>ä¾æ¬¡å°†nä¸ªå…ƒç´ æ’å…¥åˆ°â€œç‰ˆæœ¬0â€çš„ç©ºæ ‘ä¸­ï¼Œä»–ä»¬çš„â€œç‰ˆæœ¬å·â€ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰å­˜æ”¾åœ¨root[i]ä¸­ã€‚</li></ol><p>å¯¹äºæ¯ä¸€ä¸ªâ€œæ–°ç‰ˆæœ¬â€ï¼Œæˆ‘ä»¬éƒ½åœ¨åŸæ¥åŸºç¡€ä¸Šæ–°å¢â€œéœ€è¦ä¿®æ”¹çš„èŠ‚ç‚¹â€ï¼Œå¹¶å°†å…¶æ ¹èŠ‚ç‚¹è®°å½•åœ¨rootæ•°ç»„ä¸­ã€‚<br>å¦‚æ­¤æˆ‘ä»¬çš„æ—¶ç©ºèŠ±è´¹éƒ½ä¸ä¿®æ”¹çš„è·¯å¾„æˆæ­£æ¯”ï¼Œå³æ¯æ¬¡$O(log_2N)$ã€‚</p><p>å½“ç„¶è¿™äº›éƒ½æ˜¯ä»ç†è®ºæ€æƒ³ä¸Šæ¥è®²çš„ï¼Œæ¯”è¾ƒæŠ½è±¡ï¼›å…·ä½“åˆ°è¿™ä¸€é¢˜ï¼Œæˆ‘ä»¬ä»¤çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´å†…å…ƒç´ æ•°é‡ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸‰ä¸ªå˜é‡ï¼Œåˆ†åˆ«æ˜¯ ls , rs , sumï¼Œå³å·¦å„¿å­ç¼–å·ï¼Œå³å„¿å­ç¼–å·ï¼ŒåŒºé—´å†…å…ƒç´ ä¸ªæ•°ã€‚<br>åˆå§‹æ—¶suméƒ½ä¸º0ï¼Œéšåå°†nä¸ªå…ƒç´ ä¾æ¬¡æ’å…¥å½¢æˆnæ£µæ–°çš„çº¿æ®µæ ‘ï¼Œè€Œè¿™n+1æ£µï¼ˆåŒ…æ‹¬ç¼–å·ä¸º0çš„ç©ºæ ‘ï¼‰æ„æˆäº†ä¸€æ£µé™æ€ä¸»å¸­æ ‘ã€‚<br>æ‰€ä»¥å»ºæ ‘æ“ä½œå…¶å®åˆ†ä¸ºä¸¤æ­¥ï¼šBuildTree()å»ºç«‹ä¸€æ£µç©ºæ ‘å¹¶è¿”å›æ ¹èŠ‚ç‚¹ç¼–å·ï¼›updata()åœ¨åŸæ ‘åŸºç¡€ä¸Šâ€œå¢åŠ ä¸€æ£µæ–°æ ‘â€ï¼Œå¹¶è¿”å›è¯¥ç‰ˆæœ¬çš„æ ¹èŠ‚ç‚¹ç¼–å·ã€‚</p><p>è™½ç„¶ä¸åŒå†å²ç‰ˆæœ¬çš„çº¿æ®µæ ‘èŠ‚ç‚¹ä¹‹é—´æœ‰äº¤å‰ä»¥é‡å¤åˆ©ç”¨ï¼Œä½†æ¯ä¸ªå†å²ç‰ˆæœ¬éƒ½æœ‰å”¯ä¸€ä¸”ç‹¬ç«‹çš„æ ¹èŠ‚ç‚¹</p><h5 id="æŸ¥è¯¢ï¼š"><a href="#æŸ¥è¯¢ï¼š" class="headerlink" title="æŸ¥è¯¢ï¼š"></a>æŸ¥è¯¢ï¼š</h5><p>ç”±äºçº¿æ®µæ ‘ç»´æŠ¤çš„æ˜¯åŒºé—´å†…å…ƒç´ çš„æ•°é‡ï¼Œæ‰€ä»¥ä¸åŒç‰ˆæœ¬çš„çº¿æ®µæ ‘çš„å¯¹åº”èŠ‚ç‚¹æ˜¯å¯ä»¥åŠ å‡çš„ï¼Œé‚£ä¹ˆroot[i] - root[j]æ„ä¹‰å°±æ˜¯â€œç¬¬ i ä¸ªç‰ˆæœ¬çš„çº¿æ®µæ ‘æ¯”ç¬¬ j ä¸ªç‰ˆæœ¬çš„çº¿æ®µæ ‘å¤šå‡ ä¸ªå…ƒç´ â€ã€‚å¦‚æœæˆ‘ä»¬å†åŠ ä¸ŠåŒºé—´èŒƒå›´é™åˆ¶[l , r]ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥æŸ¥è¯¢â€œç¬¬ i ä¸ªç‰ˆæœ¬æ¯”ç¬¬ j ä¸ªç‰ˆæœ¬ï¼Œåœ¨[l , r]ä¸Šå¤šå‡ ä¸ªå…ƒç´ â€ã€‚</p><p>å…·ä½“åˆ°æœ¬é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥è¯¢åŒºé—´[l , r]å†…ç¬¬kå¤§çš„å…ƒç´ ï¼Œå·²çŸ¥çº¿æ®µæ ‘å¯ä»¥åŠ å‡ï¼Œé‚£ä¹ˆå¯¹äºè¯¢é—®(l , r , k)ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨root[l-1] ä¸ root[r]ä¸¤æ£µçº¿æ®µæ ‘ä¸Šæ‰¾å¯»ç­”æ¡ˆï¼Œä¸è¦å¿˜è®°äº†è¿™é¢—çº¿æ®µæ ‘æ˜¯æ ¹æ®æƒå€¼å»ºç«‹çš„ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„æƒå€¼çº¿æ®µæ ‘ã€‚é‚£ä¹ˆåœ¨resä¸ªæ•°ä¸­æ‰¾ç¬¬kä¸ªï¼Œæ˜¾ç„¶äºŒåˆ†ï¼ˆæ ‘ä¸Šï¼‰ï¼Œå‚è§ä»£ç ã€‚</p><h5 id="ä»£ç æ¨¡æ¿"><a href="#ä»£ç æ¨¡æ¿" class="headerlink" title="ä»£ç æ¨¡æ¿"></a>ä»£ç æ¨¡æ¿</h5><p>è§é™„å½•éƒ¨åˆ†code-1ï¼šæ´›è°·P3834é™æ€ä¸»å¸­æ ‘æ¨¡æ¿-æ±‚åŒºé—´ç¬¬kå¤§å€¼</p><h4 id="åŠ¨æ€ä¸»å¸­æ ‘"><a href="#åŠ¨æ€ä¸»å¸­æ ‘" class="headerlink" title="åŠ¨æ€ä¸»å¸­æ ‘"></a>åŠ¨æ€ä¸»å¸­æ ‘</h4><p>é™æ€ä¸»å¸­æ ‘è™½ç„¶æ”¯æŒå†å²æŸ¥è¯¢ï¼Œä½†å…¶åŠŸèƒ½è¿˜æ˜¯ä¸å¤ªå¼ºå¤§ï¼Œå› ä¸ºå…¶ä¸æ”¯æŒæ›´æ”¹ã€‚æˆ‘ä»¬å°†æ”¯æŒä¿®æ”¹çš„ä¸»å¸­æ ‘ç§°ä¸ºåŠ¨æ€ä¸»å¸­æ ‘ï¼Œä½†æ˜¯è¿™ä¸ªåŠŸèƒ½æ·»åŠ èµ·æ¥å¹¶ä¸å®¹æ˜“ã€‚é™æ€ä¸»å¸­æ ‘è¿˜å¯ä»¥çœ‹ä½œæ˜¯çº¿æ®µæ ‘é€šè¿‡å°ä¿®æ”¹å¾—åˆ°ï¼Œè€ŒåŠ¨æ€ä¸»å¸­æ ‘åˆ™æ˜¯æ ‘å¥—æ ‘ã€‚</p><p>æ€æƒ³ä¾æ—§æ˜¯ç»´æŠ¤å…ƒç´ å‡ºç°æ¬¡æ•°çš„å‰ç¼€å’Œï¼Œå¯ä»¥ç±»æ¯”å·®åˆ†æ•°ç»„ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“å‰ç¼€å’Œæ•°ç»„æ˜¯ä¸æ”¯æŒä¿®æ”¹çš„ï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œå°±éœ€è¦ç”¨ æ ‘çŠ¶æ•°ç»„/çº¿æ®µæ ‘ æ¥ç»´æŠ¤ï¼Œè¿™é‡Œä¹Ÿæ˜¯ç±»ä¼¼ã€‚</p><p>æˆ‘ä»¬è€ƒè™‘â€œå¤–å±‚ç”¨æ ‘çŠ¶æ•°ç»„ï¼Œå†…å±‚ç”¨è®°å½•åŒºé—´å†…æ•°å€¼å‡ºç°æ¬¡æ•°çš„çº¿æ®µæ ‘â€æ¥å®ç°æ”¯æŒä¿®æ”¹çš„å¯æŒä¹…åŒ–çº¿æ®µæ ‘ï¼Œä¹Ÿå³åŠ¨æ€ä¸»å¸­æ ‘ã€‚</p><p>åœ¨é™æ€ä¸»å¸­æ ‘ä¸Šï¼Œå¯ä»¥é€šè¿‡ä¸¤ä¸ªæƒå€¼çº¿æ®µæ ‘ç›¸å‡æ¥æ±‚å¾—åŒºé—´ç¬¬kå¤§å€¼ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä»æ—§æ˜¯é€šè¿‡è¿™ç§æ–¹æ³•æ±‚åŒºé—´ç¬¬kå¤§ï¼Œä¸åŒçš„æ˜¯æˆ‘ä»¬éœ€è¦ä¿è¯æ‰€æœ‰çº¿æ®µæ ‘çš„æ•°æ®æ˜¯æ­£ç¡®çš„ï¼ˆç»´æŠ¤ä¿®æ”¹ï¼‰ã€‚<br>å¦‚æœæˆ‘ä»¬ç”¨æ ‘çŠ¶æ•°ç»„æ¥ç»´æŠ¤ä¸åŒç‰ˆæœ¬çš„æƒå€¼çº¿æ®µæ ‘çš„ç¼–å·ï¼Œé‚£ä¹ˆå¯¹äºâ€œå°†ä½ç½® p çš„ x ä¿®æ”¹ä¸º yâ€è¿™ä¸€æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹å…±logNä¸ªç‰ˆæœ¬çš„æƒå€¼çº¿æ®µæ ‘ï¼Œå¦‚æ­¤ä¿®æ”¹æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯$O((log_2N)^2)$ã€‚<br>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶ç©ºé—´å¤æ‚åº¦ = æ ‘çŠ¶æ•°ç»„ç©ºé—´ * æƒå€¼çº¿æ®µæ ‘ç©ºé—´ = $N^2$ï¼Œä½†æ˜¯æ ‘çŠ¶æ•°ç»„å®é™…ä¸Šåªä¿å­˜æƒå€¼çº¿æ®µæ ‘çš„â€œç‰ˆæœ¬å·â€è€Œå·²ï¼Œå› æ­¤å®é™…ä¸Šç”¨åˆ°çš„ç©ºé—´ä¹Ÿå°±åªæœ‰æƒå€¼çº¿æ®µæ ‘ä¸Šçš„$O(N(log_2N)^2)$ä¸ªèŠ‚ç‚¹çš„ç©ºé—´ï¼Œå› æ­¤åŠ¨æ€å¼€ç‚¹å³å¯ã€‚</p><h5 id="ä¾‹é¢˜2ï¼šæ´›è°·P2617"><a href="#ä¾‹é¢˜2ï¼šæ´›è°·P2617" class="headerlink" title="ä¾‹é¢˜2ï¼šæ´›è°·P2617"></a>ä¾‹é¢˜2ï¼šæ´›è°·P2617</h5><p><strong>ä»£ç æ¨¡æ¿ï¼š</strong> è§é™„å½•éƒ¨åˆ†code-2</p><h4 id="æ³¨é‡Šï¼š"><a href="#æ³¨é‡Šï¼š" class="headerlink" title="æ³¨é‡Šï¼š"></a>æ³¨é‡Šï¼š</h4><p>[1] å‡½æ•°å¼ç¼–ç¨‹ï¼šâ€œå‡½æ•°å¼ç¼–ç¨‹â€æ˜¯ä¸€ç§â€œç¼–ç¨‹èŒƒå¼â€(programming paradigm)ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•ç¼–å†™ç¨‹åºçš„æ–¹æ³•è®ºã€‚å®ƒå±äºâ€œç»“æ„åŒ–ç¼–ç¨‹â€çš„ä¸€ç§ï¼Œä¸»è¦æ€æƒ³æ˜¯æŠŠè¿ç®—è¿‡ç¨‹å°½é‡å†™æˆä¸€ç³»åˆ—åµŒå¥—çš„å‡½æ•°è°ƒç”¨ã€‚</p><p><em>å¼•ç”¨è‡ªï¼š<a href="https://www.cnblogs.com/aezero/p/4979890.html" target="_blank" rel="noopener">aezeroçš„åšå®¢</a></em></p><h4 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h4><p><strong>code-1ï¼šæ´›è°·P3834é™æ€ä¸»å¸­æ ‘æ¨¡æ¿-æ±‚åŒºé—´ç¬¬kå¤§å€¼</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,a[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">zxTree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ls,rs,sum;<span class="comment">//å·¦å³å„¿å­,åŒºé—´å†…å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> ls(x) tr[x].ls</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rs(x) tr[x].rs</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> sum(x) tr[x].sum</span></span><br><span class="line">&#125; tr[N*<span class="number">40</span>];<span class="comment">//æ³¨æ„æ•°ç»„å¤§å°</span></span><br><span class="line"><span class="keyword">int</span> sz = <span class="number">0</span>;<span class="comment">//ä¸åŒç‰ˆæœ¬çš„æ ‘çš„æ€»æ•° </span></span><br><span class="line"><span class="keyword">int</span> root[N];<span class="comment">//root[i]å­˜æ”¾ç¬¬iæ£µæ ‘çš„æ ‘æ ¹çš„ç¼–å·</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*å»ºæ ‘,å’Œæ™®é€šçº¿æ®µæ ‘ç›¸åŒ*/</span></span><br><span class="line">    <span class="keyword">int</span> rt = ++sz;sum(rt) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> rt;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    ls(rt) = BuildTree(l,mid);</span><br><span class="line">    rs(rt) = BuildTree(mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="keyword">return</span> rt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> pre,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*æ–°å»ºä¸€æ£µæ ‘,å…¶æ¯”preæ ‘å¤šä¸€ä¸ªå…ƒç´ x*/</span></span><br><span class="line">    <span class="keyword">int</span> rt = ++sz;</span><br><span class="line">    tr[rt] = tr[pre]; sum(rt)++;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> rt;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x &lt;= mid) ls(rt) = updata(ls(pre),l,mid,x);</span><br><span class="line">    <span class="keyword">else</span> rs(rt) = updata(rs(pre),mid+<span class="number">1</span>,r,x);</span><br><span class="line">    <span class="keyword">return</span> rt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> pre,<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*  ä¾æ¬¡æ˜¯:ä¸Šä¸€ä¸ªæ ‘æ ¹,å½“å‰æ ‘æ ¹,åŒºé—´å·¦å³ç«¯ç‚¹,æ‰€æ±‚åŒºé—´ç¬¬kå¤§</span></span><br><span class="line"><span class="comment">        è¿”å›è¯¥åŒºé—´ç¬¬kå¤§æ•°çš„ä¸‹æ ‡ */</span></span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">int</span> res = sum(ls(rt)) - sum(ls(pre));</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(res &gt;= k) <span class="keyword">return</span> ask(ls(pre),ls(rt),l,mid,k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> ask(rs(pre),rs(rt),mid+<span class="number">1</span>,r,k-res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tmp[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i),tmp[i] = a[i];</span><br><span class="line">    <span class="comment">//ç¦»æ•£åŒ–</span></span><br><span class="line">    sort(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+n);</span><br><span class="line">    <span class="keyword">int</span> tot = unique(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+n)-tmp<span class="number">-1</span>;</span><br><span class="line">    root[<span class="number">0</span>] = BuildTree(<span class="number">1</span>,tot);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x = lower_bound(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+tot,a[i])-tmp;</span><br><span class="line">        root[i] = updata(root[i<span class="number">-1</span>],<span class="number">1</span>,tot,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ©ç”¨ä¸»å¸­æ ‘å¯ä»¥åŠ å‡åŸç†è®¡ç®—</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,l,r,k;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;l,&amp;r,&amp;k);</span><br><span class="line">        <span class="keyword">int</span> x = ask(root[l<span class="number">-1</span>],root[r],<span class="number">1</span>,tot,k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,tmp[x]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>code2-æ´›è°·P2617åŠ¨æ€ä¸»å¸­æ ‘</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="comment">/*çº¿æ®µæ ‘èŠ‚ç‚¹,è¦å­˜æ”¾å·¦å³å„¿å­ç¼–å·,åŒºé—´å†…å…ƒç´ ä¸ªæ•°*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ls,rs,sum;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> ls(x) tr[x].ls</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rs(x) tr[x].rs</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> sum(x) tr[x].sum</span></span><br><span class="line">&#125;tr[N*<span class="number">400</span>];<span class="comment">//ç©ºé—´è¦N(logN)^2å¤§å°</span></span><br><span class="line"><span class="comment">/*å› ä¸ºè¦ç¦»æ•£åŒ–,æ‰€ä»¥è¦æå‰è¯»å–æ‰€æœ‰æ“ä½œ*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Query</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l,r,k;<span class="comment">//æŸ¥è¯¢æ“ä½œ,è¯¢é—®åŒºé—´[l,r]å†…ç¬¬kå¤§æ•°çš„å€¼</span></span><br><span class="line">    <span class="keyword">int</span> p,x;    <span class="comment">//ä¿®æ”¹æ“ä½œ,ä¿®æ”¹ä½ç½®pä½ç½®ä¸Šçš„å…ƒç´ ä¸ºx</span></span><br><span class="line">&#125;qy[N];</span><br><span class="line"><span class="keyword">int</span> sz = N;<span class="comment">/*ä¸åŒç‰ˆæœ¬çš„çº¿æ®µæ ‘æ€»æ•°,</span></span><br><span class="line"><span class="comment">å³åŠ¨æ€ç”³è¯·èŠ‚ç‚¹ç¼–å·,åˆå§‹å€¼è¦ä¸ºN,å› ä¸ºå‰nä¸ªèŠ‚ç‚¹è¢«ä½¿ç”¨*/</span></span><br><span class="line"><span class="keyword">int</span> a[N],n,m,tot = <span class="number">0</span>;<span class="comment">//totç¦»æ•£åŒ–ç”¨</span></span><br><span class="line"><span class="keyword">char</span> op[<span class="number">10</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*å¯¹ä»¥rtä¸ºæ ¹çš„çº¿æ®µæ ‘,åŒºé—´[l,r]å†…æ–°å¢ä¸€ä¸ªå…ƒç´ x*/</span></span><br><span class="line">    sum(rt) += d;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span>; <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(!ls(rt)) ls(rt) = ++sz;<span class="comment">//å¦‚æœè¯¥å­æ ‘æ²¡æœ‰å­èŠ‚ç‚¹åˆ™æ–°å»º</span></span><br><span class="line">    <span class="keyword">if</span>(!rs(rt)) rs(rt) = ++sz;<span class="comment">//åŠ¨æ€ç”³è¯·èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span>(p &lt;= mid) Insert(ls(rt),l,mid,p,d);</span><br><span class="line">    <span class="keyword">else</span> Insert(rs(rt),mid+<span class="number">1</span>,r,p,d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> p,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*å‘æ ‘çŠ¶æ•°ç»„ä¸­çš„ çº¿æ®µæ ‘ä¸­ ä½ç½®på€¼+d,è¦ä»lå¼€å§‹å“¦*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x = l;x &lt;= n;x += x&amp;-x) Insert(x,<span class="number">1</span>,tot,p,y); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> t1[N],t2[N],c1,c2;<span class="comment">//ä¸´æ—¶è®°å½•éå†è·¯å¾„</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*è¿”å›åŒºé—´[l,r]å†…ç¬¬kå¤§å…ƒç´ çš„å€¼(ç¦»æ•£åŒ–åçš„)*/</span></span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>, mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= c1;i++) res -= sum(ls(t1[i]));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= c2;i++) res += sum(ls(t2[i]));</span><br><span class="line">    <span class="keyword">if</span>(res &gt;= k)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= c1;i++) t1[i] = ls(t1[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= c2;i++) t2[i] = ls(t2[i]);</span><br><span class="line">    <span class="keyword">return</span> ask(l,mid,k);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= c1;i++) t1[i] = rs(t1[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= c2;i++) t2[i] = rs(t2[i]);</span><br><span class="line"><span class="keyword">return</span> ask(mid+<span class="number">1</span>,r,k-res);</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tmp[N*<span class="number">2</span>];<span class="comment">//ç¦»æ•£åŒ–ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">c1 = c2 = <span class="number">0</span>;</span><br><span class="line"><span class="comment">/*æˆ‘ä»¬å°†æ ‘çŠ¶æ•°ç»„ä¸Šå¾…æŸ¥è¯¢çš„çº¿æ®µæ ‘çš„å·¦å„¿å­ç¼–å·å…ˆå­˜å‚¨*/</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = l;i;i -= i&amp;-i) t1[++c1] = i;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = r;i;i -= i&amp;-i) t2[++c2] = i;</span><br><span class="line"><span class="keyword">int</span> x = ask(<span class="number">1</span>,tot,k);<span class="comment">//æ³¨æ„æŸ¥è¯¢åŒºé—´æ˜¯[1,tot] </span></span><br><span class="line"><span class="keyword">return</span> tmp[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i),tmp[++tot] = a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>,op);</span><br><span class="line">        <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">'C'</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;qy[i].p,&amp;qy[i].x);</span><br><span class="line">            tmp[++tot] = qy[i].x;<span class="comment">//å…ˆå­˜å‚¨,æ–¹ä¾¿ç¦»æ•£åŒ–</span></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;qy[i].l,&amp;qy[i].r,&amp;qy[i].k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç¦»æ•£åŒ–</span></span><br><span class="line">    sort(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+tot);</span><br><span class="line">    tot = unique(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+tot)-tmp<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> p = lower_bound(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+tot,a[i])-tmp;</span><br><span class="line">        add(i,p,<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(qy[i].l)&#123;</span><br><span class="line">            <span class="keyword">int</span> l = qy[i].l, r = qy[i].r;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,query(l<span class="number">-1</span>,r,qy[i].k));</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> p = lower_bound(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+tot,qy[i].x)-tmp;</span><br><span class="line">            <span class="keyword">int</span> pre = lower_bound(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+tot,a[qy[i].p])-tmp;</span><br><span class="line">            add(qy[i].p,pre,<span class="number">-1</span>); add(qy[i].p,p,<span class="number">1</span>); a[qy[i].p] = qy[i].x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æƒå€¼çº¿æ®µæ ‘</title>
      <link href="/2019/08/27/qz-tree/"/>
      <url>/2019/08/27/qz-tree/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>æƒå€¼çº¿æ®µæ ‘æ˜¯åœ¨æ™®é€šçº¿æ®µæ ‘çš„åŸºç¡€ä¸Šè¿›è¡Œæ›´æ”¹ï¼Œåˆ©ç”¨å€¼åŸŸå»ºæ ‘è€Œéå®šä¹‰åŸŸï¼ˆä¸‹æ ‡ï¼‰ï¼›è¿™ä½¿å¾—çº¿æ®µæ ‘å…·æœ‰äº†ä¸€äº›æ–°çš„åŠŸèƒ½ï¼Œæœ¬æ–‡å°±å°†ä»æƒå€¼çº¿æ®µæ ‘çš„æ¥å†ï¼Œç”¨é€”ä»¥åŠç®—æ³•æµç¨‹æ–¹é¢æ¥ä»‹ç»è¯¥æ•°æ®ç»“æ„ã€‚æœ€ç»ˆæˆ‘ä»¬ä¼šç”¨ä¸¤ä¸ªä¾‹é¢˜æ¥ä½“ç°æƒå€¼çº¿æ®µæ ‘çš„ç”¨é€”ï¼Œå½“ç„¶è¯¥ä»£ç ä¹Ÿä½œä¸ºå‚è€ƒæ¨¡æ¿ã€‚</p><h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>çº¿æ®µæ ‘æ˜¯å°†ä¸‹æ ‡ä¸æ–­äºŒåˆ†ï¼Œä½¿å¾—æ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹å¯¹åº”ä¸€æ®µåŒºé—´ï¼Œä»è€Œå°†åŒºé—´æ“ä½œæ‹†åˆ†æˆæœ‰å…³è‹¥å¹²èŠ‚ç‚¹çš„æ“ä½œã€‚æƒå€¼çº¿æ®µæ ‘ä¸ä¹‹ç±»ä¼¼ï¼Œéƒ½æ˜¯å°†ä¸€æ®µåŒºé—´ä¸æ–­äºŒåˆ†ï¼Œå¹¶ä»¤æ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹å¯¹åº”ä¸€æ®µåŒºé—´ï¼Œä»¥æ­¤å®ç°â€œå°†åŒºé—´æ“ä½œå˜ä¸ºå¯¹æ ‘ä¸ŠæŸæ¡è·¯å¾„çš„æ“ä½œâ€ï¼Œåªä¸è¿‡è¿™é‡Œåˆ’åˆ†çš„åŒºé—´ä¸å†æ˜¯ä¸‹æ ‡ï¼Œè€Œæ˜¯æƒå€¼ã€‚</p><p>è‡³æ­¤å…¶å®æƒå€¼çº¿æ®µæ ‘çš„ç‰¹ç‚¹å·²ç»å¾ˆæ˜æ˜¾äº†ï¼Œä¸€èˆ¬çš„çº¿æ®µæ ‘å¯¹ä¸‹æ ‡å»ºæ ‘ï¼Œè€Œæƒå€¼çº¿æ®µæ ‘å¯¹æƒå€¼å»ºæ ‘ï¼›æ™®é€šçº¿æ®µæ ‘å¯¹ä¸‹æ ‡ä¸Šçš„å€¼è¿›è¡Œæ“ä½œï¼ˆåŠ å‡ä¹˜é™¤ï¼‰ï¼Œè€Œæƒå€¼çº¿æ®µæ ‘å¯¹å€¼æ‰€å¯¹åº”çš„ä¸‹æ ‡è¿›è¡Œæ“ä½œã€‚</p><h4 id="æƒå€¼çº¿æ®µæ ‘çš„ç”¨é€”"><a href="#æƒå€¼çº¿æ®µæ ‘çš„ç”¨é€”" class="headerlink" title="æƒå€¼çº¿æ®µæ ‘çš„ç”¨é€”"></a>æƒå€¼çº¿æ®µæ ‘çš„ç”¨é€”</h4><p>è¿™å°±å¥½æ¯”ä¸€ä¸ªæ˜¯å¯¹ <strong>å®šä¹‰åŸŸ</strong> å»ºæ ‘ï¼Œè€Œå¦ä¸€ä¸ªæ˜¯å¯¹ <strong>å€¼åŸŸ</strong> å»ºæ ‘ï¼Œæ‰€ä»¥æƒå€¼çº¿æ®µæ ‘å…·æœ‰å¦‚ä¸‹ç”¨é€”ï¼š</p><ul><li>ç»Ÿè®¡èŒƒå›´å†…å…ƒç´ çš„ä¸ªæ•°ï¼ˆè¿™é‡Œçš„èŒƒå›´æ˜¯æŒ‡å€¼åŸŸä¸Šçš„èŒƒå›´ï¼Œä¾‹å¦‚ï¼šæ±‚é€†åºå¯¹ï¼‰ã€‚</li><li>æŸ¥è¯¢åºåˆ—ä¸­ï¼Œä¸‹æ ‡å¤§äºrçš„ ç¬¬ä¸€ä¸ªå¤§äº k çš„æ•°ã€‚</li></ul><p>åªæ˜¯å¯¹çº¿æ®µæ ‘è¿›è¡Œç®€å•çš„æ›´æ”¹ï¼Œå°±ä½¿å…¶æ‹¥æœ‰äº†è¿™äº›åŠŸèƒ½ï¼ˆè™½ç„¶è¿™äº›åŠŸèƒ½å…¶å®ƒæ•°æ®ç»“æ„ä¹Ÿèƒ½å®ç°ï¼‰ï¼Œå¯è§çº¿æ®µæ ‘çš„çµæ´»æ€§ã€‚</p><h4 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h4><p>ç¬¬ä¸€æ­¥ï¼šé€šå¸¸å…ƒç´ çš„å€¼åŸŸèŒƒå›´å¾ˆå¤§ï¼Œä½†æ˜¯ä¸ªæ•°å¾ˆå°‘ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šå…ˆå¯¹è¿™nä¸ªæ•°ç¦»æ•£åŒ–å¤„ç†ï¼Œå¤„ç†ä¹‹åå°±åªæœ‰totä¸ªä¸åŒçš„å€¼([1 , tot])ã€‚</p><p>ç¬¬äºŒæ­¥ï¼šå¯¹åŒºé—´[1, tot]å»ºç«‹çº¿æ®µæ ‘ã€‚</p><p>ç¬¬ä¸‰æ­¥ï¼šæŒ‰ç…§é¢˜æ„è¿›è¡Œæ“ä½œã€‚</p><h4 id="ä¾‹é¢˜1ï¼šæ±‚é€†åºå¯¹"><a href="#ä¾‹é¢˜1ï¼šæ±‚é€†åºå¯¹" class="headerlink" title="ä¾‹é¢˜1ï¼šæ±‚é€†åºå¯¹"></a>ä¾‹é¢˜1ï¼šæ±‚é€†åºå¯¹</h4><p><a href="https://www.luogu.org/problem/P1908" target="_blank" rel="noopener">æµ‹è¯•åœ°å€ï¼šæ´›è°·P1908</a><br>è™½ç„¶æˆ‘ä»¬æœ‰æ›´å¥½çš„æ±‚é€†åºå¯¹çš„æ–¹æ³•ï¼Œä¾‹å¦‚å½’å¹¶ã€CDQåˆ†æ²»ã€æ ‘çŠ¶æ•°ç»„ç­‰ï¼Œä½†æ˜¯è¿™é¢˜å…¶å®ä¹Ÿå¾ˆå¥½çš„ä½“ç°æƒå€¼çº¿æ®µæ ‘çš„æ€è·¯ï¼Œä½œä¸ºå…¥é—¨è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬å°†è¾ƒä¸ºåˆ†æ•£çš„nä¸ªå…ƒç´ æŒ‰ç…§æƒå€¼ç¦»æ•£åŒ–ï¼Œç¦»æ•£åŒ–ä¹‹åè¿™nä¸ªå…ƒç´ å–å€¼èŒƒå›´ï¼ˆæ˜ å°„é›†åˆï¼‰å°±åœ¨[1,tot]ä¹‹é—´ï¼Œè€Œè‹¥  i &gt; jï¼Œé‚£ä¹ˆ i ä»£è¡¨çš„å…ƒç´ ä¸€å®šæ¯” j ä»£è¡¨çš„å…ƒç´ å¤§ã€‚</p><p>æ¥ä¸‹æ¥ä»å‰å‘åéå†åŸæ•°ç»„çš„nä¸ªå…ƒç´ ï¼Œæ‰¾åˆ°å…¶ç¦»æ•£åŒ–åçš„æ ‡å·iï¼Œå†ç»Ÿè®¡çº¿æ®µæ ‘ä¸­&gt;içš„å…ƒç´ ä¸ªæ•°æœ‰å¤šå°‘ä¸ªï¼Œç´¯åŠ åˆ°ç­”æ¡ˆå³å¯ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æƒå€¼çº¿æ®µæ ‘æ¨¡æ¿ æœ€åä¿®æ”¹:2019/8/25 </span></span><br><span class="line"><span class="comment">æ´›è°·P1908:ç»™å‡ºnä¸ªæ•°æ±‚é€†åºå¯¹æ•°é‡ </span></span><br><span class="line"><span class="comment">ç”±äºå€¼åŸŸè¿‡äºåˆ†æ•£,ä¸”æ•°å­—å¤ªå¤§,é‡‡ç”¨ç¦»æ•£åŒ–æ–¹æ³• </span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll a[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> l,r,sum;</span><br><span class="line"><span class="comment">/* å·¦ç«¯ç‚¹,å³ç«¯ç‚¹,[l,r]å†…å…ƒç´ æ€»æ•° */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) tr[x].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) tr[x].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(x) tr[x].sum</span></span><br><span class="line">&#125;tr[N*<span class="number">4</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">ll val;<span class="keyword">int</span> id;</span><br><span class="line"><span class="comment">/*å…ƒç´ çš„å€¼,åºå·,ç”¨äºç¦»æ•£åŒ–*/</span></span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node&amp; rhs)<span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> val &lt; rhs.val;</span><br><span class="line">&#125;</span><br><span class="line">&#125;tmp[N]; </span><br><span class="line"><span class="keyword">int</span> n,tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å¯¹[l,r]å»ºç«‹ä¸€æ£µå­æ ‘,è¯¥å­æ ‘æ ¹èŠ‚ç‚¹æ˜¯rt*/</span></span><br><span class="line">l(rt) = l, r(rt) = r, sum(rt) = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">BuildTree(rt*<span class="number">2</span>,l,mid);</span><br><span class="line">BuildTree(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="comment">/*æŸ¥è¯¢å¤§äºç­‰äºyçš„æ•°çš„ä¸ªæ•°*/</span> </span><br><span class="line"><span class="keyword">if</span>(l(rt) == r(rt)) <span class="keyword">return</span> sum(rt);</span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>, res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(y &lt;= mid) <span class="keyword">return</span> ask(rt*<span class="number">2</span>,y)+sum(rt*<span class="number">2</span>+<span class="number">1</span>); <span class="comment">//åŠ ä¸Šæ•´æ®µå³åŒºé—´ </span></span><br><span class="line"><span class="keyword">return</span> ask(rt*<span class="number">2</span>+<span class="number">1</span>,y);<span class="comment">//ç­”æ¡ˆåœ¨å³å­æ ‘ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å°†pä½ç½®+1*/</span></span><br><span class="line"><span class="keyword">if</span>(l(rt) &lt;= p &amp;&amp; p &lt;= r(rt)) sum(rt)++;</span><br><span class="line"><span class="keyword">if</span>(l(rt) == r(rt)) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(p &lt;= mid) updata(rt*<span class="number">2</span>,p);</span><br><span class="line"><span class="keyword">else</span> updata(rt*<span class="number">2</span>+<span class="number">1</span>,p);</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//é¦–å…ˆç¦»æ•£åŒ–</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) tmp[i].val = a[i],tmp[i].id = i; </span><br><span class="line">sort(tmp+<span class="number">1</span>,tmp+<span class="number">1</span>+n); tot = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(i == <span class="number">1</span> || tmp[i].val != tmp[i<span class="number">-1</span>].val) ++tot;</span><br><span class="line">a[tmp[i].id] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç¦»æ•£åŒ–ä¹‹åå€¼åŸŸ[1,tot],ä»¥æ­¤ä¸ºåŒºé—´å»ºæ ‘</span></span><br><span class="line">BuildTree(<span class="number">1</span>,<span class="number">1</span>,tot); </span><br><span class="line"><span class="comment">//ä¸‹ä¸€æ­¥å°±æ˜¯æŸ¥è¯¢ä¸æ›´æ–°äº†</span></span><br><span class="line">ll ans = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">ans += ask(<span class="number">1</span>,a[i]+<span class="number">1</span>);<span class="comment">//åœ¨å‰i-1ä¸ªæ•°ä¸­,æ¯”a[i]å¤§çš„æœ‰å¤šå°‘</span></span><br><span class="line">updata(<span class="number">1</span>,a[i]);<span class="comment">//å€¼ä¸ºa[i]çš„æ•°+1 </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,a+i);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ä¾‹é¢˜2ï¼š2019CCPCç½‘ç»œèµ›-B-array"><a href="#ä¾‹é¢˜2ï¼š2019CCPCç½‘ç»œèµ›-B-array" class="headerlink" title="ä¾‹é¢˜2ï¼š2019CCPCç½‘ç»œèµ› B.array"></a>ä¾‹é¢˜2ï¼š2019CCPCç½‘ç»œèµ› B.array</h4><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6703" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®š1~nå…±nä¸ªæ•°ç»„æˆçš„åºåˆ—ï¼Œæœ‰mæ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œæœ‰ä¸¤ç§å¯èƒ½ï¼š</p><ol><li>(1,pos)ä»¤ $a_{pos} = a_{pos}+1,000,000$ã€‚</li><li>(2, r , k) å›ç­”ä¸åœ¨$a_i(1&lt;= i &lt;= r)$å†…çš„ï¼Œå¤§äºç­‰äºkçš„æœ€å°å€¼ã€‚</li></ol><p>å¼ºåˆ¶åœ¨çº¿ã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>é¦–å…ˆæ˜¯ç†è§£é¢˜æ„ï¼Œç„¶åå¦‚æœæŒ‰ç…§é¢˜ç›®è¦æ±‚æ¥è§£é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ¯æ¬¡éƒ½é€šè¿‡éå†æ¥æ’é™¤[1,r]å†…çš„å…ƒç´ ï¼Œæ˜¾ç„¶ä¼šè¶…æ—¶ã€‚ç”±äºé¢˜ç›®ä¸­$a_i$æ˜¯å„ä¸ç›¸åŒçš„ï¼Œåˆæ˜¯å°äºnçš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†åŸé—®é¢˜è½¬åŒ–ä¸ºæ±‚â€œå¤§äºç­‰äºkçš„æ‰€æœ‰å…ƒç´ ä¸­ï¼Œç¬¬ä¸€ä¸ªä¸‹æ ‡å¤§äºrçš„å…ƒç´ çš„å€¼â€ã€‚å¯¹äºè¿™ä¸ªé—®é¢˜æˆ‘ä»¬æ¯æ¬¡éœ€è¦è¯¢é—®æ‰€æœ‰å€¼åœ¨[k,n+10]å†…ï¼Œç¬¬ä¸€ä¸ªä¸‹æ ‡å¤§äºrçš„å³å¯ã€‚</p><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å»ºç«‹æƒå€¼çº¿æ®µæ ‘ï¼Œçº¿æ®µæ ‘çš„ä¸‹æ ‡æ˜¯å€¼$a_i$ï¼Œå€¼æ˜¯ä¸‹æ ‡iï¼Œå¯¹äºæ¯ä¸ªæ“ä½œ1ï¼Œå°±ç›¸å½“äºæŠŠposä½ç½®ä¸Šçš„æ•°åˆ æ‰äº†ã€‚åŠ ä¸Šä¸€äº›å°å‰ªæå°±å¯ä»¥è¿‡ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt; </span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line"><span class="comment">/*åŒºé—´[l,r]å†…å…ƒç´ ä¸ªæ•°ä¸ºsum*/</span></span><br><span class="line"><span class="keyword">int</span> l,r,sum,mx;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) tr[x].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) tr[x].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mx(x) tr[x].mx</span></span><br><span class="line">&#125;tr[N*<span class="number">4</span>];</span><br><span class="line"><span class="comment">/*aæ•°ç»„å­˜æ”¾åºåˆ—,bæ•°ç»„ç¦»æ•£åŒ–ç”¨</span></span><br><span class="line"><span class="comment">totæ˜¯ç¦»æ•£åŒ–åä¸åŒå…ƒç´ ä¸ªæ•° </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">ll a[N],b[N];</span><br><span class="line"><span class="keyword">int</span> n,m,tot,t;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å¯¹[l,r]å»ºç«‹ä¸€æ£µæ ¹ä¸ºrtçš„å­æ ‘*/</span></span><br><span class="line">l(rt) = l, r(rt) = r , mx(rt) = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">BuildTree(rt*<span class="number">2</span>,l,mid);</span><br><span class="line">BuildTree(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> p,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"><span class="comment">/*pä½ç½®å€¼+1(å€¼ä¸ºpçš„å…ƒç´ çš„æ•°é‡+1)*/</span></span><br><span class="line"><span class="comment">//printf("%d %d %d %d %d\n",rt,l(rt),r(rt),p,d);</span></span><br><span class="line"><span class="keyword">if</span>(l(rt) == r(rt))&#123;</span><br><span class="line">mx(rt) = d; <span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(p &lt;= mid) Insert(rt*<span class="number">2</span>,p,d);</span><br><span class="line"><span class="keyword">else</span> Insert(rt*<span class="number">2</span>+<span class="number">1</span>,p,d); </span><br><span class="line">mx(rt) = max(mx(rt*<span class="number">2</span>),mx(rt*<span class="number">2</span>+<span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> k,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">//printf("%d %d %d %d %d %d\n",rt,l(rt),r(rt),k,r,mx(rt));</span></span><br><span class="line"><span class="comment">/*è¿”å›[k,n]ä¸­ç¬¬ä¸€ä¸ªå¤§äºrçš„å€¼*/</span></span><br><span class="line"><span class="keyword">if</span>(l(rt) == r(rt))&#123;</span><br><span class="line"><span class="keyword">if</span>(mx(rt) &lt;= r) <span class="keyword">return</span> -INF;</span><br><span class="line"><span class="keyword">return</span> l(rt);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>, res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(k &lt;= mid &amp;&amp; mx(rt*<span class="number">2</span>) &gt; r) res = ask(rt*<span class="number">2</span>,k,r);</span><br><span class="line"><span class="keyword">if</span>(res &lt;= <span class="number">0</span>) <span class="keyword">return</span> ask(rt*<span class="number">2</span>+<span class="number">1</span>,k,r);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line">ans = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">BuildTree(<span class="number">1</span>,<span class="number">1</span>,n+<span class="number">10</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lld"</span>,a+i);</span><br><span class="line">Insert(<span class="number">1</span>,a[i],i);<span class="comment">//a[i]ä¸‹æ ‡ä¸º i </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = n+<span class="number">1</span>;i &lt;= n+<span class="number">10</span>;i++) Insert(<span class="number">1</span>,i,INF);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,op,pos,r,k;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;op);</span><br><span class="line"><span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;pos);</span><br><span class="line">pos ^= ans;</span><br><span class="line">Insert(<span class="number">1</span>,a[pos],INF);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;r,&amp;k);</span><br><span class="line">k ^= ans, r ^= ans;</span><br><span class="line">ans = ask(<span class="number">1</span>,k,r);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019CCPCç½‘ç»œèµ›éƒ¨åˆ†é¢˜è§£</title>
      <link href="/2019/08/25/2019ccpc/"/>
      <url>/2019/08/25/2019ccpc/</url>
      
        <content type="html"><![CDATA[<h4 id="1001-amp"><a href="#1001-amp" class="headerlink" title="1001 ^&amp;^"></a>1001 ^&amp;^</h4><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®šæ­£æ•´æ•°aå’Œbï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„æ­£æ•´æ•°cï¼Œä½¿å¾—(a^c)&amp;(b^c)æœ€å°ã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>ä¸¤ä¸ªæ•°æŒ‰ä½ä¸æœ€å°ç»“æœè‚¯å®šæ˜¯0å•Šï¼Œæ‰€ä»¥å¯¹äºaå’Œbï¼Œå¦‚æœå®ƒä»¬å¯¹åº”äºŒè¿›åˆ¶ä½ä¸Šæœ‰0ï¼Œåˆ™cç½®ä¸º0å³å¯ï¼Œå› ä¸º0^0 = 0 , è¿™å°±ä¿è¯äº†å¼‚æˆ–ä¹‹åè‚¯å®šæœ‰ä¸€ä¸ªæ˜¯0ï¼Œå†&amp;ä¹‹åè¿˜æ˜¯0ï¼›è‹¥å®ƒä»¬å¯¹åº”äºŒè¿›åˆ¶ä½éƒ½æ˜¯1ï¼Œåˆ™åªèƒ½ç½®cçš„å¯¹åº”äºŒè¿›åˆ¶ä½ä¸º1äº†ï¼Œå› ä¸º1^1 = 0ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ‰€æ±‚ç»“æœcæ˜¯æ­£æ•´æ•°ï¼Œæ‰€ä»¥å¦‚æœå½“c = 0æ—¶ï¼Œåˆ™éœ€è¦ä»ä½ä½å‘é«˜ä½ï¼Œå°†0-1æˆ–1-0ä½æ—¶ï¼Œcå¯¹åº”äºŒè¿›åˆ¶ä½ = 1ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line">ll a,b;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll c = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= <span class="number">32</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>((a&amp;(<span class="number">1l</span>l&lt;&lt;i)) &amp;&amp; (b&amp;(<span class="number">1l</span>l&lt;&lt;i))) c = c|(<span class="number">1l</span>l&lt;&lt;i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(c == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= <span class="number">32</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>((a&amp;(<span class="number">1l</span>l&lt;&lt;i)) != (b&amp;(<span class="number">1l</span>l&lt;&lt;i)))&#123;</span><br><span class="line">                c = c|(<span class="number">1l</span>l&lt;&lt;i);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;a,&amp;b);</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="1002-array"><a href="#1002-array" class="headerlink" title="1002 array"></a>1002 array</h4><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6703" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®š1~nå…±nä¸ªæ•°ç»„æˆçš„åºåˆ—ï¼Œæœ‰mæ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œæœ‰ä¸¤ç§å¯èƒ½ï¼š</p><ol><li>(1,pos)ä»¤ $a_{pos} = a_{pos}+1,000,000$ã€‚</li><li>(2, r , k) å›ç­”ä¸åœ¨$a_i(1&lt;= i &lt;= r)$å†…çš„ï¼Œå¤§äºç­‰äºkçš„æœ€å°å€¼ã€‚</li></ol><p>å¼ºåˆ¶åœ¨çº¿ã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>é¦–å…ˆæ˜¯ç†è§£é¢˜æ„ï¼Œç„¶åå¦‚æœæŒ‰ç…§é¢˜ç›®è¦æ±‚æ¥è§£é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ¯æ¬¡éƒ½é€šè¿‡éå†æ¥æ’é™¤[1,r]å†…çš„å…ƒç´ ï¼Œæ˜¾ç„¶ä¼šè¶…æ—¶ã€‚ç”±äºé¢˜ç›®ä¸­$a_i$æ˜¯å„ä¸ç›¸åŒçš„ï¼Œåˆæ˜¯å°äºnçš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†åŸé—®é¢˜è½¬åŒ–ä¸ºæ±‚â€œå¤§äºç­‰äºkçš„æ‰€æœ‰å…ƒç´ ä¸­ï¼Œç¬¬ä¸€ä¸ªä¸‹æ ‡å¤§äºrçš„å…ƒç´ çš„å€¼â€ã€‚å¯¹äºè¿™ä¸ªé—®é¢˜æˆ‘ä»¬æ¯æ¬¡éœ€è¦è¯¢é—®æ‰€æœ‰å€¼åœ¨[k,n+10]å†…ï¼Œç¬¬ä¸€ä¸ªä¸‹æ ‡å¤§äºrçš„å³å¯ã€‚</p><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å»ºç«‹æƒå€¼çº¿æ®µæ ‘ï¼Œçº¿æ®µæ ‘çš„ä¸‹æ ‡æ˜¯å€¼$a_i$ï¼Œå€¼æ˜¯ä¸‹æ ‡iï¼Œå¯¹äºæ¯ä¸ªæ“ä½œ1ï¼Œå°±ç›¸å½“äºæŠŠposä½ç½®ä¸Šçš„æ•°åˆ æ‰äº†ã€‚åŠ ä¸Šä¸€äº›å°å‰ªæå°±å¯ä»¥è¿‡ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt; </span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line"><span class="comment">/*åŒºé—´[l,r]å†…å…ƒç´ ä¸ªæ•°ä¸ºsum*/</span></span><br><span class="line"><span class="keyword">int</span> l,r,sum,mx;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) tr[x].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) tr[x].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mx(x) tr[x].mx</span></span><br><span class="line">&#125;tr[N*<span class="number">4</span>];</span><br><span class="line"><span class="comment">/*aæ•°ç»„å­˜æ”¾åºåˆ—,bæ•°ç»„ç¦»æ•£åŒ–ç”¨</span></span><br><span class="line"><span class="comment">totæ˜¯ç¦»æ•£åŒ–åä¸åŒå…ƒç´ ä¸ªæ•° </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">ll a[N],b[N];</span><br><span class="line"><span class="keyword">int</span> n,m,tot,t;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildTree</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">/*å¯¹[l,r]å»ºç«‹ä¸€æ£µæ ¹ä¸ºrtçš„å­æ ‘*/</span></span><br><span class="line">l(rt) = l, r(rt) = r , mx(rt) = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">BuildTree(rt*<span class="number">2</span>,l,mid);</span><br><span class="line">BuildTree(rt*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> p,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"><span class="comment">/*pä½ç½®å€¼+1(å€¼ä¸ºpçš„å…ƒç´ çš„æ•°é‡+1)*/</span></span><br><span class="line"><span class="comment">//printf("%d %d %d %d %d\n",rt,l(rt),r(rt),p,d);</span></span><br><span class="line"><span class="keyword">if</span>(l(rt) == r(rt))&#123;</span><br><span class="line">mx(rt) = d; <span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(p &lt;= mid) Insert(rt*<span class="number">2</span>,p,d);</span><br><span class="line"><span class="keyword">else</span> Insert(rt*<span class="number">2</span>+<span class="number">1</span>,p,d); </span><br><span class="line">mx(rt) = max(mx(rt*<span class="number">2</span>),mx(rt*<span class="number">2</span>+<span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> k,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">//printf("%d %d %d %d %d %d\n",rt,l(rt),r(rt),k,r,mx(rt));</span></span><br><span class="line"><span class="comment">/*è¿”å›[k,n]ä¸­ç¬¬ä¸€ä¸ªå¤§äºrçš„å€¼*/</span></span><br><span class="line"><span class="keyword">if</span>(l(rt) == r(rt))&#123;</span><br><span class="line"><span class="keyword">if</span>(mx(rt) &lt;= r) <span class="keyword">return</span> -INF;</span><br><span class="line"><span class="keyword">return</span> l(rt);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">int</span> mid = l(rt)+r(rt)&gt;&gt;<span class="number">1</span>, res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(k &lt;= mid &amp;&amp; mx(rt*<span class="number">2</span>) &gt; r) res = ask(rt*<span class="number">2</span>,k,r);</span><br><span class="line"><span class="keyword">if</span>(res &lt;= <span class="number">0</span>) <span class="keyword">return</span> ask(rt*<span class="number">2</span>+<span class="number">1</span>,k,r);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line">ans = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">BuildTree(<span class="number">1</span>,<span class="number">1</span>,n+<span class="number">10</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lld"</span>,a+i);</span><br><span class="line">Insert(<span class="number">1</span>,a[i],i);<span class="comment">//a[i]ä¸‹æ ‡ä¸º i </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = n+<span class="number">1</span>;i &lt;= n+<span class="number">10</span>;i++) Insert(<span class="number">1</span>,i,INF);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,op,pos,r,k;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;op);</span><br><span class="line"><span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;pos);</span><br><span class="line">pos ^= ans;</span><br><span class="line">Insert(<span class="number">1</span>,a[pos],INF);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;r,&amp;k);</span><br><span class="line">k ^= ans, r ^= ans;</span><br><span class="line">ans = ask(<span class="number">1</span>,k,r);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="1004-Path"><a href="#1004-Path" class="headerlink" title="1004 Path"></a>1004 Path</h4><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6705" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ä¸€å…±æœ‰nä¸ªç‚¹mæ¡è¾¹å’Œqæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™å‡ºä¸€ä¸ªæ•´æ•°kï¼Œè¯·é—®åœ¨å›¾ä¸­çš„æ‰€æœ‰è·¯å¾„ä¸­ç¬¬kçŸ­çš„è·¯å¾„é•¿åº¦æ˜¯å¤šå°‘ï¼Ÿ</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>åˆšå¼€å§‹æ€è·¯æœ‰äº›ä¸å¯¹ï¼Œå…¶å®è¿™é¢˜å¹¶ä¸æ˜¯æ±‚æœ€çŸ­è·¯æˆ–è€…A *  æˆ–æ€æ ·ï¼Œæ®è¯´æ˜¯å¸¸è§å¥—è·¯ã€‚<br>é¦–å…ˆå‰mçŸ­çš„è¾¹å°±æ˜¯è¿™mæ¡è¾¹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤ è·¯å¾„ï¼Œè€Œä¸€æ¡è·¯å¾„ç”±â€œèµ·ç‚¹ï¼Œç»ˆç‚¹ï¼Œè·¯å¾„é•¿åº¦ï¼Œä¸Šä¸€ä¸ªç‚¹çš„ç¼–å·ï¼Œè¯¥è¾¹åœ¨ä¸Šä¸€ä¸ªç‚¹æ‰€æœ‰è¾¹ä¸­çš„æ’åâ€æ„æˆã€‚</p><p>è¿™æ ·æ¯æ¬¡ä»æœ€å°å †ä¸­å¼¹å‡ºä¸€æ¡è·¯å¾„ï¼Œè¯¥è·¯å¾„å°±æ˜¯å‰©ä¸‹æ‰€æœ‰è·¯å¾„ä¸­æœ€çŸ­çš„ä¸€æ¡ï¼›è€Œä¸”è¯¥è·¯å¾„åªæœ‰â€œä»å½“å‰ç»ˆç‚¹å‡ºå‘èµ°ä¸‹ä¸€æ¡æœ€çŸ­è¾¹â€å’Œâ€œè¿”å›åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹parï¼Œç„¶åä»parèµ°æ¬¡çŸ­è¾¹â€è¿™ä¸¤ç§å¯èƒ½ä¼šå¯¹æœ€ç»ˆç­”æ¡ˆæœ‰è´¡çŒ®ï¼Œæ‰€ä»¥å°†è¿™ä¸¤æ¡è·¯å¾„å†å‹å…¥æœ€å°å †å³å¯ï¼Œå¦‚æ­¤åå¤æ“ä½œç›´è‡³æ±‚å¾—æ‰€æœ‰æœ€çŸ­è·¯å¾„ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">x:è¾¹çš„èµ·ç‚¹,y:ç»ˆç‚¹,par:ä¸Šä¸€ä¸ªç‚¹çš„ç¼–å·,</span></span><br><span class="line"><span class="comment">rk:åœ¨ä¸Šä¸€ä¸ªç‚¹çš„æ‰€æœ‰å‡ºè¾¹ä¸­åæ¬¡,d:è·¯å¾„é•¿åº¦ </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">int</span> x,y,par,rk;</span><br><span class="line">ll d;</span><br><span class="line">Node(<span class="keyword">int</span> x,<span class="keyword">int</span> y,ll d,<span class="keyword">int</span> par,<span class="keyword">int</span> rk):x(x),y(y),d(d),par(par),rk(rk)&#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node&amp; B)<span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> d &gt; B.d;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">ll dis[N];</span><br><span class="line">priority_queue&lt;Node&gt; q;</span><br><span class="line"><span class="keyword">int</span> t,n,m,qq,k;</span><br><span class="line"><span class="keyword">int</span> a[N],ord[N];</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,ll&gt; pa;</span><br><span class="line"><span class="built_in">vector</span>&lt;pa&gt; G[N];<span class="comment">//å­˜å‚¨ç‚¹çš„æ‰€æœ‰å‡ºè¾¹,æŒ‰æƒå€¼å‡åº </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">Node e = q.top();q.pop();</span><br><span class="line">dis[++cnt] = e.d;</span><br><span class="line"><span class="keyword">if</span>(cnt &gt; k) <span class="keyword">break</span>;<span class="comment">//ç»Ÿè®¡å‡ºæ¥å‰kä¸ªå³å¯</span></span><br><span class="line"><span class="comment">/*åªæœ‰ä¸¤ç§æƒ…å†µå¯èƒ½æ›´æ–°ç­”æ¡ˆ*/</span> </span><br><span class="line"><span class="keyword">if</span>(G[e.par].size() &gt; e.rk+<span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">int</span> x = e.x,y = G[e.x][e.rk+<span class="number">1</span>].second , par = x, rk = e.rk+<span class="number">1</span>;</span><br><span class="line">ll z = e.d - G[e.x][e.rk].first+G[e.x][rk].first;</span><br><span class="line">q.push(Node(x,y,z,par,rk));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(G[e.y].size()) </span><br><span class="line">q.push(Node(e.y,G[e.y][<span class="number">0</span>].second,e.d+G[e.y][<span class="number">0</span>].first,e.y,<span class="number">0</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;qq); k = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) G[i].clear(),ord[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.empty()) q.pop();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">G[x].push_back(make_pair(z,y));</span><br><span class="line">q.push(Node(x,y,z,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) sort(G[i].begin(),G[i].end());</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= qq;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i),k = k&gt;a[i]?k:a[i];</span><br><span class="line">solve();<span class="comment">//é¢„å¤„ç† </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= qq;i++) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,dis[a[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="1006-Shuffle-Card"><a href="#1006-Shuffle-Card" class="headerlink" title="1006 Shuffle Card"></a>1006 Shuffle Card</h4><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>é˜Ÿå‹ä¸€å‘è¿‡äº†ï¼Œå¬è¯´æ˜¯ä¸ªæ¨¡æ‹Ÿé¢˜ï¼Œccfnbã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Max = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,q,s;</span><br><span class="line"><span class="keyword">int</span> bk[Max];</span><br><span class="line"><span class="keyword">int</span> val[Max];</span><br><span class="line"><span class="built_in">deque</span> &lt;<span class="keyword">int</span>&gt; deq;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>,&amp;n,&amp;q);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;val[i]);</span><br><span class="line">        deq.push_back(val[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;s);</span><br><span class="line">        deq.push_front(s);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!deq.empty())&#123;</span><br><span class="line">        <span class="keyword">if</span>(!bk[deq.front()])&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d "</span>,deq.front());</span><br><span class="line">            bk[deq.front()] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        deq.pop_front();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="1007-Windows-Of-CCPC"><a href="#1007-Windows-Of-CCPC" class="headerlink" title="1007 Windows Of CCPC"></a>1007 Windows Of CCPC</h4><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>è¾“å‡ºCCPCï¼Œå½“ç„¶æ˜¯2 <em> 2çŸ©é˜µè¾“å‡ºï¼Œæ­¤ä¸ºå•å…ƒã€‚å¦‚æœn &gt; 1ï¼Œé‚£ä¹ˆå°±é€’å½’n - 1æ¬¡ï¼Œæ¯æ¬¡é€’å½’éƒ½æŠŠCæ›¿æ¢æˆä¸€ä¸ªæ ‡å‡†å•å…ƒï¼ŒæŠŠPæ›¿æ¢ä¸ºä¸€ä¸ªâ€œåå•å…ƒâ€ï¼ˆåå•å…ƒå³å°†æ ‡å‡†å•å…ƒä¸­çš„Cæ›¿æ¢ä¸ºPï¼ŒPæ›¿æ¢ä¸ºCï¼Œå³PPCPï¼Œä¹Ÿæ˜¯2 </em> 2çŸ©é˜µå½¢å¼ï¼‰ä½œä¸ºæ–°çš„çŸ©é˜µã€‚<br>ç»™å®šnï¼Œè¾“å‡ºç»“æœã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>å°±æ˜¯ç®€å•çš„æ¨¡æ‹Ÿï¼Œç”¨æ•°ç»„ï¼Œå½“ç„¶æœ€å¥½ç”¨putcharï¼Œå¦åˆ™å¯èƒ½ä¼šè¶…æ—¶ï¼Œè¿˜æœ‰å°±æ˜¯næœ€å¤§æ˜¯10ï¼Œå¯ä»¥è¾“å‡ºåˆ°txtæ–‡ä»¶ä¸­è‚‰çœ¼è§‚å¯Ÿä¸€ä¸‹æ˜¯å¦æ­£ç¡®å†æäº¤ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> t,k;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3400</span>;</span><br><span class="line"><span class="keyword">char</span> G[N][N];</span><br><span class="line"><span class="keyword">char</span> tmp[N][N]; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    G[<span class="number">1</span>][<span class="number">1</span>] = G[<span class="number">1</span>][<span class="number">2</span>] = G[<span class="number">2</span>][<span class="number">2</span>] = <span class="string">'C'</span>;</span><br><span class="line">    G[<span class="number">2</span>][<span class="number">1</span>] = <span class="string">'P'</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= k;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= (<span class="number">1</span>&lt;&lt;i);j++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> z = <span class="number">1</span>;z &lt;= (<span class="number">1</span>&lt;&lt;i);z++)&#123;</span><br><span class="line">                <span class="keyword">int</span> r = <span class="number">2</span>*(j<span class="number">-1</span>)+<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">int</span> c = <span class="number">2</span>*(z<span class="number">-1</span>)+<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(G[j][z] == <span class="string">'C'</span>)&#123;</span><br><span class="line">                    tmp[r][c] = tmp[r][c+<span class="number">1</span>] = tmp[r+<span class="number">1</span>][c+<span class="number">1</span>] = <span class="string">'C'</span>;</span><br><span class="line">                    tmp[r+<span class="number">1</span>][c] = <span class="string">'P'</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    tmp[r][c] = tmp[r][c+<span class="number">1</span>] = tmp[r+<span class="number">1</span>][c+<span class="number">1</span>] = <span class="string">'P'</span>;</span><br><span class="line">                    tmp[r+<span class="number">1</span>][c] = <span class="string">'C'</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= (<span class="number">1</span>&lt;&lt;i);j++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> z = <span class="number">1</span>;z &lt;= (<span class="number">1</span>&lt;&lt;i);z++)</span><br><span class="line">              G[j][z] = tmp[j][z];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">1</span>&lt;&lt;k;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">1</span>&lt;&lt;k;j++) <span class="built_in">putchar</span>(G[i][j]);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//freopen("in.txt","r",stdin);</span></span><br><span class="line">    <span class="comment">//freopen("out.txt","w",stdout);</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;k);</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="1008-Fishing-Master"><a href="#1008-Fishing-Master" class="headerlink" title="1008 Fishing Master"></a>1008 Fishing Master</h4><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6709" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ä¸€å…±æœ‰næ¡é±¼ï¼Œé’“ä»»æ„ä¸€æ¡é±¼éœ€è¦èŠ±è´¹æ—¶é—´kï¼Œè€Œç…®ç†Ÿä¸€æ¡é±¼éœ€è¦èŠ±è´¹$t_i$ æ—¶é—´ï¼Œè¿™næ¡é±¼çš„é¡ºåºä¸å›ºå®šï¼Œå³æˆ‘ä»¬æ¯æ¬¡å¯ä»¥é’“æˆ‘ä»¬æƒ³è¦çš„é‚£æ¡ã€‚åœ¨é’“é±¼çš„kæ—¶é—´å†…ä¸èƒ½ä¸­æ–­ï¼Œå³æˆ‘ä»¬ä¸èƒ½åœ¨é’“é±¼çš„æ—¶é—´å†…å»ç…®æˆ–è€…æ‹¿å‡ºï¼Œå½“ç„¶ä¸€æ¬¡åªèƒ½ç…®ä¸€æ¡é±¼ã€‚è¯·é—®ç…®ç†Ÿè¿™næ¡é±¼æœ€å°‘èŠ±è´¹å¤šå°‘æ—¶é—´ï¼Ÿ<br>tipï¼šåœ¨é’“ä¸Šæ¥ä¸€æ¡é±¼åï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç­‰é”…é‡Œçš„é±¼ç…®ç†Ÿï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰ï¼Œæˆ–è€…ç›´æ¥å»é’“é±¼ï¼Œå›æ¥å†è¯´ï¼Œå› ä¸ºåŒä¸€æ—¶åˆ»æˆ‘ä»¬æ‰‹é‡Œå¯ä»¥æœ‰ä»»æ„å¤šæ¡é±¼ï¼Œä¸å±€é™äºä¸€æ¡ã€‚æé™æƒ…å†µå°±æ˜¯æˆ‘ä»¬å…ˆé’“å®Œnæ¡é±¼ï¼Œå†ä¸€æ¡ä¸€æ¡ç…®ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è¿™é¢˜ç»†èŠ‚å¾ˆå¤šï¼Œé¢˜æ„å¾ˆå¤šåœ°æ–¹ç¨ä¸æ³¨æ„å°±ä¼šæœ‰æ­§ä¹‰ï¼Œæ‰€ä»¥åšè¿™ç§é¢˜ä¹‹å‰ä¸€å®šè¦å…ˆäº†è§£æ¸…æ¥šé¢˜æ„åˆ°åº•æ˜¯ä»€ä¹ˆè§„åˆ™ä»¥åŠè¦æ±‚ä»€ä¹ˆã€‚ææ¸…æ¥šäº†ä¹‹åç®—æ³•çš„è®¾è®¡å°±å¹¶ä¸éš¾æƒ³äº†ï¼Œæ˜¯è´ªå¿ƒç­–ç•¥ã€‚<br>å¦‚æœæé™æƒ…å†µï¼Œæˆ‘ä»¬èŠ±è´¹çš„æœ€å¤šæ—¶é—´å°±æ˜¯â€œå…ˆæŠŠnæ¡é±¼å…¨éƒ¨é’“ä¸Šæ¥ï¼Œå†æŒ¨ä¸ªç…®â€ï¼ŒèŠ±è´¹çš„æ—¶é—´æ˜¯$sum = n * k+\sum_{i = 1}^nt_i$ï¼Œè€Œæˆ‘ä»¬èƒ½å‡å°‘èŠ±è´¹çš„æ—¶é—´ï¼Œå½“ä¸”ä»…å½“æˆ‘ä»¬åœ¨é’“é±¼çš„åŒæ—¶å»ç…®é±¼ï¼›è€Œåˆç”±äºé’“é±¼çš„æ—¶é—´æ®µä¸èƒ½ç»ˆæ­¢ï¼Œæ‰€ä»¥å°±ç›¸å½“äºæˆ‘ä»¬æœ‰n-1æ®µæ—¶é—´ï¼Œæ¯æ®µæ—¶é—´å¤§å°ä¸ºkï¼Œé‚£ä¹ˆå¯¹äºä»»æ„ç…®ä¸€æ¡é±¼çš„æ—¶é—´$t_i$ï¼š</p><ul><li>è‹¥$t_i$ æ˜¯ k çš„å€æ•°ï¼Œ$\frac{t_i}{k} = cnt$ é‚£ä¹ˆè¿™cntä»½æ—¶é—´å®Œå…¨è¢«åˆ©ç”¨äº†ï¼Œå³sum -= cnt * k</li><li>è‹¥$t_i &gt; k$ï¼Œé‚£ä¹ˆè¯´æ˜æˆ‘ä»¬å¯ä»¥å…ˆç…®å‡ æ®µkï¼Œè€Œå‰©ä¸‹çš„éƒ¨åˆ†å†è€ƒè™‘æ˜¯ç­‰å¾…è¿˜æ˜¯ç»§ç»­é’“é±¼ï¼Œ$\frac{t_i}{k} = cnt$ï¼Œsum -= cnt <em> k , $t_i$ -= cnt </em> k</li><li>ç»è¿‡ä¸Šé¢çš„æ“ä½œä¹‹åï¼Œå‰©ä¸‹çš„$t_i$å°±éƒ½æ˜¯å°äºkçš„äº†ï¼Œé‚£ä¹ˆå¦‚æœæ­¤æ—¶æˆ‘ä»¬è¿˜å‰©resæ®µæ—¶é—´ï¼Œåˆ™æŒ‘æœ€å¤§çš„resä¸ª$t_i$æ¥ç…®ï¼Œè¿™æ ·å°±èƒ½æœ€å¤§åŒ–åˆ©ç”¨æ—¶é—´äº†ï¼Œå¦‚æœres = 0ï¼Œåˆ™ç®—æ³•ç»“æŸã€‚</li></ul><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> tt,n;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll t[N],k,a[N];</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll ans = n*k;<span class="keyword">int</span> res = n<span class="number">-1</span>,tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(t[i]%k == <span class="number">0</span> &amp;&amp; res) ans -= t[i],res -= t[i]/k;</span><br><span class="line">        <span class="keyword">else</span> a[++tot] = t[i]%k, cnt += t[i]/k;</span><br><span class="line">        ans += t[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cnt &gt;= res)&#123;</span><br><span class="line">        ans -= k*res;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    ans -= cnt*k;res -= cnt;</span><br><span class="line">    sort(a+<span class="number">1</span>,a+<span class="number">1</span>+tot);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = tot;i &gt;= <span class="number">1</span> &amp;&amp; res;i--)&#123;</span><br><span class="line">       <span class="comment">// printf("%lld %d %lld\n",b[i],res,ans);</span></span><br><span class="line">        ans -= a[i];res--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;tt);</span><br><span class="line">    <span class="keyword">while</span>(tt--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%lld"</span>,&amp;n,&amp;k);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,t+i);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,solve());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æƒå€¼çº¿æ®µæ ‘ </tag>
            
            <tag> è´ªå¿ƒç­–ç•¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JZOJ4920é™é›·çš‡(æœ€é•¿ä¸Šå‡å­åºåˆ—æ•°é‡)</title>
      <link href="/2019/08/24/JZOJ4920/"/>
      <url>/2019/08/24/JZOJ4920/</url>
      
        <content type="html"><![CDATA[<p><a href="http://ybt.ssoier.cn:8088/problem_show.php?pid=1742" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a></p><h5 id="é¢˜æ„ç®€è¿°"><a href="#é¢˜æ„ç®€è¿°" class="headerlink" title="é¢˜æ„ç®€è¿°"></a>é¢˜æ„ç®€è¿°</h5><p>å“ˆè’™æœ‰næ¡å¯¼çº¿æ’æˆä¸€æ’ï¼Œæ¯æ¡å¯¼çº¿æœ‰ä¸€ä¸ªç”µé˜»å€¼ï¼Œç¥å¥‡çš„ç”µå…‰åªèƒ½ä»ä¸€æ ¹å¯¼çº¿ä¼ åˆ°ç”µé˜»æ¯”å®ƒå¤§çš„ä¸Šé¢ï¼Œè€Œä¸”å¿…é¡»ä»å·¦è¾¹å‘å³ä¼ å¯¼ï¼Œå½“ç„¶å¯¼çº¿ä¸å¿…æ˜¯è¿ç»­çš„ã€‚</p><p>å“ˆè’™æƒ³çŸ¥é“ç”µå…‰æœ€å¤šèƒ½é€šè¿‡å¤šå°‘æ¡å¯¼çº¿ï¼Œè¿˜æƒ³çŸ¥é“è¿™æ ·çš„æ–¹æ¡ˆæœ‰å¤šå°‘ã€‚</p><h5 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h5><p>ç¬¬ä¸€é—®å°±æ˜¯ç®€å•çš„LISé—®é¢˜ï¼Œå³è¯¢é—®æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ã€‚ç¬¬äºŒé—®æ˜¯è¯¢é—®æœ€é•¿ä¸Šå‡å­åºåˆ—çš„æ•°é‡ï¼Œå¦‚æœç”¨æš´åŠ›åšæ³•ï¼Œåªéœ€è¦å¤šå¼€ä¸€ä¸ªæ•°ç»„è®°å½•æ•°é‡å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦O(N^2)ï¼›å®é™…ä¸Šæˆ‘ä»¬å¯ä»¥åˆ©ç”¨BITæ¥ä»£æ›¿æšä¸¾ï¼Œä½¿å¾—æ—¶é—´å¤æ‚åº¦è‡³O(NlogN)ã€‚</p><p>æˆ‘ä»¬ç”¨ä¸€ä¸ªç»“æ„ä½“Node{v,s}æ¥è¡¨ç¤ºå½“æœ€é•¿ä¸Šå‡å­åºåˆ—é•¿åº¦ä¸ºvæ—¶ï¼Œæ–¹æ¡ˆæ•°æ˜¯sã€‚é‚£ä¹ˆå¯¹äºæ¯ä¸€ä¸ªæ–°å…ƒç´ xï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾å‡ºæ‰€æœ‰ <strong>ç”µé˜»å€¼å°äºxçš„</strong> æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦vä»¥åŠæ•°é‡så³å¯ï¼ˆç¬¦åˆBITç»´æŠ¤å‰ç¼€å’ŒåŠŸèƒ½ï¼‰ã€‚</p><p>å½“æˆ‘ä»¬æ±‚å‡ºå½“å‰å…ƒç´  x çš„ v(æœ€é•¿ä¸Šå‡å­åºåˆ—é•¿åº¦) å’Œ s(æ–¹æ¡ˆæ•°) åï¼Œç”¨æ¥æ›´æ–°ansï¼Œå¹¶å°†å…¶æ’å…¥æ ‘çŠ¶æ•°ç»„ç¬¬xä¸ªä½ç½®ã€‚ç”±äºé¢˜ç›®ä¿è¯xå°äº1e5ï¼Œæ‰€ä»¥æ ‘çŠ¶æ•°ç»„å¼€åˆ°1e5å³å¯ã€‚</p><h5 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*ä»£ç å‚è€ƒï¼šä¿¡æ¯å­¦å¥¥èµ›ä¸€æœ¬é€šP263*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> ll P = <span class="number">123456789</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">ll v,s;</span><br><span class="line">Node()&#123;</span><br><span class="line">v = <span class="number">0</span>, s = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;tr[N],tmp,ans;</span><br><span class="line"><span class="keyword">int</span> n,ty;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> x,Node y)</span></span>&#123;</span><br><span class="line"><span class="comment">/*æ›´æ”¹ç”µé˜»å€¼ä¸ºxæ—¶çš„é•¿åº¦å’Œæ–¹æ¡ˆæ•°*/</span> </span><br><span class="line"><span class="keyword">while</span>(x &lt;= N)&#123;</span><br><span class="line"><span class="keyword">if</span>(y.v &gt; tr[x].v) tr[x] = y;<span class="comment">//å¦‚æœé•¿åº¦å˜é•¿,ç›´æ¥æ›´æ–°ç­”æ¡ˆ </span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(y.v == tr[x].v) tr[x].s = (tr[x].s+y.s)%P;</span><br><span class="line">x += x&amp;-x;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Node <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">/*è¿”å›å½“ç”µé˜» &lt;= xæ—¶,æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦å’Œæ–¹æ¡ˆæ•°*/</span></span><br><span class="line">Node res;res.s = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(x)&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[x].v &gt; res.v) res = tr[x];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(tr[x].v == res.v) res.s = (res.s + tr[x].s)%P;</span><br><span class="line">x -= x&amp;-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmax</span><span class="params">(Node &amp;x,<span class="keyword">const</span> Node&amp; y)</span></span>&#123;</span><br><span class="line"><span class="comment">/*æ›´æ–°æœ€ç»ˆç­”æ¡ˆ,å³æœ€é•¿ä¸Šå‡å­åºåˆ—ä»¥åŠä¸ªæ•°*/</span></span><br><span class="line"><span class="keyword">if</span>(x.v &lt; y.v) x = y;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(x.v == y.v) x.s = (x.s+y.s)%P;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;ty);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">tmp = ask(x<span class="number">-1</span>);<span class="comment">//å› ä¸ºè¿™é‡Œä¿è¯xä¸è¶…è¿‡1e5,æ‰€ä»¥ä¸éœ€è¦ç¦»æ•£åŒ– </span></span><br><span class="line">tmp.v++;</span><br><span class="line">ckmax(ans,tmp);<span class="comment">//æ›´æ–°ç­”æ¡ˆ </span></span><br><span class="line">updata(x,tmp);<span class="comment">//æ›´æ–°æ ‘çŠ¶æ•°ç»„ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans.v);</span><br><span class="line"><span class="keyword">if</span>(ty == <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans.s);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘çŠ¶æ•°ç»„ </tag>
            
            <tag> LIS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rikka with Coin è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2019/08/22/hdu6685/"/>
      <url>/2019/08/22/hdu6685/</url>
      
        <content type="html"><![CDATA[<p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6685" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br>æœ¬é¢˜ä¸º2019èˆªç”µicpcæš‘æœŸå¤šæ ¡è®­ç»ƒç¬¬9åœºçš„ç¬¬6é¢˜ã€‚</p><h5 id="é¢˜æ„ç®€è¿°"><a href="#é¢˜æ„ç®€è¿°" class="headerlink" title="é¢˜æ„ç®€è¿°"></a>é¢˜æ„ç®€è¿°</h5><p>æœ‰10åˆ†ï¼Œ20åˆ†ï¼Œ50åˆ†ï¼Œ100åˆ†çš„ç¡¬å¸è‹¥å¹²ï¼ˆåæ­£å¤Ÿç”¨ï¼‰ï¼Œå•†åº—æœ‰nä»¶å•†å“ï¼ˆn&lt;101ï¼‰ï¼Œæ¯ä»¶å•†å“çš„ä»·æ ¼ç»™å‡ºï¼›è¯·é—®è¦æƒ³å¯ä»¥ä¹°ä¸‹ä»»æ„ä¸€ä»¶å•†å“ï¼Œæœ€å°‘å¸¦å¤šå°‘ä¸ªç¡¬å¸ï¼Ÿ</p><h5 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h5><p>æˆ‘ä¸€å¼€å§‹æ€è·¯æ˜¯èƒŒåŒ…ï¼Œç„¶åè§‰å¾—wï¼ˆå•†å“çš„ä»·å€¼ï¼‰å¤ªå¤§äº†ï¼Œå¯èƒ½ç”¨å¤§èƒŒåŒ…ï¼Œå°±æ”¾å¼ƒäº†ã€‚åŸæ¥è¿™é¢˜éœ€è¦è½¬åŒ–ä¸€ä¸‹æ€ç»´ï¼Œå¹¶ä¸æ˜¯ç”¨èƒŒåŒ…è€Œæ˜¯ç®€å•çš„éå†ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç™½ï¼Œå°±æ˜¯å¦‚è‹¥æˆ‘ä»¬ä¹°ä¸€ä»¶ç‰©å“éœ€è¦ç”¨2ä¸ª10åˆ†çš„ç¡¬å¸ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¢æˆä¸€ä¸ª10åˆ†ä¸€ä¸ª20åˆ†çš„è‚¯å®šæ˜¯å¯ä»¥çš„ï¼Œè€Œä¸”åè€Œèƒ½ä¹°çš„ä»·æ ¼æ›´å¤šäº†ï¼ˆä»10,20å˜ä¸º10,20,30ï¼‰ï¼ŒåŒç†ï¼š</p><ul><li>å¦‚æœæœ‰4ä¸ª20åˆ†çš„ï¼Œå°±å¯ä»¥ç”¨1ä¸ª10åˆ†ï¼Œ2ä¸ª20åˆ†ï¼Œ1ä¸ª50åˆ†çš„ç¡¬å¸ä»£æ›¿ã€‚å› ä¸ºåŸæ¥å¯ä»¥è¡¨ç¤º20,40,60,80,ç°åœ¨å¯ä»¥è¡¨ç¤º10,20,30,40,50,60,70,80,90,100ã€‚</li><li>å¦‚æœæœ‰2ä¸ª50åˆ†çš„ï¼ŒåŒç†ï¼Œå¯ä»¥ç”¨1ä¸ª50ï¼Œ1ä¸ª100æ›¿ä»£ã€‚</li></ul><p>äºæ˜¯æˆ‘ä»¬çŸ¥é“äº†10åˆ†ï¼Œ20åˆ†ï¼Œ50åˆ†çš„ç¡¬å¸æœ€å¤šéœ€è¦1ä¸ªï¼Œ3ä¸ªï¼Œ1ä¸ªï¼Œæ‰€ä»¥ä¸‰å±‚å¾ªç¯éå†æ‰€æœ‰å¯èƒ½çš„æƒ…å†µï¼Œå¯¹äºæ¯ç§æƒ…å†µï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥è¡¨å‡ºæ‰€æœ‰ç‰©å“ï¼ˆå½“ç„¶ä¸è¶³çš„ç”¨100åˆ†çš„ç¡¬å¸æ›¿ä»£ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> t,n;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">int</span> w[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = INF;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= a;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt;= b;j++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt;= c;k++)&#123;</span><br><span class="line"><span class="keyword">if</span>((x-i*<span class="number">10</span>-j*<span class="number">20</span>-k*<span class="number">50</span>)%<span class="number">100</span> == <span class="number">0</span>) </span><br><span class="line">res = min((x-i*<span class="number">10</span>-j*<span class="number">20</span>-k*<span class="number">50</span>)/<span class="number">100</span>,res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> tmp = check2(w[i],a,b,c);</span><br><span class="line"><span class="keyword">if</span>(tmp == INF) <span class="keyword">return</span> INF; </span><br><span class="line"><span class="keyword">else</span> res = max(res,tmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//printf("%d %d %d %d\n",res,a,b,c);</span></span><br><span class="line"><span class="keyword">return</span> res+a+b+c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = INF;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">if</span>(w[i]%<span class="number">10</span>)&#123;<span class="built_in">puts</span>(<span class="string">"-1"</span>);<span class="keyword">return</span>;&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= <span class="number">1</span>;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt;= <span class="number">3</span>;j++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt;= <span class="number">1</span>;k++)</span><br><span class="line">ans = min(ans,check(i,j,k));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line"><span class="keyword">while</span>(t--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,w+i);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2018å¾å·icpcç½‘ç»œèµ›Aã€Bé¢˜è§£</title>
      <link href="/2019/08/21/2018xuzhou-icpc/"/>
      <url>/2019/08/21/2018xuzhou-icpc/</url>
      
        <content type="html"><![CDATA[<h4 id="A-Hard-to-prepare"><a href="#A-Hard-to-prepare" class="headerlink" title="A. Hard to prepare"></a>A. Hard to prepare</h4><p><a href="https://nanti.jisuanke.com/t/A2000" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br>æŠ±æ€¨ä¸€ä¸‹ï¼Œè¿™é¢˜ç›®çœŸçš„æ˜¯é•¿ï¼Œé¢˜æ„ç†è§£èµ·æ¥æœ‰ç‚¹è´¹åŠ²ï¼Œå½“ç„¶è´¹åŠ²çš„åªæ˜¯å› ä¸ºé¢˜é¢é•¿è€Œä¸æ˜¯è¡¨è¿°ä¸æ¸…ã€‚<br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ä»$[1,2^k-1]$ä¸­é€‰å‡ºnä¸ªæ•°ï¼Œå°†nä¸ªæ•°å›´æˆä¸€åœˆï¼Œè¦æ±‚ç›¸é‚»çš„ä¸¤ä¸ªæ•°NXORå¤§äº0ï¼Œå³å¼‚æˆ–åæŒ‰ä½å–åçš„å€¼å¤§äº0ã€‚é—®å…±æœ‰å¤šå°‘ç§ä¸åŒçš„æ–¹æ¡ˆã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>é€šè¿‡ç®€å•è¯æ˜ï¼Œæˆ‘ä»¬ä¼šå‘ç°åªæœ‰1æŒ‰ä½å–åçš„å€¼æ‰æ˜¯0ï¼Œæ‰€ä»¥ä¸¤ä¸ªæ•° å¼‚æˆ– != 1 å°±å¯ä»¥ç›¸é‚»ï¼›è€Œä¸xå¼‚æˆ– = 1 çš„æ•°ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªã€‚</p><p>é¦–å…ˆå¦‚æœä¸æ˜¯ç¯å½¢ï¼Œè€Œæ˜¯ä¸€æ¡ç›´çº¿ï¼Œé‚£ä¹ˆä¸€å…± $2 ^ k  *  (2 ^ k - 1) ^ {n-1}$â€‹ ç§ä¸åŒçš„æ–¹æ¡ˆï¼Œè¿™é‡Œè®¾A = â€‹2^kâ€‹ã€‚ç¯å½¢å’Œç›´çº¿ä¸åŒä¹‹å¤„åœ¨äºï¼Œç›´çº¿é¦–å°¾çš„å€¼å¼‚æˆ–å¯èƒ½ = 1ï¼Œå³æˆ‘ä»¬ä¹‹å‰çš„ç­”æ¡ˆå¤šç®—äº†é¦–å°¾å¼‚æˆ–=1çš„æƒ…å†µã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥å°±éœ€è¦è®¾æ³•å‡å»è¿™äº›å€¼ã€‚</p><p>æˆ‘ä»¬é€šè¿‡åŠ¨æ€è§„åˆ’æ€æƒ³æ¥è®¡ç®—è¿™äº›å¤šåŠ ä¸Šçš„å€¼ã€‚å‡è®¾å½“å‰ä½ç½®ä¸º i ï¼Œç›´çº¿é¦–å…ƒç´ æ˜¯aï¼Œå°¾å…ƒç´ æ˜¯bï¼Œä¸”a^b = 1ï¼›è®¾xæ˜¯ä½ç½® i å…ƒç´  = aæ—¶çš„æ–¹æ¡ˆæ•°ï¼Œyæ˜¯ä½ç½® i å…ƒç´  = bæ—¶çš„æ–¹æ¡ˆæ•°ï¼Œzæ˜¯ä½ç½® i ä¸ç­‰äºaå’Œbæ—¶çš„æ–¹æ¡ˆæ•°ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬åˆå§‹çŠ¶æ€ï¼ˆç¬¬2ä¸ªä½ç½®æ—¶ï¼‰x = 1 , y = 0 , z = A - 2ï¼›ç›®æ ‡æ˜¯æ±‚ç¬¬n-1 ä½æ—¶çš„ y + zï¼ˆé¦–ä½æ˜¯aï¼Œæœ«ä½æ˜¯bæ—¶ï¼Œä¸­é—´2~n-1ä½çš„ä¸åŒæ’åˆ—æƒ…å†µæ•°ï¼‰ã€‚<br>é‚£ä¹ˆæ˜“å¾—ï¼š<br>x = x + z;<br>y = y + z;<br>z = z<em>(A-3)+(x+y) </em> (A-2).<br>äºæ˜¯æˆ‘ä»¬ä»ç¬¬3ä½é€’æ¨åˆ°ç¬¬n-1ä½å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> ll P = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> t,n,k;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = res*a%P;</span><br><span class="line">        a = a*a%P;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res%P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll A = qpow(<span class="number">2</span>,k);</span><br><span class="line">    ll ans = A*qpow(A<span class="number">-1</span>,n<span class="number">-1</span>)%P;</span><br><span class="line">    ll x = <span class="number">1</span>,y = <span class="number">0</span>,z = A<span class="number">-2</span>;</span><br><span class="line">    <span class="comment">/*x:å½“å‰ä½ç½®æ•°å’ŒAç›¸åŒæ–¹æ¡ˆæ•°,</span></span><br><span class="line"><span class="comment">y:å½“å‰ä½ç½®æ•°å’ŒBç›¸åŒæ–¹æ¡ˆæ•°,</span></span><br><span class="line"><span class="comment">z:å½“å‰ä½ç½®çš„æ•°å’ŒABéƒ½ä¸åŒçš„æ–¹æ¡ˆæ•°ã€‚ </span></span><br><span class="line"><span class="comment">    */</span> </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">3</span>;i &lt; n;i++)&#123;</span><br><span class="line">        ll t1 = x+z,t2 = y+z;</span><br><span class="line">        z = z*(A<span class="number">-3</span>)%P+(x+y)*(A<span class="number">-2</span>)%P;</span><br><span class="line">        z = z%P;</span><br><span class="line">        x = t1%P, y = t2%P;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">//  printf("%lld %lld %lld\n",ans,y,z);</span></span><br><span class="line">    <span class="keyword">if</span>(n &gt; <span class="number">2</span>) ans = (ans - A*(y+z)%P+P)%P;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="B-BE-GE-or-NE"><a href="#B-BE-GE-or-NE" class="headerlink" title="B. BE,GE or NE"></a>B. BE,GE or NE</h4><p><a href="https://nanti.jisuanke.com/t/A2001" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>è¿™æ˜¯ä¸€ä¸ªåšå¼ˆè®ºé¢˜ã€‚æœ‰ä¸¤ä¸ªäººï¼Œå°Kå’Œå°Såœ¨ç©æ¸¸æˆï¼Œè¯¥æ¸¸æˆä¸€å…±æœ‰næ¬¡æ“ä½œï¼Œä¿©äººè½®æµè¿›è¡Œã€‚åˆå§‹ç»™å®šä¸€ä¸ªæ•°å€¼mï¼Œæ¯æ¬¡æ“ä½œæœ‰ä¸‰ç§é€‰æ‹©ï¼šåŠ ä¸Šaï¼›å‡å»bï¼›è‹¥cä¸º1ï¼Œåˆ™m = -1ã€‚æ¯æ¬¡ä¸‰é€‰ä¸€ï¼Œå…¶ä¸­å°Kæƒ³ä½¿å¾—æœ€ç»ˆå€¼&gt;= kï¼Œè€Œå°Sæƒ³ä½¿å¾—æœ€ç»ˆå€¼&lt;= lï¼Œå¦åˆ™ä¸¤äººå¹³å±€ã€‚ç»™å®šè¿™næ¬¡æ“ä½œçš„a,b,cå€¼ï¼Œè¯·é—®ä¸¤äººéƒ½é‡‡å–æœ€ä¼˜ç­–ç•¥ï¼Œæœ€ç»ˆç»“æœæ˜¯è°èƒœå‡ºæˆ–æ˜¯å¹³å±€ï¼Ÿ</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>é¦–å…ˆæ¯ä¸ªå†³ç­–çš„é€‰ä¸¾ä¼šå½±å“ä¹‹åçš„å†³ç­–ï¼Œå³ä¸æ»¡è¶³æ— åæ•ˆï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½å•çº¯çš„ä»åå‘å‰æ¨ï¼ˆä»åŠ¨æ€è§„åˆ’è§’åº¦ï¼‰ã€‚è€Œä»åšå¼ˆè®ºæ¥çœ‹ï¼Œå¦‚æœå½“å‰å±€é¢å¯ä»¥è½¬ç§»åˆ°å¿…èƒœæ€ï¼Œåˆ™å½“å‰é€‰æ‰‹å¿…èƒœï¼Œæ¢åˆ°è¿™é¢˜ï¼Œå°±æ˜¯ä½¿å¾—å½“å‰é€‰æ‰‹å¾—åˆ†æœ€å¤§æˆ–æœ€å°ã€‚ç”±äºå¾—åˆ†åªæœ‰200ç§å¯èƒ½ï¼Œäºæ˜¯å¯èƒ½çš„çŠ¶æ€åªæœ‰1000 * 200 = 200,000ç§ï¼Œè®°å¿†åŒ–æœç´¢å³å¯ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1100</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> f[N][<span class="number">250</span>];</span><br><span class="line"><span class="keyword">int</span> a[N],b[N],c[N];</span><br><span class="line"><span class="keyword">int</span> n,m,k,l;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> pos,<span class="keyword">int</span> sum)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(pos &gt; n) <span class="keyword">return</span> sum;</span><br><span class="line">    <span class="keyword">if</span>(f[pos][sum+<span class="number">100</span>] != INF) <span class="keyword">return</span> f[pos][sum+<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">if</span>(pos&amp;<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> x = -INF;</span><br><span class="line">        <span class="keyword">if</span>(a[pos]) x = max(x,dfs(pos+<span class="number">1</span>,min(<span class="number">100</span>,sum+a[pos])));</span><br><span class="line">        <span class="keyword">if</span>(b[pos]) x = max(x,dfs(pos+<span class="number">1</span>,max(<span class="number">-100</span>,sum-b[pos])));</span><br><span class="line">        <span class="keyword">if</span>(c[pos]) x = max(x,dfs(pos+<span class="number">1</span>,-sum));</span><br><span class="line">        f[pos][sum+<span class="number">100</span>] = x;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = INF;</span><br><span class="line">        <span class="keyword">if</span>(a[pos]) x = min(x,dfs(pos+<span class="number">1</span>,min(sum+a[pos],<span class="number">100</span>)));</span><br><span class="line">        <span class="keyword">if</span>(b[pos]) x = min(x,dfs(pos+<span class="number">1</span>,max(<span class="number">-100</span>,sum-b[pos])));</span><br><span class="line">        <span class="keyword">if</span>(c[pos]) x = min(x,dfs(pos+<span class="number">1</span>,-sum));</span><br><span class="line">        f[pos][sum+<span class="number">100</span>] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[pos][sum+<span class="number">100</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;k,&amp;l);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,a+i,b+i,c+i);</span><br><span class="line">    <span class="keyword">int</span> ans = dfs(<span class="number">1</span>,m);</span><br><span class="line">    <span class="keyword">if</span>(ans &gt;= k) <span class="built_in">puts</span>(<span class="string">"Good Ending"</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ans &lt;= l) <span class="built_in">puts</span>(<span class="string">"Bad Ending"</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"Normal Ending"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŠ¨æ€è§„åˆ’ </tag>
            
            <tag> åšå¼ˆè®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ä¸€ç«  åŸºç¡€æ•°æ®ç»“æ„æ¨¡æ¿</title>
      <link href="/2019/08/20/chapter1/"/>
      <url>/2019/08/20/chapter1/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºç¡€æ•°æ®ç»“æ„"><a href="#åŸºç¡€æ•°æ®ç»“æ„" class="headerlink" title="åŸºç¡€æ•°æ®ç»“æ„"></a>åŸºç¡€æ•°æ®ç»“æ„</h2><h3 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h3><ol><li>å¹¶æŸ¥é›†</li><li>æ±‚æœ€è¿‘å…¬å…±ç¥–å…ˆLCA</li><li>å¹³æ–¹åˆ†å‰²æ³•</li><li>è«é˜Ÿç®—æ³•ï¼ˆä¸€ç»´ï¼ŒäºŒç»´ï¼‰</li><li>stè¡¨ï¼ˆä¸€ç»´ï¼ŒäºŒç»´ï¼‰</li><li>äºŒå‰å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰</li><li>å•è°ƒæ ˆä¸ç¬›å¡å°”æ ‘</li><li>CDQåˆ†æ²»</li></ol><h3 id="1-å¹¶æŸ¥é›†"><a href="#1-å¹¶æŸ¥é›†" class="headerlink" title="1 å¹¶æŸ¥é›†"></a>1 å¹¶æŸ¥é›†</h3><h4 id="1-1-å¹¶æŸ¥é›†â€œæ‹“å±•åŸŸâ€"><a href="#1-1-å¹¶æŸ¥é›†â€œæ‹“å±•åŸŸâ€" class="headerlink" title="1.1 å¹¶æŸ¥é›†â€œæ‹“å±•åŸŸâ€"></a>1.1 å¹¶æŸ¥é›†â€œæ‹“å±•åŸŸâ€</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å…³æŠ¼ç½ªçŠ¯</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100100</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> par[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> a,b,c;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node &amp;B) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> c &gt; B.c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; nodes[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x == par[x]) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">return</span> par[x] = Find(par[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    par[Find(x)] = Find(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;nodes[i].a,&amp;nodes[i].b,&amp;nodes[i].c);</span><br><span class="line">        par[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(nodes+<span class="number">1</span>,nodes+<span class="number">1</span>+m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x = nodes[i].a,y = nodes[i].b,d = nodes[i].c;</span><br><span class="line">        <span class="keyword">int</span> x_en = x+n, y_en = y+n;</span><br><span class="line">        <span class="keyword">if</span>(Find(x) == Find(y))&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,d);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Merge(x,y_en);Merge(x_en,y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"0"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-2-å¹¶æŸ¥é›†â€œè¾¹å¸¦æƒâ€"><a href="#1-2-å¹¶æŸ¥é›†â€œè¾¹å¸¦æƒâ€" class="headerlink" title="1.2 å¹¶æŸ¥é›†â€œè¾¹å¸¦æƒâ€"></a>1.2 å¹¶æŸ¥é›†â€œè¾¹å¸¦æƒâ€</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//POJ1773</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">21000</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Query</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l,r,ans;</span><br><span class="line">&#125; q[N];</span><br><span class="line"><span class="keyword">int</span> a[N],par[N],d[N],cnt = <span class="number">0</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    aæ•°ç»„ç”¨æ¥ç¦»æ•£åŒ–ï¼Œpar[x]ä»£è¡¨xçš„çˆ¶èŠ‚ç‚¹ç¼–å·ï¼Œd[x]ä»£è¡¨</span></span><br><span class="line"><span class="comment">    ä»xåˆ°æ ¹èŠ‚ç‚¹è·¯å¾„å’Œï¼Œcntä¹Ÿæ˜¯ç”¨äºç¦»æ•£åŒ–ã€‚</span></span><br><span class="line"><span class="comment">    è¿™é‡Œæ ¹èŠ‚ç‚¹å³é›†åˆçš„ä»£è¡¨èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(par[x] == x) <span class="keyword">return</span> x;   <span class="comment">//æ‰¾åˆ°æ ¹èŠ‚ç‚¹ï¼Œè¿”å›</span></span><br><span class="line">    <span class="keyword">int</span> root = Find(par[x]);    <span class="comment">//ä¸´æ—¶å­˜æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    d[x] ^= d[par[x]];          <span class="comment">//è·¯å¾„å‹ç¼©ï¼Œè·ç¦»æ•°ç»„dä¹Ÿåº”è¯¥æ›´æ–°</span></span><br><span class="line">    <span class="keyword">return</span> par[x] = root;       <span class="comment">//è·¯å¾„å‹ç¼©</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">char</span> rs[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%s"</span>,&amp;q[i].l,&amp;q[i].r,rs);</span><br><span class="line">        <span class="keyword">if</span>(rs[<span class="number">0</span>] == <span class="string">'o'</span>) q[i].ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> q[i].ans = <span class="number">0</span>;</span><br><span class="line">        a[cnt++] = q[i].l<span class="number">-1</span>;    <span class="comment">//è¿™é‡Œéœ€è¦å­˜l-1ï¼Œä¸ºäº†ä½¿lä¹ŸåŒ…å«åœ¨å†…</span></span><br><span class="line">        a[cnt++] = q[i].r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ä»¥ä¸‹ä¸¤è¡Œä»£ç ç¦»æ•£åŒ–ç”¨</span></span><br><span class="line">    sort(a,a+cnt);</span><br><span class="line">    <span class="keyword">int</span> len = unique(a,a+cnt)-a;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++) par[i] = i; <span class="comment">//åˆå§‹åŒ–çˆ¸çˆ¸æ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;      </span><br><span class="line">        <span class="comment">//å·¦å³è¾¹ç•Œåœ¨ç¦»æ•£åŒ–æ•°ç»„ä¸­çš„ç¼–å·ï¼š</span></span><br><span class="line">        <span class="keyword">int</span> x = lower_bound(a,a+len,q[i].l<span class="number">-1</span>)-a;</span><br><span class="line">        <span class="keyword">int</span> y = lower_bound(a,a+len,q[i].r)-a;  </span><br><span class="line">        <span class="comment">//å·¦å³è¾¹ç•Œçš„ç¥–å…ˆåˆ†åˆ«ä¸ºtaå’Œtb</span></span><br><span class="line">        <span class="keyword">int</span> ta = Find(x),tb = Find(y);</span><br><span class="line">        <span class="keyword">if</span>(ta == tb)&#123;   <span class="comment">//å¦‚æœå·²ç»åœ¨åŒä¸€ä¸ªé›†åˆå†…ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦çŸ›ç›¾</span></span><br><span class="line">            <span class="keyword">if</span>((d[x]^d[y]) != q[i].ans)&#123;<span class="comment">//çŸ›ç›¾çš„æ¡ä»¶å°±æ˜¯äº‹å®å’Œç»“æœä¸åŒ</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i<span class="number">-1</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            par[ta] = tb;d[ta] = d[x]^d[y]^q[i].ans;</span><br><span class="line">            <span class="comment">//è¿™é‡Œd[ta]çš„å€¼éœ€è¦æ¨å¯¼ä¸€ä¸‹ã€‚</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            æˆ‘ä»¬å°†xæ‰€åœ¨çš„é›†åˆå’Œyæ‰€åœ¨çš„é›†åˆåˆå¹¶ï¼Œé‚£ä¹ˆå°±éœ€è¦æ›´æ–°dæ•°ç»„</span></span><br><span class="line"><span class="comment">            è¿™é‡Œd[x]å­˜æ”¾çš„æ˜¯xåˆ°par[x]çš„è·ç¦»ï¼Œæ‰€ä»¥åˆå¹¶ä¸¤ä¸ªé›†åˆå¯¹äº</span></span><br><span class="line"><span class="comment">            éæ ¹èŠ‚ç‚¹æ¥è¯´å¹¶æ— å½±å“ï¼Œå…³é”®æ˜¯å¯¹äºä¸¤ä¸ªæ ¹d[ta]å’Œd[tb]å¦‚ä½•å¤„ç†</span></span><br><span class="line"><span class="comment">            å¦‚æœæˆ‘ä»¬å°†taä»£è¡¨çš„é›†åˆå½’äºtbä¸‹ï¼Œé‚£ä¹ˆå°±éœ€è¦æ›´æ–°d[ta],è€Œå·²çŸ¥</span></span><br><span class="line"><span class="comment">            ans = d[x]^d[y]^d[ta]ï¼Œå³xåˆ°yçš„æ€»è·¯å¾„ç­‰äºxåˆ°ta XOR yåˆ°tb XOR </span></span><br><span class="line"><span class="comment">            taåˆ°tbï¼›å¯¹ä¸Šå¼å˜å½¢ï¼Œå¾—ï¼šd[ta] = ans^d[x]^d[y],è€Œåä¸‰è€…æ˜¯å·²çŸ¥ï¼Œ</span></span><br><span class="line"><span class="comment">            æ•…å¯ä»¥æ±‚å‡ºd[ta]ã€‚</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,m);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-å€å¢æ³•æ±‚-LCA"><a href="#2-å€å¢æ³•æ±‚-LCA" class="headerlink" title="2 å€å¢æ³•æ±‚ LCA"></a>2 å€å¢æ³•æ±‚ LCA</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//HDU2586æ±‚æ ‘ä¸Šä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹çš„è·¯å¾„çš„è¾¹æƒå’Œ  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2</span>*<span class="number">41000</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[N],nex[N],edge[N],tot = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span>&#123;x ^= y;y^=x;x^=y;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    ver[++tot] = y,edge[tot] = z;</span><br><span class="line">    nex[tot] = head[x],head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    deep[x]è¡¨ç¤ºxçš„æ·±åº¦,anc[x][i]ä¸ºxå‘ä¸Šèµ°2^iæ­¥çš„ç¥–å…ˆ </span></span><br><span class="line"><span class="comment">    dis[x]ä¸ºèŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·ç¦»,å³è¾¹æƒæˆ–ç‚¹æƒå’Œ </span></span><br><span class="line"><span class="comment">*/</span>  </span><br><span class="line"><span class="keyword">int</span> deep[N],anc[N][<span class="number">25</span>],dis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        1.åˆå§‹åŒ–ancæ•°ç»„ï¼Œ</span></span><br><span class="line"><span class="comment">        2.åˆå§‹åŒ–deepæ•°ç»„</span></span><br><span class="line"><span class="comment">        3.åˆå§‹åŒ–disæ•°ç»„</span></span><br><span class="line"><span class="comment">        ä»¥ä¸Šä¸‰ä¸ªéƒ½å¯ä»¥é€šè¿‡dfsæ¥å®ç°</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">22</span>;i++)</span><br><span class="line">        anc[x][i] = anc[anc[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x]; i;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i],z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(dis[y] || y == <span class="number">1</span>) <span class="keyword">continue</span>;<span class="comment">//é˜²æ­¢é‡å¤è®¿é—®</span></span><br><span class="line">        deep[y] = deep[x]+<span class="number">1</span>;</span><br><span class="line">        dis[y] = dis[x] + z;</span><br><span class="line">        anc[y][<span class="number">0</span>] = x;</span><br><span class="line">        dfs(y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* å…ˆæŠŠæ·±åº¦è°ƒåˆ°ä¸€è‡´ï¼Œå†æŒ‰ç…§äºŒè¿›åˆ¶æ‹†åˆ†æ€æƒ³æ‰¾å¯»æœ€è¿‘å…¬å…±ç¥–å…ˆ */</span></span><br><span class="line">    <span class="keyword">if</span>(deep[u] &lt; deep[v]) swap(u,v);    <span class="comment">//uæ˜¯è¾ƒæ·±çš„èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(deep[anc[u][i]] &gt;= deep[v]) u = anc[u][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(u == v) <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(anc[u][i] != anc[v][i])&#123;</span><br><span class="line">            u = anc[u][i];</span><br><span class="line">            v = anc[v][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> anc[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line"><span class="comment">/*è¿”å›uåˆ°vçš„è·ç¦»*/</span></span><br><span class="line">    <span class="keyword">return</span> dis[u] + dis[v] <span class="number">-2</span>*dis[Lca(u,v)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t,n,m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">memset</span>(dis,<span class="number">0</span>,<span class="keyword">sizeof</span> dis);</span><br><span class="line">        <span class="built_in">memset</span>(deep,<span class="number">0</span>,<span class="keyword">sizeof</span> deep);</span><br><span class="line">        <span class="built_in">memset</span>(anc,<span class="number">0</span>,<span class="keyword">sizeof</span> anc);</span><br><span class="line">        <span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span> head);<span class="comment">//headä¹Ÿè¦åˆå§‹åŒ–</span></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);tot = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt; n;i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">            addEdge(x,y,z);</span><br><span class="line">            addEdge(y,x,z);</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(x,y));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-å¹³æ–¹åˆ†å‰²æ³•"><a href="#3-å¹³æ–¹åˆ†å‰²æ³•" class="headerlink" title="3 å¹³æ–¹åˆ†å‰²æ³•"></a>3 å¹³æ–¹åˆ†å‰²æ³•</h3><p><strong>é—®é¢˜æ¨¡å‹ï¼š</strong></p><blockquote><p>ç»™å®šä¸€ä¸ªæ•°åˆ—$a_1,a_2,â€¦,a_n$ï¼Œç›®æ ‡æ˜¯åœ¨Oï¼ˆ&radic;nï¼‰å¤æ‚åº¦å†…å®ç°ä»¥ä¸‹ä¸¤ä¸ªåŠŸèƒ½ï¼š</p><ul><li>ç»™å®šsï¼Œtï¼Œæ±‚$a_s,a_{s+1},â€¦a_t$çš„æœ€å°å€¼</li><li>ç»™å®šiï¼Œxï¼ŒæŠŠ$a_i$çš„å€¼å˜ä¸ºxã€‚</li></ul></blockquote><p><strong>åŸºäºå¹³æ–¹åˆ†å‰²çš„RMQçš„å¤æ‚åº¦ï¼š</strong><br>åœ¨æ›´æ–°å€¼æ—¶ï¼Œç”±äºæ¯ä¸ªæ¡¶å†…æœ‰bä¸ªå…ƒç´ ï¼Œæ‰€ä»¥å¤æ‚åº¦æ˜¯O(b) = O(&radic;n)<br>è€ŒæŸ¥è¯¢ä¸ºï¼šO(n/b+b) = O(&radic;n+&radic;n) = O(&radic;n)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> B = <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">int</span> mi[N/B];</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> pos,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">a[pos] = y;</span><br><span class="line">mi[pos/B] = min(mi[pos/B],y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = INF;</span><br><span class="line"><span class="keyword">while</span>(l &lt;= r &amp;&amp; l%B) ans = min(ans,a[l++]);</span><br><span class="line"><span class="keyword">while</span>(l &lt;= r &amp;&amp; r%B) ans = min(ans,a[--r]);</span><br><span class="line"><span class="keyword">while</span>(l &lt; r)&#123;</span><br><span class="line"><span class="keyword">int</span> b = l/B;</span><br><span class="line">ans = min(ans,mi[b]);</span><br><span class="line">l += B;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N/B;i++) mi[i] = INF;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">mi[i/B] = min(mi[i/B],a[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(m--)&#123;</span><br><span class="line"><span class="keyword">int</span> op,x,y;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;op,&amp;x,&amp;y);</span><br><span class="line"><span class="keyword">if</span>(op == <span class="number">1</span>) updata(x,y);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; query(x,y) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-è«é˜Ÿç®—æ³•"><a href="#4-è«é˜Ÿç®—æ³•" class="headerlink" title="4 è«é˜Ÿç®—æ³•"></a>4 è«é˜Ÿç®—æ³•</h3><p><strong>SPOJ D-queryï¼š</strong> ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œæ¯æ¬¡è¯¢é—®ä¸€ä¸ªåŒºé—´å†…æœ‰å¤šå°‘ä¸ªä¸åŒçš„å…ƒç´ ã€‚</p><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong> è«é˜Ÿç®—æ³•æ˜¯ç¦»çº¿ç®—æ³•ï¼Œå¯ä»¥è§£å†³ä¸€ç±»ç¦»çº¿çš„åŒºé—´é—®é¢˜ï¼Œå¯¹äºåºåˆ—ä¸Šçš„åŒºé—´è¯¢é—®é—®é¢˜ï¼Œå¦‚æœä» [l,r] çš„ç­”æ¡ˆèƒ½å¤Ÿ O(1) æ‰©å±•åˆ° [lâˆ’1,r],[l+1,r],[l,r+1],[l,râˆ’1] çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ $O(n\sqrt n)$ çš„å¤æ‚åº¦å†…æ±‚å‡ºæ‰€æœ‰è¯¢é—®çš„ç­”æ¡ˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">31000</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Q = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],m;</span><br><span class="line"><span class="keyword">int</span> ans,sum[<span class="number">1010000</span>];<span class="comment">//ä¸€ä¸ªå…¨å±€ç­”æ¡ˆanså’Œæ ‡è®°æ•°ç»„sumæ˜¯å¿…è¦çš„ </span></span><br><span class="line"><span class="comment">//å½“ç„¶ä¹Ÿå¯ä»¥ç¦»æ•£åŒ– </span></span><br><span class="line"><span class="keyword">int</span> len;<span class="comment">//å—å¤§å°ï¼Œåœ¨è¯»å…¥è¯¢é—®å‰éœ€è¦å…ˆèµ‹å€¼ </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Query</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> l,r,block,id;</span><br><span class="line">Query()&#123;&#125;</span><br><span class="line">Query(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> id):l(l),r(r),id(id)&#123;</span><br><span class="line">block = l/len;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> Query &amp;B) <span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(block == B.block) <span class="keyword">return</span> block&amp;<span class="number">1</span>? r &lt; B.r : r &gt; B.r;</span><br><span class="line"><span class="comment">//å°ä¼˜åŒ–ï¼Œä½¿å¾—rå‘ˆæ³¢æµªå½¢ </span></span><br><span class="line"><span class="keyword">return</span> block &lt; B.block;</span><br><span class="line">&#125;</span><br><span class="line">&#125;query[Q];</span><br><span class="line">priority_queue&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt; q;</span><br><span class="line"><span class="comment">//å¢åŠ æˆ–å‡å°‘ä¸€ä¸ªxä½ç½®ä¸Šçš„æ•° </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Move</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">x = a[x]; </span><br><span class="line">sum[x] += v;</span><br><span class="line"><span class="keyword">if</span>(v &gt; <span class="number">0</span>) ans += sum[x] == <span class="number">1</span>;<span class="comment">//åˆ¤ç­‰æ˜¯ä¸ºäº†é˜²æ­¢é‡å¤è®¡æ•° </span></span><br><span class="line"><span class="keyword">else</span> ans -= sum[x] == <span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">len = <span class="built_in">sqrt</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">query[i] = Query(x,y,i);</span><br><span class="line">&#125;</span><br><span class="line">sort(query+<span class="number">1</span>,query+<span class="number">1</span>+m);</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span>,r = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(l &lt; query[i].l) Move(l,<span class="number">-1</span>),l++;</span><br><span class="line"><span class="keyword">while</span>(l &gt; query[i].l) Move(l<span class="number">-1</span>,<span class="number">1</span>),l--;</span><br><span class="line"><span class="keyword">while</span>(r &gt; query[i].r) Move(r,<span class="number">-1</span>),r--;</span><br><span class="line"><span class="keyword">while</span>(r &lt; query[i].r) Move(r+<span class="number">1</span>,<span class="number">1</span>),r++;</span><br><span class="line">q.push(make_pair(-query[i].id,ans));<span class="comment">//å¤§æ ¹å †å˜ä¸ºå°æ ¹å † </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> x = q.top().second;q.pop();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-stè¡¨"><a href="#5-stè¡¨" class="headerlink" title="5 stè¡¨"></a>5 stè¡¨</h3><h4 id="5-1ä¸€ç»´stè¡¨"><a href="#5-1ä¸€ç»´stè¡¨" class="headerlink" title="5.1ä¸€ç»´stè¡¨"></a>5.1ä¸€ç»´stè¡¨</h4><p><strong>é—®é¢˜æ¨¡å‹ï¼š</strong></p><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnçš„åºåˆ—ï¼Œæœ‰mæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡ç»™å®šåŒºé—´[L , R]ï¼Œæ±‚åŒºé—´å†…æœ€å¤§å€¼ã€‚</p><p>æˆ‘ä»¬è®¾ <code>st[i][j]</code> ä¸ºä» i å¼€å§‹çš„ $2^j$ ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼ã€‚å‡è®¾è¿™nä¸ªæ•°å­˜æ”¾çš„åºåˆ—aä¸­ï¼Œæ ¹æ®å®šä¹‰ <code>st[i][j]</code> = max{a[k] | $i &lt;= k &lt;= i+2^j - 1$}ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> a[N],st[N][<span class="number">25</span>],Log[N];<span class="comment">//2^20å°±è¿‡ä¸€ç™¾ä¸‡äº†ï¼Œå®Œå…¨å¤Ÿç”¨ </span></span><br><span class="line"><span class="comment">//åˆå§‹åŒ–stè¡¨ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">Log[<span class="number">1</span>] = <span class="number">0</span>;<span class="comment">//é¢„å¤„ç†logå‡½æ•° </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n+<span class="number">1</span>;i++) Log[i] = Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) st[i][<span class="number">0</span>] = a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; (<span class="number">1</span>&lt;&lt;j) &lt;= n;j++)&#123;<span class="comment">//æ¶‰åŠåˆ°ä½è¿ç®—å¤šåŠ æ‹¬å·! </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>)) &lt;= n;i++)&#123;</span><br><span class="line">st[i][j] = max(st[i][j<span class="number">-1</span>],st[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = Log[r-l+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> mx = max(st[l][k],st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line"><span class="comment">//printf("%d %d\n",k,mx);</span></span><br><span class="line"><span class="keyword">return</span> mx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,l,r;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;l,&amp;r);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(l,r));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-2-äºŒç»´stè¡¨"><a href="#5-2-äºŒç»´stè¡¨" class="headerlink" title="5.2 äºŒç»´stè¡¨"></a>5.2 äºŒç»´stè¡¨</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä»¤t1 = st[a][b][c];</span><br><span class="line">ä»¤t2 = st[a][b+c-(1&lt;&lt;k)+1][c];</span><br><span class="line">ä»¤t3 = st[a+c-(1&lt;&lt;k)+1][b][c];</span><br><span class="line">ä»¤t4 = st[a+c-(1&lt;&lt;k)+1][b+c-(1&lt;&lt;k)+1][c];</span><br><span class="line">ans = max&#123;t1 , t2 , t3 , t4&#125;ï¼›</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">int</span> a[N][N],n,m,len,Log[N];</span><br><span class="line"><span class="keyword">int</span> st[<span class="number">3</span>][N][N][<span class="number">15</span>];<span class="comment">//0æœ€å°ï¼Œ1æœ€å¤§å€¼ </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> mx = a;<span class="keyword">if</span>(mx &lt; b) mx = b;<span class="keyword">if</span>(mx &lt; c) mx = c;<span class="keyword">if</span>(mx &lt; d) mx = d;</span><br><span class="line"><span class="keyword">return</span> mx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> mi = a;<span class="keyword">if</span>(mi &gt; b) mi = b;<span class="keyword">if</span>(mi &gt; c) mi = c;<span class="keyword">if</span>(mi &gt; d) mi = d;</span><br><span class="line"><span class="keyword">return</span> mi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; N;i++) Log[i] = Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= m;j++) </span><br><span class="line">st[<span class="number">0</span>][i][j][<span class="number">0</span>] = st[<span class="number">1</span>][i][j][<span class="number">0</span>] = a[i][j];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= <span class="number">12</span>;k++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span>&lt;&lt;k)<span class="number">-1</span> &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j + (<span class="number">1</span>&lt;&lt;k)<span class="number">-1</span> &lt;= m;j++)&#123;</span><br><span class="line"><span class="keyword">int</span> t1 = st[<span class="number">0</span>][i][j][k<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">int</span> t2 = st[<span class="number">0</span>][i+(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>))][j][k<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">int</span> t3 = st[<span class="number">0</span>][i][j+(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>))][k<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">int</span> t4 = st[<span class="number">0</span>][i+(<span class="number">1</span>&lt;&lt;k<span class="number">-1</span>)][j+(<span class="number">1</span>&lt;&lt;k<span class="number">-1</span>)][k<span class="number">-1</span>];</span><br><span class="line">st[<span class="number">0</span>][i][j][k] = min(t1,t2,t3,t4);</span><br><span class="line">t1 = st[<span class="number">1</span>][i][j][k<span class="number">-1</span>];</span><br><span class="line">t2 = st[<span class="number">1</span>][i+(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>))][j][k<span class="number">-1</span>];</span><br><span class="line">t3 = st[<span class="number">1</span>][i][j+(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>))][k<span class="number">-1</span>];</span><br><span class="line">t4 = st[<span class="number">1</span>][i+(<span class="number">1</span>&lt;&lt;k<span class="number">-1</span>)][j+(<span class="number">1</span>&lt;&lt;k<span class="number">-1</span>)][k<span class="number">-1</span>];</span><br><span class="line">st[<span class="number">1</span>][i][j][k] = max(t1,t2,t3,t4);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> r,<span class="keyword">int</span> c,<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = Log[len];</span><br><span class="line"><span class="keyword">int</span> t1 = st[<span class="number">0</span>][r][c][k];</span><br><span class="line"><span class="keyword">int</span> t2 = st[<span class="number">0</span>][r+len-(<span class="number">1</span>&lt;&lt;k)][c][k];</span><br><span class="line"><span class="keyword">int</span> t3 = st[<span class="number">0</span>][r][c+len-(<span class="number">1</span>&lt;&lt;k)][k];</span><br><span class="line"><span class="keyword">int</span> t4 = st[<span class="number">0</span>][r+len-(<span class="number">1</span>&lt;&lt;k)][c+len-(<span class="number">1</span>&lt;&lt;k)][k];</span><br><span class="line"><span class="keyword">int</span> mi = min(t1,t2,t3,t4);</span><br><span class="line">t1 = st[<span class="number">1</span>][r][c][k];</span><br><span class="line">t2 = st[<span class="number">1</span>][r+len-(<span class="number">1</span>&lt;&lt;k)][c][k];</span><br><span class="line">t3 = st[<span class="number">1</span>][r][c+len-(<span class="number">1</span>&lt;&lt;k)][k];</span><br><span class="line">t4 = st[<span class="number">1</span>][r+len-(<span class="number">1</span>&lt;&lt;k)][c+len-(<span class="number">1</span>&lt;&lt;k)][k];</span><br><span class="line"><span class="keyword">int</span> mx = max(t1,t2,t3,t4);</span><br><span class="line"><span class="comment">//printf("%d %d\n",mx,mi);</span></span><br><span class="line"><span class="keyword">return</span> mx - mi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;len);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= m;j++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i][j]);</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n-len+<span class="number">1</span>;i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= m-len+<span class="number">1</span>;j++)&#123;</span><br><span class="line"><span class="keyword">int</span> tmp = ask(i,j,len);</span><br><span class="line">ans = ans &lt; tmp?ans:tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-äºŒå‰å †"><a href="#6-äºŒå‰å †" class="headerlink" title="6 äºŒå‰å †"></a>6 äºŒå‰å †</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å·¦å„¿å­ï¼š2*rt+1, å³å„¿å­: 2*rt+2,æ—¶é—´å¤æ‚åº¦O(N)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> heap[N];</span><br><span class="line"><span class="keyword">int</span> sz = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">//iæ˜¯è‡ªå·±èŠ‚ç‚¹çš„ç¼–å· </span></span><br><span class="line"><span class="keyword">int</span> i = sz++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(i &gt; <span class="number">0</span>)&#123;</span><br><span class="line"><span class="comment">//pæ˜¯çˆ¶äº²èŠ‚ç‚¹çš„ç¼–å·</span></span><br><span class="line"><span class="keyword">int</span> p = (i<span class="number">-1</span>)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span>(heap[p] &lt;= x) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">heap[i] = heap[p];</span><br><span class="line">i = p; </span><br><span class="line">&#125;</span><br><span class="line">heap[i] = x;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pop</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = heap[<span class="number">0</span>];</span><br><span class="line"><span class="comment">//è¦æåˆ°æ ¹çš„æ•°å€¼x</span></span><br><span class="line"><span class="keyword">int</span> x = heap[--sz];</span><br><span class="line"><span class="comment">//ä»æ ¹å¼€å§‹å‘ä¸‹äº¤æ¢ </span></span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(i*<span class="number">2</span> + <span class="number">1</span> &lt; sz)&#123;</span><br><span class="line"><span class="comment">//å·¦å³å„¿å­ </span></span><br><span class="line"><span class="keyword">int</span> a = i*<span class="number">2</span>+<span class="number">1</span>,b = i*<span class="number">2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span>(b &lt; sz &amp;&amp; heap[b] &lt; heap[a]) a = b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(heap[a]  &gt;= x) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">heap[i] = heap[a];</span><br><span class="line">i = a;</span><br><span class="line">&#125;</span><br><span class="line">heap[i] = x;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-å•è°ƒæ ˆä¸ç¬›å¡å°”æ ‘"><a href="#7-å•è°ƒæ ˆä¸ç¬›å¡å°”æ ‘" class="headerlink" title="7 å•è°ƒæ ˆä¸ç¬›å¡å°”æ ‘"></a>7 å•è°ƒæ ˆä¸ç¬›å¡å°”æ ‘</h3><p>ç¬›å¡å°”æ ‘ï¼ˆCartesian Treeï¼‰æ˜¯ä¸€ç§åŒæ—¶æ»¡è¶³å †æ€§è´¨å’ŒäºŒå‰æœç´¢æ ‘æ€§è´¨çš„ä¸€æ£µäºŒå‰æ ‘ã€‚å› æ­¤ç¬›å¡å°”æ ‘çš„æ ‘æ ¹å¯¹åº”ç€è¯¥æ ‘çš„æå€¼ï¼ˆå †æ€§è´¨ï¼‰ï¼Œå¹¶ä¸”å¯¹å…¶ä¸­åºéå†å¾—åˆ°çš„æ˜¯åŸåºåˆ—ä¸€æ®µè¿ç»­çš„åŒºé—´ï¼ˆäºŒå‰æœç´¢æ ‘æ€§è´¨ï¼‰ã€‚<br>æˆ‘ä»¬å‡è®¾åˆ©ç”¨ä¸€ä¸ªæ•´æ•°åºåˆ—Aï¼ša1~an å»ºç«‹ç¬›å¡å°”æ ‘ï¼Œé‚£ä¹ˆæ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹æœ‰2ä¸ªé”®å€¼ï¼Œidxï¼ˆä¸‹æ ‡ï¼‰å’Œ valï¼ˆå€¼ï¼‰ã€‚æˆ‘ä»¬ä½¿æ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹çš„idxæ»¡è¶³äºŒå‰æœç´¢æ ‘æ€§è´¨ï¼Œè€Œvalæ»¡è¶³å †æ€§è´¨ï¼Œäºæ˜¯ç¬›å¡å°”æ ‘å°±å»ºæˆäº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> a[N],tot = <span class="number">0</span>,n;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function">ll <span class="title">max</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a &lt; b?b:a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> idx,val;<span class="comment">//ä¸‹æ ‡ã€æƒå€¼ </span></span><br><span class="line"><span class="keyword">int</span> l,r,par;<span class="comment">//å·¦å„¿å­ã€å³å„¿å­ã€çˆ¶äº²èŠ‚ç‚¹çš„ç¼–å· </span></span><br><span class="line">Node()&#123;&#125;</span><br><span class="line">Node(<span class="keyword">int</span> idx,<span class="keyword">int</span> val)</span><br><span class="line">:idx(idx),val(val)&#123;</span><br><span class="line">l = r = par = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BuildTree</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> k = i<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">while</span>(t[k].val &gt; t[i].val) k = t[k].par;</span><br><span class="line">t[i].l = t[k].r;<span class="comment">//kçš„å³å­æ ‘ä½œä¸ºiçš„å·¦å­æ ‘ </span></span><br><span class="line">t[k].r = i;<span class="comment">//iä½œä¸ºkçš„å³å­æ ‘ </span></span><br><span class="line">t[i].par = k;<span class="comment">//içš„çˆ¶äº²æ˜¯k </span></span><br><span class="line">t[t[i].l].par = i;<span class="comment">//içš„å·¦å­æ ‘çš„çˆ¶äº²æ˜¯i </span></span><br><span class="line"><span class="comment">//printf("%d %d\n",i,k);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> t[<span class="number">0</span>].r;<span class="comment">//æœ€ç»ˆæ ‘çš„æ ¹èŠ‚ç‚¹çš„ç¼–å· </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line"><span class="comment">//printf("%d\n",rt);</span></span><br><span class="line"><span class="keyword">if</span>(rt == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">ll sz = <span class="number">1</span>;</span><br><span class="line">sz += dfs(t[rt].l);</span><br><span class="line">sz += dfs(t[rt].r);</span><br><span class="line">ans = max(ans,sz*(t[rt].val));</span><br><span class="line"><span class="keyword">return</span> sz;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)</span><br><span class="line">t[i] = Node(i,a[i]);</span><br><span class="line">tot = ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> rt = BuildTree();</span><br><span class="line">dfs(rt);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n) &amp;&amp; n)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-CDQåˆ†æ²»"><a href="#8-CDQåˆ†æ²»" class="headerlink" title="8 CDQåˆ†æ²»"></a>8 CDQåˆ†æ²»</h3><h4 id="8-2-äºŒç»´CDQåˆ†æ²»"><a href="#8-2-äºŒç»´CDQåˆ†æ²»" class="headerlink" title="8.2 äºŒç»´CDQåˆ†æ²»"></a>8.2 äºŒç»´CDQåˆ†æ²»</h4><blockquote><p>ç»™å®šä¸€ä¸ªNä¸ªå…ƒç´ çš„åºåˆ—Aï¼Œåˆå§‹å€¼å…¨éƒ¨ä¸º0ï¼Œå¯¹è¿™ä¸ªåºåˆ—è¿›è¡Œä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š<br>ã€€ã€€æ“ä½œ1ï¼šæ ¼å¼ä¸º1 x kï¼ŒæŠŠä½ç½®xçš„å…ƒç´ åŠ ä¸Škï¼ˆä½ç½®ä»1æ ‡å·åˆ°Nï¼‰ã€‚<br>ã€€ã€€æ“ä½œ2ï¼šæ ¼å¼ä¸º2 x yï¼Œæ±‚å‡ºåŒºé—´[x,y]å†…æ‰€æœ‰å…ƒç´ çš„å’Œã€‚</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500050</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">500050</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Q = N*<span class="number">3</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> type,pos;</span><br><span class="line">    ll val;</span><br><span class="line">    Node(<span class="keyword">int</span> type,<span class="keyword">int</span> pos,ll val):type(type),pos(pos),val(val)&#123;&#125;</span><br><span class="line">    Node()&#123;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (Node b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(pos == b.pos) <span class="keyword">return</span> type &lt; b.type;</span><br><span class="line">        <span class="keyword">return</span> pos &lt; b.pos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> aidx = <span class="number">0</span>,qidx = <span class="number">0</span>;</span><br><span class="line">Node query[Q];</span><br><span class="line">Node tmp[Q];</span><br><span class="line">ll ans[Q];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CDQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r<span class="number">-1</span>) <span class="keyword">return</span>;<span class="comment">//å·¦é—­å³å¼€å˜›</span></span><br><span class="line">    <span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">    CDQ(l,mid);</span><br><span class="line">    CDQ(mid,r);</span><br><span class="line">    <span class="keyword">int</span> p = l,q = mid,k = <span class="number">0</span>;</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(p &lt; mid &amp;&amp; q &lt; r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(query[p] &lt; query[q])&#123;</span><br><span class="line">            <span class="keyword">if</span>(query[p].type == <span class="number">1</span>)</span><br><span class="line">                sum += query[p].val;</span><br><span class="line">            tmp[k++] = query[p++];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> x = query[q].val;</span><br><span class="line">            <span class="keyword">if</span>(query[q].type == <span class="number">2</span>)</span><br><span class="line">                ans[x] -= sum;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(query[q].type == <span class="number">3</span>)</span><br><span class="line">                ans[x] += sum;</span><br><span class="line">            tmp[k++] = query[q++];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(p &lt; mid) tmp[k++] = query[p++];<span class="comment">//è¿™é‡Œä¸ç”¨å†ç´¯åŠ ä¿®æ”¹çš„å€¼ï¼Œå› ä¸ºç”¨ä¸åˆ°äº†å•Š </span></span><br><span class="line">    <span class="keyword">while</span>(q &lt; r)&#123;</span><br><span class="line">    <span class="comment">//è¿™é‡Œè¿˜éœ€å°†æˆ‘ä»¬ç´¯åŠ çš„ç»“æœè¿›è¡Œè¿ç®—ï¼Œæˆ‘ä»¬è§„å®šå°±æ˜¯è¦ç´¯åŠ å·¦åŒºé—´ï¼ŒæŸ¥è¯¢å³åŒºé—´å˜› </span></span><br><span class="line">        <span class="keyword">int</span> x = query[q].val;</span><br><span class="line">        <span class="keyword">if</span>(query[q].type == <span class="number">2</span>)</span><br><span class="line">            ans[x] -= sum;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(query[q].type == <span class="number">3</span>)</span><br><span class="line">            ans[x] += sum;</span><br><span class="line">        tmp[k++] = query[q++];</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; k;i++)</span><br><span class="line">        query[i+l] = tmp[i]; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">        query[qidx++] = Node(<span class="number">1</span>,i,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> a,b,c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line">        <span class="keyword">if</span>(a == <span class="number">1</span>)&#123;</span><br><span class="line">            query[qidx++] = Node(a,b,c);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            query[qidx++] = Node(<span class="number">2</span>,b<span class="number">-1</span>,aidx);</span><br><span class="line">            query[qidx++] = Node(<span class="number">3</span>,c,aidx);</span><br><span class="line">            aidx++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    CDQ(<span class="number">0</span>,qidx);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; aidx;i++) </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-2-ä¸‰ç»´CDQåˆ†æ²»"><a href="#8-2-ä¸‰ç»´CDQåˆ†æ²»" class="headerlink" title="8.2 ä¸‰ç»´CDQåˆ†æ²»"></a>8.2 ä¸‰ç»´CDQåˆ†æ²»</h4><p>&emsp;&emsp;åœ¨äºŒç»´ååºé—®é¢˜æ‹“å±•ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨äºŒç»´æœ‰åºå½“ä½œç´¢å¼•ï¼Œæ¥æŸ¥æ‰¾æƒ³è¦çš„ç»“æœã€‚ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä¸å¯ä»¥ç”¨ä¸‰ç»´æœ‰åºå¯¹æ¥å½“ä¸‹æ ‡ï¼Œæ‰¾å¯»æƒ³è¦çš„ç­”æ¡ˆé›†åˆTå‘¢ï¼Ÿ<br><strong>ä¾‹é¢˜ï¼š</strong> </p><blockquote><p>&emsp;&emsp;å¹³é¢ä¸Šæœ‰Nä¸ªç‚¹ï¼Œæ¯ä¸ªç‚¹çš„æ¨ªçºµåæ ‡åœ¨[0,1e7]ä¹‹é—´ï¼Œæœ‰Mä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®ä¸ºæŸ¥è¯¢åœ¨æŒ‡å®šçŸ©å½¢ä¹‹å†…æœ‰å¤šå°‘ä¸ªç‚¹ï¼ŒçŸ©å½¢ç”¨(x1,y1,x2,y2)çš„æ–¹å¼ç»™å‡ºï¼Œå…¶ä¸­(x1,y1)ä¸ºå·¦ä¸‹è§’åæ ‡ï¼Œ(x2,y2)ä¸ºå³ä¸Šè§’åæ ‡ã€‚</p></blockquote><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>&emsp;&emsp;æˆ‘ä»¬åŒæ ·å°†æŸ¥è¯¢åŒºé—´å†…ç‚¹æ•°é‡åˆ†æˆå››ä¸ªæ±‚å‰ç¼€å’Œæ“ä½œï¼ˆè¿™é‡Œéœ€è¦ç”¨å®¹æ–¥åŸç†ï¼‰ã€‚å°†å¹³é¢ä¸Šç‚¹çœ‹æˆæ’å…¥æ“ä½œï¼ŒæŸ¥è¯¢çŸ©å½¢å†…ç‚¹ä¸ªæ•°çœ‹æˆæŸ¥è¯¢æ“ä½œã€‚é‚£ä¹ˆå¯¹äºæ¯ä¸ªæ“ä½œï¼Œæœ‰<time , x y>ä¸‰ä¸ªç»´åº¦ä½œä¸ºç´¢å¼•ï¼ˆæˆ–è€…ä¸‹æ ‡ï¼‰ï¼Œåˆå› ä¸ºtimeæ˜¯é»˜è®¤æœ‰åºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ ¹æ®xå½’å¹¶ï¼ŒåŒæ—¶ç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤yçš„å‰ç¼€å’Œã€‚æˆ‘ä»¬æŒ‰ç…§CDQåˆ†æ²»çš„æ€æƒ³ï¼Œç»Ÿè®¡å·¦è¾¹åŒºé—´èŠ‚ç‚¹å¯¹å³è¾¹åŒºé—´æŸ¥è¯¢çš„è´¡çŒ®ã€‚ï¼ˆè¿™é‡Œæ‰€è¯´çš„å·¦å³åŒºé—´æ¦‚å¿µå¼•è‡ªå½’å¹¶æ’åºï¼‰è¯¦ç»†æ€æƒ³è¯·å¯¹ç…§ä»£ç ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong> </time></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">BZOJ1935</span></span><br><span class="line"><span class="comment">å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">CDQ+æ ‘çŠ¶æ•°ç»„ </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">50</span>;<span class="comment">//æœ€å¤§èŠ‚ç‚¹æ•°é‡ </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> op,x,y,val;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">op = 1æ˜¯ä¿®æ”¹å€¼æ“ä½œï¼Œ2æ˜¯å‡å»å‰ç¼€å’Œæ“ä½œï¼Œ3æ˜¯åŠ ä¸Šå‰ç¼€å’Œæ“ä½œ</span></span><br><span class="line"><span class="comment">xã€yä»£è¡¨åæ ‡</span></span><br><span class="line"><span class="comment">valæœ‰ä¸¤é‡ç”¨æ³•ï¼Œ å½“æ˜¯ä¿®æ”¹å€¼æ“ä½œæ—¶ï¼Œvalä»£è¡¨è¦ä¿®æ”¹çš„å€¼ï¼› </span></span><br><span class="line"><span class="comment">å½“è¡¨ç¤ºæ±‚å‰ç¼€å’Œæ“ä½œæ—¶ï¼Œvalä»£è¡¨ç­”æ¡ˆæ•°ç»„ansçš„ä¸‹æ ‡ï¼ˆå› ä¸ºæœ€ç»ˆç»“æœè¦ç´¯åŠ ï¼‰ </span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> Node &amp;B) <span class="keyword">const</span>&#123; </span><br><span class="line"><span class="comment">//xä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œyä¸ºç¬¬äºŒå…³é”®å­—ï¼Œopä¸ºç¬¬ä¸‰å…³é”®å­—ï¼Œå‡åºæ’åº </span></span><br><span class="line"><span class="keyword">if</span>(x == B.x)&#123;</span><br><span class="line"><span class="keyword">if</span>(y == B.y) <span class="keyword">return</span> op &lt; B.op;</span><br><span class="line"> <span class="keyword">return</span> y &lt; B.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x &lt; B.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ„é€ å‡½æ•°ï¼Œæ— å‚çš„ç”¨æ¥åˆ›å»ºæ•°ç»„ï¼Œæœ‰å‚çš„ç”¨æ¥å¿«é€Ÿèµ‹å€¼ </span></span><br><span class="line">Node()&#123;&#125;</span><br><span class="line">Node(<span class="keyword">int</span> op,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> val):op(op),x(x),y(y),val(val)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">Node Q[<span class="number">7</span>*N];<span class="comment">//ä¸ºå•¥æ˜¯7å€ï¼Œå› ä¸ºæ¯ä¸ªæŸ¥è¯¢æ“ä½œè¢«åˆ†æˆå››ä¸ªå­æ“ä½œäº†å˜› </span></span><br><span class="line">Node tmp[<span class="number">7</span>*N];</span><br><span class="line"><span class="keyword">int</span> ans[N],st[<span class="number">10100000</span>];<span class="comment">//æ ‘çŠ¶æ•°ç»„æ²¡å¼€ç¦»æ•£åŒ–ï¼Œå½“ç„¶å¦‚æœèŒƒå›´å†å¤§ç‚¹å°±è¦å¼€äº† </span></span><br><span class="line"><span class="keyword">int</span> qidx = <span class="number">0</span>,aidx = <span class="number">2</span>;<span class="comment">//åˆ†åˆ«ä»£è¡¨æŸ¥è¯¢é›†åˆQå’Œç­”æ¡ˆé›†åˆansçš„ä¸‹æ ‡ </span></span><br><span class="line"><span class="comment">//ä»¥ä¸‹ä¿©ä¸ªå‡½æ•°æ˜¯æ ‘çŠ¶æ•°ç»„çš„å‡½æ•° </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x &lt; N;x += x&amp;-x) st[x] += y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x -= x&amp;-x) sum += st[x];</span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//CDQåˆ†æ²»çš„ç”¨æ³• </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(r-l &lt;= <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">solve(l,mid);</span><br><span class="line">solve(mid,r);</span><br><span class="line"><span class="keyword">int</span> p = l,q = mid,k = l;</span><br><span class="line"><span class="keyword">while</span>(p &lt; mid &amp;&amp; q &lt; r)&#123;</span><br><span class="line"><span class="keyword">if</span>(Q[p] &lt; Q[q])&#123;</span><br><span class="line"><span class="keyword">if</span>(Q[p].op == <span class="number">1</span>) add(Q[p].y,Q[p].val);</span><br><span class="line">tmp[k++] = Q[p++];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(Q[q].op == <span class="number">2</span>)  ans[Q[q].val] -= ask(Q[q].y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(Q[q].op == <span class="number">3</span>)ans[Q[q].val] += ask(Q[q].y);</span><br><span class="line">tmp[k++] = Q[q++];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(q &lt; r)&#123;</span><br><span class="line"><span class="keyword">if</span>(Q[q].op == <span class="number">2</span>)  ans[Q[q].val] -= ask(Q[q].y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(Q[q].op == <span class="number">3</span>) ans[Q[q].val] += ask(Q[q].y);</span><br><span class="line">tmp[k++] = Q[q++];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æˆ‘ä»¬ç”¨è¿™ç§æ–¹æ³•æ¥æ¸…ç©ºæ ‘çŠ¶æ•°ç»„ï¼Œå¯ä»¥èŠ‚çœæ—¶é—´ </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = l;i &lt; p;i++)</span><br><span class="line"><span class="keyword">if</span>(Q[i].op == <span class="number">1</span>) add(Q[i].y,-Q[i].val);</span><br><span class="line"><span class="keyword">while</span>(p &lt; mid) tmp[k++] = Q[p++];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = l;i &lt; r;i++) Q[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">Q[qidx++] = Node(<span class="number">1</span>,x+<span class="number">1</span>,y+<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> x1,y1,x2,y2;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;x1,&amp;y1,&amp;x2,&amp;y2);</span><br><span class="line">Q[qidx++] = Node(<span class="number">3</span>,x1,y1,aidx);</span><br><span class="line">Q[qidx++] = Node(<span class="number">2</span>,x1,y2+<span class="number">1</span>,aidx);</span><br><span class="line">Q[qidx++] = Node(<span class="number">2</span>,x2+<span class="number">1</span>,y1,aidx);</span><br><span class="line">Q[qidx++] = Node(<span class="number">3</span>,x2+<span class="number">1</span>,y2+<span class="number">1</span>,aidx++);</span><br><span class="line">&#125;</span><br><span class="line">solve(<span class="number">0</span>,qidx);<span class="comment">//ä¾æ—§å·¦é—­å³å¼€ </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; aidx;i++) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ValenShiçš„ACMæ¨¡æ¿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hdu6681 Rikka with Cake</title>
      <link href="/2019/08/19/hdu6681/"/>
      <url>/2019/08/19/hdu6681/</url>
      
        <content type="html"><![CDATA[<p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6681" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a></p><h5 id="é¢˜æ„ç®€è¿°"><a href="#é¢˜æ„ç®€è¿°" class="headerlink" title="é¢˜æ„ç®€è¿°"></a>é¢˜æ„ç®€è¿°</h5><p>ç›´æ¥çœ‹æ ·ä¾‹å…¶å®å°±æ˜ç™½äº†ï¼Œçœ‹å›¾è¯´è¯ï¼Œå°±æ˜¯ç»™å‡ºä¸€ä¸ªå·¦ä¸‹è§’åæ ‡ä¸º(0,0)ï¼Œå³ä¸Šè§’ä¸º(n,m)çš„çŸ©å½¢ï¼›ç„¶åæœ‰kæ¡çº¿æ®µï¼Œè¿™äº›çº¿æ®µä¸é‡å ï¼Œéƒ½æ˜¯ä»çŸ©å½¢å†…æŸä¸€ç‚¹å‡ºå‘åˆ°çŸ©å½¢æŸä¸€è¾¹ä¸ºæ­¢ï¼Œè¿™äº›çº¿æ®µå…±å››ç§ï¼Œéƒ½ä¸åæ ‡è½´å¹³è¡Œã€‚<br><img src="/2019/08/19/hdu6681/1.png" alt="1"><br>è¯·é—®è¿™äº›çº¿æ®µå°†çŸ©å½¢åˆ†ä¸ºäº†å‡ ä¸ªä¸è¿é€šçš„é¢ï¼Ÿï¼ˆå›¾ä¸€æ˜¯3ä¸ªï¼Œå›¾äºŒæ˜¯5ä¸ªï¼‰</p><h5 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h5><p>é¦–å…ˆè€ƒè™‘åˆ°ä»»æ„ä¸¤æ¡ç›´çº¿çš„xï¼Œyåæ ‡éƒ½æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°é‡å ç°è±¡ã€‚è§‚å¯Ÿå¾—ï¼Œè‚¯å®šæ˜¯ç›¸äº¤çš„çº¿æ®µæ‰èƒ½åˆ†å‰²å‡ºæ–°çš„é¢ï¼ˆä¸€æ¡æ¨ªçš„çº¿ä¸å‡ æ¡ç«–çº¿ç›¸äº¤å°±ä¼šå¢åŠ å‡ ä¸ªé¢ï¼‰ã€‚<br>æ‰€ä»¥æˆ‘ä»¬åªéœ€è€ƒè™‘ï¼Œå‡è®¾å…ˆå°†æ‰€æœ‰ä¸yè½´å¹³è¡Œçš„çº¿åŠ å…¥ï¼Œç„¶åå¯¹äºæ¯ä¸€æ¡ä¸xè½´å¹³è¡Œçš„çº¿ï¼Œæœ‰å‡ æ¡ä¸å…¶ç›¸äº¤ï¼Œæœ€ç»ˆç­”æ¡ˆå°±æ˜¯è¿™äº›äº¤ç‚¹ä¸ªæ•°å†+1ã€‚</p><p>ç°åœ¨çš„é—®é¢˜å°±æ˜¯å¯¹äºæ¯ä¸ªä¸xè½´å¹³è¡Œçš„çº¿ï¼Œæœ‰å¤šå°‘ä¸yè½´å¹³è¡Œçš„çº¿ä¸å…¶ç›¸äº¤ã€‚å¦‚æœæŒ¨ä¸ªè®¡ç®—å¹¶ç´¯åŠ ï¼Œè®¡ç®—å®Œæ‰€æœ‰çº¿æ®µéœ€è¦O(N^2)æ—¶é—´ã€‚å…¶å®æˆ‘ä»¬ä¼šå‘ç°ï¼Œæ‰¾ä¸(x , y)è‡³å·¦è¾¹ç•Œï¼ˆLï¼‰çš„æ¨ªçº¿ç›¸äº¤çš„çº¿æ®µï¼Œåªéœ€è¦æ‰¾å‡º xâ€™ &lt;= x &amp;&amp; yâ€™ &lt;= yçš„å‘ä¸Šæ–¹(U) çš„çº¿æ®µä»¥åŠ xâ€™ &lt;= x &amp;&amp; yâ€™ &gt;= yçš„å‘ä¸‹ (D) çš„çº¿æ®µçš„æ•°é‡å³å¯ã€‚è¿™æ˜¯äºŒç»´ååºé—®é¢˜ï¼Œæ˜¯4ä¸ªäºŒç»´ååºé—®é¢˜ã€‚è€ŒäºŒç»´ååºé—®é¢˜å¯ä»¥åœ¨$O(Nlog_2^N)$æ—¶é—´å†…ç”¨CDQåˆ†æ²»è§£å†³ï¼Œå†™èµ·æ¥ä¹Ÿä¸æ˜¯å¾ˆéº»çƒ¦ï¼ˆè¿˜å¥½ä¸æ˜¯ä¸‰ç»´ï¼‰ã€‚</p><p>PSï¼šå‘œå‘œå‘œæ­£è§£æ˜¯æ¬§æ‹‰å®šç†å‘œå‘œå‘œå‘œå‘œ</p><h5 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x,y,t;</span><br><span class="line">    Node()&#123;&#125;</span><br><span class="line">    Node(<span class="keyword">int</span> x,<span class="keyword">int</span> y):x(x),y(y)&#123;t = <span class="number">0</span>;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node&amp; B)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x &lt; B.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Node U[N],D[N],R[N],L[N],tmp[N];</span><br><span class="line">Node TU[N];</span><br><span class="line"><span class="keyword">int</span> cu,cd,cr,cl,cnt;</span><br><span class="line"><span class="keyword">int</span> n,m,t,k;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cdq1</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r<span class="number">-1</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    cdq1(l,mid); cdq1(mid,r);</span><br><span class="line">    <span class="keyword">int</span> p = l,q = mid,tk = <span class="number">0</span>,tt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(p &lt; mid &amp;&amp; q &lt; r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(TU[p].y &lt;= TU[q].y)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!TU[p].t) tt++;</span><br><span class="line">            tmp[tk++] = TU[p++];</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(TU[q].t) cnt += tt;</span><br><span class="line">            tmp[tk++] = TU[q++];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(p &lt; mid) tmp[tk++] = TU[p++];</span><br><span class="line">    <span class="keyword">while</span>(q &lt; r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(TU[q].t) cnt += tt;</span><br><span class="line">        tmp[tk++] = TU[q++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; tk;i++) TU[i+l] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp2</span><span class="params">(Node a,Node b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.x &gt; b.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    å¯¹äºL[i],æœ‰å¤šå°‘Uä¸­x &lt; L[i].x &amp;&amp; y &lt; L[i].y,</span></span><br><span class="line"><span class="comment">            æœ‰å¤šå°‘Dä¸­x &lt; L[i].x &amp;&amp; y &gt; L[i].y;</span></span><br><span class="line"><span class="comment">    å¯¹äºR[i]æœ‰å¤šå°‘Uä¸­x &gt; R[i].x &amp;&amp; y &lt; R[i].y,</span></span><br><span class="line"><span class="comment">            æœ‰å¤šå°‘Dä¸­x &gt; R[i].x &amp;&amp; y &gt; R[i].y;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; cu;i++) TU[i] = U[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; cl;i++) TU[i+cu] = L[i],TU[i+cu].t = <span class="number">1</span>;</span><br><span class="line">    stable_sort(TU,TU+cu+cl);</span><br><span class="line">    cdq1(<span class="number">0</span>,cl+cu);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; cd;i++) TU[i] = D[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; cl;i++) TU[i+cd] = L[i],TU[i+cd].t = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; cl+cd;i++) TU[i].y *= <span class="number">-1</span>;</span><br><span class="line">    stable_sort(TU,TU+cd+cl);</span><br><span class="line">    cdq1(<span class="number">0</span>,cl+cd);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; cu;i++) TU[i] = U[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; cr;i++) TU[i+cu] = R[i],TU[i+cu].t = <span class="number">1</span>;</span><br><span class="line">    stable_sort(TU,TU+cr+cu,cmp2);</span><br><span class="line">    <span class="comment">//for(int i = 0;i &lt; cr+cu;i++) printf("%d %d\n",TU[i].x,TU[i].y);</span></span><br><span class="line">    cdq1(<span class="number">0</span>,cr+cu);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; cd;i++) TU[i] = D[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; cr;i++) TU[i+cd] = R[i],TU[i+cd].t = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; cd+cr;i++) TU[i].y *= <span class="number">-1</span>;</span><br><span class="line">    stable_sort(TU,TU+cr+cd,cmp2);</span><br><span class="line">    cdq1(<span class="number">0</span>,cr+cd);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,cnt+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;k);</span><br><span class="line">        cu = cd = cr = cl = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= k;i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x,y;<span class="keyword">char</span> dir[<span class="number">5</span>];</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%s"</span>,&amp;x,&amp;y,dir);</span><br><span class="line">            <span class="keyword">if</span>(dir[<span class="number">0</span>] == <span class="string">'U'</span>) U[cu++] = Node(x,y);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(dir[<span class="number">0</span>] == <span class="string">'D'</span>) D[cd++] = Node(x,y);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(dir[<span class="number">0</span>] == <span class="string">'L'</span>) L[cl++] = Node(x,y);</span><br><span class="line">            <span class="keyword">else</span> R[cr++] = Node(x,y);</span><br><span class="line">        &#125;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CDQåˆ†æ²» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>bzoj1093æœ€å¤§åŠè¿é€šå­å›¾</title>
      <link href="/2019/08/18/bzoj1093/"/>
      <url>/2019/08/18/bzoj1093/</url>
      
        <content type="html"><![CDATA[<p><a href="http://www.mfstem.org/contest/17/problem/B" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a></p><h5 id="é—®é¢˜ç®€è¿°"><a href="#é—®é¢˜ç®€è¿°" class="headerlink" title="é—®é¢˜ç®€è¿°"></a>é—®é¢˜ç®€è¿°</h5><p>ç»™å‡ºä¸€ä¸ªæœ‰å‘å›¾ï¼Œæ±‚å…¶æœ€å¤§åŠè¿é€šå­å›¾çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œä»¥åŠä¸åŒçš„æœ€å¤§åŠè¿é€šå­å›¾çš„æ•°ç›®ã€‚<br>ï¼ˆå­å›¾ã€åŠè¿é€šå›¾ã€æœ€å¤§åŠè¿é€šå­å›¾ç­‰å®šä¹‰è¯·å‚ç…§åŸé¢˜ï¼‰</p><h5 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h5><p>æœ¬é¢˜æ˜¯ã€Šä¿¡æ¯å­¦å¥¥èµ›ä¸€æœ¬é€šÂ·æé«˜ç¯‡ã€‹ä¸­ï¼Œå¼ºè¿é€šåˆ†é‡ç« èŠ‚çš„ä¸€é“ä¾‹é¢˜ã€‚æœ¬é¢˜æ€è·¯å…¶å®å¾ˆæ¸…æ™°ä¹Ÿå¾ˆæ˜ç¡®ï¼Œå°±æ˜¯æ±‚æœ€å¤§åŠè¿é€šå­å›¾çš„èŠ‚ç‚¹æ•°ï¼Œä»¥åŠæœ‰å¤šå°‘ä¸ªè¿™æ ·çš„å­å›¾ã€‚å¯ä»¥å¾—çŸ¥ï¼Œå¦‚æœä¸€ä¸ªå­å›¾æ˜¯å¼ºè¿é€šçš„ï¼Œé‚£ä¹ˆä»–ä¸€å®šæ˜¯åŠè¿é€šçš„ï¼Œæ‰€ä»¥å¯¹äºæ‰€æœ‰çš„å¼ºè¿é€šåˆ†é‡ï¼Œæˆ‘ä»¬éƒ½ç¼©ä¸ºä¸€ä¸ªç‚¹ï¼Œè¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ã€‚<br>æˆ‘ä»¬å¯¹å¾—åˆ°çš„DAGè¿›è¡Œå»ºå›¾å¾—åˆ°Gâ€™ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„â€œæƒå€¼â€å°±ç­‰äºè¯¥å¼ºè¿é€šåˆ†é‡çš„é¡¶ç‚¹æ•°ï¼›äºæ˜¯åŸé—®é¢˜å°±æˆäº†åœ¨ Gâ€™ ä¸Šæ‰¾åˆ°æƒå€¼æœ€å¤§çš„<strong>é“¾</strong>ï¼ˆå› ä¸ºæˆ‘ä»¬å¯ä»¥ä¿è¯å¯¹äºé“¾ä¸Šä»»æ„ä¸¤ç‚¹uå’Œvï¼Œéƒ½å•å‘æˆ–åŒå‘å¯è¾¾ï¼‰ã€‚<br>æ‰¾åˆ°äº†â€œæœ€é•¿é“¾â€ä¹‹åï¼Œä¸‹ä¸€æ­¥æ˜¯æ‰¾<strong>ä¸åŒçš„æœ€é•¿é“¾çš„ä¸ªæ•°</strong> ï¼Œè¿™ä¸€æ­¥ç”¨åˆ°ç±»ä¼¼DPçš„æ€æƒ³ï¼Œå³è®¾f[i]ä¸ºåˆ°èŠ‚ç‚¹ i æ—¶ï¼Œè¾¾åˆ°å±€éƒ¨æœ€é•¿é“¾æ—¶ä¸åŒæ–¹æ¡ˆæ•°ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨è¿›è¡Œ<strong>æ‹“æ‰‘æ’åºæ±‚æœ€é•¿é“¾</strong> çš„åŒæ—¶<strong>é€’æ¨æ›´æ–°f[]</strong> å³å¯ã€‚</p><h5 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h5><p>è™½ç„¶å†™ä»£ç æ—¶çš„æ€è·¯å¾ˆæ¸…æ™°ï¼Œä½†æ˜¯ä»£ç è¿˜æ˜¯å†™çš„å¾ˆä¹±ï¼Œå¯è¯»æ€§å¾ˆå·®ï¼›å› ä¸ºæ¶‰åŠå˜é‡å¤ªå¤šã€å¤ªä¹±ï¼Œæ‰€ä»¥æ¯ä¸ªå˜é‡æˆ–æ•°ç»„çš„ä½œç”¨æ˜¯ä»€ä¹ˆå¹¶ä¸æ˜¯ä¸€ç›®äº†ç„¶ï¼Œä½†æˆ‘ä¹Ÿæ‡’å¾—å†™æ³¨é‡Šäº†ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],nex[M],tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    ver[++tot] = y;nex[tot] = head[x];head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head2[N],ver2[M],nex2[M],tot2 = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    ver2[++tot2] = y; nex2[tot2] = head2[x];head2[x] = tot2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> Stack[N],top;</span><br><span class="line"><span class="keyword">int</span> dfn[N],low[N],num,co[N],col;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Tarjan</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">dfn[u] = low[u] = ++num;</span><br><span class="line">Stack[++top] = u;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> v = ver[i];</span><br><span class="line"><span class="keyword">if</span>(!dfn[v])&#123;</span><br><span class="line">Tarjan(v);</span><br><span class="line">low[u] = min(low[u],low[v]);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!co[v]) low[u] = min(low[u],dfn[v]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(low[u] == dfn[u])&#123;</span><br><span class="line">co[u] = ++col;</span><br><span class="line"><span class="keyword">while</span>(Stack[top] != u)&#123;</span><br><span class="line">co[Stack[top]] = col;</span><br><span class="line">top--;</span><br><span class="line">&#125;</span><br><span class="line">top--;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,P;</span><br><span class="line">pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; e[M];</span><br><span class="line"><span class="keyword">int</span> du[N],dis[N],si[N];<span class="comment">//si[col]è®°å½•å¼ºè¿é€šåˆ†é‡colèŠ‚ç‚¹ä¸ªæ•°</span></span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="keyword">int</span> mxnum,mxcol;</span><br><span class="line"><span class="keyword">int</span> f[N];<span class="comment">//åˆ°iè·ç¦»ä¸ºæœ€é•¿çš„æ–¹æ¡ˆæ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">topo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(si,<span class="number">0</span>,<span class="keyword">sizeof</span> si);</span><br><span class="line">    <span class="built_in">memset</span>(dis,<span class="number">0</span>,<span class="keyword">sizeof</span> dis);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) si[co[i]]++,f[co[i]] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= col;i++) <span class="keyword">if</span>(!du[i]) q.push(i),dis[i] = si[i];</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front();q.pop();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head2[x];i ;i = nex2[i])&#123;</span><br><span class="line">            <span class="keyword">int</span> y = ver2[i];du[y]--;</span><br><span class="line">            <span class="keyword">if</span>(!du[y]) q.push(y);</span><br><span class="line">            <span class="keyword">if</span>(dis[y] &lt; dis[x]+si[y])&#123;</span><br><span class="line">                dis[y] = dis[x] + si[y];</span><br><span class="line">                f[y] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span>(dis[mxcol] &lt; dis[y]) mxcol = y;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(dis[y] == dis[x]+si[y])</span><br><span class="line">                f[y] = (f[y]+f[x])%P;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= col;i++)</span><br><span class="line">        <span class="keyword">if</span>(dis[i] == dis[mxcol]) mxnum = (mxnum+f[i])%P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    num = col = top = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(dfn,<span class="number">0</span>,<span class="keyword">sizeof</span> dfn);</span><br><span class="line">    <span class="built_in">memset</span>(co,<span class="number">0</span>,<span class="keyword">sizeof</span> co);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="keyword">if</span>(!dfn[i]) Tarjan(i);</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = head[i];j ;j = nex[j])&#123;</span><br><span class="line">            <span class="keyword">int</span> y = ver[j];</span><br><span class="line">            e[++cnt] = make_pair(co[i],co[y]);</span><br><span class="line">            <span class="comment">//printf("%d %d %d %d\n",co[i],co[y],i,y);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//printf("cnt %d\n",cnt);</span></span><br><span class="line">    sort(e+<span class="number">1</span>,e+<span class="number">1</span>+cnt);tot2 = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">memset</span>(du,<span class="number">0</span>,<span class="keyword">sizeof</span> du);</span><br><span class="line">    <span class="built_in">memset</span>(head2,<span class="number">0</span>,<span class="keyword">sizeof</span> head2);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(e[i].first != e[i].second &amp;&amp;</span><br><span class="line">         (e[i].first != e[i<span class="number">-1</span>].first || e[i].second != e[i<span class="number">-1</span>].second))</span><br><span class="line">            addEdge2(e[i].first,e[i].second), du[e[i].second]++;</span><br><span class="line">        <span class="comment">//printf("%d %d\n",e[i].first,e[i].second);</span></span><br><span class="line">    &#125;</span><br><span class="line">    topo();<span class="comment">//æ‹“æ‰‘æ’åºæ‰¾å‡ºæœ€é•¿é“¾</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n%d\n"</span>,dis[mxcol],mxnum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;P);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,a,b;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);</span><br><span class="line">        addEdge(a,b);</span><br><span class="line">    &#125;</span><br><span class="line">    solve();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMé¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼ºè¿é€šåˆ†é‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤§æ•´æ•°å¼€æ–¹æ ¹æ¨¡æ¿</title>
      <link href="/2019/08/18/bigsqrt/"/>
      <url>/2019/08/18/bigsqrt/</url>
      
        <content type="html"><![CDATA[<p><strong>ä¾‹1ï¼š</strong> è¯•åˆ¤æ–­næ˜¯å¦ä¸ºå®Œå…¨å¹³æ–¹æ•°(Perfect square)ï¼Œ$n &lt;=10^{200}$ã€‚</p><p>æœ¬æ¥æƒ³å†™ä¸€ç¯‡å…³äºç‰›é¡¿è¿­ä»£æ³•+é«˜ç²¾åº¦è¿ç®—çš„C++ç‰ˆæœ¬çš„æ¨¡æ¿ï¼Œä½†æ˜¯æ¶‰åŠåˆ°é«˜ç²¾åº¦åŠ å‡ä¹˜é™¤ï¼ŒåŠ¨è¾„300è¡Œä»£ç ä»¥ä¸Šï¼Œè¿˜æ˜¯åœ¨ç½‘ä¸Šæ‰¾ä¸ªJAVAçš„å¤§æ•´æ•°å¼€æ–¹æ ¹çš„æ¨¡æ¿å‡‘åˆç”¨å§ã€‚</p><p>ç”¨JAVAä¹¦å†™ä»£ç ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ—¶é—´å’Œç©ºé—´ï¼Œå†…å­˜è¶…é™å¾ˆå¸¸è§ã€‚</p><h4 id="å¤§æ•°å¼€å¹³æ–¹æ ¹æ¨¡æ¿"><a href="#å¤§æ•°å¼€å¹³æ–¹æ ¹æ¨¡æ¿" class="headerlink" title="å¤§æ•°å¼€å¹³æ–¹æ ¹æ¨¡æ¿"></a>å¤§æ•°å¼€å¹³æ–¹æ ¹æ¨¡æ¿</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">public static BigInteger sqrt(String x) &#123;</span><br><span class="line">        int mlen = x.length();    //è¢«å¼€æ–¹æ•°çš„é•¿åº¦</span><br><span class="line">        int len;    //å¼€æ–¹åçš„é•¿åº¦</span><br><span class="line">        BigInteger beSqrtNum = new BigInteger(x);//è¢«å¼€æ–¹æ•°</span><br><span class="line">        BigInteger sqrtOfNum;    //å­˜å‚¨å¼€æ–¹åçš„æ•°</span><br><span class="line">        BigInteger sqrtOfNumMul;    //å¼€æ–¹æ•°çš„å¹³æ–¹</span><br><span class="line">        String sString;//å­˜å‚¨sArrayè½¬åŒ–åçš„å­—ç¬¦ä¸²</span><br><span class="line">        if(mlen%2 == 0)    len = mlen/2;</span><br><span class="line">        else    len = mlen/2+1;</span><br><span class="line">        char[] sArray = new char[len];</span><br><span class="line">        Arrays.fill(sArray, &apos;0&apos;);//å¼€æ–¹æ•°åˆå§‹åŒ–ä¸º0</span><br><span class="line">        for(int pos=0; pos&lt;len; pos++)&#123;</span><br><span class="line">         //ä»æœ€é«˜å¼€å§‹éå†æ•°ç»„ï¼Œæ¯ä¸€ä½éƒ½è½¬åŒ–ä¸ºå¼€æ–¹æ•°å¹³æ–¹ååˆšå¥½ä¸å¤§äºè¢«å¼€æ–¹æ•°çš„ç¨‹åº¦</span><br><span class="line">            for(char num=&apos;1&apos;; num&lt;=&apos;9&apos;; num++)&#123;</span><br><span class="line">                sArray[pos] = num;</span><br><span class="line">                sString = String.valueOf(sArray);</span><br><span class="line">                sqrtOfNum = new BigInteger(sString);</span><br><span class="line">                sqrtOfNumMul = sqrtOfNum.multiply(sqrtOfNum);</span><br><span class="line">                if(sqrtOfNumMul.compareTo(beSqrtNum) == 1)&#123;</span><br><span class="line">                    sArray[pos]-=1;</span><br><span class="line">                    break;    </span><br><span class="line">                &#125;    </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return new BigInteger(String.valueOf(sArray));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ¤æ–­næ˜¯å¦ä¸ºPerfect-square"><a href="#åˆ¤æ–­næ˜¯å¦ä¸ºPerfect-square" class="headerlink" title="åˆ¤æ–­næ˜¯å¦ä¸ºPerfect square"></a>åˆ¤æ–­næ˜¯å¦ä¸ºPerfect square</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner cin = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">int</span> T = cin.nextInt();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> cas = <span class="number">1</span>; cas &lt;= T; ++cas) &#123;</span><br><span class="line">            String str = cin.next();</span><br><span class="line">            BigInteger n = <span class="keyword">new</span> BigInteger(str);</span><br><span class="line">            BigInteger m = n.multiply(n.subtract(BigInteger.ONE)).shiftRight(<span class="number">1</span>);</span><br><span class="line">            <span class="comment">//System.out.println(n);</span></span><br><span class="line">            <span class="comment">//System.out.println(m);</span></span><br><span class="line">            <span class="keyword">boolean</span> nIsSquare = isSquare(n);</span><br><span class="line">            <span class="keyword">boolean</span> mIsSquare = isSquare(m);</span><br><span class="line">            <span class="keyword">if</span> (nIsSquare &amp;&amp; mIsSquare) &#123;</span><br><span class="line">                System.out.println(<span class="string">"Arena of Valor"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nIsSquare &amp;&amp; !mIsSquare) &#123;</span><br><span class="line">                System.out.println(<span class="string">"Hearth Stone"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!nIsSquare &amp;&amp; mIsSquare) &#123;</span><br><span class="line">                System.out.println(<span class="string">"Clash Royale"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">"League of Legends"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isSquare</span><span class="params">(BigInteger n)</span> </span>&#123;</span><br><span class="line">        BigInteger low = BigInteger.ZERO;</span><br><span class="line">        BigInteger high = n;</span><br><span class="line">        <span class="keyword">while</span> (low.compareTo(high) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            BigInteger mid = low.add(high).shiftRight(<span class="number">1</span>);</span><br><span class="line">            BigInteger square = mid.multiply(mid);</span><br><span class="line">            <span class="keyword">int</span> result = square.compareTo(n);</span><br><span class="line">            <span class="keyword">if</span> (result == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (result &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                high = mid.subtract(BigInteger.ONE);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                low = mid.add(BigInteger.ONE);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>Molexçš„<a href="https://www.cnblogs.com/yzm10/p/9651696.html" target="_blank" rel="noopener">åšå®¢</a></li><li>2019ç„¦ä½œç½‘ç»œèµ› J é¢˜<a href="https://nanti.jisuanke.com/t/A2020" target="_blank" rel="noopener">Participate in E-sports</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­å›½å‰©ä½™å®šç†ï¼ˆæ‹“å±•ï¼‰</title>
      <link href="/2019/08/18/realchina/"/>
      <url>/2019/08/18/realchina/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>åœ¨ã€Šå­™å­ç®—ç»ã€‹ä¸­æœ‰è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šâ€œä»Šæœ‰ç‰©ä¸çŸ¥å…¶æ•°ï¼Œä¸‰ä¸‰æ•°ä¹‹å‰©äºŒï¼ˆé™¤ä»¥3ä½™2ï¼‰ï¼Œäº”äº”æ•°ä¹‹å‰©ä¸‰ï¼ˆé™¤ä»¥5ä½™3ï¼‰ï¼Œä¸ƒä¸ƒæ•°ä¹‹å‰©äºŒï¼ˆé™¤ä»¥7ä½™2ï¼‰ï¼Œé—®ç‰©å‡ ä½•ï¼Ÿâ€è¿™ä¸ªé—®é¢˜ç§°ä¸ºâ€œå­™å­é—®é¢˜â€ï¼Œè¯¥é—®é¢˜çš„ä¸€èˆ¬è§£æ³•å›½é™…ä¸Šç§°ä¸ºâ€œä¸­å›½å‰©ä½™å®šç†â€ã€‚</p><p>ä¸­å›½å‰©ä½™å®šç†æ˜¯æ•°è®ºå››å¤§å®šç†ä¹‹ä¸€ï¼Œå…¶é‡è¦æ€§ä¸å®¹ç½®ç–‘ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»ä¸­å›½å‰©ä½™å®šç†é—®é¢˜çš„ç»å…¸æ¨¡å‹ï¼Œç„¶åå†å¯¹æ›´ä¸€èˆ¬çš„æƒ…å†µè¿›è¡Œæ‹“å±•ï¼Œå¾—åˆ°æ‹“å±•ä¸­å›½å‰©ä½™å®šç†ï¼Œå½“ç„¶æœ€é‡è¦çš„æ˜¯ç»™å‡ºæ¨¡æ¿å¹¶é™„ä¸Šæ¨¡æ¿ä½¿ç”¨è¯´æ˜ä¹¦ã€‚</p><h4 id="ä¸­å›½å‰©ä½™å®šç†"><a href="#ä¸­å›½å‰©ä½™å®šç†" class="headerlink" title="ä¸­å›½å‰©ä½™å®šç†"></a>ä¸­å›½å‰©ä½™å®šç†</h4><p>è‹¥$m_1,m_2,â€¦,m_n$æ˜¯ä¸¤ä¸¤äº’è´¨çš„æ­£æ•´æ•°ï¼ŒM = $\prod_{i = 1}^{n} m_i$, $M_i = M/m_i$ï¼Œ$t_i$æ˜¯çº¿æ€§åŒä½™æ–¹ç¨‹$M_it_i \equiv1(mod\: m_i)$çš„ä¸€ä¸ªè§£ã€‚å¯¹äºä»»æ„çš„nä¸ªæ•´æ•°$a_1,a_2,â€¦,a_n$ï¼Œåˆ™åŒä½™æ–¹ç¨‹ç»„</p><p><img src="/2019/08/18/realchina/1.png" alt="1"></p><p>æœ‰æ•´æ•°è§£ï¼Œæ–¹ç¨‹ç»„çš„è§£ä¸º$x = a_1M_1t_1 + a_2M_2t_2 + â€¦ + a_nM_nt_n$ã€‚å¹¶ä¸”åœ¨æ¨¡Mæ„ä¹‰ä¸‹æœ‰å”¯ä¸€è§£ã€‚</p><h4 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h4><p>å› ä¸º$M_i = M/m_i$æ˜¯é™¤$m_i$ä¹‹å¤–æ‰€æœ‰æ¨¡æ•°çš„å€æ•°ï¼Œæ‰€ä»¥$\forall k \neq i, a_iM_it_i \equiv 0(mod\:m_k)$ã€‚åˆå› ä¸º$a_iM_it_i \equiv a_i(mod\: m_i)$ï¼Œæ‰€ä»¥å¸¦å…¥$x = \sum_{i = 1}^n a_iM_it_i$ï¼ŒåŸæ–¹ç¨‹ç»„æˆç«‹ã€‚<br>è¯æ¯•ã€‚</p><h4 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h4><p>ä¸­å›½å‰©ä½™å®šç†ç»™å‡ºäº†æ¨¡æ•°ä¸¤ä¸¤äº’è´¨çš„çº¿æ€§åŒä½™æ–¹ç¨‹ç»„çš„ä¸€ä¸ªç‰¹æ®Šè§£ã€‚æ–¹ç¨‹ç»„çš„é€šè§£å¯ä»¥è¡¨ç¤ºä¸º$x + kM(k \in Z)$ã€‚æœ‰äº›é¢˜ç›®è¦æ±‚æˆ‘ä»¬æ±‚å‡ºæœ€å°çš„éè´Ÿæ•´æ•°è§£ï¼Œåªéœ€æŠŠ x å¯¹Må–æ¨¡ï¼Œå¹¶è®© x è½åœ¨0~M-1çš„èŒƒå›´å†…å³å¯ã€‚</p><p>å¦å¤–ï¼Œå³ä½¿æ¨¡æ•°ä¸æ»¡è¶³ä¸¤ä¸¤äº’è´¨ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰åŠæ³•åˆ¤æ–­çº¿æ€§åŒä½™æ–¹ç¨‹ç»„æ˜¯å¦æœ‰è§£ï¼Œå¹¶æ±‚å‡ºæ–¹ç¨‹ç»„çš„è§£ã€‚</p><h4 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * ä»£ç å‡ºè‡ª:æ´›è°·ç”¨æˆ·sumijie 2019/8/18</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨è¯´æ˜:</span></span><br><span class="line"><span class="comment"> *    1.llä¸ºè‡ªå®šä¹‰ç±»å‹,è§†é¢˜ç›®æ•°æ®è€Œå®š,å¹¶ä¸ä¸€å®šæ˜¯__int128</span></span><br><span class="line"><span class="comment"> *    2.Nä¸ºæ–¹ç¨‹ç»„ä¸­æ–¹ç¨‹ä¸ªæ•°,è§†æ•°æ®è€Œå®š</span></span><br><span class="line"><span class="comment"> * è¾“å…¥ï¼š</span></span><br><span class="line"><span class="comment"> *    è¾“å…¥ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° n.</span></span><br><span class="line"><span class="comment"> *    æ¥ä¸‹æ¥ n è¡Œ,æ¯è¡Œä¸¤ä¸ªéè´Ÿæ•´æ•° ai,bi</span></span><br><span class="line"><span class="comment"> * è¾“å‡º:</span></span><br><span class="line"><span class="comment"> *    è¾“å‡ºä¸€è¡Œ,ä¸ºæ»¡è¶³æ¡ä»¶çš„æœ€å°éè´Ÿæ•´æ•°x.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> __int128 ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;g,ll &amp;x,ll &amp;y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;</span><br><span class="line">        g = a; x = <span class="number">1</span>; y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    exgcd(b,a%b,g,y,x);</span><br><span class="line">    y-=(a/b)*x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">ll a1,a2,n1,n2;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">abs</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;<span class="number">0</span>?x:-x;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">china</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll d = a2 - a1;</span><br><span class="line">    ll g,x,y;</span><br><span class="line">    exgcd(n1,n2,g,x,y);</span><br><span class="line">    <span class="keyword">if</span> (d % g == <span class="number">0</span>) &#123;</span><br><span class="line">        x = ((x*d/g)%(n2/g)+(n2/g))%(n2/g);</span><br><span class="line">        a1 = x*n1 + a1;</span><br><span class="line">        n1 = (n1*n2)/g;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        flag = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;          <span class="comment">//æ–¹ç¨‹ä¸ªæ•°</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> as[N];<span class="comment">//ä½™æ•°</span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ns[N];<span class="comment">//æ¨¡æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">realchina</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/*è¿”å›çº¿æ€§åŒä½™æ–¹ç¨‹ç»„çš„æœ€å°éè´Ÿæ•´æ•°è§£*/</span></span><br><span class="line">    a1 = as[<span class="number">0</span>];</span><br><span class="line">    n1 = ns[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>;i&lt;n;i++) &#123;</span><br><span class="line">        a2 = as[i];</span><br><span class="line">        n2 = ns[i];</span><br><span class="line">        china();</span><br><span class="line">        <span class="keyword">if</span> (flag)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;ns[i]&gt;&gt;as[i];<span class="comment">//è¾“å…¥æ¨¡æ•°å’Œä½™æ•°</span></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;(<span class="keyword">long</span> <span class="keyword">long</span>)realchina()&lt;&lt;<span class="built_in">endl</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>è‘£æ°¸å»ºï¼Œä¿¡æ¯å­¦ç«èµ›ä¸€æœ¬é€šæé«˜ç¯‡ï¼Œç¦å·ï¼šç¦å»ºæ•™è‚²å‡ºç‰ˆç¤¾ï¼Œ2018.6ï¼Œ401-403</li><li>æ´›è°·ç½‘ç”¨æˆ·sumijieçš„<a href="https://www.luogu.org/blog/sumijie/solution-p4777" target="_blank" rel="noopener">åšå®¢</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°è®º </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŸ©é˜µå¿«é€Ÿå¹‚æ¨¡æ¿</title>
      <link href="/2019/08/17/Matrix/"/>
      <url>/2019/08/17/Matrix/</url>
      
        <content type="html"><![CDATA[<p>çŸ©é˜µå¿«é€Ÿå¹‚å¸¸ç”¨äºåŠ¨æ€è§„åˆ’ä¸­çš„â€œçŸ©é˜µåŠ é€Ÿé“¾ä¹˜â€é‡Œï¼Œå¯ä»¥å°†çº¿æ€§çš„é€’å½’å¼ä¼˜åŒ–ä¸º$O(log_2N)$ï¼Œæ˜¯ä¸€ç§å¾ˆå¸¸ç”¨çš„æŠ€å·§ã€‚ç”±äºçŸ©é˜µå¿«é€Ÿå¹‚ä¸åƒæ™®é€šçš„æ•´æ•°å¿«é€Ÿå¹‚ä¸€æ ·æ–¹ä¾¿è®°å¿†ï¼Œå› æ­¤æ•´ç†æ¨¡æ¿ä»¥ä¾¿éœ€è¦æ—¶å‚è€ƒã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*********************************************</span></span><br><span class="line"><span class="comment"> æœ€åä¿®æ”¹ï¼š2019/8/17 ValenShi</span></span><br><span class="line"><span class="comment"> ä½¿ç”¨è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">    1.æ³¨æ„çŸ©é˜µæ˜¯åœ¨Mod Pä¸‹ç›¸ä¹˜</span></span><br><span class="line"><span class="comment">    2.çŸ©é˜µä¸ºnn*nnçš„æ–¹é˜µ,ä½¿ç”¨å‰éœ€å¯¹nnèµ‹å€¼</span></span><br><span class="line"><span class="comment">    3.çŸ©é˜µæœ‰æ•ˆè¡Œåˆ—ä¸‹æ ‡æ˜¯1~nn</span></span><br><span class="line"><span class="comment">    4.æ³¨æ„memsetå¤´æ–‡ä»¶ä»¥åŠ long long</span></span><br><span class="line"><span class="comment"> *********************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> nn; <span class="comment">//nn ä¸ºçŸ©é˜µå¤§å° nn*nn</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Mat</span>&#123;</span></span><br><span class="line">    ll v[<span class="number">20</span>][<span class="number">20</span>];</span><br><span class="line">    Mat()&#123;<span class="built_in">memset</span>(v,<span class="number">0</span>,<span class="keyword">sizeof</span> v);&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">Mat <span class="title">Mul</span><span class="params">(<span class="keyword">const</span> Mat&amp; a,<span class="keyword">const</span> Mat&amp; b)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* è¿”å›çŸ©é˜µa*çŸ©é˜µbçš„ç»“æœ */</span></span><br><span class="line">    Mat c;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= nn;i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= nn;j++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= nn;k++)</span><br><span class="line">          c.v[i][j] = (c.v[i][j]+a.v[i][k]*b.v[k][j]%P)%P;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Mat <span class="title">qpow</span><span class="params">(Mat A,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* è¿”å›çŸ©é˜µA^båçš„ç»“æœ(çŸ©é˜µ) */</span></span><br><span class="line">    Mat c;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= nn;i++) c.v[i][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) c = Mul(c,A);</span><br><span class="line">        A = Mul(A,A);</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¼¸å±•æ ‘ç¬”è®°</title>
      <link href="/2019/08/16/splay/"/>
      <url>/2019/08/16/splay/</url>
      
        <content type="html"><![CDATA[<h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p><strong>å‰ç½®çŸ¥è¯†ï¼š</strong></p><ul><li>æ ‘-&gt;äºŒå‰æœç´¢æ ‘-&gt;å¹³è¡¡æ ‘-&gt;AVLæ ‘-&gt;Treap-&gt;ä¼¸å±•æ ‘</li><li>å·¦å•(åŒ)æ—‹ã€å³å•(åŒ)æ—‹ã€å·¦å³åŒæ—‹</li></ul><p><strong>ä¼¸å±•æ ‘(Splay Tree)</strong> æ˜¯å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘çš„ä¸€ç§ï¼Œå…·æœ‰äºŒå‰æŸ¥æ‰¾æ ‘çš„æ‰€æœ‰æ€§è´¨ï¼›ä¼¸å±•æ ‘åˆç§°Self-Adjusting Search Treesï¼Œå³<strong>è‡ªè°ƒæ•´çš„äºŒå‰æœç´¢æ ‘</strong> ã€‚ä¸æ™®é€šçš„äºŒå‰æŸ¥æ‰¾æ ‘ç›¸æ¯”ï¼Œå…¶ç»´æŠ¤æ›´å°‘çš„èŠ‚ç‚¹é¢å¤–ä¿¡æ¯ï¼Œç©ºé—´æ€§èƒ½æ›´ä¼˜ä¸”ç¼–ç¨‹å¤æ‚åº¦æ›´ä½ã€‚å®ƒç”±Daniel Sleator å’Œ Robert Tarjanåˆ›é€ ã€‚åœ¨ä¼¸å±•æ ‘ä¸Šçš„ä¸€èˆ¬æ“ä½œéƒ½åŸºäº<strong>ä¼¸å±•æ“ä½œ</strong>ã€‚</p><h4 id="éœ€è¦ä¼¸å±•æ ‘çš„åŸå› ï¼š"><a href="#éœ€è¦ä¼¸å±•æ ‘çš„åŸå› ï¼š" class="headerlink" title="éœ€è¦ä¼¸å±•æ ‘çš„åŸå› ï¼š"></a>éœ€è¦ä¼¸å±•æ ‘çš„åŸå› ï¼š</h4><p>å„ç§æŸ¥æ‰¾æ ‘éƒ½æœ‰å„è‡ªçš„ä¼˜ç¼ºç‚¹ä»¥åŠé€‚ç”¨èŒƒå›´ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€æ£µå…·æœ‰nä¸ªèŠ‚ç‚¹çš„å¹³è¡¡æ ‘ï¼Œè™½ç„¶å…¶æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸è¶…è¿‡O(log n)ï¼Œä½†æ˜¯å¦‚æœè®¿é—®æ¨¡å¼ä¸å‡åŒ€ï¼ˆè¯¢é—®ç‚¹ä¸éšæœºï¼‰ï¼Œå¹³è¡¡æ ‘çš„æ•ˆç‡å°±ä¼šå—å½±å“ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦é¢å¤–çš„ç©ºé—´è®°å½•å¹³è¡¡ä¿¡æ¯ï¼ŒåŒæ—¶ä¹ŸåŠ å¤§äº†ç¼–ç¨‹å¤æ‚åº¦ã€‚<br>è¿™äº›æŸ¥æ‰¾æ ‘çš„è®¾è®¡ç›®æ ‡éƒ½æ˜¯å‡å°‘æœ€åæƒ…å†µä¸‹å•æ¬¡æ“ä½œæ—¶é—´ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä½¿ä¸€ç³»åˆ—æŸ¥æ‰¾æ“ä½œçš„æ€»æ—¶é—´æœ€å°‘ï¼Œé‚£æˆ‘ä»¬æ›´å¥½çš„ç›®æ ‡å°±æ˜¯é™ä½æ“ä½œçš„æ‘Šå¹³æ—¶é—´ã€‚æ­¤å¤„çš„æ‘Šå¹³æ—¶é—´æŒ‡çš„æ˜¯åœ¨ä¸€ç³»åˆ—æœ€åæƒ…å†µä¸‹çš„æ“ä½œåºåˆ—ä¸­å•æ¬¡æ“ä½œçš„å¹³å‡æ—¶é—´ã€‚è€Œä¼¸å±•æ ‘å°±æ˜¯ä¸ºå®ç°è¿™ä¸€ç›®æ ‡è€Œè®¾è®¡çš„ã€‚</p><h4 id="å’Œå…¶ä»–å¹³è¡¡æ ‘æˆ–å…·æœ‰æ˜ç¡®é™åˆ¶çš„æ•°æ®ç»“æ„ç›¸æ¯”ï¼Œä¼¸å±•æ ‘çš„ä¼˜ç‚¹ï¼š"><a href="#å’Œå…¶ä»–å¹³è¡¡æ ‘æˆ–å…·æœ‰æ˜ç¡®é™åˆ¶çš„æ•°æ®ç»“æ„ç›¸æ¯”ï¼Œä¼¸å±•æ ‘çš„ä¼˜ç‚¹ï¼š" class="headerlink" title="å’Œå…¶ä»–å¹³è¡¡æ ‘æˆ–å…·æœ‰æ˜ç¡®é™åˆ¶çš„æ•°æ®ç»“æ„ç›¸æ¯”ï¼Œä¼¸å±•æ ‘çš„ä¼˜ç‚¹ï¼š"></a>å’Œå…¶ä»–å¹³è¡¡æ ‘æˆ–å…·æœ‰æ˜ç¡®é™åˆ¶çš„æ•°æ®ç»“æ„ç›¸æ¯”ï¼Œä¼¸å±•æ ‘çš„ä¼˜ç‚¹ï¼š</h4><ul><li>ä»æ‘Šå¹³è§’åº¦è®²ï¼Œå®ƒä»¬å¿½ç•¥å¸¸é‡å› å­ï¼Œå› æ­¤ç»å¯¹ä¸ä¼šæ¯”æœ‰æ˜ç¡®é™åˆ¶çš„æ•°æ®ç»“æ„å·®ã€‚è€Œä¸”å®ƒä»¬å¯ä»¥ä¾æ®é€‚ç”¨æƒ…å†µè¿›è¡Œè°ƒæ•´ï¼Œäºæ˜¯åœ¨<strong>ä½¿ç”¨æ¨¡å¼ä¸å‡åŒ€</strong>çš„æƒ…å†µä¸‹æ›´åŠ æœ‰æ•ˆã€‚</li><li>ç”±äºæ— éœ€å­˜å‚¨é™åˆ¶ä¿¡æ¯ï¼Œå®ƒä»¬æ‰€éœ€ç©ºé—´æ›´å°ï¼Œå®ç°èµ·æ¥ä¹Ÿæ›´åŠ ç®€æ´ã€‚</li><li>å®ƒä»¬çš„æŸ¥æ‰¾å’Œæ›´æ–°ç®—æ³•æ¦‚å¿µç®€å•ï¼Œæ˜“äºå®ç°ã€‚</li></ul><h4 id="æ½œåœ¨çš„ä¸¤ä¸ªç¼ºç‚¹ï¼š"><a href="#æ½œåœ¨çš„ä¸¤ä¸ªç¼ºç‚¹ï¼š" class="headerlink" title="æ½œåœ¨çš„ä¸¤ä¸ªç¼ºç‚¹ï¼š"></a>æ½œåœ¨çš„ä¸¤ä¸ªç¼ºç‚¹ï¼š</h4><ul><li>å®ƒä»¬éœ€è¦æ›´å¤šçš„å±€éƒ¨è°ƒæ•´ï¼Œå°¤å…¶æ˜¯åœ¨æŸ¥æ‰¾æœŸé—´ã€‚ï¼ˆè€Œå…¶ä»–æœ‰æ˜ç¡®é™åˆ¶çš„æŸ¥æ‰¾æ ‘ä»…éœ€è¦åœ¨æ›´æ–°æœŸé—´è¿›è¡Œè°ƒæ•´ï¼ŒæŸ¥æ‰¾æœŸé—´åˆ™ä¸ç”¨ï¼‰</li><li>ä¸€ç³»åˆ—æŸ¥æ‰¾æ“ä½œä¸­çš„æŸä¸€ä¸ªå¯èƒ½ä¼šè€—æ—¶è¾ƒé•¿ã€‚è¿™åœ¨å®é™…åº”ç”¨ä¸­éœ€è¦ä½œä¸ºæ˜¯å¦é€‰ç”¨çš„å‚è€ƒä¾æ®ã€‚</li></ul><h4 id="ä»€ä¹ˆæ˜¯ä¼¸å±•æ ‘ï¼š"><a href="#ä»€ä¹ˆæ˜¯ä¼¸å±•æ ‘ï¼š" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¼¸å±•æ ‘ï¼š"></a>ä»€ä¹ˆæ˜¯ä¼¸å±•æ ‘ï¼š</h4><p>å‡è®¾è¦å¯¹ä¸€ä¸ªäºŒå‰æœç´¢æ ‘æ‰§è¡Œä¸€ç³»åˆ—æŸ¥æ‰¾æ“ä½œï¼Œä¸ºäº†ä½¿å¾—æ€»æ—¶é—´æœ€å°ï¼Œé‚£ä¹ˆè¢«æŸ¥æ‰¾é¢‘ç‡é«˜çš„èŠ‚ç‚¹è‡ªç„¶å°±è¦æ”¾åœ¨é è¿‘æ ¹çš„ä½ç½®ã€‚äºæ˜¯æƒ³åˆ°ä¸€ä¸ªç®€å•çš„è®¾è®¡æ–¹æ¡ˆï¼Œ<strong>åœ¨æ¯æ¬¡æŸ¥æ‰¾ä¹‹åå¯¹æ ‘è¿›è¡Œé‡æ„ï¼ŒæŠŠè¢«æŸ¥æ‰¾çš„æ¡ç›®æ¬åˆ°ç¦»æ ‘æ ¹è¿‘ä¸€ç‚¹çš„ä½ç½®ã€‚</strong> é¡ºç€è¿™ä¸ªæ€è·¯ï¼Œsplayè¯ç”Ÿäº†ã€‚<br>splayæ˜¯ä¸€ç§è‡ªè°ƒæ•´å½¢å¼çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œå®ƒä¼šæ²¿ç€ä»æŸä¸ªèŠ‚ç‚¹åˆ°æ ‘æ ¹ä¹‹é—´çš„è·¯å¾„ï¼Œé€šè¿‡ä¸€ç³»åˆ—æ—‹è½¬æŠŠè¯¥èŠ‚ç‚¹æ¬ç§»åˆ°æ ‘æ ¹ï¼ŒåŒæ—¶ä½¿å¾—è¯¥æ¡è·¯å¾„ä¸Šçš„ç‚¹å°½é‡é è¿‘æ ‘æ ¹ã€‚</p><h4 id="æ„å»ºæ–¹æ³•"><a href="#æ„å»ºæ–¹æ³•" class="headerlink" title="æ„å»ºæ–¹æ³•"></a>æ„å»ºæ–¹æ³•</h4><p><strong>ä¸¤ç§å¯èƒ½çš„é‡æ„æ–¹æ³•ï¼š</strong></p><ul><li>å•æ—‹ï¼šåœ¨æŸ¥æ‰¾å®Œä½äºèŠ‚ç‚¹xä¸­çš„æ¡ç›®ä¹‹åï¼Œæ—‹è½¬é“¾æ¥xå’Œå…¶çˆ¶èŠ‚ç‚¹çš„è¾¹ã€‚ï¼ˆé™¤éxæ˜¯æ ¹ï¼‰</li><li>æ¬ç§»è‡³æ ‘æ ¹ï¼šåœ¨æŸ¥æ‰¾å®Œä½äºèŠ‚ç‚¹xä¸­çš„æ¡ç›®åï¼Œæ—‹è½¬é“¾æ¥xå’Œå…¶çˆ¶èŠ‚ç‚¹çš„è¾¹ï¼Œç„¶åé‡å¤è¿™ä¸ªæ“ä½œç›´è‡³xæˆä¸ºæ ‘æ ¹ã€‚</li></ul><p><strong>æ³¨ï¼š</strong><br>ä¸Šè¿°ä¸¤ä¸ªæ–¹æ³•æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸€ç§æ˜¯æŸ¥æ‰¾xåä»…äº¤æ¢ä¸€æ¬¡ï¼Œå¦ä¸€ä¸ªæ˜¯å°†è¢«æŸ¥è¯¢çš„èŠ‚ç‚¹xæ—‹è½¬è‡³æ ‘æ ¹ã€‚<br><strong>æ—‹è½¬ç¤ºæ„å›¾ï¼š</strong><br>å…¶ä¸­ä¸‰è§’å½¢ä»£è¡¨å­æ ‘ï¼Œè€Œå›¾ç¤ºçš„æ ‘ä¹Ÿå¯èƒ½æ˜¯ä¸€æ£µæ›´å¤§çš„æ ‘çš„å­æ ‘ã€‚<br><img src="/2019/08/16/splay/1.png" alt="1"></p><p><strong>ä¸Šè¿°ä¸¤ç§é‡æ„æ–¹æ³•çš„ç¤ºæ„å›¾ï¼š</strong><br>å…¶ä¸­è¢«æŸ¥è¯¢èŠ‚ç‚¹æ˜¯aã€‚<br><img src="/2019/08/16/splay/2.png" alt="2"></p><p><strong>æ³¨ï¼š</strong></p><ul><li>è‹¥xä¸ºp(x)çš„å·¦å­©å­ï¼Œäº¤æ¢xå’Œp(x)çš„ä½ç½®ï¼Œç§°ä¸ºå³æ—‹ã€‚</li><li>è‹¥xä¸ºp(x)çš„å³å­©å­ï¼Œäº¤æ¢xå’Œp(x)çš„ä½ç½®ï¼Œç§°ä¸ºå·¦æ—‹ã€‚</li></ul><p><strong>ä¸å¹¸çš„æ˜¯ï¼Œä¸Šè¿°ä¸¤ä¸ªé‡æ„æ–¹æ³•åœ¨æ‘Šåˆ†æ•ˆç‡æ–¹é¢è¡¨ç°çš„éƒ½ä¸å¤ªå¥½ã€‚</strong> å¦‚æœæœ‰å¾ˆé•¿çš„éšæœºæŸ¥è¯¢åºåˆ—ï¼Œé‚£ä¹ˆä¸Šè¿°ä¸¤ç§é‡æ„æ–¹æ³•çš„æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦æ˜¯O(N)ã€‚æ˜¾ç„¶æˆ‘ä»¬éœ€è¦ä¸€ç§æ€§èƒ½æ›´å¼ºå¤§çš„é‡æ„æ–¹æ³•ã€‚</p><h4 id="ä¼¸å±•æ“ä½œ"><a href="#ä¼¸å±•æ“ä½œ" class="headerlink" title="ä¼¸å±•æ“ä½œ"></a>ä¼¸å±•æ“ä½œ</h4><p>æˆ‘ä»¬é‡‡å–çš„é‡æ„æ–¹æ³•å«åšsplayingï¼Œå³ä¼¸å±•ï¼Œå®ƒå’Œä¸Šè¿°â€œæ¬ç§»è‡³æ ‘æ ¹â€ç›¸ä¼¼ã€‚å®ƒä»¬éƒ½æ˜¯æ²¿ç€<strong>æŸ¥è¯¢è·¯å¾„</strong> åšæ—‹è½¬å€’ç½®ï¼Œå°†è¢«æŸ¥è¯¢çš„èŠ‚ç‚¹é€šè¿‡æ­¤æ–¹æ³•ç§»åŠ¨åˆ°æ ¹èŠ‚ç‚¹ã€‚ä¸åŒçš„æ˜¯ï¼Œä¼¸å±•æ“ä½œæ˜¯æŒ‰ç…§è¯¥ç»“æ„ä¸Šçš„æŸ¥æ‰¾é¡ºåº<strong>æˆå¯¹æ—‹è½¬</strong> ã€‚å¯¹äºä¼¸å±•æ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹xï¼Œæˆ‘ä»¬é‡å¤å¦‚ä¸‹æ“ä½œ<strong>ç›´åˆ°</strong> x æˆä¸ºæ ‘çš„æ ¹èŠ‚ç‚¹ã€‚</p><p><strong><em>Splaying Step</em></strong><br><em>Case 1(zig)ï¼š</em> å¦‚æœp(x)æ˜¯xçš„çˆ¶èŠ‚ç‚¹ï¼Œå¹¶ä¸”p(x)æ˜¯æ ‘çš„æ ¹ï¼Œé‚£ä¹ˆæ—‹è½¬xå’Œp(x)é—´çš„è¾¹ã€‚ï¼ˆæ­¤ä¸ºæœ€ç»ˆæ­¥éª¤ï¼‰<br><em>Case 2(zig-zig)ï¼š</em> å¦‚æœp(x)ä¸æ˜¯æ ¹èŠ‚ç‚¹ï¼Œå¹¶ä¸”xå’Œp(x)éƒ½æ˜¯å·¦å„¿å­æˆ–è€…å³å„¿å­ï¼Œé‚£ä¹ˆæ—‹è½¬é“¾æ¥p(x)å’Œg(x)çš„è¾¹ï¼Œç„¶åæ—‹è½¬é“¾æ¥xå’Œp(x)çš„è¾¹ã€‚<br><em>Case 3(zig-zag)ï¼š</em> å¦‚æœp(x)ä¸æ˜¯æ ¹ï¼Œå¹¶ä¸”xæ˜¯å·¦å„¿å­ p(x)æ˜¯å³å„¿å­ï¼Œæˆ–è€…ç›¸åï¼Œé‚£ä¹ˆæ—‹è½¬é“¾æ¥xå’Œp(x)çš„è¾¹ï¼Œç„¶åæ—‹è½¬é“¾æ¥xå’Œp(x)çš„æ–°è¾¹ã€‚</p><p><strong>æ³¨ï¼š</strong><br>å…¶ä¸­æˆ‘ä»¬å‡è®¾p(x)ä¸ºxçš„çˆ¶èŠ‚ç‚¹ï¼Œg(x)ä¸ºp(x)çš„çˆ¶èŠ‚ç‚¹ã€‚ä¸‹å›¾ä¸‰ä¸ªæ“ä½œaã€bã€cåˆ†åˆ«å¯¹åº”ä¸Šè¿°çš„zigã€zig-zigã€zig-zagã€‚</p><p><img src="/2019/08/16/splay/3.png" alt="3"></p><p><strong>åˆ†æï¼š</strong><br>å¯¹äºæ·±åº¦ä¸ºdçš„èŠ‚ç‚¹xåšä¼¸å±•æ“ä½œï¼Œéœ€è¦èŠ±è´¹çš„æ—¶é—´å’Œdæˆæ¯”ä¾‹ï¼Œå³å’ŒæŸ¥æ‰¾xçš„æ—¶é—´æˆæ¯”ä¾‹ã€‚ä¼¸å±•æ“ä½œå¹¶ä¸ä»…ä»…æ˜¯å°†xç§»åŠ¨åˆ°æ ¹èŠ‚ç‚¹ï¼Œè€Œæ˜¯<strong>å°†æŸ¥æ‰¾è·¯å¾„ä¸Šçš„èŠ‚ç‚¹çš„æ·±åº¦éƒ½ç²—ç•¥å‡å°‘äº†ä¸€åŠã€‚</strong> å¦‚æ­¤ä¸€æ¥ä½¿å¾—ä¼¸å±•æ ‘çš„æ•ˆç‡éåŒå‡¡å“ã€‚æ•ˆç‡è¯æ˜ç•¥ï¼Œä¸è¿‡æˆ‘ä»¬ä¾ç„¶å¯ä»¥æ ¹æ®å¦‚ä¸‹1ç§å¸¸è§„æƒ…å†µ(Figures 4)åŠ2ç§æç«¯æƒ…å†µ(Figures 5)ä¸‹è¿›è¡Œsplayingæ“ä½œå æ ‘çš„æ„é€ æ¥ç•¥çª¥ä¸€äºŒã€‚</p><p><img src="/2019/08/16/splay/4.png" alt="4"></p><p><img src="/2019/08/16/splay/5.png" alt="5"></p><h4 id="ä¼¸å±•æ ‘ä¸Šçš„æ›´æ–°æ“ä½œ"><a href="#ä¼¸å±•æ ‘ä¸Šçš„æ›´æ–°æ“ä½œ" class="headerlink" title="ä¼¸å±•æ ‘ä¸Šçš„æ›´æ–°æ“ä½œ"></a>ä¼¸å±•æ ‘ä¸Šçš„æ›´æ–°æ“ä½œ</h4><p>ä½¿ç”¨ä¼¸å±•æ ‘ï¼Œæˆ‘ä»¬å¯ä»¥ç»§æ‰¿æ ‡å‡†çš„äºŒå‰æœç´¢æ ‘çš„æ“ä½œã€‚è€ƒè™‘å¦‚ä¸‹å‡ ä¸ªæ“ä½œï¼š<br><em>access(i,t):</em> &emsp;å¦‚æœiåœ¨æ ‘tä¸­ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘iä½ç½®çš„æŒ‡é’ˆï¼›å¦åˆ™ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘ç©ºèŠ‚ç‚¹çš„æŒ‡é’ˆã€‚<br><em>insert(i,t):</em> &emsp;å‘æ ‘tä¸­æ’å…¥ä¸€ä¸ªå…ƒç´ iï¼Œå‡è®¾æ­¤å‰iä¸å­˜åœ¨ã€‚<br><em>delete(i,t):</em> &emsp;ä»æ ‘tä¸­åˆ é™¤å…ƒç´ iï¼Œå‡è®¾iå­˜åœ¨ã€‚<br><em>join(t1,t2):</em> &emsp;å°†æ ‘t1å’Œt2åˆå¹¶æˆä¸€æ£µæ–°çš„æ ‘å¹¶è¿”å›æ–°æ ‘çš„æ ‘æ ¹ã€‚è¯¥æ“ä½œå‡è®¾t1ä¸­æ‰€æœ‰å…ƒç´ éƒ½å°äºt2ä¸­çš„å…ƒç´ ã€‚åˆå¹¶ååˆ é™¤t1å’Œt2ã€‚<br><em>split(i,t):</em> &emsp;å°†tåˆ†æˆä¸¤æ£µå­æ ‘t1å’Œt2ï¼Œæ‰€æœ‰å°äºç­‰äºiçš„å…ƒç´ åœ¨t1ï¼Œæ‰€æœ‰å¤§äºiçš„å…ƒç´ åœ¨t2ã€‚ç„¶ååˆ é™¤æ ‘tã€‚</p><p><strong>access(i,t)å®ç°æ–¹æ³•ï¼š</strong><br>æˆ‘ä»¬ä»æ ‘tçš„æ ¹å¼€å§‹ï¼ŒæŒ‰ç…§äºŒå‰æœç´¢æ ‘çš„æŸ¥æ‰¾æ–¹å¼å‘ä¸‹æŸ¥æ‰¾ï¼›å¦‚æœå½“å‰èŠ‚ç‚¹xåŒ…å«å¾…æŸ¥ç›®æ ‡iï¼Œåˆ™ç®—æ³•å®Œæˆï¼Œæˆ‘ä»¬å¯¹xè¿›è¡Œsplayingæ“ä½œå¹¶è¿”å›æŒ‡å‘xçš„æŒ‡é’ˆã€‚å¦‚æœæœç´¢åˆ°è¾¾äº†ç©ºèŠ‚ç‚¹ï¼ˆå³å¾…æŸ¥ç›®æ ‡ä¸å­˜åœ¨ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹æœç´¢è·¯å¾„çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œsplayingæ“ä½œï¼Œå¹¶è¿”å›ä¸€ä¸ªç©ºæŒ‡é’ˆã€‚å¦‚æœæ ‘ä¸ºç©ºï¼Œåˆ™å–æ¶ˆsplayingæ“ä½œã€‚ï¼ˆFigures 6ï¼‰</p><p><strong>join(t1,t2)å®ç°æ–¹æ³•ï¼š</strong><br>æˆ‘ä»¬é¦–å…ˆåœ¨t1ä¸­æ‰§è¡Œä¸€æ¬¡access(i,t1)ï¼Œå…¶ä¸­iæ˜¯t1ä¸­æœ€å¤§çš„å…ƒç´ ã€‚äºæ˜¯åœ¨accessåï¼Œt1çš„æ ¹åŒ…å«iï¼Œå¹¶ä¸”å®ƒæ²¡æœ‰å³å„¿å­ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥å°†t2ä½œä¸ºt1çš„å³å„¿å­è¿æ¥ï¼Œå¹¶è¿”å›å¤„ç†åçš„æ ‘ï¼Œjoinæ“ä½œå®Œæˆã€‚(Figures 7)</p><p><strong>split(i,t)å®ç°æ–¹æ³•ï¼š</strong><br>æˆ‘ä»¬é¦–å…ˆæ‰§è¡Œä¸€æ¬¡access(i,t)ï¼Œç„¶åæ–­å¼€tå’Œå·¦å³å„¿å­çš„é“¾æ¥ï¼Œå·¦å­æ ‘ä½œä¸ºt1ï¼Œå³å­æ ‘ä½œä¸ºt2ï¼Œå¹¶ä¸”è€ƒè™‘æ ¹æ˜¯å¦åŒ…å«ç­‰äºiçš„å…ƒç´ ã€‚è¿”å›t1æˆ–t2ï¼Œsplitæ“ä½œå®Œæˆã€‚(Figures 7)</p><p><strong>insert(i,t)å®ç°æ–¹æ³•</strong><br>æˆ‘ä»¬å…ˆå¯¹tè¿›è¡Œä¸€æ¬¡split(i,t)ï¼Œå¾—åˆ°äº†ä¸¤ä¸ªå­æ ‘t1å’Œt2ï¼Œè¿™æ—¶æˆ‘ä»¬æŠŠiä½œä¸ºä¸€ä¸ªæ–°çš„æ ¹èŠ‚ç‚¹ï¼Œt1ä½œä¸ºiçš„å·¦å­æ ‘ï¼Œt2ä½œä¸ºå…¶å³å­æ ‘ã€‚(Figures 8)</p><p><strong>delete(i,t)å®ç°æ–¹æ³•</strong><br>æˆ‘ä»¬å…ˆæ‰§è¡Œä¸€æ¬¡access(i,t)ï¼Œæ­¤æ—¶å¾—åˆ°æ ¹èŠ‚ç‚¹tï¼Œè¿™ä¸ªæ—¶å€™å¯¹tçš„ä¸¤ä¸ªå­æ ‘t1å’Œt2æ‰§è¡Œjoin(t1,t2)ï¼Œå°±å®Œæˆäº†åˆ é™¤ièŠ‚ç‚¹ã€‚(Figures 8)</p><p><strong>å°ç»“ï¼š</strong><br>é€šè¿‡ä¸Šè¿°æ“ä½œçš„å®ç°æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå®ç°joinå’Œsplitæ—¶ç”¨åˆ°äº†accessï¼Œå®ç°insertå’Œdeleteæ—¶æˆ‘ä»¬åˆç”¨åˆ°äº†splitå’Œjoinï¼Œç”±æ­¤å¯è§æˆ‘ä»¬å¯ä»¥é€šè¿‡å·²å®ç°çš„æ“ä½œæ¥æ­å»ºæœªå®ç°çš„æ“ä½œï¼Œè¿™æ ·æ›´åŠ ç®€æ´ä¸”é™ä½äº†ç¼–ç¨‹éš¾åº¦ã€‚</p><p><img src="/2019/08/16/splay/6.png" alt="6"></p><p><img src="/2019/08/16/splay/7.png" alt="7"></p><p>å¦å¤–ï¼Œå¯¹äºinsertå’Œdeleteæ“ä½œè¿˜æœ‰å¦ä¸€ç§ç¨åŠ ä¼˜åŒ–çš„æ–¹æ³•ï¼Œè¿™é‡Œçœç•¥ï¼Œå¤æ‚åº¦åˆ†æåŒæ ·çœç•¥ï¼Œå…·ä½“å¯ä»¥å‚ç…§åŸæ–‡[1]ã€‚</p><p><strong>å‚è€ƒæ–‡çŒ®ï¼š</strong></p><p>[1]  Daniel D.Sleator , Robert Endre Tarjan, <em>A data structure for dynamic trees</em>.</p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ®µæ ‘åŒºé—´ä¿®æ”¹-å»¶è¿Ÿæ ‡è®°</title>
      <link href="/2019/08/16/interval-tree/"/>
      <url>/2019/08/16/interval-tree/</url>
      
        <content type="html"><![CDATA[<h4 id="å»¶è¿Ÿæ ‡è®°"><a href="#å»¶è¿Ÿæ ‡è®°" class="headerlink" title="å»¶è¿Ÿæ ‡è®°"></a>å»¶è¿Ÿæ ‡è®°</h4><p>åœ¨çº¿æ®µæ ‘ä¸­ï¼Œå•ç‚¹ä¿®æ”¹æ—¶ï¼Œæˆ‘ä»¬æ˜¯å°†ä¿¡æ¯ä»å¶èŠ‚ç‚¹å‘ä¸Šä¾æ¬¡æ›´æ–°å®ƒçš„çˆ¶èŠ‚ç‚¹ï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹ã€‚å¦‚æœåœ¨åŒºé—´ä¿®æ”¹ä»ç„¶æŒ‰ç…§è¿™ä¸ªç­–ç•¥ï¼Œé‚£ä¹ˆä¿®æ”¹çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N)ã€‚<br>ä¸ºäº†é™ä½æ—¶é—´å¤æ‚åº¦ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ›´æ–°æ—¶åªæ›´æ–°å¤§åŒºé—´ï¼Œä¸å‘ä¸‹æ›´æ–°åˆ°å¶å­èŠ‚ç‚¹ï¼Œç­‰æŸ¥è¯¢æ—¶å†æ›´æ–°ã€‚ä¸¾ä¸ªä¾‹å­ï¼šæˆ‘ä»¬å°†1-5çš„ä½ç½®ä¸Šæ¯ä¸ªæ•°+100ï¼Œé‡å¤10000æ¬¡ä¸Šè¿°æ“ä½œã€‚<strong>æˆ‘ä»¬åŠ 10000æ¬¡100å’Œç›´æ¥+1000000æ˜¯ç›¸ç­‰çš„æ•ˆæœï¼Œä½†æ˜¯ä¸€ä¸ªæ‰§è¡Œäº†10000æ¬¡ï¼Œè€Œå¦ä¸€ä¸ªåªæ‰§è¡Œ1æ¬¡ã€‚</strong> æˆ‘ä»¬åˆçŸ¥é“è®¡ç®—æœºçš„è®¡ç®—æ•ˆç‡å’Œè®¡ç®—æ¬¡æ•°æ˜¯ç›¸å…³çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¯¥åŸç†ï¼Œå½“åŒºé—´ä¿®æ”¹æ—¶ä¸å‘ä¸‹æ›´æ–°ï¼Œç›´è‡³æŸ¥è¯¢æ—¶å†æ›´æ–°ã€‚</p><h4 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h4><p>ä»¥POJ3468ä¸ºä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çº¿æ®µæ ‘+å»¶è¿Ÿæ ‡è®°æŠ€å·§ æ¥å®ç°å¿«é€ŸåŒºé—´ä¿®æ”¹ä¸åŒºé—´æŸ¥è¯¢ã€‚<br>å…·ä½“åšæ³•æ˜¯ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªèŠ‚ç‚¹å¢åŠ ä¸€ä¸ªå»¶è¿Ÿæ ‡è®°addï¼Œå¦‚æœaddä¸º0ï¼Œåˆ™è¯´æ˜è¯¥ç‚¹çš„æ‰€æœ‰å­åŒºé—´éƒ½å·²æ›´æ–°å®Œæˆï¼Œå¦åˆ™è¯´æ˜å…¶å­åŒºé—´ä»éœ€è¦+addã€‚è¯·æ³¨æ„ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹è¢«æ‰“ä¸Šâ€œå»¶è¿Ÿæ ‡è®°â€ï¼Œè¯´æ˜è¯¥èŠ‚ç‚¹æ›¾ç»è¢«ä¿®æ”¹è¿‡ï¼Œä½†å…¶å­èŠ‚ç‚¹å°šæœªè¢«æ›´æ–°ï¼Œå³å»¶è¿Ÿæ ‡è®°è¯´æ˜çš„æ˜¯å­èŠ‚ç‚¹çš„å¾…æ›´æ–°æƒ…å†µã€‚<br>å…·ä½“å®ç°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°spreadæ¥å®ç°å»¶è¿Ÿæ ‡è®°å‘ä¸‹ä¼ é€’ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span>+<span class="number">50</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> l,r;</span><br><span class="line">ll sum,add;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) t[x].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) t[x].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(x) t[x].sum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> add(x) t[x].add</span></span><br><span class="line">&#125;t[MAXN*<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[MAXN],n,m;</span><br><span class="line"><span class="comment">//å°†å»¶è¿Ÿæ ‡è®°å‘ä¸‹æ›´æ–°ä¸€å±‚ </span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">spread</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(add(p))&#123;</span><br><span class="line">sum(p*<span class="number">2</span>) += (r(p*<span class="number">2</span>) - l(p*<span class="number">2</span>) + <span class="number">1</span>)*add(p);</span><br><span class="line">sum(p*<span class="number">2</span>+<span class="number">1</span>) += (r(p*<span class="number">2</span>+<span class="number">1</span>) - l(p*<span class="number">2</span>+<span class="number">1</span>) + <span class="number">1</span>)*add(p);</span><br><span class="line">add(p*<span class="number">2</span>) += add(p);</span><br><span class="line">add(p*<span class="number">2</span>+<span class="number">1</span>) += add(p);</span><br><span class="line">add(p) = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å»ºæ ‘  lå’Œræ˜¯å½“å‰èŠ‚ç‚¹æ‰€ä»£è¡¨çš„åŒºé—´çš„å·¦å³ç«¯ç‚¹ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">l(p) = l,r(p) = r,add(p) = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">t[p].sum = a[l];</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">build(p*<span class="number">2</span>,l,mid);</span><br><span class="line">build(p*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">t[p].sum = t[p*<span class="number">2</span>].sum + t[p*<span class="number">2</span>+<span class="number">1</span>].sum; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åŒºé—´æ›´æ–° å¦‚æœå½“å‰åŒºé—´è¢«åŒ…å« åˆ™å»¶è¿Ÿæ ‡è®° </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= l(p) &amp;&amp; r(p) &lt;= r)&#123;</span><br><span class="line">sum(p) += (r(p)-l(p)+<span class="number">1</span>)*d;</span><br><span class="line">add(p) += d;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">spread(p);</span><br><span class="line"><span class="keyword">int</span> mid = (l(p)+r(p))/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) change(p*<span class="number">2</span>,l,r,d);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) change(p*<span class="number">2</span>+<span class="number">1</span>,l,r,d);</span><br><span class="line">sum(p) = sum(p*<span class="number">2</span>) + sum(p*<span class="number">2</span>+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åŒºé—´æŸ¥è¯¢ å½“æŸ¥è¯¢åˆ°è¯¥åŒºé—´æ—¶é¡ºä¾¿æ›´æ–° </span></span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="comment">//printf("%d %d\n",l(p),r(p));</span></span><br><span class="line"><span class="keyword">if</span>(l &lt;= l(p) &amp;&amp; r(p) &lt;= r)&#123;</span><br><span class="line"><span class="keyword">return</span> sum(p);</span><br><span class="line">&#125;</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line">spread(p);</span><br><span class="line"><span class="keyword">int</span> mid = (l(p) + r(p))/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) ans += ask(p*<span class="number">2</span>,l,r);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) ans += ask(p*<span class="number">2</span>+<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">build(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="keyword">while</span>(m--)&#123;</span><br><span class="line"><span class="keyword">char</span> op[<span class="number">5</span>];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,op);</span><br><span class="line"><span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">'C'</span>)&#123;</span><br><span class="line"><span class="keyword">int</span> l,r,d;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;l,&amp;r,&amp;d);</span><br><span class="line">change(<span class="number">1</span>,l,r,d);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> l,r;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;l,&amp;r);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ask(<span class="number">1</span>,l,r));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>å‚è€ƒä¹¦ç›®ï¼š</strong><br>ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹æç…œä¸œ.P209</p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Trie-å­—å…¸æ ‘ç¬”è®°</title>
      <link href="/2019/08/16/trie/"/>
      <url>/2019/08/16/trie/</url>
      
        <content type="html"><![CDATA[<p>Trieï¼Œåˆç§°å­—å…¸æ ‘ï¼Œæ˜¯ä¸€ç§ç”¨äºå®ç°å­—ç¬¦ä¸²å¿«é€Ÿæ£€ç´¢çš„<strong>å¤šå‰æ ‘</strong>ç»“æ„ã€‚Trieçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ‹¥æœ‰è‹¥å¹²ä¸ªå­—ç¬¦æŒ‡é’ˆï¼Œè‹¥åœ¨æ’å…¥æˆ–æ£€ç´¢å­—ç¬¦ä¸²æ—¶æ‰«æåˆ°ä¸€ä¸ªå­—ç¬¦cï¼Œå°±æ²¿ç€å½“å‰èŠ‚ç‚¹çš„cè¿™ä¸ªå­—ç¬¦æŒ‡é’ˆï¼Œèµ°å‘è¯¥æŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ã€‚</p><h5 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h5><p>ä¸€é¢—ç©ºTrieä»…åŒ…å«ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹çš„å­—ç¬¦æŒ‡é’ˆå‡æŒ‡å‘ç©ºã€‚</p><h5 id="æ’å…¥"><a href="#æ’å…¥" class="headerlink" title="æ’å…¥"></a>æ’å…¥</h5><p>è‹¥éœ€è¦æ’å…¥ä¸€ä¸ªå­—ç¬¦ä¸²Sæ—¶ï¼Œæˆ‘ä»¬ä»¤ä¸€ä¸ªæŒ‡é’ˆPèµ·åˆæŒ‡å‘æ ¹èŠ‚ç‚¹ã€‚ç„¶åï¼Œä¾æ¬¡æ‰«æSä¸­çš„æ¯ä¸ªå­—ç¬¦cï¼š</p><ul><li>è‹¥Pçš„cå­—ç¬¦æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªå·²ç»å­˜åœ¨çš„èŠ‚ç‚¹Qï¼Œåˆ™ä»¤ P = Qã€‚</li><li>è‹¥Pçš„cå­—ç¬¦æŒ‡é’ˆæŒ‡å‘ç©ºï¼Œåˆ™æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹Qï¼Œä»¤Pçš„cå­—ç¬¦æŒ‡é’ˆæŒ‡å‘Qï¼Œç„¶åä»¤P = Qã€‚</li></ul><p>å½“Sçš„å­—ç¬¦æ‰«æå®Œæ¯•æ—¶ï¼Œåœ¨å½“å‰èŠ‚ç‚¹Pä¸Šæ ‡è®°å®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„æœ«å°¾ã€‚</p><h5 id="æ£€ç´¢"><a href="#æ£€ç´¢" class="headerlink" title="æ£€ç´¢"></a>æ£€ç´¢</h5><p>å½“éœ€è¦æ£€ç´¢ä¸€ä¸ªå­—ç¬¦ä¸²Såœ¨Trieä¸­æ˜¯å¦å­˜åœ¨æ—¶ï¼Œæˆ‘ä»¬ä»¤ä¸€ä¸ªæŒ‡é’ˆPèµ·åˆæŒ‡å‘æ ¹èŠ‚ç‚¹ï¼Œç„¶åä¾æ¬¡æ‰«æSä¸­çš„æ¯ä¸ªå­—ç¬¦cï¼š</p><ul><li>è‹¥pçš„cå­—ç¬¦æŒ‡é’ˆæŒ‡å‘ç©ºï¼Œåˆ™è¯´æ˜Sæ²¡æœ‰è¢«æ’å…¥è¿‡Trieï¼Œç»“æŸæ£€ç´¢ã€‚</li><li>è‹¥Pçš„cå­—ç¬¦æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªå·²ç»å­˜åœ¨çš„èŠ‚ç‚¹Qï¼Œåˆ™ä»¤P = Q</li></ul><p>è‹¥Sä¸­çš„å­—ç¬¦æ‰«æå®Œæ¯•æ—¶ï¼Œå½“å‰èŠ‚ç‚¹Pè¢«æ ‡è®°ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²çš„æœ«å°¾ï¼Œåˆ™è¯´æ˜Såœ¨Trieä¸­å­˜åœ¨ï¼Œå¦åˆ™è¯´æ˜Sæ²¡æœ‰è¢«æ’å…¥è¿‡ã€‚</p><h5 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h5><p>æˆ‘ä»¬ä»¥ä¸€ä¸ªç®€å•çš„ç»å…¸é—®é¢˜ä¸ºä¾‹ï¼šæœ‰mæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™å‡ºä¸€ä¸ªæ“ä½œç¬¦opå’Œå­—ç¬¦ä¸²Sï¼Œè‹¥op = 1ï¼Œåˆ™å°†Sæ”¾å…¥é›†åˆTï¼Œè‹¥op = 2ï¼Œåˆ™å›ç­”Té›†åˆä¸­æ˜¯å¦æœ‰Så­—ç¬¦ä¸²ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SIZE = <span class="number">10000</span>;</span><br><span class="line"><span class="keyword">bool</span> End[SIZE];</span><br><span class="line"><span class="keyword">int</span> trie[SIZE][<span class="number">30</span>],tot = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> *str)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(str);</span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt; len;k++)&#123;</span><br><span class="line">        <span class="keyword">int</span> ch = str[k]-<span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">if</span>(trie[p][ch] == <span class="number">0</span>) trie[p][ch] = ++tot;</span><br><span class="line">        p = trie[p][ch];</span><br><span class="line">    &#125;</span><br><span class="line">    End[p] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">search</span><span class="params">(<span class="keyword">char</span> *str)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(str),p = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt; len;k++)&#123;</span><br><span class="line">        p = trie[p][str[k]-<span class="string">'0'</span>];</span><br><span class="line">        <span class="keyword">if</span>(p == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> End[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> s[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">int</span> m,op;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%s"</span>,&amp;op,s);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>) insert(s);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(search(s)) <span class="built_in">printf</span>(<span class="string">"Yes\n"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"No\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å‚è€ƒä¹¦ç›®ï¼š</strong></p><ul><li>ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹æç…œä¸œ.P71</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ€çŸ­è·¯å¾„ç®—æ³•</title>
      <link href="/2019/08/16/dijkstra/"/>
      <url>/2019/08/16/dijkstra/</url>
      
        <content type="html"><![CDATA[<p><strong>å‰ç½®çŸ¥è¯†ï¼š</strong> å›¾çš„ç›¸å…³å®šä¹‰ã€å›¾çš„å­˜å‚¨</p><p><strong>æ‘˜è¦ï¼š</strong><br>æœ€çŸ­è·¯å¾„ç®—æ³•ä¸­å¸¸ç”¨çš„æœ‰4ä¸ªï¼šFloyed-Warshallã€Dijkstraã€Bellman-Fordã€SPFAã€‚è¿™å‡ ç§ç®—æ³•åŒºåˆ«åœ¨äºé€‚ç”¨èŒƒå›´ï¼Œä»¥åŠå¯¹äºä¸åŒæ„é€ çš„å›¾æ•ˆç‡ä¸åŒã€‚ç”±äºè¾¹çš„æƒå€¼å¯ä»¥ä¸ºè´Ÿï¼Œåœ¨è¾¹æƒä¸ºè´Ÿçš„æƒ…å†µä¸‹Dijkstraç®—æ³•æ— æ³•ä½¿ç”¨ã€‚è€ŒBellman-Fordç®—æ³•è™½ç„¶å¯ä»¥å¤„ç†è´Ÿè¾¹æƒå›¾ï¼Œä½†å´ä¸èƒ½å¤„ç†è´Ÿæƒå›è·¯çš„æƒ…å†µï¼ˆæ–‡ä¸­æœ‰ä»‹ç»ï¼‰ã€‚<br>è¿›ä¸€æ­¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†æœ€çŸ­è·¯å¾„é—®é¢˜åˆ†ä¸ºå•æºæœ€çŸ­è·¯å¾„å’Œå¤šæºæœ€çŸ­è·¯å¾„é—®é¢˜ã€‚åœ¨å­¦ä¼šå¤„ç†è¿™ä¸¤ä¸ªé—®é¢˜åï¼Œæˆ‘ä»¬è¿˜å°†æ¢è®¨å¦‚ä½•è®°å½•å¹¶è¾“å‡ºæœ€çŸ­è·¯å¾„è€Œä¸ä»…ä»…æ˜¯æ±‚å€¼ï¼›åœ¨èµ°æœ€çŸ­è·¯å¾„çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¿˜åº”èƒ½å¯¹ç­‰æ•ˆè·¯å¾„ï¼ˆå³æœ€ç»ˆç»“æœç›¸åŒçš„ä¸¤æ¡è·¯å¾„ï¼Œè¿™é‡Œè¡¨ç°ä¸ºæƒå€¼ç›¸åŒï¼‰åšçº¦æŸé€‰æ‹©ï¼ˆå³æœ‰ç¬¬äºŒæƒå€¼ï¼‰ã€‚</p><h4 id="ç›¸å…³æ¦‚å¿µ"><a href="#ç›¸å…³æ¦‚å¿µ" class="headerlink" title="ç›¸å…³æ¦‚å¿µ"></a>ç›¸å…³æ¦‚å¿µ</h4><p>æˆ‘ä»¬å‡è®¾å›¾ä¸­é¡¶ç‚¹ä¸ªæ•°ä¸ºNï¼Œç¼–å·ä¾æ¬¡ä¸º1~Nï¼Œè¾¹çš„ä¸ªæ•°ä¸ºMã€‚</p><p><strong>æœ€çŸ­è·¯é—®é¢˜ï¼š</strong> åœ¨å›¾ä¸­ï¼Œç»™å®šä¸¤ä¸ªé¡¶ç‚¹ï¼Œåœ¨ä»¥è¿™ä¸¤ä¸ªç‚¹ä¸ºèµ·ç‚¹å’Œç»ˆç‚¹çš„è·¯å¾„ä¸­ï¼Œè¾¹çš„æƒå€¼å’Œæœ€å°çš„è·¯å¾„ã€‚<br><strong>ç¨€ç–å›¾ï¼š</strong> ç¬¦åˆ|E| = O(V)çš„å›¾ç§°ä¸ºç¨€ç–å›¾ã€‚<br><strong>ç¨ å¯†å›¾ï¼š</strong> ç¬¦åˆ|E| = O(V^2)çš„å›¾ç§°ä¸ºç¨ å¯†å›¾ã€‚åœ¨ç®—æ³•ç«èµ›ä¸­ï¼Œè‹¥|E|æ¯”|V|å¤§ä¸€ä¸ªæ•°é‡çº§ä»¥ä¸Šåˆ™å¯è®¤ä¸ºæ˜¯ç¨ å¯†å›¾ã€‚</p><h4 id="å•æºæœ€çŸ­è·¯å¾„"><a href="#å•æºæœ€çŸ­è·¯å¾„" class="headerlink" title="å•æºæœ€çŸ­è·¯å¾„"></a>å•æºæœ€çŸ­è·¯å¾„</h4><p>æºï¼Œå³èµ·ç‚¹çš„æ„æ€ã€‚å•æºæœ€çŸ­è·¯å¾„é—®é¢˜å°±æ˜¯æ±‚ä»ä¸€ä¸ªèµ·ç‚¹å‡ºå‘åˆ°å…¶å®ƒé¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚è¿™é‡Œæˆ‘ä»¬å‡è®¾èµ·ç‚¹ä¸º1ï¼ˆå›¾ä¸­é¡¶ç‚¹ç¼–å·ä¸º1~Nï¼‰ï¼Œdist[ i ] ä¸ºä»èµ·ç‚¹1åˆ°é¡¶ç‚¹içš„æœ€çŸ­è·¯å¾„ã€‚<br>æ±‚å•æºæœ€çŸ­è·¯å¾„æœ‰3ä¸ªç®—æ³•ï¼šDijkstraã€Bellman-Fordå’ŒSPFAã€‚å…¶ä¸­SPFAæ˜¯Bellman-Fordçš„ä¼˜åŒ–ç‰ˆæœ¬ï¼Œäºæ˜¯æˆ‘ä»¬é€šå¸¸ä¾æ®æƒ…å†µæŒ‘é€‰é€‚åˆçš„ç®—æ³•ä½¿ç”¨ã€‚</p><h5 id="Dijkstraç®—æ³•"><a href="#Dijkstraç®—æ³•" class="headerlink" title="Dijkstraç®—æ³•"></a>Dijkstraç®—æ³•</h5><p><strong>é€‚ç”¨èŒƒå›´ä¸æ•ˆç‡ï¼š</strong><br>Dijkstraç®—æ³•é€‚ç”¨äºæ‰€æœ‰è¾¹æƒå€¼éè´Ÿæƒ…å†µï¼Œå…¶è¿è¡Œæ•ˆç‡ä¸ºO(N^2)ï¼Œä¼˜åŒ–åæ•ˆç‡ä¸ºO(M* LogN)ï¼Œé€‚ç”¨äºç¨ å¯†å›¾ã€‚</p><p><strong>ç®—æ³•æµç¨‹ï¼š</strong> </p><ol><li>åˆå§‹åŒ–dist[1] = 0ï¼Œå…¶ä½™èŠ‚ç‚¹çš„distå€¼è®¾ä¸ºæ— ç©·å¤§ã€‚</li><li>æ‰¾å‡ºä¸€ä¸ªæœªè¢«æ ‡è®°çš„ã€dist[x]æœ€å°çš„èŠ‚ç‚¹xï¼Œç„¶åæ ‡è®°èŠ‚ç‚¹xã€‚</li><li>æ‰«æèŠ‚ç‚¹xçš„æ‰€æœ‰å‡ºè¾¹ï¼ˆx,y,zï¼‰ï¼Œè‹¥dist[y] &gt; dist[x]+zï¼Œåˆ™é€‚ç”¨dist[x]+zæ›´æ–°dist[y]ã€‚</li></ol><p><strong>ç®—æ³•æ€æƒ³ï¼š</strong><br>Dijkstraç®—æ³•åŸºäºè´ªå¿ƒçš„æ€æƒ³ã€‚æˆ‘ä»¬çš„åšæ³•å°±æ˜¯ä¸æ–­é€šè¿‡å·²æ±‚å‡ºçš„æœ€çŸ­è·¯å¾„dist[x]æ¥æ›´æ–°å’Œå…¶ç›¸è¿çš„ç‚¹yï¼ˆå‡è®¾(x,y,z)åˆ†åˆ«ä¸ºèµ·ç‚¹ã€ç»ˆç‚¹ã€è¾¹æƒï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªç‚¹yæœ‰å¯èƒ½è¢«å¤šä¸ªç‚¹xæ›´æ–°ï¼Œäºæ˜¯æˆ‘ä»¬å–dist[x]+zå€¼æœ€å°çš„ä½œä¸ºdist[y]ã€‚<br><strong>æ­£ç¡®æ€§è¯æ˜ï¼š</strong><br>åœ¨ä¸Šè¿°ç®—æ³•æµç¨‹æ­¥éª¤2ä¸­ï¼Œæˆ‘ä»¬æ‰¾å‡ºæœªè¢«æ ‡è®°çš„ã€dist[x]æœ€å°çš„èŠ‚ç‚¹xæ¥æ›´æ–°å’Œxç›¸è¿çš„ç‚¹ï¼Œè¿™é‡Œæ‰€æŒ‡çš„dist[x]å³<strong>å…¨å±€æœ€å°å€¼</strong>ã€‚ä¸ºä»€ä¹ˆä½¿ç”¨å…¨å±€æœ€å°å€¼æ¥æ›´æ–°å’Œå…¶ç›¸è¿çš„ç‚¹å¯ä»¥è¾¾åˆ°ç›®çš„å‘¢ï¼Ÿ<br>é¦–å…ˆï¼Œç”±äºé™¤äº†èŠ‚ç‚¹1å¤–æ‰€æœ‰ç‚¹çš„diståˆå§‹å€¼éƒ½ä¸ºæ— ç©·å¤§ï¼Œå› æ­¤distä¸æ˜¯æ— ç©·å¤§çš„ç‚¹ä¸€å®šæ˜¯è¢«æ›´æ–°è¿‡äº†çš„ï¼›å¦å¤–ï¼Œdistä¸ºå…¨å±€æœ€å°å€¼çš„ç‚¹ï¼Œå…¶distä¸€å®šä¸ä¼šå†è¢«æ›´æ–°ï¼Œå› ä¸º<strong>æ²¡æœ‰æ¯”å…¶distæ›´å°çš„ç‚¹</strong>å¯ä»¥ç”¨æ¥æ›´æ–°å®ƒã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»è¯æ˜äº†distä¸ºå…¨å±€æœ€å°å€¼çš„ç‚¹xä¸€å®šæ˜¯è¢«æ›´æ–°è¿‡äº†çš„ï¼Œä¸”ä¸€å®šæ˜¯ä¸èƒ½å†è¢«æ›´æ–°äº†çš„ï¼Œå› æ­¤dist[x]å³ä¸ºèŠ‚ç‚¹1åˆ°xçš„æœ€çŸ­è·¯å¾„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨xæ¥æ›´æ–°å…¶å®ƒç‚¹ã€‚</p><p><strong>ä¼˜åŒ–ï¼š</strong><br>ä¸Šè¿°ç®—æ³•ï¼Œåœ¨æ‰¾å…¨å±€æœ€å°å€¼æ—¶é‡‡å–éå†çš„æ–¹æ³•ï¼Œå…¶æŸ¥æ‰¾ä¸åˆ é™¤çš„æ•ˆç‡ä¸ºO(N)ï¼ŒåŠ ä¹‹ä½¿ç”¨é‚»æ¥çŸ©é˜µå­˜å‚¨ï¼Œéå†è¾¹ä¹Ÿæ˜¯O(N)ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å †+é‚»æ¥è¡¨çš„æ–¹å¼æ¥ä¼˜åŒ–ã€‚æˆ‘ä»¬å¯ä»¥åœ¨O(log N)çš„å¤æ‚åº¦ä¸‹è·å–å’Œåˆ é™¤å…¨å±€æœ€å°å€¼ï¼Œæœ€ç»ˆå¯åœ¨O(M log N)æ—¶é—´å†…å®Œæˆç®—æ³•ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br>è§é™„å½•éƒ¨åˆ†code-1ï¼šäºŒå‰å †ä¼˜åŒ–çš„Dijkstraç®—æ³•æ¨¡æ¿</p><h5 id="Bellman-Fordç®—æ³•ä¸SPFAç®—æ³•"><a href="#Bellman-Fordç®—æ³•ä¸SPFAç®—æ³•" class="headerlink" title="Bellman-Fordç®—æ³•ä¸SPFAç®—æ³•"></a>Bellman-Fordç®—æ³•ä¸SPFAç®—æ³•</h5><p><strong>é€‚ç”¨èŒƒå›´ä¸æ•ˆç‡ï¼š</strong><br>èƒ½å¤„ç†å¸¦è´Ÿæƒè¾¹çš„æƒ…å†µï¼Œä¸èƒ½å¤„ç†å­˜åœ¨è´Ÿæƒå›è·¯çš„æƒ…å†µã€‚å…¶ä¸­Bellman-Fordæ•ˆç‡ä¸ºO(NM)ï¼ŒSPFAæ•ˆç‡ä¸ºO(KE)ï¼Œå…¶ä¸­Kä¸ºå¸¸æ•°ï¼Œå¹³å‡å€¼ä¸º2ã€‚é€‚ç”¨äºç¨€ç–å›¾ã€‚<br><strong>ç®—æ³•ä»‹ç»ï¼š</strong><br>å¯ä»¥æ³¨æ„åˆ°æˆ‘ä»¬å°†Bellman-Fordç®—æ³•å’ŒSPFAç®—æ³•æ”¾åœ¨äº†ä¸€èµ·æ•´ç†ï¼Œå› ä¸ºå®é™…ä¸ŠSPFAæ˜¯â€œé˜Ÿåˆ—ä¼˜åŒ–çš„Bellman-Fordç®—æ³•â€ï¼Œå› æ­¤æœ¬è´¨ä¸Šæ€æƒ³ç›¸åŒã€‚<br><strong>ç®—æ³•æµç¨‹ï¼š</strong> </p><ol><li>æ‰«ææ‰€æœ‰è¾¹(x,y,z)ï¼Œè‹¥dist[y] &gt; dist[x] + zï¼Œåˆ™ç”¨dist[x] + zæ›´æ–°dist[y]ã€‚</li><li>é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œç›´åˆ°æ²¡æœ‰æ›´æ–°æ“ä½œä¸ºæ­¢ã€‚</li></ol><p><strong>ç®—æ³•æ€æƒ³ï¼š</strong><br>Bellman-Fordç®—æ³•æ˜¯åŸºäºè¿­ä»£æ€æƒ³çš„ã€‚æˆ‘ä»¬æ¯ä¸€æ¬¡éƒ½å¯¹æ‰€æœ‰çš„è¾¹è¿›è¡Œä¸€æ¬¡æ›´æ–°æ“ä½œï¼Œç›´è‡³æ²¡æœ‰æ›´æ–°æ“ä½œå‘ç”Ÿä¸ºæ­¢ã€‚æ¯ä¸€æ¬¡çš„æ›´æ–°æ“ä½œéƒ½ä½¿å¾—æˆ‘ä»¬æ›´æ¥è¿‘ç­”æ¡ˆï¼Œè¿™ç§é€šè¿‡è‹¥å¹²æ¬¡é‡å¤æ“ä½œä¸æ–­é€¼è¿‘ç­”æ¡ˆçš„æ€æƒ³å°±æ˜¯è¿­ä»£æ€æƒ³ã€‚ç®—æ³•çš„æ­£ç¡®æ€§å¾ˆæ˜¾ç„¶ï¼Œä¸äºˆè¯æ˜ã€‚</p><p><strong>SPFAï¼š</strong></p><ol><li>å»ºç«‹ä¸€ä¸ªé˜Ÿåˆ—ï¼Œæœ€åˆé˜Ÿåˆ—ä¸­åªåŒ…å«èµ·ç‚¹ã€‚</li><li>å–å‡ºé˜Ÿå¤´èŠ‚ç‚¹xï¼Œæ‰«æå®ƒæ‰€æœ‰å‡ºè¾¹ï¼ˆx,y,z)ï¼Œè‹¥dist[y] &gt; dist[x] + zï¼Œåˆ™ä½¿ç”¨dist[x] + zæ›´æ–°dist[y]ã€‚åŒæ—¶ï¼Œè‹¥yä¸åœ¨é˜Ÿåˆ—ä¸­ï¼Œåˆ™æŠŠyå…¥é˜Ÿã€‚</li><li>é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºã€‚</li></ol><p>åœ¨è¿™ä¸ªä¼˜åŒ–ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨é˜Ÿåˆ—ä¿å­˜äº†å¾…æ‰©å±•èŠ‚ç‚¹ã€‚æ¯æ¬¡å…¥é˜Ÿç›¸å½“äºå®Œæˆä¸€æ¬¡å¯¹distæ•°ç»„çš„æ›´æ–°æ“ä½œï¼Œä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½ä¼šå…¥é˜Ÿã€å‡ºé˜Ÿå¤šæ¬¡ã€‚è¿™ä¸ªé˜Ÿåˆ—é¿å…äº†Bellman-Fordç®—æ³•ä¸­å¯¹ä¸éœ€è¦æ‰©å±•èŠ‚ç‚¹çš„å†—ä½™æ‰«æã€‚åœ¨ç¨€ç–å›¾ä¸ŠSPFAæ•ˆç‡è¾ƒé«˜ï¼Œä¸ºO(KM)çº§åˆ«ï¼Œå…¶ä¸­kæ˜¯ä¸€ä¸ªè¾ƒå°çš„å¸¸æ•°ã€‚ä½†æ˜¯åœ¨ç¨ å¯†å›¾æˆ–è€…ç‰¹æ®Šçš„ç½‘æ ¼å›¾ä¸Šï¼Œä»æœ‰å¯èƒ½é€€åŒ–ä¸ºO(NM)ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br>è§é™„å½•éƒ¨åˆ†code-2ï¼šSPFAæ¨¡æ¿</p><h4 id="å¤šæºæœ€çŸ­è·¯å¾„é—®é¢˜"><a href="#å¤šæºæœ€çŸ­è·¯å¾„é—®é¢˜" class="headerlink" title="å¤šæºæœ€çŸ­è·¯å¾„é—®é¢˜"></a>å¤šæºæœ€çŸ­è·¯å¾„é—®é¢˜</h4><p>ä¸å•æºæœ€çŸ­è·¯å¾„é—®é¢˜å¯¹åº”ï¼Œå¤šæºæœ€çŸ­è·¯å¾„é—®é¢˜ä¸å±€é™äºæŸä¸€å›ºå®šèµ·ç‚¹ï¼Œè€Œæ˜¯å¯èƒ½åœ¨ä¸€æ¬¡ç®—æ³•ä¸­è¯¢é—®ä»»æ„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ï¼Œäºæ˜¯ä¹‹å‰çš„3ä¸ªç®—æ³•å°±æ‰è¥Ÿè§è‚˜äº†ï¼Œæ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–°çš„ç®—æ³•æ¥è§£å†³è¿™ç±»é—®é¢˜ï¼Œè¿™ä¸ªç®—æ³•å°±æ˜¯Floydç®—æ³•ã€‚</p><h5 id="Floydç®—æ³•"><a href="#Floydç®—æ³•" class="headerlink" title="Floydç®—æ³•"></a>Floydç®—æ³•</h5><p><strong>é€‚ç”¨èŒƒå›´ï¼š</strong> é€‚ç”¨äºæ±‚å¤šæºæœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œé€‚ç”¨äºç¨ å¯†å›¾ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N^3)ã€‚<br><strong>ç®—æ³•æ€æƒ³ï¼š</strong><br>Floydç®—æ³•åŸºäºåŠ¨æ€è§„åˆ’ã€‚è®¾D[k,i,j]è¡¨ç¤ºâ€œç»è¿‡è‹¥å¹²ä¸ªç¼–å·ä¸è¶…è¿‡kçš„èŠ‚ç‚¹â€ä»iåˆ°jçš„æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚è¯¥é—®é¢˜å¯ä»¥åˆ’åˆ†ä¸ºä¸¤ä¸ªå­é—®é¢˜ï¼Œç»è¿‡ç¼–å·ä¸è¶…è¿‡k-1çš„èŠ‚ç‚¹ä»iåˆ°jï¼Œæˆ–è€…ä»iå…ˆåˆ°kå†åˆ°jã€‚äºæ˜¯æœ‰çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š<br>&emsp;&emsp;D[k,i,j] = min( D[k-1,i,j] , D[k-1,i,k] + D[k-1,k,j] )<br>åˆå€¼ä¸ºD[0,i,j] = A[i,j]å…¶ä¸­A[i,j]ä¸ºè‡ªå®šä¹‰çš„é‚»æ¥çŸ©é˜µã€‚<br>ä¸Šè¿°ç®—æ³•ä¸­ï¼Œkæ˜¯é˜¶æ®µï¼Œæ‰€ä»¥å¿…é¡»ç½®äºæœ€å¤–å±‚å¾ªç¯ã€‚iå’Œjæ˜¯é™„åŠ çŠ¶æ€ï¼Œå› æ­¤å¯ä»¥ç½®äºå†…å±‚å¾ªç¯ã€‚ç®—æ³•çš„æ­£ç¡®ç­‰ä»·äºåŠ¨æ€è§„åˆ’çš„æ­£ç¡®æ€§è¯æ˜ï¼Œæ­¤å¤„ä¸äºˆè¯æ˜ã€‚<br><strong>ä¼˜åŒ–ï¼š</strong><br>Floydç®—æ³•å¯è¿›è¡Œç©ºé—´ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ç¬¬ä¸€ç»´å®Œå…¨å¯ä»¥å‘èƒŒåŒ…é—®é¢˜ä¸­ä¸€æ ·çœç•¥ã€‚æœ€åˆï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨Dä¿å­˜é‚»æ¥çŸ©é˜µã€‚åœ¨æœ€å¤–å±‚å¾ªç¯åˆ°kå±‚æ—¶ï¼Œå†…å±‚æœ‰çŠ¶æ€è½¬ç§»ï¼š<br>&emsp;&emsp;D[i,j] = min(D[i,j] , D[i,k] + D[k,j])<br>æœ€ç»ˆD[i,j]å°±ä¿å­˜äº†iåˆ°jçš„æœ€çŸ­è·¯å¾„ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br>è§é™„å½•éƒ¨åˆ†code-3ï¼šFloydç®—æ³•æ¨¡æ¿ã€‚</p><h4 id="æœªè§£å†³çš„é—®é¢˜"><a href="#æœªè§£å†³çš„é—®é¢˜" class="headerlink" title="æœªè§£å†³çš„é—®é¢˜"></a>æœªè§£å†³çš„é—®é¢˜</h4><p>ä»¥ä¸‹é—®é¢˜å°†åœ¨å¦ä¸€ç¯‡ç¬”è®°ä¸­æ•´ç†ï¼š</p><ul><li>å¦‚ä½•ä¿å­˜å¹¶è¾“å‡ºæœ€çŸ­è·¯å¾„ã€‚</li><li>æœ€çŸ­è·¯å¾„çš„å˜å½¢ï¼Œå¦‚ï¼šæ±‚è¿é€šæ€§ã€æ±‚ä¼ é€’é—­åŒ…ã€æ±‚è·¯å¾„æœ€å¤§æƒå€¼æœ€å°ã€‚</li><li>èŠ‚ç‚¹æœ‰çº¦æŸçš„æœ€çŸ­è·¯å¾„é—®é¢˜ã€‚</li><li>å¦‚ä½•åˆ¤æ–­è´Ÿç¯ã€‚</li></ul><h4 id="å‚è€ƒä¹¦ç›®"><a href="#å‚è€ƒä¹¦ç›®" class="headerlink" title="å‚è€ƒä¹¦ç›®"></a>å‚è€ƒä¹¦ç›®</h4><ul><li>ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹,æç…œä¸œ,P322-331.</li><li>ã€Šä¿¡æ¯å­¦å¥¥èµ›ä¸€æœ¬é€šã€‹,è‘£æ°¸å»º,ç§‘å­¦æŠ€æœ¯æ–‡çŒ®å‡ºç‰ˆç¤¾,P471-485.</li><li>ã€ŠæŒ‘æˆ˜ç¨‹åºè®¾è®¡ç«èµ›(ç¬¬äºŒç‰ˆ)ã€‹,äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾,ç§‹å¶æ‹“å“‰,P99.</li></ul><h4 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h4><p>code-1ï¼šäºŒå‰å †ä¼˜åŒ–çš„Dijkstraç®—æ³•æ¨¡æ¿<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹P324</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],edge[M],Next[M],d[N];</span><br><span class="line"><span class="keyword">int</span> n,m,tot;</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line">priority_queue&lt; pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt; q;</span><br><span class="line"><span class="comment">//pair ç¬¬ä¸€ç»´æ˜¯distçš„ç›¸åæ•°ï¼Œåˆ©ç”¨ç›¸åæ•°ä½¿å¾—å¤§æ ¹å †å˜æˆå°æ ¹å †</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    ver[++tot] = y,edge[tot] = z;</span><br><span class="line">    Next[tot] = head[x],head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">(<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(d,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> d);    <span class="comment">//åˆå§‹åŒ–distæ•°ç»„</span></span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span> vis);   <span class="comment">//åˆå§‹åŒ–æ ‡è®°æ•°ç»„</span></span><br><span class="line">    d[s] = <span class="number">0</span>;   </span><br><span class="line">    q.push(make_pair(<span class="number">0</span>,s));</span><br><span class="line">    <span class="keyword">while</span>(q.size())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.top().second;q.pop();<span class="comment">//xä¸ºå…¨æœ€æœ€å°å€¼èŠ‚ç‚¹ç¼–å·</span></span><br><span class="line">        <span class="keyword">if</span>(vis[x]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[x] = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">//éå†æ‰€æœ‰è¾¹</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x]; i;i = Next[i])&#123;</span><br><span class="line">            <span class="keyword">int</span> y = ver[i],z = edge[i];</span><br><span class="line">            <span class="keyword">if</span>(d[y] &gt; d[x] + z)&#123;</span><br><span class="line">                d[y] = d[x]+z;</span><br><span class="line">                q.push(make_pair(-d[y],y));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>code-2ï¼šSPFAç®—æ³•æ¨¡æ¿</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹P326</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],edge[M],ver[M],Next[M],d[N];</span><br><span class="line"><span class="keyword">int</span> n,m,tot;</span><br><span class="line"><span class="keyword">bool</span> vis[N];    <span class="comment">//ç”¨æ¥æ ‡è®°èŠ‚ç‚¹xæ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­</span></span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;   <span class="comment">//è¾…åŠ©é˜Ÿåˆ—</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    ver[++tot] = y,edge[tot] = z;</span><br><span class="line">    Next[tot] = head[x],head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span><span class="params">(<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(d,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> d);</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line">    d[s] = <span class="number">0</span>;</span><br><span class="line">    q.push(s);</span><br><span class="line">    <span class="keyword">while</span>(q.size())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front();q.pop();</span><br><span class="line">        vis[x] = <span class="literal">false</span>;     <span class="comment">//è¡¨ç¤ºxä¸åœ¨é˜Ÿåˆ—ä¸­äº†</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x]; i;i = Next[i])&#123;</span><br><span class="line">            <span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line">            <span class="keyword">if</span>(d[y] &gt; d[x]+z)&#123;</span><br><span class="line">                d[y] = d[x]+z;</span><br><span class="line">                <span class="keyword">if</span>(!vis[y]) q.push(y),vis[y] = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x,y,z,s;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">        add(x,y,z);</span><br><span class="line">    &#125;</span><br><span class="line">    SPFA(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>,d[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>code-3ï¼šFloydç®—æ³•æ¨¡æ¿</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">int</span> d[N][N];</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123; <span class="keyword">return</span> a&gt;b?b:a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="built_in">memset</span>(d,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> d);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) d[i][i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">        d[x][y] = min(d[x][y],z);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= n;k++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)</span><br><span class="line">                d[i][j] = min(d[i][j],d[i][k]+d[k][j]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++) <span class="built_in">printf</span>(<span class="string">"%d "</span>,d[i][j]);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ€é•¿ä¸Šå‡å­åºåˆ—æ¨¡æ¿</title>
      <link href="/2019/08/16/lis/"/>
      <url>/2019/08/16/lis/</url>
      
        <content type="html"><![CDATA[<p>æŒ‰ç…§æ•°æ®ç»“æ„æ¥åˆ’åˆ†çš„è¯ï¼Œæœ€é•¿ä¸Šå‡å­åºåˆ—(LIS)æ˜¯å±äºçº¿æ€§DPï¼Œå…¶ä½œä¸ºåŠ¨æ€è§„åˆ’ç»å…¸å…¥é—¨æ¨¡å‹ï¼Œé‡è¦æ€§ä¹Ÿæ˜¯ä¸è¨€è€Œå–»çš„ã€‚è€ŒLISé—®é¢˜ä¹Ÿæœ‰å¾ˆå¤šç§å˜å‹ï¼Œå¯¹äºè¿™äº›é—®é¢˜æœ‰çš„è¶…è¿‡äº†åŠ¨æ€è§„åˆ’çš„é€‚ç”¨èŒƒå›´ï¼Œæœ‰çš„éœ€è¦å¯¹è½¬ç§»æ–¹ç¨‹è¿›è¡Œæ›´æ”¹ï¼Œéœ€è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚</p><p><strong>å‰ç½®çŸ¥è¯†ï¼š</strong></p><ul><li>å­åºåˆ—çš„æ¦‚å¿µ</li><li>åŠ¨æ€è§„åˆ’ä¸€èˆ¬æ­¥éª¤</li><li>äºŒåˆ†æŸ¥æ‰¾</li></ul><blockquote><p>é—®é¢˜æ¨¡å‹ï¼šç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºNçš„æ•°åˆ—Aï¼Œæ±‚æ•°å€¼å•è°ƒé€’å¢çš„å­åºåˆ—é•¿åº¦æœ€é•¿æ˜¯å¤šå°‘ã€‚</p></blockquote><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>çŠ¶æ€è¡¨ç¤ºï¼šæˆ‘ä»¬è®¾F[i]è¡¨ç¤ºä»¥A[i]ä¸ºç»“å°¾çš„â€œæœ€é•¿ä¸Šå‡å­åºåˆ—â€çš„é•¿åº¦ã€‚<br>é˜¶æ®µåˆ’åˆ†ï¼šå­åºåˆ—çš„ç»“å°¾ä½ç½®ï¼ˆæ•°åˆ—Aä¸­çš„ä½ç½®ï¼Œä»å‰åˆ°åï¼‰ã€‚<br>è½¬ç§»æ–¹ç¨‹ï¼šF[i] = max{ f[j] + 1} (0 &lt;= j &lt; i ä¸” A[j] &lt; A[i])ã€‚<br>è¾¹ç•Œï¼šF[0] = 0ã€‚<br>ç›®æ ‡ï¼šmax{F[i]} ( 0 &lt;= i &lt; = N)ã€‚</p><p>å¦‚æ­¤è®¾è®¡ç›®æ ‡å‡½æ•°ä¸è½¬ç§»æ–¹ç¨‹ï¼Œå¾ˆæ˜¾ç„¶å¯ä»¥å¾—åˆ°æ­£ç¡®ç»“æœï¼Œå…¶æ•ˆç‡æ˜¯O(N^2)ï¼Œä»£ç å®ç°ä¹Ÿå¾ˆç®€å•ã€‚</p><p><strong>ä¼˜åŒ–ï¼š</strong><br>é¦–å…ˆè€ƒè™‘ä¸€ä¸‹ä¸Šè¿°ç®—æ³•æœ€è€—æ—¶çš„åœ°æ–¹åœ¨å“ªï¼Œæ˜¾ç„¶æˆ‘ä»¬æ¯æ¬¡éƒ½è¦ç”¨O(N)çš„æ—¶é—´éå†å‰i-1ä¸ªä½ç½®ä¸Šçš„å…ƒç´ æ¥æ›´æ–°F[i]ï¼Œè€Œèƒ½æ›´æ–°F[i]çš„å…ƒç´ A[j]éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼šA[j] &lt; A[i]ä¸”F[j] &gt;= F[i]ï¼Œé‚£ä¹ˆF[i]å°±å¯ä»¥è¢«æ›´æ–°ä¸ºF[j]+1ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒA[j]ä¹Ÿå¯ä»¥æè¿°ä¸ºâ€œå°äºA[i]çš„æ‰€æœ‰å…ƒç´ ä¸­Fçš„å€¼æœ€å¤§çš„é‚£ä¸ªâ€ï¼Œé€šè¿‡è¿™ä¸ªæè¿°æ¥æ‰¾A[j]çš„æ•ˆç‡æ˜¯O(N)ã€‚<br>è€ƒè™‘å¦ä¸€ç§æ–¹å¼ï¼Œæˆ‘ä»¬æ–°å¢ä¸€ä¸ªè¾…åŠ©æ•°ç»„dï¼Œd[i] è¡¨ç¤ºâ€œé•¿åº¦ä¸ºiçš„æœ€é•¿ä¸Šå‡å­åºåˆ—çš„æœ€å°ç»“å°¾æ˜¯å¤šå°‘â€ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œdæ•°ç»„ä¸­çš„å…ƒç´ æ˜¯ä¸¥æ ¼é€’å¢çš„ã€‚ä¸”æ¯å½“æˆ‘ä»¬è¯»å–åˆ°Aåºåˆ—ä¸­çš„ä¸€ä¸ªå…ƒç´ A[i]æ—¶ï¼Œéƒ½æœ‰ä¸¤ç§æƒ…å†µï¼š</p><ol><li>A[i] &gt; d[len]ï¼Œæ­¤æ—¶ d[++len] = A[i]ã€‚ </li><li>A[i] &lt;= d[len]ï¼Œæ­¤æ—¶è¯´æ˜dæ•°ç»„ä¸­æŸä¸ªå…ƒç´ å¯ä»¥è¢«A[i]æ›´æ–°ï¼Œæˆ‘ä»¬é‡‡ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ–¹å¼æ›´æ–°dæ•°ç»„å³å¯ã€‚</li></ol><p>å…¶ä¸­lenä»£è¡¨å½“å‰æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ã€‚<br>ä¸Šè¿°æ–¹æ³•ä¸­ï¼Œå¦‚æœé‡åˆ°æƒ…å†µ1ï¼Œé‚£ä¹ˆæ•ˆç‡æ˜¯O(1)ï¼Œæƒ…å†µ2ï¼Œæ•ˆç‡å°±æ˜¯O(log N)ï¼Œæ€»ä½“æ¥è®²ï¼Œå¯¹äºå¤§é‡æ•°æ®ï¼Œè¯¥ä¼˜åŒ–æ•ˆæœè¿˜æ˜¯å¾ˆå–œäººçš„ã€‚</p><p><strong>ä¼˜åŒ–çš„æ­£ç¡®æ€§è¯´æ˜ï¼š</strong><br>ä¸Šè¿°ä¼˜åŒ–å¯ä»¥ç”¨å †æ ˆæ€æƒ³æ¥è§£é‡Šï¼Œä¹Ÿå¯ä»¥å°†å…¶çœ‹ä½œä¸€ä¸ªå°æŠ€å·§ã€‚å€ŸåŠ©äºdæ•°ç»„ï¼Œå¯¹äºåºåˆ—Aä¸­çš„æ¯ä¸ªå…ƒç´ A[i]ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥å¿«é€Ÿæ‰¾åˆ°â€œå°äºA[i]çš„æ‰€æœ‰å…ƒç´ ä¸­Fçš„å€¼æœ€å¤§çš„é‚£ä¸ªâ€ï¼Œ<strong>å› ä¸ºd[len]å­˜æ”¾çš„å°±æ˜¯æœ€é•¿ä¸Šå‡å­åºåˆ—é•¿åº¦ä¸ºlenæ—¶çš„æœ€å°å…ƒç´ </strong> ã€‚å¦‚æœA[i] &lt;= d[len]ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶å½“å‰çš„æœ€é•¿ä¸Šå‡å­åºåˆ—é•¿åº¦lenä¸èƒ½å†å¢åŠ äº†ï¼ˆå› ä¸ºA[i] ä¸èƒ½æ·»åŠ åœ¨Açš„å­åºåˆ—d[1] ~d[len] çš„åé¢ï¼‰ï¼Œä¸”dæ•°ç»„å¯ä»¥è¢«æ›´æ–°(å†ä¸æµä¹Ÿå¯ä»¥å°†d[len] æ›´æ–°ä¸º A[i]ï¼Œå› ä¸º A[i] &lt; d[len])ã€‚äºæ˜¯å€ŸåŠ©äºdæ•°ç»„çš„ç‰¹æ€§ï¼Œå®Œæˆäº†ä¼˜åŒ–ï¼Œå½“ç„¶ä¹Ÿæœ‰æ‰€ç‰ºç‰²ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> d[<span class="number">100005</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">b_search</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> s,<span class="keyword">int</span> e)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(s &lt; e)&#123;</span><br><span class="line">        <span class="keyword">int</span> mid = s+(e-s)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(d[mid] &gt;= x) e = mid;</span><br><span class="line">        <span class="keyword">else</span> s = mid+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LIS</span><span class="params">(<span class="keyword">int</span> A[],<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(d,<span class="number">0</span>,<span class="keyword">sizeof</span> d);</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">1</span>;</span><br><span class="line">    d[<span class="number">1</span>] = A[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(A[i] &gt;= d[len])  d[++len] = A[i];</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> p = b_search(A[i],<span class="number">1</span>,len);</span><br><span class="line">            d[p] = A[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//  for(int i = 0;i &lt; len;i++)  cout &lt;&lt; d[i+1]&lt;&lt;" ";</span></span><br><span class="line">    <span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h5 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h5><ul><li>ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹,æç…œä¸œ,P237.</li><li><a href="https://www.cnblogs.com/wxjor/p/5524447.html" target="_blank" rel="noopener">åšå®¢</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>â€œæ‹“å±•åŸŸâ€ä¸â€œè¾¹å¸¦æƒâ€å¹¶æŸ¥é›†</title>
      <link href="/2019/08/16/bingchaji/"/>
      <url>/2019/08/16/bingchaji/</url>
      
        <content type="html"><![CDATA[<h5 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h5><ul><li>å¹¶æŸ¥é›†</li><li>è·¯å¾„å‹ç¼©ä¸æŒ‰ç§©åˆå¹¶</li></ul><h5 id="â€œè¾¹å¸¦æƒâ€å¹¶æŸ¥é›†"><a href="#â€œè¾¹å¸¦æƒâ€å¹¶æŸ¥é›†" class="headerlink" title="â€œè¾¹å¸¦æƒâ€å¹¶æŸ¥é›†"></a>â€œè¾¹å¸¦æƒâ€å¹¶æŸ¥é›†</h5><p>å¹¶æŸ¥é›†å®é™…ä¸Šæ˜¯ç”±è‹¥å¹²æ£µæ ‘æ„æˆçš„æ£®æ—ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ ‘ä¸­çš„æ¯æ¡è¾¹ä¸Šè®°å½•ä¸€ä¸ªæƒå€¼ï¼Œå³ç»´æŠ¤ä¸€ä¸ªæ•°ç»„dï¼Œç”¨d[x]ä¿å­˜èŠ‚ç‚¹xåˆ°çˆ¶èŠ‚ç‚¹fa[x]ä¹‹å‰çš„è¾¹æƒã€‚åœ¨æ¯æ¬¡è·¯å¾„å‹ç¼©åï¼Œæ¯ä¸ªè®¿é—®è¿‡çš„èŠ‚ç‚¹éƒ½ä¼šç›´æ¥æŒ‡å‘æ ‘æ ¹ï¼Œå¦‚æœæˆ‘ä»¬åŒæ—¶æ›´æ–°è¿™äº›èŠ‚ç‚¹çš„då€¼ï¼Œå°±å¯ä»¥åˆ©ç”¨è·¯å¾„å‹ç¼©çš„è¿‡ç¨‹æ¥ç»Ÿè®¡æ¯ä¸ªèŠ‚ç‚¹åˆ°æ ‘æ ¹ä¹‹é—´çš„è·¯å¾„ä¸Šçš„ä¸€äº›ä¿¡æ¯ã€‚è¿™å°±æ˜¯æ‰€è°“â€œè¾¹å¸¦æƒâ€ çš„å¹¶æŸ¥é›†ã€‚</p><h5 id="ä¾‹é¢˜ï¼š"><a href="#ä¾‹é¢˜ï¼š" class="headerlink" title="ä¾‹é¢˜ï¼š"></a>ä¾‹é¢˜ï¼š</h5><blockquote><p>POJ1773<br>é¢˜ç›®æè¿°ï¼šè§ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹P190</p></blockquote><p><strong>è§£é¢˜æ€è·¯1ï¼šè¾¹å¸¦æƒ</strong><br>æœ¬é¢˜å¯ä½œä¸ºâ€œè¾¹å¸¦æƒâ€å’Œâ€œæ‰©å±•åŸŸâ€æ¨¡æ¿é¢˜æ•´ç†ã€‚ä¸ä¸€èˆ¬çš„å¹¶æŸ¥é›†ä¸åŒçš„æ˜¯ï¼Œæœ¬é¢˜ä¼ é€’å…³ç³»ä¸æ­¢ä¸€ç§ï¼š</p><ul><li>è‹¥x1å’Œx2å¥‡å¶æ€§ç›¸åŒï¼Œx2ä¸x3å¥‡å¶æ€§ä¹Ÿç›¸åŒï¼Œåˆ™x1ä¸x3å¥‡å¶æ€§ç›¸åŒã€‚</li><li>è‹¥x1å’Œx2å¥‡å¶æ€§ç›¸åŒï¼Œx2ä¸x3å¥‡å¶æ€§ä¸åŒï¼Œåˆ™x1ä¸x3å¥‡å¶æ€§ä¸åŒã€‚</li><li>è‹¥x1å’Œx2å¥‡å¶æ€§ä¸åŒï¼Œx2ä¸x3å¥‡å¶æ€§ä¸åŒï¼Œåˆ™x1ä¸x3å¥‡å¶æ€§ç›¸åŒã€‚</li></ul><p>å¦å¤–ï¼Œæœ¬é¢˜çš„Nå¤ªå¤§ï¼Œè€ŒMå´å¾ˆå°ï¼Œå¯ä»¥ä½¿ç”¨ç¦»æ•£åŒ–æ–¹æ³•ï¼Œæ‰€ä»¥é¡ºä¾¿å¤ä¹ ä¸€ä¸‹ç¦»æ•£åŒ–ã€‚<br>ä¸ºäº†å¤„ç†æœ¬é¢˜çš„å¤šç§ä¼ é€’å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä¸€ç§â€œè¾¹å¸¦æƒâ€çš„å¹¶æŸ¥é›†ã€‚å…·ä½“æ“ä½œæ˜¯ç”¨è¾¹æƒd[x] = 0 è¡¨ç¤º x ä¸ par[x] å¥‡å¶æ€§ç›¸åŒï¼›ä¸º1è¡¨ç¤º x ä¸ par[x] å¥‡å¶æ€§ä¸åŒã€‚äºæ˜¯åœ¨è·¯å¾„å‹ç¼©æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡å¯¹è·¯å¾„ä¸Šè¾¹æƒåšå¼‚æˆ–è¿ç®—ï¼Œå³å¯å¾—åˆ° x ä¸æ ‘æ ¹çš„å¥‡å¶æ€§å…³ç³»ã€‚<br>äºæ˜¯å¯¹äºæ¯ä¸€ä¸ªè¯¢é—®çš„(l , r , ans)ï¼Œæˆ‘ä»¬å‡è®¾å›ç­”â€oddâ€æ—¶ï¼Œans = 1ï¼Œâ€œevenâ€æ—¶ans = 0ï¼Œæˆ‘ä»¬ä»¤ x ã€ y åˆ†åˆ«ä»£è¡¨l-1å’Œrç¦»æ•£åŒ–åçš„åºå·ï¼Œå¦‚æœxå’Œyåœ¨åŒä¸€ä¸ªé›†åˆï¼Œåˆ™åˆ¤æ–­d[x] ^ d[y] æ˜¯å¦ç­‰äº ansï¼Œè‹¥ä¸ç­‰åˆ™å†²çªï¼›å¦‚æœxå’Œyä¸åœ¨åŒä¸€ä¸ªé›†åˆå†…ï¼Œåˆ™åˆå¹¶ x å’Œ y ï¼Œæ­¤æ—¶éœ€è¦æ³¨æ„å¦‚ä½•æ›´æ–°dæ•°ç»„ã€‚ï¼ˆä»£ç  code - 1 è¯¦è§£ï¼‰</p><p><strong>è§£é¢˜æ€è·¯2ï¼šæ‰©å±•åŸŸ</strong><br>æœ¬é¢˜è¿˜å¯ä»¥ä½¿ç”¨â€œæ‰©å±•åŸŸâ€çš„å¹¶æŸ¥é›†ã€‚<br>æˆ‘ä»¬æŠŠæ¯ä¸ªå˜é‡xæ‹†åˆ†æˆä¸¤ä¸ªèŠ‚ç‚¹x_oddå’Œx_evenã€‚å…¶ä¸­ç”¨ x_odd è¡¨ç¤º1~xæœ‰å¥‡æ•°ä¸ª1ï¼Œx_evenè¡¨ç¤ºæœ‰å¶æ•°ä¸ªã€‚æˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ªèŠ‚ç‚¹ç§°ä¸ºxçš„â€œå¥‡æ•°åŸŸâ€ä¸â€œå¶æ•°åŸŸâ€ã€‚<br>å¯¹äºæ¯ä¸ªé—®é¢˜ï¼Œå‡è®¾åœ¨ç¦»æ•£åŒ–åçš„ l-1 ä¸ r çš„å€¼åˆ†åˆ«æ˜¯xå’Œyï¼Œè®¾ansè¡¨ç¤ºè¯¥é—®é¢˜çš„å›ç­”ï¼ˆ0ä»£è¡¨å›ç­”å¶æ•°ä¸ªï¼Œ1ä»£è¡¨å›ç­”å¥‡æ•°ä¸ªï¼‰ã€‚</p><ul><li>è‹¥ans = 0ï¼Œx_odd ä¸ y_evenåœ¨åŒä¸€ä¸ªé›†åˆï¼Œåˆ™ä¸ç­”æ¡ˆçŸ›ç›¾ï¼›å¦åˆ™åˆå¹¶x_oddä¸y_oddï¼Œx_evenä¸y_evenï¼Œè¿™è¡¨ç¤º[l , r]ä¸­æœ‰å¶æ•°ä¸ª1ã€‚</li><li>è‹¥ans = 1ï¼Œx_oddä¸y_oddåœ¨åŒä¸€ä¸ªé›†åˆï¼Œåˆ™ä¸ç­”æ¡ˆçŸ›ç›¾ï¼›å¦åˆ™åˆå¹¶x_oddä¸y_evenï¼Œx_evenä¸y_oddã€‚</li></ul><p>ä»£ç è§code - 2.</p><h5 id="å‚è€ƒä¹¦ç›®"><a href="#å‚è€ƒä¹¦ç›®" class="headerlink" title="å‚è€ƒä¹¦ç›®"></a>å‚è€ƒä¹¦ç›®</h5><ul><li>ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹,æç…œä¸œ,P190.</li></ul><p><strong>ä»£ç ç¤ºä¾‹ï¼šcode - 1</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">21000</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Query</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l,r,ans;</span><br><span class="line">&#125; q[MAXN];</span><br><span class="line"><span class="keyword">int</span> a[MAXN],par[MAXN],d[MAXN],cnt = <span class="number">0</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    aæ•°ç»„ç”¨æ¥ç¦»æ•£åŒ–ï¼Œpar[x]ä»£è¡¨xçš„çˆ¶èŠ‚ç‚¹ç¼–å·ï¼Œd[x]ä»£è¡¨</span></span><br><span class="line"><span class="comment">    ä»xåˆ°æ ¹èŠ‚ç‚¹è·¯å¾„å’Œï¼Œcntä¹Ÿæ˜¯ç”¨äºç¦»æ•£åŒ–ã€‚</span></span><br><span class="line"><span class="comment">    è¿™é‡Œæ ¹èŠ‚ç‚¹å³é›†åˆçš„ä»£è¡¨èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(par[x] == x) <span class="keyword">return</span> x;   <span class="comment">//æ‰¾åˆ°æ ¹èŠ‚ç‚¹ï¼Œè¿”å›</span></span><br><span class="line">    <span class="keyword">int</span> root = Find(par[x]);    <span class="comment">//ä¸´æ—¶å­˜æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    d[x] ^= d[par[x]];          <span class="comment">//è·¯å¾„å‹ç¼©ï¼Œè·ç¦»æ•°ç»„dä¹Ÿåº”è¯¥æ›´æ–°</span></span><br><span class="line">    <span class="keyword">return</span> par[x] = root;       <span class="comment">//è·¯å¾„å‹ç¼©</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">char</span> rs[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%s"</span>,&amp;q[i].l,&amp;q[i].r,rs);</span><br><span class="line">        <span class="keyword">if</span>(rs[<span class="number">0</span>] == <span class="string">'o'</span>) q[i].ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> q[i].ans = <span class="number">0</span>;</span><br><span class="line">        a[cnt++] = q[i].l<span class="number">-1</span>;    <span class="comment">//è¿™é‡Œéœ€è¦å­˜l-1ï¼Œä¸ºäº†ä½¿lä¹ŸåŒ…å«åœ¨å†…</span></span><br><span class="line">        a[cnt++] = q[i].r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ä»¥ä¸‹ä¸¤è¡Œä»£ç ç¦»æ•£åŒ–ç”¨</span></span><br><span class="line">    sort(a,a+cnt);</span><br><span class="line">    <span class="keyword">int</span> len = unique(a,a+cnt)-a;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= len;i++) par[i] = i; <span class="comment">//åˆå§‹åŒ–çˆ¸çˆ¸æ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;      </span><br><span class="line">        <span class="comment">//å·¦å³è¾¹ç•Œåœ¨ç¦»æ•£åŒ–æ•°ç»„ä¸­çš„ç¼–å·ï¼š</span></span><br><span class="line">        <span class="keyword">int</span> x = lower_bound(a,a+len,q[i].l<span class="number">-1</span>)-a;</span><br><span class="line">        <span class="keyword">int</span> y = lower_bound(a,a+len,q[i].r)-a;  </span><br><span class="line">        <span class="comment">//å·¦å³è¾¹ç•Œçš„ç¥–å…ˆåˆ†åˆ«ä¸ºtaå’Œtb</span></span><br><span class="line">        <span class="keyword">int</span> ta = Find(x),tb = Find(y);</span><br><span class="line">        <span class="keyword">if</span>(ta == tb)&#123;   <span class="comment">//å¦‚æœå·²ç»åœ¨åŒä¸€ä¸ªé›†åˆå†…ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦çŸ›ç›¾</span></span><br><span class="line">            <span class="keyword">if</span>((d[x]^d[y]) != q[i].ans)&#123;<span class="comment">//çŸ›ç›¾çš„æ¡ä»¶å°±æ˜¯äº‹å®å’Œç»“æœä¸åŒ</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i<span class="number">-1</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            par[ta] = tb;d[ta] = d[x]^d[y]^q[i].ans;</span><br><span class="line">            <span class="comment">//è¿™é‡Œd[ta]çš„å€¼éœ€è¦æ¨å¯¼ä¸€ä¸‹ã€‚</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            æˆ‘ä»¬å°†xæ‰€åœ¨çš„é›†åˆå’Œyæ‰€åœ¨çš„é›†åˆåˆå¹¶ï¼Œé‚£ä¹ˆå°±éœ€è¦æ›´æ–°dæ•°ç»„</span></span><br><span class="line"><span class="comment">            è¿™é‡Œd[x]å­˜æ”¾çš„æ˜¯xåˆ°par[x]çš„è·ç¦»ï¼Œæ‰€ä»¥åˆå¹¶ä¸¤ä¸ªé›†åˆå¯¹äº</span></span><br><span class="line"><span class="comment">            éæ ¹èŠ‚ç‚¹æ¥è¯´å¹¶æ— å½±å“ï¼Œå…³é”®æ˜¯å¯¹äºä¸¤ä¸ªæ ¹d[ta]å’Œd[tb]å¦‚ä½•å¤„ç†</span></span><br><span class="line"><span class="comment">            å¦‚æœæˆ‘ä»¬å°†taä»£è¡¨çš„é›†åˆå½’äºtbä¸‹ï¼Œé‚£ä¹ˆå°±éœ€è¦æ›´æ–°d[ta],è€Œå·²çŸ¥</span></span><br><span class="line"><span class="comment">            ans = d[x]^d[y]^d[ta]ï¼Œå³xåˆ°yçš„æ€»è·¯å¾„ç­‰äºxåˆ°ta XOR yåˆ°tb XOR </span></span><br><span class="line"><span class="comment">            taåˆ°tbï¼›å¯¹ä¸Šå¼å˜å½¢ï¼Œå¾—ï¼šd[ta] = ans^d[x]^d[y],è€Œåä¸‰è€…æ˜¯å·²çŸ¥ï¼Œ</span></span><br><span class="line"><span class="comment">            æ•…å¯ä»¥æ±‚å‡ºd[ta]ã€‚</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,m);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>ä»£ç ç¤ºä¾‹ï¼šcode - 2</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,t = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2</span>*<span class="number">21000</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Query</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l,r,ans;</span><br><span class="line">&#125;Q[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[N],par[N];    <span class="comment">//aç”¨äºç¦»æ•£åŒ–ï¼Œparæ˜¯çˆ¸çˆ¸æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(par[x] == x) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">return</span> par[x] = Find(par[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> str[<span class="number">10</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%s"</span>,&amp;Q[i].l,&amp;Q[i].r,str);</span><br><span class="line">        Q[i].ans = str[<span class="number">0</span>] == <span class="string">'o'</span>?<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">        a[++t] = Q[i].l<span class="number">-1</span>;</span><br><span class="line">        a[++t] = Q[i].r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sort(a+<span class="number">1</span>,a+<span class="number">1</span>+t);</span><br><span class="line">    n = unique(a+<span class="number">1</span>,a+<span class="number">1</span>+t) - a- <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">2</span>*n;i++) par[i] = i;</span><br><span class="line">    <span class="comment">//å› ä¸ºæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸¤ä¸ªæ‰©å±•åŸŸï¼Œæ‰€ä»¥néœ€è¦*2</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x = lower_bound(a+<span class="number">1</span>,a+<span class="number">1</span>+n,Q[i].l<span class="number">-1</span>)-a;</span><br><span class="line">        <span class="keyword">int</span> y = lower_bound(a+<span class="number">1</span>,a+<span class="number">1</span>+n,Q[i].r)-a;</span><br><span class="line">        <span class="keyword">int</span> x_odd = x,x_even = x+n;</span><br><span class="line">        <span class="keyword">int</span> y_odd = y,y_even = y+n;</span><br><span class="line">        <span class="keyword">if</span>(Q[i].ans == <span class="number">0</span>)&#123;      </span><br><span class="line">            <span class="keyword">if</span>(Find(x_odd) == Find(y_even))&#123;    <span class="comment">//ç­”æ¡ˆä¸äº‹å®ä¸ç¬¦</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i<span class="number">-1</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125; </span><br><span class="line">            par[Find(x_odd)] = Find(y_odd);</span><br><span class="line">            par[Find(x_even)] = Find(y_even);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(Find(x_odd) == Find(y_odd))&#123;     <span class="comment">//ç­”æ¡ˆä¸äº‹å®ä¸ç¬¦</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i<span class="number">-1</span>); </span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            par[Find(x_odd)] = Find(y_even);    <span class="comment">//åˆå¹¶xä¸ºå¥‡ï¼Œyä¸ºå¶</span></span><br><span class="line">            par[Find(x_even)] = Find(y_odd);    <span class="comment">//åˆå¹¶xä¸ºå¶å’Œyä¸ºå¥‡</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,m);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è«é˜Ÿç®—æ³•</title>
      <link href="/2019/08/16/modui/"/>
      <url>/2019/08/16/modui/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>è«é˜Ÿç®—æ³•å¤§æ¦‚æœ‰åŸºç¡€è«é˜Ÿã€æ ‘å½¢è«é˜Ÿã€å¸¦ä¿®ï¼ˆå¸¦ä¿®æ”¹çš„ï¼‰è«é˜Ÿç­‰ç±»å‹ï¼Œæœ¬æ–‡ä»…ä»‹ç»åŸºç¡€è«é˜Ÿã€‚å¯ä»¥çœ‹ä½œè«é˜Ÿç®—æ³•çš„å…¥é—¨ã€‚<br>è«é˜Ÿç®—æ³•æ®è¯´æ˜¯2010å¹´å›½å®¶é›†è®­é˜Ÿçš„è«æ¶›å‘æ˜çš„ä¸€ä¸ªä¼˜åŒ–ç±»çš„ç®—æ³•ï¼Œç”±äºè«æ¶›ç»å¸¸æ‰“æ¯”èµ›åšé˜Ÿé•¿ï¼Œå¤§å®¶éƒ½å«ä»–è«é˜Ÿï¼Œè¯¥ç®—æ³•ä¹Ÿè¢«ç§°ä¸ºè«é˜Ÿç®—æ³•ã€‚å®ƒä½¿ç”¨æŒ‡é’ˆç§»åŠ¨ä»¥åŠåˆ†å—çš„æ€æƒ³å¯¹æœ´ç´ ç®—æ³•è¿›è¡Œä¼˜åŒ–ã€‚<br>è«é˜Ÿç®—æ³•æ˜¯ç¦»çº¿ç®—æ³•ï¼Œå¯ä»¥è§£å†³ä¸€ç±»ç¦»çº¿çš„åŒºé—´é—®é¢˜ï¼Œå¯¹äºåºåˆ—ä¸Šçš„åŒºé—´è¯¢é—®é—®é¢˜ï¼Œå¦‚æœä» [l,r] çš„ç­”æ¡ˆèƒ½å¤Ÿ O(1) æ‰©å±•åˆ° [lâˆ’1,r],[l+1,r],[l,r+1],[l,râˆ’1] çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ O(nâˆšn) çš„å¤æ‚åº¦å†…æ±‚å‡ºæ‰€æœ‰è¯¢é—®çš„ç­”æ¡ˆã€‚</p><h4 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h4><p><strong>SPOJ D-queryï¼š</strong> ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œæ¯æ¬¡è¯¢é—®ä¸€ä¸ªåŒºé—´å†…æœ‰å¤šå°‘ä¸ªä¸åŒçš„å…ƒç´ ã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong> </p><ol><li>æœ´ç´ æ€æƒ³<br>æ³¨æ„åˆ°è¯¢é—®æ²¡æœ‰å¼ºåˆ¶åœ¨çº¿ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¦»çº¿çš„æ–¹æ³•ã€‚é¦–å…ˆæˆ‘ä»¬è€ƒè™‘æ­¤ç±»é—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬å·²ç»è®¡ç®—å‡º[L , R]çš„ç­”æ¡ˆä»¥åŠä¸­é—´ç»“æœï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¾ç„¶å¯ä»¥åœ¨å¸¸æ•°æ—¶é—´å†…è®¡ç®—å‡º[L-1,R] , [L+1 , R] , [L , R-1] , [L , R+1]çš„ç­”æ¡ˆï¼Œå³ä¾¿æ‰€ç»™çš„è¯¢é—®å¹¶ä¸ä¸€å®šæ˜¯è¿™æ ·ç›¸å·®ä¸º1çš„åŒºé—´ï¼Œä½†è¿™ä¹Ÿå¯å‘äº†æˆ‘ä»¬è¦å°½å¯èƒ½å°†åŒºé—´èŒƒå›´ç›¸è¿‘çš„æ”¾åœ¨ä¸€èµ·è®¡ç®—ã€‚</li><li>ä¸ºä»€ä¹ˆå°†è¯¢é—®åŒºé—´ç›¸è¿‘çš„æ”¾åœ¨ä¸€èµ·è®¡ç®—å¯ä»¥èŠ‚çœæ—¶é—´å‘¢ï¼Ÿ<br>å› ä¸ºæˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªæŒ‡é’ˆï¼ˆpå’Œqï¼‰çš„å·¦å³ç§»åŠ¨æ¥ç»Ÿè®¡åŒºé—´ä¿¡æ¯ï¼Œæ˜¾ç„¶å¯¹äºç¨‹åºçš„æ¯æ¬¡è¿è¡Œï¼Œè¿™ä¸¤ä¸ªæŒ‡é’ˆçš„ç§»åŠ¨æ¬¡æ•°è¶Šå°‘è¶Šå¥½ï¼Œè¦æƒ³ç§»åŠ¨çš„å°½é‡å°‘ï¼Œæ˜¾ç„¶åŒºé—´ç›¸è¿‘çš„æ”¾åœ¨ä¸€èµ·æœ€å¥½ã€‚</li><li>å¦‚ä½•æ’åºï¼Ÿ<br>æŒ‰ç…§ä»¥ä¸Šæ€è·¯ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯å¯¹åŒºé—´è¿›è¡Œæ’åºï¼Œä½¿å¾—èŒƒå›´ç›¸è¿‘çš„è¯¢é—®åŒºé—´å°½é‡æ”¾åœ¨ä¸€èµ·ï¼›ä½†æ˜¯åŒºé—´æœ‰ä¸¤ä¸ªå…³é”®å­—ï¼ˆå·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬æŒ‰ç…§å·¦ç«¯ç‚¹ä¸¥æ ¼å‡åºï¼Œå†æŒ‰ç…§å³ç«¯ç‚¹ä¸¥æ ¼å‡åºï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“å°±æƒ³åˆ°ä¸€äº›åä¾‹æ¥è¯æ˜è¿™ç§æ–¹æ³•ä¸æ˜¯æœ€ä¼˜çš„ï¼Œä¾‹å¦‚ï¼š(1, 100), (2, 2), (3, 99), (4, 4), (5, 102), (6, 7)ã€‚æ˜¾ç„¶ä¸¥æ ¼å‡åºæ˜¯ä¸å¥½çš„ï¼Œå¾ˆå®¹æ˜“è¢«å‡ºé¢˜äººé’ˆå¯¹ï¼Œå¦‚æœèƒ½é€‚å½“çš„å‡å°‘å³ç«¯ç‚¹çš„ç§»åŠ¨æ¬¡æ•°ï¼Œé‚£ä¹ˆå³ä½¿å·¦ç«¯ç‚¹çš„ç§»åŠ¨æ¬¡æ•°å¢åŠ äº›è®¸ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ã€‚å› æ­¤æˆ‘ä»¬å°±è¦è®¾è®¡ä¸€ç§å‡è¡¡çš„ç®—æ³•ï¼Œä½¿å¾—å·¦å³ç«¯ç‚¹å¹¶ä¸ä¸€å®šä¸¥æ ¼æœ‰åºï¼Œä½†æ€»ä½“å¤æ‚åº¦ï¼ˆæŒ‡é’ˆç§»åŠ¨æ¬¡æ•°ï¼‰å°½é‡å°ã€‚<br>åˆ©ç”¨åˆ†å—æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸Šè¿°ç›®æ ‡ã€‚æˆ‘ä»¬å°†é•¿åº¦ä¸ºnçš„åºåˆ—åˆ†ä¸ºé•¿åº¦ä¸º$\sqrt{n}$çš„è‹¥å¹²å—ï¼Œå°†åŒºé—´<strong>æŒ‰ç…§å·¦ç«¯ç‚¹æ‰€åœ¨çš„å—çš„åºå·è¿›è¡Œæ’åºï¼Œå¦‚æœå—å·ç›¸åŒåˆ™æŒ‰ç…§å³ç«¯ç‚¹æ’åºã€‚</strong> å½“ç„¶æˆ‘ä»¬åªæ˜¯æ¦‚å¿µä¸Šåˆ†å—ï¼Œå¹¶ä¸ä¸€å®šéœ€è¦ä¸¥æ ¼å­˜å‚¨å—ã€‚ä¹‹åæˆ‘ä»¬åªéœ€è¦æŒ‰ç…§æ’åºå¥½æ˜¯é¡ºåºæŒ¨ä¸ªè®¡ç®—å³å¯ã€‚</li></ol><p>æ€»ç»“èµ·æ¥ä¸€å…±ä¸‰æ­¥ï¼šåˆ†å—ã€æ’åºã€è®¡ç®—ã€‚ç®—æ³•å¤æ‚åº¦ä¸º$O(N \sqrt{N})$</p><h4 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h4><p>å¯ä»¥å‘ç°æœ¬æ–‡æ˜¯åº”ç”¨å‹çš„ï¼Œå¯¹äºç®—æ³•çš„æ­£ç¡®æ€§è¯æ˜ä»¥åŠå¤æ‚åº¦è¯æ˜éƒ½æ²¡æœ‰æ¶‰åŠï¼Œè¿™æ–¹é¢çš„åŸå› ä¹‹ä¸€æ˜¯ç”±äºè¿™æ˜¯å…¥é—¨æ–‡ç« ï¼Œå†™å¤ªå¤šè¯æ˜åè€Œä»¤åˆå­¦è€…å®³æ€•ï¼Œå¦‚æœå­¦æœ‰ä½™åŠ›è‡ªç„¶å¯ä»¥æ‰¾ç›¸å…³è¯æ˜ï¼›ç„¶åå°±æ˜¯æ‹“å±•ï¼ŒæŒæ¡äº†åŸºæœ¬æ€æƒ³å†å»æ‹“å±•å°±è½»æ¾å¾ˆå¤šäº†ï¼Œæ‹“å±•æ–¹å‘å¯ä»¥å‘æ ‘å½¢è«é˜Ÿã€å¸¦ä¿®è«é˜Ÿç­‰å¸¸è§ç±»å‹æ‹“å±•ï¼ŒåŒæ—¶æ³¨æ„æ¯”è¾ƒè«é˜Ÿå’Œå…¶ä»–æ•°æ®ç»“æ„çš„å¼‚åŒä»¥åŠä¼˜åŠ£ã€‚</p><h4 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">31000</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Q = <span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],m;</span><br><span class="line"><span class="keyword">int</span> ans,sum[<span class="number">1010000</span>];<span class="comment">//ä¸€ä¸ªå…¨å±€ç­”æ¡ˆanså’Œæ ‡è®°æ•°ç»„sumæ˜¯å¿…è¦çš„ </span></span><br><span class="line"><span class="comment">//å½“ç„¶ä¹Ÿå¯ä»¥ç¦»æ•£åŒ– </span></span><br><span class="line"><span class="keyword">int</span> len;<span class="comment">//å—å¤§å°ï¼Œåœ¨è¯»å…¥è¯¢é—®å‰éœ€è¦å…ˆèµ‹å€¼ </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Query</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> l,r,block,id;</span><br><span class="line">Query()&#123;&#125;</span><br><span class="line">Query(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> id):l(l),r(r),id(id)&#123;</span><br><span class="line">block = l/len;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> Query &amp;B) <span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(block == B.block) <span class="keyword">return</span> block&amp;<span class="number">1</span>? r &lt; B.r : r &gt; B.r;</span><br><span class="line"><span class="comment">//å°ä¼˜åŒ–ï¼Œä½¿å¾—rå‘ˆæ³¢æµªå½¢ </span></span><br><span class="line"><span class="keyword">return</span> block &lt; B.block;</span><br><span class="line">&#125;</span><br><span class="line">&#125;query[Q];</span><br><span class="line">priority_queue&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt; q;</span><br><span class="line"><span class="comment">//å¢åŠ æˆ–å‡å°‘ä¸€ä¸ªxä½ç½®ä¸Šçš„æ•° </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Move</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">x = a[x]; </span><br><span class="line">sum[x] += v;</span><br><span class="line"><span class="keyword">if</span>(v &gt; <span class="number">0</span>) ans += sum[x] == <span class="number">1</span>;<span class="comment">//åˆ¤ç­‰æ˜¯ä¸ºäº†é˜²æ­¢é‡å¤è®¡æ•° </span></span><br><span class="line"><span class="keyword">else</span> ans -= sum[x] == <span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">len = <span class="built_in">sqrt</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">query[i] = Query(x,y,i);</span><br><span class="line">&#125;</span><br><span class="line">sort(query+<span class="number">1</span>,query+<span class="number">1</span>+m);</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span>,r = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="keyword">while</span>(l &lt; query[i].l) Move(l,<span class="number">-1</span>),l++;</span><br><span class="line"><span class="keyword">while</span>(l &gt; query[i].l) Move(l<span class="number">-1</span>,<span class="number">1</span>),l--;</span><br><span class="line"><span class="keyword">while</span>(r &gt; query[i].r) Move(r,<span class="number">-1</span>),r--;</span><br><span class="line"><span class="keyword">while</span>(r &lt; query[i].r) Move(r+<span class="number">1</span>,<span class="number">1</span>),r++;</span><br><span class="line">q.push(make_pair(-query[i].id,ans));<span class="comment">//å¤§æ ¹å †å˜ä¸ºå°æ ¹å † </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"><span class="keyword">int</span> x = q.top().second;q.pop();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><p>[1] å¼ ç‘¯å°å¼ºçš„<a href="https://www.cnblogs.com/CsOH/p/5904430.html" target="_blank" rel="noopener">åšå®¢</a>ï¼Œ2019.7.4<br>[2] ä¾‹é¢˜æµ‹è¯•åœ°å€<a href="https://vjudge.net/problem/SPOJ-DQUERY" target="_blank" rel="noopener">SPOJ-DQUERY</a></p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€†å…ƒæ¨¡æ¿</title>
      <link href="/2019/08/16/inv/"/>
      <url>/2019/08/16/inv/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†å‡ ç§æ±‚é€†å…ƒçš„æ–¹æ³•ï¼Œä½†æ˜¯å¯¹äºè¯æ˜å¹¶æœªç»™å‡ºï¼Œæ‰€ä»¥æœ¬æ–‡æ˜¯åäºåº”ç”¨å‹çš„ï¼Œå…¶åé™„å½•éƒ¨åˆ†çš„ä»£ç æ¨¡æ¿å¯ä»¥å‚è€ƒä½¿ç”¨ã€‚å…¶ä¸­æœ€å®¹æ˜“ç†è§£ä¹Ÿæœ€å®¹æ˜“å†™çš„æ˜¯è´¹é©¬å°å®šç†æ±‚é€†å…ƒï¼Œç„¶åæ›´åŠ å¸¸ç”¨çš„å°±æ˜¯æ±‚é˜¶ä¹˜çš„é€†å…ƒäº†ï¼Œé€šè¿‡O(N)çš„é¢„å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¸¸æ•°æ—¶é—´å†…æ±‚å‡ºç»„åˆæ•°C(n,m)åœ¨ mod Pä¸‹çš„å€¼ã€‚</p><h4 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1.æ¦‚å¿µ"></a>1.æ¦‚å¿µ</h4><p><strong>1.1 å®šä¹‰ï¼š</strong> é€†å…ƒç´ æ˜¯æŒ‡ä¸€ä¸ªå¯ä»¥å–æ¶ˆå¦ä¸€ç»™å®šå…ƒç´ è¿ç®—çš„å…ƒç´ ï¼Œåœ¨æ•°å­¦é‡Œï¼Œé€†å…ƒç´ å¹¿ä¹‰åŒ–äº†åŠ æ³•ä¸­çš„åŠ æ³•é€†å…ƒå’Œä¹˜æ³•ä¸­çš„å€’æ•°ã€‚</p><p><strong>1.2 æ•°è®ºä¸­å®šä¹‰ï¼š</strong> å¦‚æœæ»¡è¶³å…¬å¼ï¼Œa*b = 1ï¼ˆmod Pï¼‰ï¼Œåˆ™aæ˜¯bçš„é€†å…ƒï¼ŒåŒæ—¶bä¹Ÿæ˜¯açš„é€†å…ƒã€‚</p><p><strong>1.3 å¦ä¸€ç§å®šä¹‰ï¼š</strong> a*x  = 1 (mod P)ï¼Œå…¶ä¸­aä¸Päº’è´¨ï¼Œåˆ™ç§°xçš„æœ€å°æ•´æ•°ä¸ºaå…³äºPçš„é€†å…ƒã€‚</p><h4 id="2-é€†å…ƒçš„åº”ç”¨"><a href="#2-é€†å…ƒçš„åº”ç”¨" class="headerlink" title="2.é€†å…ƒçš„åº”ç”¨"></a>2.é€†å…ƒçš„åº”ç”¨</h4><p><strong>2.1 é™¤æ³•æ¨¡è¿ç®—ï¼š</strong> è®¾cä¸ºbåœ¨å¯¹På–æ¨¡çŠ¶æ€ä¸‹çš„é€†å…ƒï¼Œåœ¨æ±‚(a/b)modPæ—¶ï¼Œå¾ˆå¯èƒ½ä¼šå› ä¸ºbè¿‡å¤§è€Œè¶…è¿‡ç²¾åº¦èŒƒå›´ï¼Œè¿™æ—¶å€™å¯ä»¥å°†é™¤æ³•è½¬æ¢æˆä¹˜æ³•æ¥åšï¼Œï¼ˆa/bï¼‰mod P = (a <em> Invb) mod P = (a mod P)</em> (Invb mod P) mod Pã€‚</p><h4 id="3-æ±‚é€†å…ƒçš„å¸¸ç”¨æ–¹æ³•"><a href="#3-æ±‚é€†å…ƒçš„å¸¸ç”¨æ–¹æ³•" class="headerlink" title="3.æ±‚é€†å…ƒçš„å¸¸ç”¨æ–¹æ³•"></a>3.æ±‚é€†å…ƒçš„å¸¸ç”¨æ–¹æ³•</h4><h5 id="3-1-è´¹é©¬å°å®šç†"><a href="#3-1-è´¹é©¬å°å®šç†" class="headerlink" title="3.1 è´¹é©¬å°å®šç†"></a>3.1 è´¹é©¬å°å®šç†</h5><blockquote><p>è´¹é©¬å°å®šç†ï¼šè‹¥pä¸ºç´ æ•°ï¼Œåˆ™æœ‰$a^{P-1} \equiv 1(mod P)$<br>æ¨è®ºï¼š$a * a^{P-2} \equiv 1(mod P)$<br>æ•…$a^{P-2}$å°±æ˜¯aå…³äºPçš„ä¸€ä¸ªé€†å…ƒ</p></blockquote><p><strong>3.1.1 ä»£ç å®ä¾‹ï¼š</strong> è§é™„å½•éƒ¨åˆ†code-1ã€‚</p><p><strong>3.1.2 å¤æ‚åº¦åˆ†æï¼š</strong> æ±‚å•ä¸ªé€†å…ƒçš„æ—¶é—´å¤æ‚åº¦æ˜¯lg(Mod)ã€‚</p><h5 id="3-2-æ‹“å±•æ¬§å‡ é‡Œå¾—ç®—æ³•"><a href="#3-2-æ‹“å±•æ¬§å‡ é‡Œå¾—ç®—æ³•" class="headerlink" title="3.2 æ‹“å±•æ¬§å‡ é‡Œå¾—ç®—æ³•"></a>3.2 æ‹“å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</h5><h5 id="3-3-é€†å…ƒçº¿æ€§ç­›"><a href="#3-3-é€†å…ƒçº¿æ€§ç­›" class="headerlink" title="3.3 é€†å…ƒçº¿æ€§ç­›"></a>3.3 é€†å…ƒçº¿æ€§ç­›</h5><blockquote><p>é€’æ¨å¼ï¼šinv[i] = (Mod-Mod / i) <em> inv[Mod% i]%Mod<br>å¦‚æœè¦ä¿è¯ç»“æœä¸ºæ­£ï¼š inv[i] = (Mod-Mod / i) </em> inv[Mod% i]%Mod<br>è¯æ˜ï¼š</p></blockquote><p><strong>3.3.1 ä»£ç ç¤ºä¾‹ï¼š</strong> è§é™„å½•éƒ¨åˆ†code-2ã€‚<br><strong>3.3.2 å¤æ‚åº¦åˆ†æï¼š</strong> O(N)ã€‚</p><h5 id="3-4æ±‚é˜¶ä¹˜çš„é€†å…ƒ"><a href="#3-4æ±‚é˜¶ä¹˜çš„é€†å…ƒ" class="headerlink" title="3.4æ±‚é˜¶ä¹˜çš„é€†å…ƒ"></a>3.4æ±‚é˜¶ä¹˜çš„é€†å…ƒ</h5><blockquote><p>é€’æ¨å¼ï¼šinv[i] = inv[i+1] * (i + 1) % Mod<br>è¯æ˜ï¼š</p></blockquote><p><strong>3.4.1ä»£ç ç¤ºä¾‹ï¼š</strong> è§é™„å½•éƒ¨åˆ†code-3.ã€‚</p><h4 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h4><p><strong>code-1ï¼šè´¹é©¬å°å®šç†æ±‚é€†å…ƒ</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">#include&lt;cstdio&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">const int N = 100010;</span><br><span class="line">const int P = 1e5+7;</span><br><span class="line">typedef long long ll;</span><br><span class="line">ll Finv[N];</span><br><span class="line">ll qpow(ll x,ll p,ll m)&#123;//å¿«é€Ÿå¹‚ç®—æ³• </span><br><span class="line">ll res = 1;</span><br><span class="line">while(p)&#123;</span><br><span class="line">if(p&amp;1)res =res*x%m;</span><br><span class="line">x = x*x%m;</span><br><span class="line">p &gt;&gt;= 1;</span><br><span class="line">&#125;</span><br><span class="line">return res;</span><br><span class="line">&#125;</span><br><span class="line">void Init()&#123;//ç”¨æ¥æ±‚é€†å…ƒ </span><br><span class="line">Finv[1] = 1;</span><br><span class="line">for(int i = 2;i &lt; N;i++)</span><br><span class="line">Finv[i] = qpow(i,P-2,P);</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">Init();</span><br><span class="line">for(int i = 1;i &lt; N;i++)</span><br><span class="line">cout &lt;&lt; Finv[i] &lt;&lt; &quot; &quot;;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>code-2ï¼šé€†å…ƒçº¿æ€§ç­›</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">#include&lt;cstdio&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">typedef long long ll;</span><br><span class="line">const int N = 100010;</span><br><span class="line">const int P = 1e5+7;</span><br><span class="line">ll inv[N];</span><br><span class="line">void Inv()&#123;</span><br><span class="line">inv[0] = inv[1] = 1;</span><br><span class="line">for(ll i = 2;i &lt; N;i++)&#123;</span><br><span class="line">inv[i] = (P - P/i)*inv[P%i]%P;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">Inv();</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>code-3æ±‚é˜¶ä¹˜çš„é€†å…ƒ</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll Finv[N],F[N];<span class="comment">//Få­˜é˜¶ä¹˜ï¼ŒFinvå­˜å¯¹åº”é€†å…ƒ </span></span><br><span class="line"><span class="function">ll <span class="title">Qpow</span><span class="params">(ll x,ll p,ll m)</span></span>&#123; </span><br><span class="line">ll res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(p)&#123;</span><br><span class="line"><span class="keyword">if</span>(p&amp;<span class="number">1</span>)res =res*x%m;</span><br><span class="line">x = x*x%m;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">F[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(ll i = <span class="number">1</span>;i &lt; N;i++)</span><br><span class="line">F[i] = F[i<span class="number">-1</span>]*i%P; </span><br><span class="line">Finv[N<span class="number">-1</span>] = Qpow(F[N<span class="number">-1</span>],P<span class="number">-2</span>,P);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = N<span class="number">-1</span>;i &gt; <span class="number">0</span>;i--)</span><br><span class="line">Finv[i<span class="number">-1</span>] = Finv[i]*i%P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Init();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; N;i++)</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; Finv[i]*F[i]%P &lt;&lt; <span class="string">"\t"</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°è®º </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½è¿ç®—</title>
      <link href="/2019/08/16/bit-cal/"/>
      <url>/2019/08/16/bit-cal/</url>
      
        <content type="html"><![CDATA[<p><strong>éœ€è¦æŒæ¡çš„çŸ¥è¯†ï¼š</strong></p><ul><li>åŸç ã€åç ã€è¡¥ç </li><li>æŒ‰ä½æˆ–</li><li>æŒ‰ä½ä¸</li><li>å¼‚æˆ–</li><li>é</li><li>ç§»ä½è¿ç®—</li><li>lowbitçš„å®ç°</li><li>è¿ç®—ç¬¦ä¼˜å…ˆçº§<h5 id="åŸç ã€åç ã€è¡¥ç "><a href="#åŸç ã€åç ã€è¡¥ç " class="headerlink" title="åŸç ã€åç ã€è¡¥ç "></a>åŸç ã€åç ã€è¡¥ç </h5><strong>åŸç ï¼š</strong> æ˜¯æœ€ç®€å•çš„æœºå™¨æ•°è¡¨ç¤ºæ³•ã€‚ç”¨æœ€é«˜ä½è¡¨ç¤ºç¬¦å·ä½ï¼Œâ€˜1â€™è¡¨ç¤ºè´Ÿå·ï¼Œâ€˜0â€™è¡¨ç¤ºæ­£å·ã€‚å…¶ä»–ä½å­˜æ”¾è¯¥æ•°çš„äºŒè¿›åˆ¶çš„ç»å¯¹å€¼ã€‚<blockquote><p>1010  ï¼š æœ€é«˜ä½ä¸ºâ€˜1â€™,è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè´Ÿæ•°ï¼Œå…¶ä»–ä¸‰ä½ä¸ºâ€˜010â€™ï¼Œ<br>å³ï¼ˆ0<em> 2^2ï¼‰+ï¼ˆ1</em> 2^1ï¼‰+ï¼ˆ0* 2^0ï¼‰=2ï¼ˆâ€˜^â€™è¡¨ç¤ºå¹‚è¿ç®—ç¬¦ï¼‰<br>æ‰€ä»¥1010è¡¨ç¤ºåè¿›åˆ¶æ•°ï¼ˆ-2ï¼‰ã€‚</p></blockquote></li></ul><p><strong>é¢ä¸´é—®é¢˜ï¼š</strong> åŸç ä¸‹ï¼Œæ­£æ•°ç›¸åŠ æ‰€å¾—ç»“æœæ­£ç¡®ï¼Œä½†æ˜¯æ­£æ•°å’Œè´Ÿæ•°ç›¸åŠ å‡ºé”™ã€‚</p><hr><p><strong>åç ï¼š</strong> æ­£æ•°çš„åç è¿˜æ˜¯ç­‰äºåŸç ï¼Œè´Ÿæ•°çš„åç å°±æ˜¯ä»–çš„åŸç é™¤ç¬¦å·ä½å¤–ï¼ŒæŒ‰ä½å–åã€‚</p><blockquote><p>3æ˜¯æ­£æ•°ï¼Œåç ä¸åŸç ç›¸åŒï¼Œåˆ™å¯ä»¥è¡¨ç¤ºä¸º0011<br>-3çš„åŸç æ˜¯1011ï¼Œç¬¦å·ä½ä¿æŒä¸å˜ï¼Œä½ä¸‰ä½ï¼ˆ011ï¼‰æŒ‰ä½å–åå¾—ï¼ˆ100ï¼‰<br>æ‰€ä»¥-3çš„åç ä¸º1100</p></blockquote><p><strong>é¢ä¸´é—®é¢˜ï¼š</strong> æ­£æ•°ç›¸åŠ æ‰€å¾—ç»“æœæ­£ç¡®ï¼Œæ­£è´Ÿç›¸åŠ æ‰€å¾—ç»“æœæ­£ç¡®ï¼Œè´Ÿè´Ÿç›¸åŠ ç»“æœå‡ºé”™ã€‚</p><hr><p><strong>è¡¥ç ï¼š</strong> æ­£æ•°çš„è¡¥ç ç­‰äºä»–çš„åŸç ï¼Œè´Ÿæ•°çš„è¡¥ç ç­‰äºåç +1ã€‚</p><p>ä¸Šè¿°ç»™å‡ºçš„æ˜¯è¡¥ç çš„æ±‚æ³•ï¼Œè¡¥ç çš„çœŸæ­£å®šä¹‰æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦è¿™æ ·å®šä¹‰ï¼Ÿ</p><p>é‡‡ç”¨è¡¥ç çš„è¡¨ç¤ºæ–¹å¼çš„<strong>å¥½å¤„</strong>ï¼Œä¸€æ˜¯å¯ä»¥å°†å‡æ³•è½¬åŒ–ä¸ºåŠ æ³•è¿ç®—ï¼Œç®€åŒ–è¿ç®—å¤æ‚åº¦ï¼›äºŒæ˜¯å¯ä»¥è®©ç¬¦å·ä½ä½œä¸ºæ•°å€¼ç›´æ¥å‚ä¸è¿ç®—ï¼Œæ‰€å¾—ç»“æœä»ç„¶æ˜¯æ­£ç¡®çš„ï¼Œå³ç¬¦å·ä½æ— éœ€å•ç‹¬å¤„ç†ã€‚</p><h5 id="æŒ‰ä½æˆ–ã€ä¸ã€å¼‚æˆ–ã€é"><a href="#æŒ‰ä½æˆ–ã€ä¸ã€å¼‚æˆ–ã€é" class="headerlink" title="æŒ‰ä½æˆ–ã€ä¸ã€å¼‚æˆ–ã€é"></a>æŒ‰ä½æˆ–ã€ä¸ã€å¼‚æˆ–ã€é</h5><p>åœ¨cè¯­è¨€ä¸­ï¼Œæ˜¯å°†ä¸€ä¸ªåè¿›åˆ¶æ•´æ•°ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼‰è½¬åŒ–ä¸ºäºŒè¿›åˆ¶ä½ï¼Œç„¶åå†å¯¹äºŒè¿›åˆ¶æ•°çš„æ¯ä¸€ä½å¯¹åº”è¿›è¡Œæˆ–ã€ä¸ã€å¼‚æˆ–ã€éæ“ä½œã€‚</p><h5 id="ä½ç§»è¿ç®—"><a href="#ä½ç§»è¿ç®—" class="headerlink" title="ä½ç§»è¿ç®—"></a>ä½ç§»è¿ç®—</h5><p>ä½ç§»è¿ç®—åˆ†ä¸ºå·¦ç§»å’Œç®—æ•°å³ç§»ï¼Œå…¶ä¸­<strong>å·¦ç§»</strong>æ˜¯æŒ‡åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹æŠŠæ‰€æœ‰ä½æ•°å­—åŒæ—¶å‘å·¦ç§»åŠ¨ä¸€ä½ï¼Œé«˜ä½è¶Šç•Œåèˆå¼ƒï¼Œä½ä½ä»¥0è¡¥å……ã€‚å…¶ä¸­è¶Šç•Œæ˜¯æŒ‡ï¼Œintå‹å˜é‡ä¸€èˆ¬ä»…æœ‰32ä½ï¼Œå¦‚æœå·¦ç§»åè¶…è¿‡äº†32ä½åˆ™èˆå¼ƒè¶…è¿‡çš„éƒ¨åˆ†ã€‚<br><strong>ç®—æ•°å³ç§»</strong>æ˜¯æŒ‡åœ¨äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºä¸‹æŠŠæ•°å­—åŒæ—¶å‘å³ç§»åŠ¨ï¼Œé«˜ä½ä»¥ç¬¦å·ä½å¡«å……ï¼Œä½ä½è¶Šç•Œåèˆå¼ƒã€‚ç®—æ•°å³ç§»ç­‰äºé™¤ä»¥2å‘ä¸‹å–æ•´ï¼Œï¼ˆ-5ï¼‰&gt;&gt;1 = -3 , 3 &gt;&gt; 1 = 2ã€‚<br>å¯ä»¥å‘ç°ç®—æ•°å³ç§»å¹¶ä¸ç­‰åŒäºcè¯­è¨€ä¸­çš„æ•´æ•°/2ï¼Œå€¼å¾—ä¸€æçš„æ˜¯cè¯­è¨€ä¸­çš„æ•´æ•°/2æ˜¯â€œé™¤ä»¥2å‘0å–æ•´â€ã€‚<br><strong>é€»è¾‘å³ç§»</strong>æ˜¯åœ¨è¡¥ç è¡¨ç¤ºä¸‹æŠŠæ‰€æœ‰æ•°å­—åŒæ—¶å³ç§»ï¼Œé«˜ä½ä»¥0è¡¥å……ï¼Œä½ä½è¶Šç•Œåèˆå¼ƒï¼Œä½†æ˜¯C++æ²¡æœ‰è§„å®šå®ç°æ–¹å¼ï¼Œä¸€èˆ¬ç¼–è¯‘å™¨éƒ½ä¼šå®ç°ç®—æ•°å³ç§»ã€‚</p><h5 id="lowbitçš„å®ç°"><a href="#lowbitçš„å®ç°" class="headerlink" title="lowbitçš„å®ç°"></a>lowbitçš„å®ç°</h5><p><strong>å®šä¹‰ï¼š</strong> lowbit( n )æ˜¯å–å‡ºéè´Ÿæ•´æ•° n åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹æœ€ä½ä½çš„ 1 ä»¥åŠå®ƒåé¢çš„0æ‰€æ„æˆçš„åè¿›åˆ¶æ•°å€¼ã€‚<br><strong>å®ç°ï¼š</strong><br>è‹¥ n &gt; 0ï¼Œä¸”ç¬¬ k ä½æ˜¯1ï¼Œç¬¬ 0 ~ k-1 ä½éƒ½æ˜¯0ã€‚<br>å…ˆå°†næŒ‰ä½å–åï¼Œé‚£ä¹ˆç¬¬ k ä½å˜æˆäº†0ï¼Œç¬¬ 0 ~k ä½å˜æˆäº†1ã€‚<br>å†ä»¤n = n+1ï¼Œé‚£ä¹ˆæ˜¾ç„¶é€šè¿‡ä¸€ç³»åˆ—è¿›ä½ï¼Œç¬¬ 0~k-1 ä½éƒ½å˜æˆäº†0ï¼Œè€Œç¬¬ k ä½åˆå˜æˆäº†1ã€‚<br>æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæœ€åˆçš„ n ï¼Œä¸æœ€ç»ˆçš„nåªæœ‰ç¬¬ 0~k ä½ç›¸åŒï¼Œæ›´é«˜çš„ä½éƒ½æ°å¥½ç›¸åï¼ˆä¸¾ä¸ªä¾‹å­æ¨å¯¼è¯•è¯•ï¼‰ï¼Œäºæ˜¯å°†å®ƒä»¬æŒ‰ä½ä¸å°±å¾—åˆ°äº† 0~k ä½çš„æ•°å€¼ï¼Œè¿™ä¸ªå€¼å°±æ˜¯æˆ‘ä»¬æ‰€æ±‚çš„ç­”æ¡ˆã€‚</p><h5 id="è¿ç®—ç¬¦ä¼˜å…ˆçº§"><a href="#è¿ç®—ç¬¦ä¼˜å…ˆçº§" class="headerlink" title="è¿ç®—ç¬¦ä¼˜å…ˆçº§"></a>è¿ç®—ç¬¦ä¼˜å…ˆçº§</h5><p>ä¸ç¡®å®šå°±åŠ æ‹¬å·ï¼ï¼ä½ç§»è¿ç®—æœ€å¥½åŠ æ‹¬å·ï¼<br><a href="https://baike.baidu.com/item/%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/4752611?fr=aladdin" target="_blank" rel="noopener">ç™¾åº¦ç™¾ç§‘ï¼Œè¿ç®—ç¬¦ä¼˜å…ˆçº§è¡¨</a></p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒç»´stè¡¨</title>
      <link href="/2019/08/16/st2/"/>
      <url>/2019/08/16/st2/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>æˆ‘ä»¬çŸ¥é“ä¸€ç»´çš„stè¡¨åœ¨ç»è¿‡é¢„å¤„ç†åå¯ä»¥åœ¨O(1)æ—¶é—´å†…æŸ¥è¯¢ä»»æ„åŒºé—´çš„æå€¼ï¼Œè™½ç„¶å…¶æ˜¯ç¦»çº¿ç®—æ³•ï¼Œä½†èƒœåœ¨ä»£ç çŸ­å°æ˜“å†™ã€‚è€Œåœ¨äºŒç»´RMQï¼ˆåŒºé—´æœ€å€¼æŸ¥è¯¢ï¼‰é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥é‡‡ç”¨stç®—æ³•è§£å†³é—®é¢˜ï¼Œåªä¸è¿‡æˆ‘ä»¬éœ€è¦ä»ä¸€ç»´æ‹“å±•åˆ°äºŒç»´ï¼Œå½“ç„¶é€‚ç”¨èŒƒå›´ä¾ç„¶æ˜¯ç¦»çº¿ã€‚äºŒç»´stè¡¨ä»ç„¶æ˜¯ç”¨å€å¢æ€æƒ³ï¼Œå¦‚æœç†è§£äº†ä¸€ç»´çš„stè¡¨ï¼Œé‚£ä¹ˆå¯¹äºäºŒç»´çš„ä¹Ÿä¸éš¾ç†è§£ã€‚</p><h4 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h4><p>ç»™å®šä¸€ä¸ªn* nçš„çŸ©é˜µä»¥åŠä¸€ä¸ªæ•´æ•°bå’Œkï¼Œå…±æœ‰kæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™å‡ºè¾¹é•¿ä¸ºbçš„å­çŸ©é˜µçš„å·¦ä¸Šè§’çš„è¡Œå’Œåˆ—(r,c)ï¼Œè¯·å›ç­”è¯¥å­çŸ©é˜µå†…çš„æœ€å¤§å€¼å’Œæœ€å°å€¼çš„å·®æ˜¯å¤šå°‘ã€‚</p><h4 id="ç®—æ³•æ€è·¯"><a href="#ç®—æ³•æ€è·¯" class="headerlink" title="ç®—æ³•æ€è·¯"></a>ç®—æ³•æ€è·¯</h4><p><strong>å˜é‡å®šä¹‰ï¼š</strong><br><code>st[r][c][k]</code> å­˜æ”¾ä»¥(r , c)ä¸ºå·¦ä¸Šè§’çš„è¾¹é•¿ä¸º$2^k$ä¸ªå…ƒç´ çš„çŸ©é˜µçš„æœ€å¤§å€¼ã€‚<br><code>a[n][n]</code> ç”¨æ¥å­˜æ”¾çŸ©é˜µä¸­çš„å…ƒç´ ã€‚</p><p><strong>æŸ¥è¯¢æ“ä½œï¼š</strong><br>å‡è®¾æˆ‘ä»¬çš„stè¡¨å·²ç»æ›´æ–°å®Œæ¯•ï¼Œæ­¤æ—¶<code>st[r][c][k]</code> ä¸­å­˜æ”¾çš„æ˜¯ä»¥(r , c)ä¸ºå·¦ä¸Šè§’çš„è¾¹é•¿ä¸º$2^k$ çš„çŸ©é˜µå†…çš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªæŸ¥è¯¢(a , b , c) å³æŸ¥è¯¢ä»¥(a , b)ä¸ºå·¦ä¸Šè§’ï¼Œè¾¹é•¿ä¸º c çš„çŸ©é˜µå†…çš„æœ€å¤§å€¼è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ<br>æ˜¾ç„¶å’Œä¸€ç»´ä¸€æ ·ï¼Œç”±äºæˆ‘ä»¬çš„stè¡¨ä¸­å­˜æ”¾çš„åŒºé—´é•¿åº¦æ˜¯2çš„æ¬¡æ–¹é¡¹ï¼Œå› æ­¤å¦‚æœè¾¹é•¿å¹¶ä¸æ°å¥½æ˜¯2çš„æ¬¡æ–¹é¡¹ï¼Œé‚£ä¹ˆå°±æ— æ³•é€šè¿‡ä¸€æ¬¡è®¿é—®stè¡¨æ±‚å¾—ï¼Œéœ€è¦é€šè¿‡å‡ ä¸ªé‡å åŒºé—´å¾—å‡ºç»“æœã€‚åœ¨äºŒç»´RMQä¸­ï¼Œå°±ä½“ç°ä¸ºå°†ä¸€ä¸ªå¤§çŸ©é˜µæŸ¥è¯¢åˆ†ä¸º4ä¸ªå°çŸ©é˜µæŸ¥è¯¢ã€‚<br>ä¸‹é¢æˆ‘ä»¬å…·ä½“æ¥è®²ä¸€ä¸‹å¦‚ä½•åˆ’åˆ†æŸ¥è¯¢åŒºé—´ã€‚å‡è®¾æˆ‘ä»¬è¦æŸ¥è¯¢çš„æ˜¯ä»¥ï¼ˆaï¼Œbï¼‰ä¸ºå·¦ä¸Šè§’ï¼Œè¾¹é•¿ä¸º c çš„çŸ©é˜µå†…çš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆå‡è®¾ $k = log_2^c$ å‘ä¸‹å–æ•´ï¼Œé‚£ä¹ˆæ˜¾ç„¶<code>st[a][b][k]</code>æ˜¯ä¸€ä¸ªå¦‚ä¸‹å›¾(a)ä¸­æ˜¾ç¤ºçš„ä¸€ä¸ªå°çŸ©é˜µã€‚</p><p><img src="/2019/08/16/st2/1.png" alt="1"></p><p>é‚£ä¹ˆæ˜¾è€Œæ˜“è§ï¼Œ<code>st[a][b+c-(1&lt;&lt;k)+1][k]</code>æ­£å¦‚ï¼ˆbï¼‰ä¸­çš„è“è‰²çŸ©å½¢ä¸€æ ·è¦†ç›–äº†ä»¥å³ä¸Šè§’ä¸ºé¡¶ç‚¹çš„çŸ©é˜µã€‚åŒç†ï¼Œæˆ‘ä»¬å…±éœ€è¦å››ä¸ªçŸ©å½¢æ¥è¦†ç›–æ•´ä¸ªå¤§çŸ©å½¢ï¼Œå¦‚ï¼ˆcï¼‰æ‰€ç¤ºã€‚å› æ­¤å¯¹äºä»»æ„è¾¹é•¿çš„æ­£æ–¹å½¢ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥è®¡ç®—å‡ºå…¶è¦†ç›–é¢ç§¯çš„æœ€å¤§å€¼ã€‚å› ä¸ºæ±‚æå€¼æ“ä½œæ˜¯å…è®¸åŒºé—´é‡å çš„( [1 , 10] çš„æœ€å¤§å€¼å¯ä»¥ç”±[1 , 6] çš„æœ€å¤§å€¼å’Œ[2 , 10]çš„æœ€å¤§å€¼å¾—å‡º )ï¼Œå› æ­¤ä¸Šè¿°åˆ’åˆ†æ–¹æ³•è™½æœ‰åŒºé—´é‡å ï¼Œä½†å¯¹æœ€ç»ˆç­”æ¡ˆæ²¡æœ‰å½±å“ï¼ˆæ±‚å’Œåˆ™ä¸è¡Œï¼‰ã€‚<br>æ€»ç»“èµ·æ¥ï¼Œè‹¥è®¾æœ€ç»ˆè¦æ±‚çš„ç­”æ¡ˆä¸ºansï¼Œåˆ™ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä»¤t1 = st[a][b][c];</span><br><span class="line">ä»¤t2 = st[a][b+c-(1&lt;&lt;k)+1][c];</span><br><span class="line">ä»¤t3 = st[a+c-(1&lt;&lt;k)+1][b][c];</span><br><span class="line">ä»¤t4 = st[a+c-(1&lt;&lt;k)+1][b+c-(1&lt;&lt;k)+1][c];</span><br><span class="line">ans = max&#123;t1 , t2 , t3 , t4&#125;ï¼›</span><br></pre></td></tr></table></figure></p><p>å› æ­¤æˆ‘ä»¬å¾—è¯äº†ï¼Œåˆ©ç”¨ä¸Šè¿°å®šä¹‰çš„stè¡¨ï¼Œç¡®å®å¯ä»¥åœ¨å¸¸æ•°æ—¶é—´å†…æ±‚å‡ºç›®æ ‡çŸ©é˜µçš„æœ€å¤§å€¼ã€‚</p><p><strong>æ›´æ–°stè¡¨ï¼ˆé¢„å¤„ç†ï¼‰</strong><br>æˆ‘ä»¬åœ¨ä¸€å¼€å§‹å°±æåˆ°è¿‡ï¼Œstè¡¨æ˜¯ç¦»çº¿ç®—æ³•ï¼Œ å³ä¸æ”¯æŒä¿®æ”¹æ“ä½œï¼Œå› æ­¤ä»¥æ­¤é¢„å¤„ç†ä¹‹åä¾¿åªèƒ½è¿›è¡ŒæŸ¥è¯¢ã€‚é¢„å¤„ç†æ—¶é—´å¤æ‚åº¦ä¸º$O(N^2log_2N)$ã€‚é¢„å¤„ç†ç”¨åˆ°äº†åŠ¨æ€è§„åˆ’çš„æ€æƒ³ã€‚<br>æ›´æ–°ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œæ›´æ–°ä¸€ä¸ªå¤§çŸ©å½¢ï¼Œéœ€è¦ç”¨åˆ°4ä¸ªå°çŸ©å½¢ã€‚çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><p><code>st[i][j][k] = Max( st[i][j][k-1] , st[i+(1&lt;&lt;k-1)][j][k-1] , st[i][j+(1&lt;&lt;k-1)][k-1] , st[i+(1&lt;&lt;k-1)][j+(1&lt;&lt;k-1)][k-1]);</code></p><p>ä¸ºä»€ä¹ˆè¿™ä¸ªå¼å­æˆç«‹å‘¢ï¼Ÿå¦‚æœä»å¼å­ä¸Šçœ‹ï¼Œ$2^{k-1} + 2^{k-1} = 2^k$ï¼Œå› æ­¤ä¿©ä¸ªå°åŒºé—´å¯ä»¥æ›´æ–°ä¸€ä¸ªå¤§åŒºé—´ï¼Œæ‹“å±•åˆ°äºŒç»´ä¸Šå‘¢ï¼Œå°±æ˜¯4ä¸ªå°çŸ©é˜µæ›´æ–°ä¸€ä¸ªå¤§çŸ©é˜µã€‚å¦‚æœç”¨å›¾æ¥æè¿°ï¼Œå°±å¦‚ï¼ˆdï¼‰æ‰€ç¤ºï¼Œå››ä¸ªå°çŸ©å½¢æ„æˆä¸€ä¸ªå¤§çŸ©å½¢ï¼Œè€Œå¤§çŸ©å½¢çš„è¾¹é•¿æ˜¯å°çŸ©å½¢çš„2å€ã€‚äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å››ä¸ªå°çŸ©é˜µçš„å€¼æ¥æ›´æ–°å¤§çŸ©é˜µçš„å€¼ã€‚<br><img src="/2019/08/16/st2/2.png" alt="2"></p><h4 id="ä¾‹é¢˜-HAOI2007ç†æƒ³çš„æ­£æ–¹å½¢"><a href="#ä¾‹é¢˜-HAOI2007ç†æƒ³çš„æ­£æ–¹å½¢" class="headerlink" title="ä¾‹é¢˜ HAOI2007ç†æƒ³çš„æ­£æ–¹å½¢"></a>ä¾‹é¢˜ <a href="https://www.luogu.org/problem/P2216" target="_blank" rel="noopener">HAOI2007ç†æƒ³çš„æ­£æ–¹å½¢</a></h4><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>æœ¬é¢˜å°±æ˜¯ä¸€ä¸ªäºŒç»´RMQé—®é¢˜çš„è£¸é¢˜ï¼Œå’Œä¸Šè¿°æ¨¡å‹ä¸åŒçš„æ˜¯ï¼Œå…¶æ˜¯ä¸€ä¸ªé•¿aå®½bçš„çŸ©å½¢ï¼Œè€Œéæ­£æ–¹å½¢ã€‚ä¸ç®¡æ˜¯çŸ©å½¢è¿˜æ˜¯æ­£æ–¹å½¢ï¼Œæˆ‘ä»¬çš„æ›´æ–°å’ŒæŸ¥è¯¢éƒ½æ˜¯åˆ’åˆ†ä¸º4ä¸ªå­çŸ©é˜µæ¥æ›´æ–°æˆ–æŸ¥è¯¢ï¼Œå› æ­¤åªéœ€å¯¹ä»£ç ç¨ä½œæ”¹å˜å³å¯ï¼ŒåŸºæœ¬æ²¡å¤ªå¤§å˜åŒ–ï¼Œé¢„å¤„ç†éƒ½æ˜¯$O(N^2logN)$ï¼ŒæŸ¥è¯¢ä¹Ÿéƒ½æ˜¯O(1)ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">int</span> a[N][N],n,m,len,Log[N];</span><br><span class="line"><span class="keyword">int</span> st[<span class="number">3</span>][N][N][<span class="number">15</span>];<span class="comment">//0æœ€å°ï¼Œ1æœ€å¤§å€¼ </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> mx = a;<span class="keyword">if</span>(mx &lt; b) mx = b;<span class="keyword">if</span>(mx &lt; c) mx = c;<span class="keyword">if</span>(mx &lt; d) mx = d;</span><br><span class="line"><span class="keyword">return</span> mx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> mi = a;<span class="keyword">if</span>(mi &gt; b) mi = b;<span class="keyword">if</span>(mi &gt; c) mi = c;<span class="keyword">if</span>(mi &gt; d) mi = d;</span><br><span class="line"><span class="keyword">return</span> mi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; N;i++) Log[i] = Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= m;j++) </span><br><span class="line">st[<span class="number">0</span>][i][j][<span class="number">0</span>] = st[<span class="number">1</span>][i][j][<span class="number">0</span>] = a[i][j];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= <span class="number">12</span>;k++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span>&lt;&lt;k)<span class="number">-1</span> &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j + (<span class="number">1</span>&lt;&lt;k)<span class="number">-1</span> &lt;= m;j++)&#123;</span><br><span class="line"><span class="keyword">int</span> t1 = st[<span class="number">0</span>][i][j][k<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">int</span> t2 = st[<span class="number">0</span>][i+(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>))][j][k<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">int</span> t3 = st[<span class="number">0</span>][i][j+(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>))][k<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">int</span> t4 = st[<span class="number">0</span>][i+(<span class="number">1</span>&lt;&lt;k<span class="number">-1</span>)][j+(<span class="number">1</span>&lt;&lt;k<span class="number">-1</span>)][k<span class="number">-1</span>];</span><br><span class="line">st[<span class="number">0</span>][i][j][k] = min(t1,t2,t3,t4);</span><br><span class="line">t1 = st[<span class="number">1</span>][i][j][k<span class="number">-1</span>];</span><br><span class="line">t2 = st[<span class="number">1</span>][i+(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>))][j][k<span class="number">-1</span>];</span><br><span class="line">t3 = st[<span class="number">1</span>][i][j+(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>))][k<span class="number">-1</span>];</span><br><span class="line">t4 = st[<span class="number">1</span>][i+(<span class="number">1</span>&lt;&lt;k<span class="number">-1</span>)][j+(<span class="number">1</span>&lt;&lt;k<span class="number">-1</span>)][k<span class="number">-1</span>];</span><br><span class="line">st[<span class="number">1</span>][i][j][k] = max(t1,t2,t3,t4);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> r,<span class="keyword">int</span> c,<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = Log[len];</span><br><span class="line"><span class="keyword">int</span> t1 = st[<span class="number">0</span>][r][c][k];</span><br><span class="line"><span class="keyword">int</span> t2 = st[<span class="number">0</span>][r+len-(<span class="number">1</span>&lt;&lt;k)][c][k];</span><br><span class="line"><span class="keyword">int</span> t3 = st[<span class="number">0</span>][r][c+len-(<span class="number">1</span>&lt;&lt;k)][k];</span><br><span class="line"><span class="keyword">int</span> t4 = st[<span class="number">0</span>][r+len-(<span class="number">1</span>&lt;&lt;k)][c+len-(<span class="number">1</span>&lt;&lt;k)][k];</span><br><span class="line"><span class="keyword">int</span> mi = min(t1,t2,t3,t4);</span><br><span class="line">t1 = st[<span class="number">1</span>][r][c][k];</span><br><span class="line">t2 = st[<span class="number">1</span>][r+len-(<span class="number">1</span>&lt;&lt;k)][c][k];</span><br><span class="line">t3 = st[<span class="number">1</span>][r][c+len-(<span class="number">1</span>&lt;&lt;k)][k];</span><br><span class="line">t4 = st[<span class="number">1</span>][r+len-(<span class="number">1</span>&lt;&lt;k)][c+len-(<span class="number">1</span>&lt;&lt;k)][k];</span><br><span class="line"><span class="keyword">int</span> mx = max(t1,t2,t3,t4);</span><br><span class="line"><span class="comment">//printf("%d %d\n",mx,mi);</span></span><br><span class="line"><span class="keyword">return</span> mx - mi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;len);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= m;j++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i][j]);</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n-len+<span class="number">1</span>;i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= m-len+<span class="number">1</span>;j++)&#123;</span><br><span class="line"><span class="keyword">int</span> tmp = ask(i,j,len);</span><br><span class="line">ans = ans &lt; tmp?ans:tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h4><p>å¤§å®¶å¯ä»¥å‘ç°æˆ‘ä»¬çš„äºŒç»´stè¡¨å»ºç«‹åœ¨æ­£æ–¹å½¢çŸ©é˜µæŸ¥è¯¢çš„åŸºç¡€ä¸Šçš„ï¼Œå› æ­¤stè¡¨ä»…ä¸‰ä¸ªç»´åº¦ï¼Œå³<code>st[r][c][k]</code> ä»£è¡¨ä»¥(r , c) ä¸ºå·¦ä¸Šè§’çš„è¾¹é•¿ä¸º$2^k$çš„çŸ©é˜µçš„æå€¼ï¼›ä½†å¦‚æœæ‰€ç»™çŸ©é˜µä»¥åŠæ‰€æ±‚çŸ©é˜µå¹¶ä¸æ˜¯æ­£æ–¹å½¢è€Œæ˜¯æ™®é€šçŸ©å½¢ï¼Œé‚£å°±è¦å¢åŠ ä¸€ä¸ªç»´åº¦ï¼Œå³<code>st[r][c][k1][k2]</code> è¡¨ç¤ºä»¥ï¼ˆrï¼Œcï¼‰ä¸ºå·¦ä¸Šè§’ï¼Œé•¿ä¸º$2^{k1}$é«˜ä¸º$2^{k2}$çš„çŸ©é˜µçš„æå€¼ï¼Œå…¶æ›´æ–°æ–¹æ³•ä¸æœ¬æ–‡æ‰€ä»‹ç»çš„ç±»ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡4ä¸ªå­çŸ©é˜µæ¥æ›´æ–°ï¼ŒæŸ¥è¯¢ä¹Ÿæ˜¯é€šè¿‡4ä¸ªå­çŸ©é˜µæ¥æŸ¥è¯¢æœ€ç»ˆç­”æ¡ˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ±‚açš„å¤§å¹‚å¯¹På–æ¨¡</title>
      <link href="/2019/08/16/bigpow/"/>
      <url>/2019/08/16/bigpow/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æœ‰å¦‚ä¸‹é—®é¢˜ï¼š<br>æ±‚2^n mod (1e9+7)ï¼Œå…¶ä¸­1&lt; n &lt; 10^100000ã€‚</p></blockquote><p>é¦–å…ˆæ˜ç¡®ä¸€ä¸‹æ­¤ç±»é—®é¢˜çš„å‡ ç§ç®—æ³•ï¼Œé¦–å…ˆæœ´ç´ ç®—æ³•ï¼Œå³æš´åŠ›å¾ªç¯æ±‚è§£ï¼Œæ˜¯O(N)å¤æ‚åº¦ï¼Œé€‚ç”¨èŒƒå›´åº”è¯¥æ˜¯nå°äº1000000ï¼›ç„¶åæ˜¯å¿«é€Ÿå¹‚ç®—æ³•ï¼Œæ•ˆç‡æ˜¯O(log N)ï¼Œé€‚ç”¨äºnå°äº2^100000çº§åˆ«çš„ï¼›ç„¶åå°±æ˜¯ä¸Šé¢çš„ä¾‹é¢˜äº†ï¼Œç”±äºèŒƒå›´æ˜¯10^100000ï¼Œå³ä½¿æ˜¯å¿«é€Ÿå¹‚ä¹Ÿä¸å¯èƒ½åœ¨æœŸæœ›æ—¶é—´å†…è§£å†³ï¼Œè¿™æ—¶å€™éœ€è¦å¦è¾Ÿè¹Šå¾„ã€‚</p><p><strong>è´¹é©¬å°å®šç†ï¼š</strong> å¯¹äºè´¨æ•°Pï¼Œä»»æ„çš„æ•´æ•°aï¼Œè‹¥æ»¡è¶³GCD(a,P) = 1ï¼Œåˆ™æœ‰ï¼š$a^p \equiv a (mod \,p)$</p><p><strong>ä¸»è¦æ€è·¯ï¼š</strong><br>å›åˆ°ä¸Šè¿°ä¾‹é¢˜ï¼Œå¯çŸ¥ P å³1e9+7ï¼Œè¿™æ˜¯ä¸ªç´ æ•°ã€‚è€Œ a æ˜¯ 2 ï¼Œå¾ˆæ˜æ˜¾ 2 ä¹Ÿæ˜¯ç´ æ•°ï¼Œæ‰€ä»¥GCD(a , P ) = 1ï¼Œæ»¡è¶³è´¹é©¬å°å®šç†çš„æ¡ä»¶ã€‚é‚£ä¹ˆæˆ‘ä»¬æƒ³æé«˜2^nè®¡ç®—çš„æ•ˆç‡ï¼Œå°±ç»•ä¸å¼€å‡å°nçš„å¤§å°ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±åˆ©ç”¨è´¹é©¬å°å®šç†æ¥å‡å°‘å¹‚nçš„å¤§å°ã€‚</p><p>é¦–å…ˆè´¹é©¬å°å®šç†çš„ä¸€ä¸ªå°å˜å½¢ï¼š$a^{(P-1)} \equiv 1 (mod \,P)$</p><p>æ¥ä¸‹æ¥å¯¹2^nè¿›è¡Œå˜å½¢ï¼š<script type="math/tex">2^n = 2^{ x *  (P-1)}  * 2^k</script> ï¼Œè€Œæ ¹æ®è´¹é©¬å°å®šç†ï¼Œæ˜¾ç„¶ $2^{x *  (P-1)} mod\,P = 1 mod \,P$ ï¼Œäºæ˜¯ $2^n mod\,P= 2^k$ ï¼Œå…¶ä¸­k = n%(P-1)ã€‚æ­¤æ—¶kå°äºPï¼Œå³å°äº1e9+7ï¼Œå¯ä»¥ä½¿ç”¨å¿«é€Ÿå¹‚è§£å†³ã€‚</p><p><strong>æ³¨æ„ï¼š</strong> å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ10^100000 æœ€å¤§æ˜¯1åé¢æœ‰100000ä¸ª0ï¼Œéœ€è¦ç”¨å­—ç¬¦ä¸²å­˜ï¼Œåœ¨è½¬åŒ–ä¸ºæ•´æ•°æ—¶åˆ©ç”¨æ¨¡è¿ç®—è§„åˆ™ï¼Œè¾¹è½¬åŒ–è¾¹å–æ¨¡ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">ll res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(b)&#123;</span><br><span class="line"><span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = res*a%M;</span><br><span class="line">a = a*a%M;</span><br><span class="line">b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(<span class="built_in">string</span> x)</span></span>&#123;</span><br><span class="line">ll M1 = M<span class="number">-1</span>;</span><br><span class="line">ll k = x[<span class="number">0</span>]-<span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;x[i];i++) k = (k*<span class="number">10</span>+x[i]-<span class="string">'0'</span>)%M1;</span><br><span class="line">ll ans = qpow(<span class="number">2</span>,k); </span><br><span class="line"><span class="keyword">return</span> ans%M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">string</span> n;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; n &amp;&amp; n != <span class="string">"0"</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,solve(n));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼ºè¿é€šåˆ†é‡</title>
      <link href="/2019/08/16/tarjan/"/>
      <url>/2019/08/16/tarjan/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>å¼ºè¿é€šåˆ†é‡å¸¸ç”¨äº<strong>ç¼©ç‚¹</strong>ï¼Œæ˜¯å›¾è®ºä¸­ä¸€ä¸ªé‡è¦çš„çŸ¥è¯†ç‚¹ã€‚æœ¬æ–‡é¦–å…ˆä»‹ç»äº†å¼ºè¿é€šåˆ†é‡çš„ç›¸å…³å®šä¹‰ä»¥åŠå…¶åº”ç”¨èŒƒå›´ï¼Œç„¶åå°†ç€é‡ä»‹ç»ä¸¤ç§æ±‚å¼ºè¿é€šåˆ†é‡çš„ç®—æ³•ï¼šKosarajuç®—æ³•ä»¥åŠTarjanç®—æ³•ï¼Œå®ƒä»¬çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(n+m)ï¼ˆnï¼šé¡¶ç‚¹æ•°ï¼Œmï¼šè¾¹æ•°ï¼‰ã€‚<br>å…¶ä¸­Kosarajuç®—æ³•æ€æƒ³ç®€å•ï¼Œæ“ä½œæ–¹ä¾¿ï¼Œæ˜“äºç†è§£ä¸ä»£ç å®ç°ï¼Œä½†æ˜¯æ€§èƒ½ä»¥åŠæ‹“å±•æ€§ä¸Šæ¯”Tarjanç•¥é€Šä¸€ç­¹ï¼›æœ¬æ–‡å°†ä¼šé€ä¸€ä»‹ç»è¿™ä¸¤ç§ç®—æ³•çš„æ€æƒ³ä»¥åŠå®ç°æ­¥éª¤ï¼Œæœ€åä¼šä»¥ä¾‹é¢˜çš„å½¢å¼ç»™å‡ºä»£ç æ¨¡æ¿ã€‚</p><h4 id="ç›¸å…³å®šä¹‰"><a href="#ç›¸å…³å®šä¹‰" class="headerlink" title="ç›¸å…³å®šä¹‰"></a>ç›¸å…³å®šä¹‰</h4><p>åœ¨æœ‰å‘å›¾Gä¸­ï¼Œå¦‚æœä¸¤ä¸ªé¡¶ç‚¹uï¼Œvé—´å­˜åœ¨ä¸€æ¡ u åˆ° v çš„è·¯å¾„ä¸”ä¹Ÿå­˜åœ¨ä¸€æ¡ v åˆ° u çš„è·¯å¾„ï¼Œåˆ™ç§°è¿™ä¸¤ä¸ªé¡¶ç‚¹uï¼Œv æ˜¯å¼ºè¿é€šçš„ï¼ˆstrongly connectedï¼‰ã€‚å¦‚æœæœ‰å‘å›¾Gçš„ä»»æ„ä¸¤ä¸ªé¡¶ç‚¹éƒ½å¼ºè¿é€šï¼Œåˆ™ç§°Gæ˜¯ä¸€ä¸ªå¼ºè¿é€šå›¾ã€‚æœ‰å‘éå¼ºè¿é€šå›¾çš„æå¤§å¼ºè¿é€šå­å›¾ï¼Œç§°ä¸ºå¼ºè¿é€šåˆ†é‡ï¼ˆstrongly connected componentsï¼‰ã€‚</p><p><strong>æå¤§å¼ºè¿é€šå­å›¾ï¼š</strong> Gæ˜¯ä¸€ä¸ªæå¤§å¼ºè¿é€šå­å›¾ï¼Œå½“ä¸”ä»…å½“Gæ˜¯ä¸€ä¸ªå¼ºè¿é€šå­å›¾ä¸”ä¸å­˜åœ¨å¦ä¸€ä¸ªå¼ºè¿é€šå­å›¾Gâ€™ï¼Œä½¿å¾— G æ˜¯ Gâ€™ çš„çœŸå­é›†ã€‚</p><h4 id="å¼ºè¿é€šåˆ†é‡çš„åº”ç”¨"><a href="#å¼ºè¿é€šåˆ†é‡çš„åº”ç”¨" class="headerlink" title="å¼ºè¿é€šåˆ†é‡çš„åº”ç”¨"></a>å¼ºè¿é€šåˆ†é‡çš„åº”ç”¨</h4><p>è‹¥å°†æœ‰å‘å›¾ä¸­çš„å¼ºè¿é€šåˆ†é‡éƒ½ç¼©ä¸ºä¸€ä¸ªç‚¹ï¼Œåˆ™åŸå›¾ä¼šå½¢æˆä¸€ä¸ªDAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰ï¼Œå¦‚å›¾1æ‰€ç¤º:<br><img src="/2019/08/16/tarjan/1.png" alt="å›¾1"><br><em>å›¾1ï¼šè™šçº¿éƒ¨åˆ†æ„æˆä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ï¼ˆå›¾ç‰‡æ¥è‡ª<a href="https://blog.csdn.net/sinat_40872274/article/details/99344104#commentBox" target="_blank" rel="noopener">ccfçš„åšå®¢</a>ï¼‰</em></p><p>å¼ºè¿é€šåˆ†é‡çš„<strong>å¸¸è§ç”¨é€”</strong>æœ‰ä¸¤ä¸ªï¼š</p><ul><li>æœ‰å‘å›¾çš„ç¼©ç‚¹ã€‚</li><li>è§£å†³2-SATé—®é¢˜ã€‚</li></ul><h4 id="Kosaraju-ç®—æ³•"><a href="#Kosaraju-ç®—æ³•" class="headerlink" title="Kosaraju ç®—æ³•"></a>Kosaraju ç®—æ³•</h4><p>Kosarajuç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n+m)ï¼ŒåŸºäºä¸¤æ¬¡DFSçš„æœ‰å‘å›¾å¼ºè¿é€šå­å›¾ç®—æ³•ã€‚<br>è¯¥ç®—æ³•å…±åˆ†ä¸ºä¸‰æ­¥ï¼š</p><blockquote><p>ç¬¬ä¸€æ­¥ï¼Œå¯¹åŸæœ‰å‘å›¾Gè¿›è¡ŒDFSï¼Œè®°å½•èŠ‚ç‚¹è®¿é—®å®Œçš„é¡ºåºd[i] , d[i] è¡¨ç¤ºç¬¬ i ä¸ªè®¿é—®å®Œçš„èŠ‚ç‚¹æ˜¯d[i]ï¼›<br>ç¬¬äºŒæ­¥ï¼Œé€‰æ‹©å…·æœ‰æœ€æ™šè®¿é—®å®Œçš„é¡¶ç‚¹ï¼Œå¯¹åå‘å›¾GT è¿›è¡ŒDFSï¼Œåˆ é™¤èƒ½å¤Ÿéå†åˆ°çš„é¡¶ç‚¹ï¼Œè¿™äº›é¡¶ç‚¹æ„æˆçš„ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ã€‚<br>ç¬¬ä¸‰æ­¥ï¼Œå¦‚æœè¿˜æœ‰é¡¶ç‚¹æ²¡æœ‰åˆ é™¤ï¼Œç»§ç»­ç¬¬äºŒéƒ¨ï¼Œå¦åˆ™ç®—æ³•ç»“æŸã€‚</p></blockquote><h5 id="ä»£ç å®ç°ï¼š"><a href="#ä»£ç å®ç°ï¼š" class="headerlink" title="ä»£ç å®ç°ï¼š"></a>ä»£ç å®ç°ï¼š</h5><p>è§é™„å½•éƒ¨åˆ† code-1ï¼šKosarajuç®—æ³•æ¨¡æ¿ï¼ˆPOJ2186ï¼‰</p><h4 id="Tarjanç®—æ³•"><a href="#Tarjanç®—æ³•" class="headerlink" title="Tarjanç®—æ³•"></a>Tarjanç®—æ³•</h4><p>Tarjanç®—æ³•æ˜¯ Robert Tarjan å‘æ˜çš„ä¸€ä¸ªç®—æ³•ï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯O(n+m)ï¼Œä½†æˆ‘ä»¬ä¹‹æ‰€ä»¥åœ¨æŒæ¡äº†Kosarajuç®—æ³•åä»è¦å­¦ä¹ Tarjanç®—æ³•çš„ä¸»è¦åŸå› æœ‰ä»¥ä¸‹ä¸‰ç‚¹ï¼š</p><ul><li>Tarjanç®—æ³•æ•ˆç‡æ¯”Kosarajuç®—æ³•é«˜å¤§æ¦‚30%ï¼Œæ‰€ä»¥Kosarajuå¯èƒ½ä¼šè¢«å¡å¸¸ã€‚</li><li>Kosarajuç®—æ³•åˆ©ç”¨é€’å½’å®ç°ï¼Œå¯èƒ½ä¼šçˆ†æ ˆï¼›è€ŒTarjanåˆ™ä¸ä¼šï¼ˆå› ä¸ºæ ¹æœ¬æ²¡é€’å½’ï¼‰ã€‚</li><li>Tarjanç®—æ³•è¿˜å¯ä»¥é€šè¿‡æ‹“å±•è§£å†³æ±‚å‰²ç‚¹ã€å‰²æ¡¥ä»¥åŠ2-SATç­‰é—®é¢˜ã€‚</li></ul><p>å®é™…ä¸Šå¦‚æœå‡ºé¢˜äººæœ‰è¿™ä¸ªæƒ³æ³•ï¼Œé‚£ä¹ˆå°±ä¸æ˜¯å¯èƒ½ä¼šè¶…æ—¶ï¼Œæ˜¯ä¸€å®šä¼šè¶…æ—¶ï¼›ä¸æ˜¯å¯èƒ½ä¼šçˆ†æ ˆï¼Œæ˜¯ä¸€å®šä¼šçˆ†æ ˆï¼Œæ‰€ä»¥è¿˜æ˜¯è¦æŒæ¡è¯¥ç®—æ³•çš„ã€‚</p><h5 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h5><p>Tarjanç®—æ³•æ˜¯åŸºäºå¯¹å›¾æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰çš„ç®—æ³•ï¼Œæ¯ä¸ªå¼ºè¿é€šåˆ†é‡ä¸ºæœç´¢æ ‘ä¸­çš„ä¸€æ£µå­æ ‘ã€‚æœç´¢æ—¶ï¼ŒæŠŠå½“å‰æœç´¢æ ‘ä¸­æœªå¤„ç†çš„èŠ‚ç‚¹åŠ å…¥ä¸€ä¸ªæ ˆï¼Œå›æº¯æ—¶å¯ä»¥åˆ¤æ–­æ ˆé¡¶åˆ°æ ˆä¸­çš„èŠ‚ç‚¹æ˜¯å¦æ„æˆä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ã€‚<br>æˆ‘ä»¬å®šä¹‰DFSè¿‡ç¨‹ä¸­é‡åˆ°çš„<strong>å››ç§è¾¹</strong>ï¼š</p><ul><li>æ ‘æè¾¹ï¼šDFSæ—¶ç»è¿‡çš„è¾¹ï¼Œå³DFSæœç´¢æ ‘ä¸Šçš„è¾¹ã€‚</li><li>å‰å‘è¾¹ï¼šä¸DFSæ–¹å‘ä¸€è‡´ï¼Œä»æŸä¸ªèŠ‚ç‚¹æŒ‡å‘å…¶æŸä¸ªå­å­™çš„è¾¹ã€‚</li><li>åå‘è¾¹ï¼šä¸DFSæ–¹å‘ç›¸åï¼Œä»æŸä¸ªèŠ‚ç‚¹æŒ‡å‘å…¶æŸä¸ªç¥–å…ˆçš„è¾¹ã€‚</li><li>æ¨ªå‘è¾¹ï¼šä»æŸä¸ªèŠ‚ç‚¹æŒ‡å‘æœç´¢æ ‘ä¸­å¦ä¸€å­æ ‘ä¸­çš„æŸèŠ‚ç‚¹çš„è¾¹ã€‚</li></ul><p><strong>å®šä¹‰DFN(u)</strong> ä¸ºèŠ‚ç‚¹ u çš„æœç´¢æ¬¡åºç¼–å·ï¼ˆæ—¶é—´æˆ³ï¼‰ï¼ŒLow(u) ä¸ºu æˆ–è€…u çš„å­æ ‘èƒ½å¤Ÿå›æº¯åˆ°çš„æœ€æ—©çš„æ ˆä¸­èŠ‚ç‚¹çš„DFNå€¼ã€‚</p><p>æ ¹æ®å®šä¹‰æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼š</p><ul><li>å¦‚æœ(u , v)ä¸ºæ ‘æè¾¹ï¼Œu ä¸º v çš„çˆ¶èŠ‚ç‚¹ï¼Œåˆ™ Low(u) = min{ Low(u) , Low(v) }ã€‚</li><li>å¦‚æœ(u , v)ä¸ºåå‘è¾¹æˆ–æŒ‡å‘æ ˆä¸­èŠ‚ç‚¹çš„æ¨ªå‰è¾¹ï¼Œåˆ™Low(u) = min{ Low(u) , DFN(v) }ã€‚</li></ul><p>å½“èŠ‚ç‚¹uçš„æœç´¢è¿‡ç¨‹ç»“æŸåï¼Œè‹¥DFN(u) = Low(u)ï¼Œåˆ™ä»¥uä¸ºæ ¹çš„æœç´¢å­æ ‘ä¸Šæ‰€æœ‰è¿˜åœ¨æ ˆä¸­çš„èŠ‚ç‚¹ï¼ˆå³uå’Œæ ˆä¸­åœ¨uä¹‹åçš„æ‰€æœ‰èŠ‚ç‚¹ï¼‰æ˜¯ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ï¼Œå¯é€€æ ˆã€‚é€šä¿—çš„è¯´ï¼Œè‹¥uä¸ºå¼ºè¿é€šåˆ†é‡çš„æ ¹ï¼Œé‚£ä¹ˆå®ƒçš„å­å­™ä¸­çš„æœ€é«˜æœ€å…ˆåº”è¯¥å°±æ˜¯å®ƒæœ¬èº«ã€‚</p><h5 id="ç®—æ³•çš„ä¸»è¦è¿‡ç¨‹"><a href="#ç®—æ³•çš„ä¸»è¦è¿‡ç¨‹" class="headerlink" title="ç®—æ³•çš„ä¸»è¦è¿‡ç¨‹"></a>ç®—æ³•çš„ä¸»è¦è¿‡ç¨‹</h5><p><strong>æ•°ç»„çš„åˆå§‹åŒ–ï¼š</strong> å½“é¦–æ¬¡æœç´¢åˆ°ç‚¹ u æ—¶ï¼ŒDFN(u)ä¸ºèŠ‚ç‚¹uçš„æœç´¢æ¬¡åºç¼–å·ï¼ˆæ—¶é—´æˆ³ï¼‰ã€‚<br><strong>å †æ ˆï¼š</strong> å°†uå‹å…¥å †æ ˆã€‚<br><strong>æ›´æ–°Low(u)ï¼š</strong> </p><ol><li>å¦‚æœï¼ˆuï¼Œvï¼‰ä¸ºæ ‘æè¾¹ï¼ˆvä¸åœ¨æ ˆä¸­ï¼‰ï¼Œuä¸ºvçš„çˆ¶èŠ‚ç‚¹ï¼Œåˆ™Low(u) = min{Low(u) , Low(v)}ã€‚</li><li>å¦‚æœï¼ˆuï¼Œvï¼‰ä¸ºåå‘è¾¹æˆ–è€…æŒ‡å‘æ ˆä¸­èŠ‚ç‚¹çš„æ¨ªå‰è¾¹ï¼ˆvåœ¨æ ˆä¸­ï¼‰ï¼Œåˆ™Low(u) = min{ Low(u) DFN(v)}ã€‚</li><li>å¦‚æœuçš„å­æ ‘å·²ç»å…¨éƒ¨éå†åLow(u) = DFS(u)ï¼Œåˆ™å°†uå’Œ<strong>æ ˆä¸­åœ¨uä¹‹åçš„æ‰€æœ‰èŠ‚ç‚¹</strong> å¼¹å‡ºæ ˆã€‚è¿™äº›å‡ºæ ˆçš„å…ƒç´ ç»„æˆä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ã€‚</li><li>ç»§ç»­æœç´¢ï¼ˆæˆ–è®¸ä¼šæ›´æ¢æœç´¢çš„èµ·ç‚¹ï¼Œå› ä¸ºæ•´ä¸ªæœ‰å‘å›¾å¯èƒ½åˆ†ä¸ºå¤šä¸ªä¸è¿é€šçš„éƒ¨åˆ†ï¼‰ï¼Œç›´åˆ°æ‰€æœ‰ç‚¹è¢«éå†ã€‚</li></ol><h5 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h5><p>è§é™„å½•éƒ¨åˆ†code-2ï¼šPOJ2182ï¼ˆTarjanç®—æ³•ï¼‰</p><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>è‘£æ°¸å»ºï¼Œä¿¡æ¯å­¦ç«èµ›ä¸€æœ¬é€šæé«˜ç‰ˆï¼Œç¦å·ï¼šç¦å»ºæ•™è‚²å‡ºç‰ˆç¤¾ï¼Œ2018.6ï¼Œ155-178</li><li>ç§‹å¶æ‹“å“‰ï¼ŒæŒ‘æˆ˜ç¨‹åºè®¾è®¡ç«èµ›ç¬¬2ç‰ˆï¼ŒåŒ—äº¬ï¼šäººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾ï¼Œ2013.6ï¼Œ320-324</li></ul><h4 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h4><p><strong>code-1ï¼šKosarajuç®—æ³•æ¨¡æ¿ï¼ˆPOJ2182ï¼‰</strong><br>æ±‚æ‰€æœ‰â€œçº¢ç‰›â€æ€»æ•°ã€‚ï¼ˆçº¢ç‰›å³æ‰€æœ‰ç‰›çš„å¶åƒï¼‰<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************************</span></span><br><span class="line"><span class="comment">    æœ€åä¿®æ”¹ï¼š2019/8/15 Valenshi</span></span><br><span class="line"><span class="comment">    ä½¿ç”¨è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">        ç”¨æ•°ç»„è¡¨ç¤ºé‚»æ¥è¡¨,åˆ†åˆ«å»ºç«‹äº†æ­£å›¾å’Œåå›¾;</span></span><br><span class="line"><span class="comment">        åªé€‚ç”¨äºèŠ‚ç‚¹ä»1~nçš„é¢˜å‹,åˆ‡è®°è‹¥å¹²èŠ‚ç‚¹ç¼–å·æ˜¯0~n-1ä¼šæ­»å¾ªç¯!</span></span><br><span class="line"><span class="comment">        ä¸»å‡½æ•°ï¼šscc(),ç”¨äºæ±‚æ‰€æœ‰å¼ºè¿é€šåˆ†é‡,O(N+M),ç­”æ¡ˆå­˜æ”¾åœ¨kosæ•°ç»„ã€‚</span></span><br><span class="line"><span class="comment"> *******************************************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">5e4</span>+<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],nex[M],tot;  <span class="comment">//é‚»æ¥è¡¨å­˜æ”¾æœ‰å‘å›¾</span></span><br><span class="line"><span class="keyword">int</span> rhead[N],rver[M],rnex[M],rtot;<span class="comment">//å­˜æ”¾åå›¾</span></span><br><span class="line"><span class="keyword">int</span> vis[N],kos[N];<span class="comment">//è®¿é—®æ ‡è®°;èŠ‚ç‚¹æ‰€å±è”é€šåˆ†é‡æ ‡å·</span></span><br><span class="line"><span class="keyword">int</span> ts[N],tc;  <span class="comment">//æ—¶é—´æˆ³, dfsè®¿é—®æ—¶çš„é¡ºåº;tcä¸ºå½“å‰"æ—¶é—´"</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* å»ºç«‹ä¸€æ¡ä»x-&gt;yçš„æœ‰å‘è¾¹ , åŒæ—¶åœ¨åå›¾æ·»åŠ ä¸€æ¡ä»y-&gt;xçš„æœ‰å‘è¾¹*/</span></span><br><span class="line">    ver[++tot] = y,nex[tot] = head[x], head[x] = tot;</span><br><span class="line">    rver[++rtot] = x,rnex[rtot] = rhead[y],rhead[y] = rtot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*ç»™èŠ‚ç‚¹xä»¥åŠå®ƒçš„å­å­™æ‰“ä¸Šæ—¶é—´æˆ³*/</span></span><br><span class="line">    vis[x] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x] ;i ;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i];</span><br><span class="line">        <span class="keyword">if</span>(!vis[y]) dfs(y);</span><br><span class="line">    &#125;</span><br><span class="line">    ts[++tc] = x;     <span class="comment">//ç¬¬tcä¸ªå›æº¯çš„æ˜¯ç‚¹x</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rdfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* æ‰¾å‡ºå±äºç¬¬kä¸ªå¼ºè¿é€šåˆ†é‡çš„æ‰€æœ‰ç‚¹ */</span></span><br><span class="line">    vis[x] = <span class="literal">true</span>;kos[x] = k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = rhead[x];i ;i = rnex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = rver[i];</span><br><span class="line">        <span class="keyword">if</span>(!vis[y]) rdfs(y,k);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,m;      <span class="comment">//ç‚¹çš„ä¸ªæ•°,ç¼–å·ä¸º1~n;</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">scc</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">/* å°†åŸå›¾åˆ†ä¸ºè‹¥å¹²å¼ºè¿é€šåˆ†é‡,å¹¶è¿”å›ä¸ªæ•° */</span></span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);tc = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) dfs(i);</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = tc;i &gt; <span class="number">0</span>;i--) <span class="keyword">if</span>(!vis[ts[i]]) rdfs(ts[i],++k);</span><br><span class="line">    <span class="keyword">return</span> k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/***********************************</span></span><br><span class="line"><span class="comment">ä»¥ä¸‹ä¸ºPOJ2186è§£é¢˜ä»£ç  </span></span><br><span class="line"><span class="comment"> ***********************************/</span></span><br><span class="line"><span class="keyword">int</span> A[N],B[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = scc();<span class="comment">//å¤‡é€‰ç­”æ¡ˆæ€»æ•° </span></span><br><span class="line"><span class="keyword">int</span> y = <span class="number">0</span>,sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(kos[i] == k)&#123;</span><br><span class="line">y = i;sum++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ£€æŸ¥æ˜¯å¦ä»æ‰€æœ‰ç‚¹å¯è¾¾</span></span><br><span class="line"><span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line">rdfs(y,<span class="number">0</span>);<span class="comment">//ä»£ç é‡ç”¨</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!vis[i])&#123;</span><br><span class="line">sum = <span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">addEdge(x,y);</span><br><span class="line">&#125;</span><br><span class="line">solve();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>code-2ï¼šPOJ2182ï¼ˆTarjanç®—æ³•æ¨¡æ¿ï¼‰</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***************************************************************</span></span><br><span class="line"><span class="comment">æœ€åæ›´æ–°ï¼š2019/8/16 ValenShi</span></span><br><span class="line"><span class="comment">ä½¿ç”¨è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">1.è®°å¾—åˆå§‹åŒ–è¾…åŠ©æ•°ç»„dfn[],co[],head[],</span></span><br><span class="line"><span class="comment">ä»¥åŠ"æ•°ç»„æŒ‡é’ˆ" ,top,tot,num,col ;</span></span><br><span class="line"><span class="comment">2.æ¯ä¸ªè¾…åŠ©æ•°ç»„å…·ä½“ä½œç”¨è§æ³¨é‡Š;</span></span><br><span class="line"><span class="comment">3.èŠ‚ç‚¹èŒƒå›´æ˜¯1~n,è‹¥æ˜¯0~n-1ä¼šæ­»å¾ªç¯,å¯æ›´æ”¹head[]åˆå§‹å€¼è§£å†³ã€‚ </span></span><br><span class="line"><span class="comment">***************************************************************/</span> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="comment">/* é‚»æ¥è¡¨å­˜æœ‰å‘å›¾ */</span></span><br><span class="line"><span class="keyword">int</span> head[N],ver[M],nex[M],tot;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">ver[++tot] = y,nex[tot] = head[x],head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/***************************************** </span></span><br><span class="line"><span class="comment">Tarjanç®—æ³•åŠå…¶è¾…åŠ©æ•°ç»„ï¼š</span></span><br><span class="line"><span class="comment">Stack[]ä¸ºæ ˆ,topä¸ºæ ˆé¡¶æŒ‡é’ˆ;</span></span><br><span class="line"><span class="comment">dfn[]ä¸ºèŠ‚ç‚¹çš„æ—¶é—´æˆ³,numä¸ºå¯¹åº”çš„"æ—¶é—´";</span></span><br><span class="line"><span class="comment">co[]ä¸ºèŠ‚ç‚¹æ‰€åœ¨çš„å¼ºè¿é€šåˆ†é‡çš„ç¼–å·,colå¯¹åº”ç¼–å·; </span></span><br><span class="line"><span class="comment">******************************************/</span> </span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> Stack[N],top;</span><br><span class="line"><span class="keyword">int</span> dfn[N],low[N],num,co[N],col;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Tarjan</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">dfn[u] = low[u] = ++num;</span><br><span class="line">Stack[++top] = u;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];i ;i = nex[i])&#123;</span><br><span class="line"><span class="keyword">int</span> v = ver[i];</span><br><span class="line"><span class="keyword">if</span>(!dfn[v])&#123;</span><br><span class="line">Tarjan(v);</span><br><span class="line">low[u] = min(low[u],low[v]);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!co[v]) low[u] = min(low[u],dfn[v]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(low[u] == dfn[u])&#123;</span><br><span class="line">co[u] = ++col;</span><br><span class="line"><span class="keyword">while</span>(Stack[top] != u)&#123;</span><br><span class="line">co[Stack[top]] = col;</span><br><span class="line">top--;</span><br><span class="line">&#125;</span><br><span class="line">top--;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> chudu[N];<span class="comment">/*ç”¨æ¥è®°å½•æ¯ä¸ªå¼ºè¿é€šåˆ†é‡çš„å‡ºåº¦ */</span> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">num = col = top = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//memset(dfn,0,sizeof dfn);</span></span><br><span class="line"><span class="comment">//memset(co,0,sizeof co);</span></span><br><span class="line"><span class="comment">//memset(chudu,0,sizeof chudu); </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="keyword">if</span>(!dfn[i]) Tarjan(i);</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>,tcnt = <span class="number">0</span>;</span><br><span class="line"><span class="comment">/*anså­˜æ”¾ç­”æ¡ˆ,tcntè¡¨ç¤ºå‡ºåº¦ä¸º0çš„å¼ºè¿é€šåˆ†é‡çš„ä¸ªæ•°*/</span> </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = head[i];j ;j = nex[j])&#123;</span><br><span class="line"><span class="keyword">int</span> y = ver[j];</span><br><span class="line"><span class="keyword">if</span>(co[i] != co[y]) chudu[co[i]]++;</span><br><span class="line"><span class="comment">/*iæ‰€åœ¨çš„å¼ºè¿é€šåˆ†é‡çš„å‡ºåº¦+1 */</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tcol = <span class="number">1</span>;<span class="comment">/*tcolä¸ºå‡ºåº¦ä¸º0çš„å¼ºè¿é€šåˆ†é‡çš„ç¼–å·*/</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= col;i++) <span class="keyword">if</span>(!chudu[i]) tcnt++,tcol = i;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="keyword">if</span>(co[i] == tcol) ans++;</span><br><span class="line"><span class="keyword">if</span>(tcnt &gt; <span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,u,v;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);</span><br><span class="line">addEdge(u,v);</span><br><span class="line">&#125;</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·®åˆ†çº¦æŸç³»ç»Ÿ</title>
      <link href="/2019/08/12/chafen/"/>
      <url>/2019/08/12/chafen/</url>
      
        <content type="html"><![CDATA[<h4 id="ç®—æ³•ç®€ä»‹"><a href="#ç®—æ³•ç®€ä»‹" class="headerlink" title="ç®—æ³•ç®€ä»‹"></a>ç®—æ³•ç®€ä»‹</h4><p>å·®åˆ†çº¦æŸç³»ç»Ÿæ˜¯ä¸€ç§ç‰¹æ®Šçš„Nå…ƒä¸€æ¬¡ä¸ç­‰å¼ç»„ï¼Œå®ƒåŒ…å«Nä¸ªå˜é‡$X_1 - X_N$ä»¥åŠMä¸ªçº¦æŸæ¡ä»¶ï¼Œæ¯ä¸ªçº¦æŸæ¡ä»¶éƒ½æ˜¯ç”±ä¸¤ä¸ªå˜é‡ä½œå·®æ„æˆçš„ï¼Œå½¢å¦‚$X_i - X_j &lt;= C_k$ï¼Œå…¶ä¸­$C_k$æ˜¯å¸¸æ•°ï¼ˆå¯ä»¥ä¸ºè´Ÿï¼‰ï¼Œ1&lt;= i , j &lt;= N, 1 &lt;= k &lt;= Mã€‚æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼šæ±‚ä¸€ç»„è§£ï¼Œ$X_1 = a_1, X_2 = a_2 ,â€¦ , X_N = a_N$ä½¿å¾—æ‰€æœ‰çº¦æŸæ¡ä»¶éƒ½å¾—åˆ°æ»¡è¶³ã€‚</p><p>å·®åˆ†çº¦æŸç³»ç»Ÿçš„æ¯ä¸ªçº¦æŸæ¡ä»¶$X_i - X_j &lt;= C_k$ å¯ä»¥å˜å½¢ä¸º$X_i &lt;= X_j + C_k$ï¼Œè¿™ä¸å•æºæœ€çŸ­è·¯ä¸­çš„ä¸‰è§’ä¸ç­‰å¼ dis[ y ] &lt;= dis[ x ] + zéå¸¸ç±»ä¼¼ï¼Œå› æ­¤å¯ä»¥æŠŠæ¯ä¸ªå˜é‡X_i çœ‹ä½œæœ‰å‘å›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ i ï¼Œå¯¹äºæ¯ä¸ªçº¦æŸæ¡ä»¶$X_i - X_j &lt;= C_k$ ï¼Œ ä»èŠ‚ç‚¹j å‘èŠ‚ç‚¹ i è¿ä¸€æ¡é•¿åº¦ä¸º $C_k$ çš„æœ‰å‘è¾¹ã€‚</p><p>æ³¨æ„åˆ°å¦‚æœé›†åˆAæ˜¯ä¸€ç»„è§£ï¼Œé‚£ä¹ˆA+dä¹Ÿæ˜¯ä¸€ç»„è§£ï¼ˆä½œå·®ådè¢«æ¶ˆæ‰ï¼‰ã€‚</p><p>è®¾dis[0] = 0ï¼Œä»¥0ä¸ºèµ·ç‚¹æ±‚å•æºæœ€çŸ­è·¯ï¼Œè‹¥å›¾ä¸­å­˜åœ¨è´Ÿç¯åˆ™å·®åˆ†çº¦æŸç³»ç»Ÿæ— è§£ã€‚å¦åˆ™ï¼Œ$X_i = dis[i]$ å°±æ˜¯å·®åˆ†çº¦æŸç³»ç»Ÿçš„ä¸€ç»„è§£ã€‚</p><p>åœ¨æŸäº›é¢˜ç›®ä¸­ï¼Œ$X_i - X_j &gt;= C_k$ï¼Œä»å¯ä»¥çœ‹ä½œæ˜¯ä» j åˆ° i è¿æˆé•¿åº¦ä¸º $C_k$çš„æœ‰å‘è¾¹ï¼Œåªæ˜¯æ”¹ä¸ºè®¡ç®—å•æº<strong>æœ€é•¿è·¯å¾„</strong>ï¼Œè‹¥å›¾ä¸­å­˜åœ¨æ­£ç¯åˆ™æ— è§£ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä¸ç­‰å¼ä¸¤è¾¹åŒæ—¶å–è´Ÿï¼Œä½¿å¾—å˜æ¢æˆæ ‡å‡†å½¢å¼ã€‚</p><h4 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h4><p>å·®åˆ†çº¦æŸæ˜¯åŸºäºä¸‰è§’ä¸ç­‰å¼çš„ä¸€ä¸ªæ¨å¹¿ã€‚å…³é”®åœ¨äºæ ¹æ®é¢˜æ„æ„é€ å‡ºæ°å½“çš„çŠ¶æ€ï¼Œå»ºç«‹çŠ¶æ€é—´çš„ä¸ç­‰å…³ç³»ï¼Œå¹¶è¯æ˜æ»¡è¶³ä¸ç­‰å¼çš„ä¸€ä¸ªè§£ä¸åŸé—®é¢˜ä¸€ä¸€å¯¹åº”ï¼Œç„¶åä¾¿å¯ä»¥åˆ©ç”¨SPFAç®—æ³•æ±‚è§£ã€‚å…¶ä¼˜ç‚¹æ˜¯ä¸ç­‰å¼å…³ç³»æ˜æ˜¾ï¼Œæ˜“äºç†è§£ï¼Œç¼ºç‚¹æ˜¯é€‚ç”¨æ€§çª„ã€‚</p><h4 id="ä¾‹é¢˜æ¨¡æ¿"><a href="#ä¾‹é¢˜æ¨¡æ¿" class="headerlink" title="ä¾‹é¢˜æ¨¡æ¿"></a>ä¾‹é¢˜æ¨¡æ¿</h4><p><a href="http://ybt.ssoier.cn:8088/index.php" target="_blank" rel="noopener">Zju1420 å‡ºçº³å‘˜é—®é¢˜</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>æœ‰ä¸€å®¶24å°æ—¶è¥ä¸šçš„è¶…å¸‚ï¼Œéœ€è¦é›‡ä½£ä¸€æ‰¹å‡ºçº³å‘˜ã€‚ä¸€å¤©ä¸­æ¯ä¸ªå°æ—¶éœ€è¦å‡ºçº³å‘˜çš„æœ€å°‘æ•°é‡ä¸ºR0,R1,R2,â€¦,R23ã€‚æœ‰Nä¸ªäººç”³è¯·è¿™é¡¹å·¥ä½œï¼Œæ¯ä¸ªç”³è¯·è€…ï¼Œä»ä¸€ä¸ªç‰¹å®šæ—¶åˆ»Ti,å¼€å§‹è¿ç»­å·¥ä½œæ°å¥½8ä¸ªå°æ—¶ã€‚(Tiä¸ºæ•´æ•°ï¼Œä¸”0&lt;=Ti&lt;=23 )ã€‚ä½ çš„ä»»åŠ¡æ˜¯è®¡ç®—å‡ºéœ€è¦é›‡ä½£å‡ºçº³å‘˜çš„æœ€å°‘æ•°ç›®ï¼Œæ»¡è¶³åœ¨æ¯ä¸€æ—¶åˆ»kï¼Œè‡³å°‘æœ‰Riåå‡ºçº³å‘˜åœ¨å·¥ä½œã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>çœŸçš„æœ‰ç‚¹éš¾æƒ³å•Šï¼Œé¦–å…ˆæˆ‘ä»¬è¦å‡è®¾num[i] ä¸º i æ—¶åˆ»èƒ½å¤Ÿå¼€å§‹å·¥ä½œçš„äººæ•°ï¼Œx[i] ä¸ºå®é™…é›‡ä½£äººæ•°ï¼Œé‚£ä¹ˆx[i] &lt;= num[i] ã€‚è€ŒR[i]æ˜¯i æ—¶åˆ»è‡³å°‘éœ€è¦çš„äººæ•°ï¼Œè¿™ç”±é¢˜ç›®ç»™å‡ºã€‚<br>æˆ‘ä»¬ä»¤s[i] = x[i] + x[i-1] + â€¦ + x[1] ï¼Œæ˜¾ç„¶æˆ‘ä»¬å°±ä¼šå¾—åˆ°å…³äº s å’Œ num çš„ä¸€ç»„ä¸ç­‰å¼ï¼Œå¦‚æœæƒ³è¦ç­”æ¡ˆæ­£ç¡®ï¼Œéœ€è¦æ‰¾åˆ°æ‰€æœ‰éšå«çš„æ¡ä»¶ï¼š</p><p>s[i] - s[i-1] &gt;= 0     //(0 &lt;= i &lt;= 23)<br>s[i-1] - s[i] &gt;= -num[i] //  (0&lt;=i&lt;=23)<br>s[i] - s[i-8] &gt;= r[i]    //(8&lt;=i&lt;=23)<br>s[i] - s[i+16] &gt;= r[i] - s[23] //  (0 &lt;= i &lt;= 7)</p><p>æ³¨æ„åˆ°ï¼Œs[23]æœ¬æ˜¯æœªçŸ¥æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬å°†å®ƒä½œä¸ºå¸¸æ•°å¤„ç†ï¼Œå…·ä½“åšæ³•æ˜¯æˆ‘ä»¬éå†s[23]çš„æ‰€æœ‰å¯èƒ½çš„å€¼ï¼Œå¹¶ä¾æ¬¡è¿›è¡Œä¸€æ¬¡SPFAï¼Œå°è¯•æ‰¾å¯»é›‡ä½£æœ€å°äººæ•° ä¸”ä½¿å¾—ä¸ç­‰å¼ç»„æˆç«‹çš„å¯èƒ½ã€‚ æ³¨æ„å¦‚æœ i ä»0å¼€å§‹ï¼Œé‚£ä¹ˆé‚»æ¥è¡¨å­˜æœ‰å‘å›¾ï¼ŒheadèŠ‚ç‚¹å°±ä¸èƒ½åˆå§‹åŒ–ä¸º0ï¼Œé˜²æ­¢æ­»å¾ªç¯è¶…æ—¶ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> t,n,R[<span class="number">30</span>],num[<span class="number">30</span>];</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[N],edge[N],nex[N],tot;</span><br><span class="line"><span class="keyword">int</span> dis[<span class="number">100</span>],vis[<span class="number">100</span>],ts[<span class="number">100</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    ver[++tot] = y,edge[tot] = z;</span><br><span class="line">    nex[tot] = head[x],head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">SPFA</span><span class="params">(<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* è¿”å›æ­¤æ—¶æ˜¯å¦æœ‰è§£ */</span></span><br><span class="line">    <span class="keyword">while</span>(!q.empty()) q.pop();</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line">    <span class="built_in">memset</span>(ts,<span class="number">0</span>,<span class="keyword">sizeof</span> ts);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">100</span>;i++) dis[i] = -INF;</span><br><span class="line">    q.push(<span class="number">0</span>);dis[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    vis[<span class="number">0</span>] = <span class="literal">true</span>;ts[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop();</span><br><span class="line">        vis[x] = <span class="literal">false</span>;ts[x]++;</span><br><span class="line">        <span class="keyword">if</span>(ts[x] &gt; <span class="number">24</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x];i ;i = nex[i])&#123;</span><br><span class="line">            <span class="keyword">int</span> y = ver[i], z = edge[i];</span><br><span class="line">            <span class="keyword">if</span>(dis[y] &lt; dis[x] + z)&#123;</span><br><span class="line">                dis[y] = dis[x] + z;</span><br><span class="line">                <span class="keyword">if</span>(!vis[y]) q.push(y),vis[y] = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//printf("%d %d %d\n",x,y,dis[x]);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dis[<span class="number">24</span>] == s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* è¿”å›å½“s[24] = zæ—¶æ˜¯å¦æœ‰è§£*/</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span> head);tot = <span class="number">1</span>;</span><br><span class="line">    addEdge(<span class="number">0</span>,<span class="number">24</span>,z);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">24</span>;i++)</span><br><span class="line">        addEdge(i<span class="number">-1</span>,i,<span class="number">0</span>), addEdge(i,i<span class="number">-1</span>,-num[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">9</span>;i &lt;= <span class="number">24</span>;i++) addEdge(i<span class="number">-8</span>,i,R[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">8</span>;i++) addEdge(i+<span class="number">16</span>,i,R[i]-z);</span><br><span class="line">    <span class="keyword">return</span> SPFA(z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">memset</span>(num,<span class="number">0</span>,<span class="keyword">sizeof</span> num);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">24</span>;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,R+i);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">        <span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x),num[x+<span class="number">1</span>]++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)</span><br><span class="line">            <span class="keyword">if</span>(solve(i))&#123;</span><br><span class="line">               <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i),flag = <span class="literal">false</span>; </span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">            &#125; </span><br><span class="line">        <span class="keyword">if</span>(flag) <span class="built_in">puts</span>(<span class="string">"No Solution"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>è‘£æ°¸å»ºï¼Œä¿¡æ¯å­¦ç«èµ›ä¸€æœ¬é€šæé«˜ç‰ˆï¼Œç¦å·ï¼šç¦å»ºæ•™è‚²å‡ºç‰ˆç¤¾ï¼Œ2018.6ï¼Œ155-161</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pollard_rhoç®—æ³•</title>
      <link href="/2019/08/11/pollard-rho/"/>
      <url>/2019/08/11/pollard-rho/</url>
      
        <content type="html"><![CDATA[<h3 id="Pollardâ€™s-rhoç®—æ³•"><a href="#Pollardâ€™s-rhoç®—æ³•" class="headerlink" title="Pollardâ€™s rhoç®—æ³•"></a>Pollardâ€™s rhoç®—æ³•</h3><h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>Pollarâ€™s Rhoç®—æ³•æ˜¯ä¸€ç§ç”¨äºåˆ†è§£è´¨å› æ•°çš„ç®—æ³•ï¼Œå¯¹äºä¸€ä¸ªè¢«åˆ†è§£çš„æ•°Nï¼Œå‡è®¾Nçš„æœ€å°è´¨å› æ•°ä¸ºpï¼ˆ$p \neq N$ï¼‰ï¼Œé‚£ä¹ˆPollarâ€™s Rhoç®—æ³•èƒ½å¤Ÿåœ¨$O(\sqrt N * Î±(N))$çš„æœŸæœ›æ—¶é—´å¤æ‚åº¦å†…å°†Nåˆ†è§£ä¸ºä¸¤ä¸ªä¸æ˜¯1çš„æ•°çš„ä¹˜ç§¯ï¼Œå…¶ä¸­Î±(N)æ˜¯æ±‚è§£ä¸¤ä¸ªæ•°çš„gcdæ—¶é—´å¤æ‚åº¦ï¼Œå¹¶ä¸”è¯¥ç®—æ³•å¯¹äºç©ºé—´è¦æ±‚å¾ˆä½ã€‚</p><p>é¦–å…ˆè¦æ˜ç¡®çš„æ˜¯ï¼ŒPollarâ€™s Rho ç®—æ³•æ˜¯éšæœºç®—æ³•ï¼Œå…¶åŸºäºMiller-Rabinç®—æ³•ï¼Œä¸€èˆ¬åœ¨æ±‚å¤§æ•´æ•°çš„å”¯ä¸€åˆ†è§£æ—¶ä¼šç”¨åˆ°ï¼Œå› ä¸º <em>è¯•é™¤æ³•</em> $^{[1]}$çš„$O(\sqrt N)$å¤æ‚åº¦å¤ªé«˜ã€‚</p><p>æœ¬æ–‡å°†é¦–å…ˆä»ç®—æ³•çš„é€‚ç”¨æ¨¡å‹è®²èµ·ï¼Œè¯¦ç»†ä»‹ç»ç®—æ³•æµç¨‹ï¼Œæœ€åä¼šç»™å‡ºä¸€é“ä¾‹é¢˜ä»¥åŠè¯¦ç»†æ³¨é‡Šäº†çš„ä»£ç æ¨¡æ¿ï¼Œå½“ç„¶è¿˜æœ‰æ¨¡æ¿çš„ä½¿ç”¨è¯´æ˜ã€‚</p><p><em>[1]è¯•é™¤æ³•ï¼šä¸€ç§å°†æ•´æ•°å”¯ä¸€åˆ†è§£æˆè´¨å› æ•°ä¹˜ç§¯çš„æ–¹æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(\sqrt N)$</em></p><h4 id="ç®—æ³•ç®€ä»‹"><a href="#ç®—æ³•ç®€ä»‹" class="headerlink" title="ç®—æ³•ç®€ä»‹"></a>ç®—æ³•ç®€ä»‹</h4><p>è¯¥ç®—æ³•æœ€æ—©äº1975å¹´ç”±John M. Pollardæå‡ºï¼Œè€ŒRichard Brentäº1980å¹´æå‡ºäº†æ”¹è¿›ç‰ˆæœ¬ã€‚è™½ç„¶ä¸æ˜¯ç›®å‰æœ€å¿«çš„ç®—æ³•ï¼Œä½†å®ƒè¦æ¯”è¯•é™¤æ³•å¿«ä¸Šå¤šä¸ªé‡çº§ã€‚å®ç°å®ƒçš„æ€æƒ³åŒæ ·å¯ä»¥ç”¨äºå…¶ä»–åœ°æ–¹ã€‚</p><p><strong>é—®é¢˜æ¨¡å‹ï¼š</strong> ç»™å®šä¸€ä¸ªæ•´æ•°nï¼Œè¯•ç€å°†nåˆ†è§£ä¸ºè‹¥å¹²ç´ æ•°ç›¸ä¹˜çš„å½¢å¼ã€‚nå°äº$2^{60}$ã€‚</p><p><strong>åˆ†æï¼š</strong> å¦‚æœç”¨è¯•é™¤æ³•ï¼Œæ˜¾ç„¶æ—¶é—´å¤æ‚åº¦è¿‡é«˜ï¼Œç°åœ¨æˆ‘ä»¬å¸Œæœ›å¾—åˆ°ä¸€ä¸ªå¿«é€Ÿçš„æ–¹æ³•ï¼›ç±»æ¯”å¤§ç´ æ•°åˆ¤æ–­çš„Miller-Rabinç®—æ³•ï¼ŒMiller-Rabinç®—æ³•ä¾é ç€è´¹é©¬å°å®šç†ä»¥åŠäºŒæ¬¡æ£€æµ‹å®šç†å®ç°äº†å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªå¤§æ•´æ•°æ˜¯å¦ä¸ºç´ æ•°çš„ç®—æ³•ï¼Œå®é™…ä¸Šå¯¹äºå¤§æ•´æ•°çš„å”¯ä¸€åˆ†è§£ä¹ŸåŒæ ·æœ‰ç€ç±»ä¼¼çš„å·§å¦™çš„ç®—æ³•ï¼Œå°±æ˜¯æœ¬æ–‡ä»‹ç»çš„Pollardâ€™s rhoç®—æ³•ã€‚</p><h4 id="ç®—æ³•æ€æƒ³"><a href="#ç®—æ³•æ€æƒ³" class="headerlink" title="ç®—æ³•æ€æƒ³"></a>ç®—æ³•æ€æƒ³</h4><p><strong>åŸºæœ¬æ€è·¯ï¼š</strong><br>å¯¹äºç»™å®šçš„ä¸€ä¸ªæ•´æ•°nï¼Œæ˜¾ç„¶å¦‚æœnä¸ºç´ æ•°ï¼ˆMiller-Rabinç®—æ³•åˆ¤æ–­ï¼‰ï¼Œé‚£ä¹ˆç®—æ³•ç»“æŸï¼Œè¿”å›å”¯ä¸€ç´ å› å­nã€‚</p><p>å¦åˆ™ï¼Œpollardâ€™s rhoç®—æ³•ä¼šè¯•ç€æ‰¾åˆ°å½“ç„¶æ•°nçš„ä¸€ä¸ªå› å­aï¼ˆaå¹¶ä¸ä¸€å®šæ˜¯ç´ æ•°ï¼‰ï¼Œç„¶åé€’å½’ Pollard_rho( a ) å’Œ Pollard_rho( n/a ) ï¼Œå³å°†nåˆ†ä¸ºäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå°†åŸé—®é¢˜å˜æˆäº†è§„æ¨¡æ›´å°çš„ä¸¤ä¸ªå­é—®é¢˜ã€‚</p><p><strong>å¦‚ä½•æ±‚å› å­aï¼Ÿ</strong><br>ä¸€èˆ¬æƒ…å†µä¸‹å¯èƒ½ä¼šæœ¬èƒ½çš„æƒ³åˆ°æšä¸¾ï¼Œä½†è¿™æ ·è¿‡äºè€—æ—¶ã€‚å¯»æ‰¾å› å­æ˜¯è¯¥ç®—æ³•ä¸­æœ€é‡è¦çš„ä¸€æ­¥ï¼Œè¯¥ç®—æ³•ä¸­é‡‡ç”¨éšæœºåŒ–ç®—æ³•æ¥æŸ¥æ‰¾å› å­aã€‚å‡è®¾æ­¤æ—¶nä»…æœ‰2ä¸ªå› å­ p å’Œ qï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç”¨éšæœºæ•°æ¥æ‰¾nçš„å› å­ï¼ŒæˆåŠŸç‡ä¸º1/nã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ€è·¯æ˜¯å¦‚ä½•æå‡æˆåŠŸç‡ã€‚</p><p>å¯»æ‰¾ä¸€ä¸ªå› å­aï¼Œç­‰ä»·äºå¯»æ‰¾æ˜¯å¦å­˜åœ¨kä¸ªæ•°ï¼Œä½¿å¾—å…¶ä¸­æœ‰$x_i - x_j = a$ï¼Œç”±äº<strong>ç”Ÿæ—¥æ‚–è®º</strong> æˆ‘ä»¬å¯ä»¥å¾—çŸ¥å½“k = $\sqrt N$æ—¶ï¼Œè¯¥æ¦‚ç‡æ˜¯50%ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å¯èƒ½æ€§ä»$\frac{1}{n}$æå‡åˆ°äº†$\sqrt{\frac{1}{n}}$ã€‚</p><p>ä½†ä¸å¹¸çš„æ˜¯å¯¹äº10ä½çš„æ•´æ•°ï¼Œk = 1e5æ—¶ï¼Œä»è¦åš$k^2 = 10^{10}$æ¬¡æ¯”è¾ƒï¼Œå¹¸è¿çš„æ˜¯ï¼Œè¿˜æœ‰æ›´å¥½çš„æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬ä»ç„¶é€‰å–kä¸ªæ•°ï¼š$x_1,x_2,â€¦,x_k$ï¼Œä½†æˆ‘ä»¬ä¸å†è¯¢é—®æ˜¯å¦å­˜åœ¨$x_i - x_j$å¯ä»¥æ•´é™¤nï¼Œè½¬è€Œè¯¢é—®æ˜¯å¦å­˜åœ¨ $gcd( x_i - x_j , n) &gt; 1$ çš„æƒ…å†µã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬é—®$x_i - x_j$å’Œnæ˜¯å¦å­˜åœ¨ä¸€ä¸ªå¹³å‡¡çš„æœ€å¤§å…¬çº¦æ•°ã€‚</p><p>å¦‚æœæˆ‘ä»¬è¯¢é—®æœ‰å¤šå°‘ä¸ªæ•´æ•°èƒ½æ•´é™¤nï¼Œé‚£ä¹ˆç­”æ¡ˆæ˜¾ç„¶åªæœ‰ä¸¤ä¸ªï¼špå’Œqã€‚<br>ä½†æ˜¯å¦‚æœæˆ‘ä»¬é—®æœ‰å¤šå°‘ä¸ªæ•°ä½¿å¾—gcd($x_i-x_j$) &gt; 1ï¼Œç­”æ¡ˆä¾¿å¾ˆå¤šäº†ï¼Œå¦‚ï¼šp, 2p, 3p, 4p, â€¦ , (q-1)p , q , 2q ,â€¦,(p-1)qã€‚å‡†ç¡®çš„è¯´ï¼Œæœ‰p+q-2ä¸ªã€‚</p><p><strong>æ‰€ä»¥ï¼Œä¸€ä¸ªç®€å•çš„ç­–ç•¥å¦‚ä¸‹ï¼š</strong></p><ul><li>åœ¨åŒºé—´[2 , n-2]ä¸­éšæœºé€‰ k ä¸ªæ•°ï¼Œ$x_1,x_2,x_3,â€¦,x_k$ã€‚</li><li>åˆ¤æ–­æ˜¯å¦å­˜åœ¨gcd($x_i - x_y$,n) &gt; 1ï¼Œè‹¥å­˜åœ¨ï¼Œgcd($x_i - x_y$,n) æ˜¯nçš„ä¸€ä¸ªå› å­ï¼ˆpæˆ–qï¼‰ã€‚</li></ul><p>ä½†æ˜¯è¿™æ ·è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬å¤§çº¦è¦é€‰å–$n^{1/4}$ä¸ªæ•°ï¼Œæ•°é‡è¿˜æ˜¯å¤ªå¤§ï¼Œä»¥è‡³äºä¸èƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­ã€‚</p><p><strong>Pollardâ€™s rhoç®—æ³•çš„è§£å†³ç­–ç•¥ï¼š</strong><br>ä¸ºäº†è§£å†³æ— æ³•å‚¨å­˜å¤ªå¤šæ•°çš„é—®é¢˜ï¼ŒPollardâ€™s rho Algorithmåªå°†ä¸¤ä¸ªæ•°å­˜æ”¾åœ¨å†…å­˜ä¸­ã€‚å…·ä½“æ€è·¯æ˜¯ï¼šæˆ‘ä»¬å¹¶ä¸éšæœºç”Ÿæˆkä¸ªæ•°å¹¶ä¸¤ä¸¤æ¯”è¾ƒï¼Œè€Œæ˜¯ä¸€ä¸ªä¸€ä¸ªåœ°ç”Ÿæˆå¹¶æ£€æŸ¥è¿ç»­çš„ä¸¤ä¸ªæ•°ã€‚åå¤æ‰§è¡Œè¿™ä¸ªæ­¥éª¤å¹¶å¸Œæœ›èƒ½å¤Ÿå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥ç”Ÿæˆä¼ªéšæœºæ•°ã€‚<br>æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ä¸æ–­ä½¿ç”¨ä¸€ä¸ªå‡½æ•°fæ¥ç”Ÿæˆï¼ˆå¯ä»¥è¿™æ ·å½¢å®¹ï¼‰éšæœºæ•°ã€‚å½“ç„¶å¹¶ä¸æ˜¯æ‰€æœ‰çš„å‡½æ•°éƒ½èƒ½è¿™æ ·åšï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå‡½æ•°å¯ä»¥ï¼š<br>&emsp;&emsp;&emsp;&emsp;$f(x) = (x^2 + a) mod N$<br>ï¼ˆå…¶ä¸­çš„ a å¯ä»¥ç”¨éšæœºæ•°ç”Ÿæˆï¼Œå½“ç„¶è¿™ä¸æ˜¯è®¨è®ºçš„é‡ç‚¹ã€‚ï¼‰<br>æˆ‘ä»¬ä»$x_1 = 2$å¼€å§‹ï¼Œè®©$x_2 = f(x_1) , x_3 = f(x_2),â€¦â€¦.$ï¼Œé€šé¡¹ä¸ºï¼š$x_{n+1} = f(x_n)$<br>äºæ˜¯é¡ºç€è¿™ä¸ªç­–ç•¥ï¼Œä¾æ®ä¸Šè¿°åˆ†æï¼Œä¸æ–­åˆ¤æ–­gcd($x_n - x_{n-1}$, n)æ˜¯å¦å¤§äº1å³å¯ã€‚</p><p><strong>å­˜åœ¨çš„é—®é¢˜ï¼š</strong><br>å¤§å¤šæƒ…å†µä¸‹ï¼Œè¿™ç§ç®—æ³•æ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ï¼Œä½†æ˜¯å¯¹äºæŸäº›æ•°æ®ï¼Œä¼šå‡ºç°æ— çº¿çš„æ­»å¾ªç¯ï¼ŒåŸå› åœ¨äºå‡½æ•°få­˜åœ¨è‡ªç¯ã€‚<br>äºæ˜¯é—®é¢˜å˜æˆäº†â€œå¦‚ä½•åˆ¤æ–­ç¯çš„å‡ºç°â€ã€‚ä¸€ç§æ–¹æ³•æ˜¯è®°å½•æ‰€æœ‰å‡ºç°è¿‡çš„æ•°ï¼Œå½“ç„¶è¿™ä¼šè€—è´¹å¤§é‡å†…å­˜ï¼Œæ•…èˆå¼ƒï¼›å¦ä¸€ç§æ–¹æ³•æ˜¯Floydå‘æ˜çš„ç®—æ³•ï¼Œè¿™é‡Œå¯ä»¥ä¸¾ä¸€ä¸ªæœ‰è¶£çš„ä¾‹å­è¯´æ˜â€œå‡è®¾Aå’ŒBåœ¨ä¸€ä¸ªå¾ˆé•¿çš„åœ†å½¢è½¨é“ä¸Šèµ°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åˆ¤æ–­Bæ˜¯å¦èµ°å®Œä¸€åœˆå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è®©Bçš„é€Ÿåº¦æ˜¯Açš„äºŒå€ï¼Œä»–ä»¬åŒæ—¶å‡ºå‘ï¼Œå½“Bç¬¬ä¸€æ¬¡è¿½ä¸ŠAï¼Œå°±çŸ¥é“Bè‡³å°‘å·²ç»èµ°äº†ä¸€åœˆâ€ï¼ŒåŒæ ·çš„é“ç†è¿ç”¨åˆ°è¯¥ç®—æ³•ä¸­ï¼Œæ¡†æ¶å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = 2;</span><br><span class="line">b = 2;</span><br><span class="line">while(b != a)&#123;</span><br><span class="line">a = f(a);//ä¸€å€é€Ÿ </span><br><span class="line">b = f(f(b));//äºŒå€é€Ÿ</span><br><span class="line">p = GCD(|b-a| , n);</span><br><span class="line">if(p &gt; 1) return &quot;Found factor: p&quot;; </span><br><span class="line">&#125;</span><br><span class="line">return &quot;Failed&quot;;</span><br></pre></td></tr></table></figure></p><h4 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h4><p>ç®€å•æ¢³ç†ä¸€ä¸‹ï¼Œç»™å‡ºä¸»è¦æ¡†æ¶è€Œä¸æ¶‰åŠç†è®ºè¯æ˜ã€‚<br>å‡è®¾ n ä¸ºå¾…åˆ†è§£çš„æ•°ï¼Œæˆ‘ä»¬å°†åˆ†è§£å‡ºæ¥çš„æ‰€æœ‰å› å­å­˜æ”¾åœ¨factors[110]æ•°ç»„ä¸­ï¼Œå½“ç„¶å­˜æ”¾çš„æ˜¯æ— åºçš„ç´ å› å­ã€‚<br><strong>findFac( long long n) å‡½æ•°ï¼š</strong><br>è´Ÿè´£å°† n åˆ†è§£æˆç´ å› å­ç›¸ä¹˜çš„å½¢å¼ï¼Œå¹¶å°†ç»“æœå­˜æ”¾åœ¨factorsæ•°ç»„ä¸­ã€‚</p><ul><li>å¦‚æœnæœ¬èº«å°±æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆå°†nå­˜æ”¾åœ¨factorä¾¿å¯ç»“æŸå¹¶è¿”å›ã€‚</li><li>å¦‚æœnä¸æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆé€šè¿‡ pollard_rho()å‡½æ•° æ‰¾åˆ°nçš„ä¸€ä¸ªå› å­p(ä¸ä¸€å®šæ˜¯ç´ å› å­)ï¼Œé€’å½’findFac(p)å’ŒfindFac(n/p)</li></ul><p><strong>pollard_rho(long long x, long long a)å‡½æ•°ï¼š</strong><br>è¿”å›xçš„ä¸€ä¸ªå› å­ï¼ˆä¸ä¸€å®šæ˜¯ç´ æ•°ï¼‰ï¼Œè‹¥å¤±è´¥åˆ™è¿”å›xã€‚<br>åˆ©ç”¨Floydå‘æ˜çš„ç±»ä¼¼â€œäºŒå€é€Ÿçš„ç®—æ³•â€ï¼Œå…·ä½“å‚è€ƒä¸Šè¿°ä¼ªä»£ç ã€‚</p><p><strong>æ³¨ï¼š</strong> å½“ç„¶è¿˜æœ‰ä¸€äº›è¾…åŠ©å‡½æ•°ï¼Œä¾‹å¦‚å¿«é€Ÿå¹‚ã€Miller-Rabinç®—æ³•ã€æ¬§å‡ é‡Œå¾—ç®—æ³•ç­‰ã€‚</p><h4 id="ç®—æ³•æ¨¡æ¿"><a href="#ç®—æ³•æ¨¡æ¿" class="headerlink" title="ç®—æ³•æ¨¡æ¿"></a>ç®—æ³•æ¨¡æ¿</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*---------------------------------------------</span></span><br><span class="line"><span class="comment"> POJ 1811 </span></span><br><span class="line"><span class="comment"> æœ€åæ›´æ–°ï¼š2019/8/11</span></span><br><span class="line"><span class="comment"> è¯´æ˜ï¼šè¯¥ä»£ç åŒ…å«äº†å–éšæœºå€¼å‡½æ•°rand()ä»¥åŠæ±‚æœ€å°å€¼å‡½æ•°min()</span></span><br><span class="line"><span class="comment"> æ³¨ï¼šé€‚ç”¨èŒƒå›´æ˜¯2^61,è‡³å°‘è¦ä¿è¯ä¸­é—´ç»“æœä¸ä¼šæº¢å‡ºlong long</span></span><br><span class="line"><span class="comment"> (ä¸­é—´ç»“æœæœ€å¤šæ˜¯2*n)</span></span><br><span class="line"><span class="comment"> ----------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="comment">/*---------------------------------------------</span></span><br><span class="line"><span class="comment"> åˆ©ç”¨ Miller-Rabinè¿›è¡Œç´ æ€§æµ‹è¯•</span></span><br><span class="line"><span class="comment"> ----------------------------------------------*/</span></span><br><span class="line"><span class="keyword">int</span> testnum[] = &#123;<span class="number">2</span>,<span class="number">7</span>,<span class="number">61</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">19</span>&#125;;</span><br><span class="line"><span class="function">ll <span class="title">fmul</span><span class="params">(ll a,ll b,ll p)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*è¿”å›a * b % p*/</span></span><br><span class="line">    a %= p,b %= p;          <span class="comment">//é˜²æ­¢è¶…å‡ºç²¾åº¦</span></span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res += a, res %= p;</span><br><span class="line">        a &lt;&lt;= <span class="number">1</span>;            <span class="comment">//a = a*2</span></span><br><span class="line">        <span class="keyword">if</span>(a &gt;= p) a %= p;  </span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;            <span class="comment">//b = b/2</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b,ll p)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*è¿”å›a^b % p*/</span></span><br><span class="line">    ll res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = fmul(res,a,p);</span><br><span class="line">        a = fmul(a,a,p);</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isPrime</span><span class="params">(ll n)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*Miller-Rabinåˆ¤å®šxæ˜¯å¦ä¸ºç´ æ•°*/</span></span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span>(n &lt; <span class="number">2</span> || n%<span class="number">2</span> == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    ll d = n<span class="number">-1</span>, a, x, y;<span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((d&amp;<span class="number">1</span>) == <span class="number">0</span>) d &gt;&gt;= <span class="number">1</span>,t++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">7</span>;i++)&#123;</span><br><span class="line">        a = testnum[i];</span><br><span class="line">        <span class="keyword">if</span>(n == a) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        x = qpow(a,d,n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; t;j++)&#123;</span><br><span class="line">            y = fmul(x,x,n);</span><br><span class="line">            <span class="keyword">if</span>(y == <span class="number">1</span> &amp;&amp; x != <span class="number">1</span> &amp;&amp; x != n<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            x = y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(x != <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*---------------------------------------------</span></span><br><span class="line"><span class="comment"> åˆ©ç”¨ pollard rho ç®—æ³•è¿›è¡Œè´¨å› æ•°åˆ†è§£ </span></span><br><span class="line"><span class="comment"> ----------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line">ll factors[<span class="number">110</span>];    <span class="comment">//ç”¨æ¥å­˜æ”¾è¢«åˆ†è§£çš„å› æ•°(æ— åº)</span></span><br><span class="line"><span class="keyword">int</span> tot = <span class="number">0</span>;        <span class="comment">//å› å­ä¸ªæ•°</span></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* è¿”å›aå’Œbçš„æœ€å¤§å…¬çº¦æ•° */</span></span><br><span class="line">    <span class="keyword">if</span>(a == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(a &lt; <span class="number">0</span>) <span class="keyword">return</span> gcd(-a,b);</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        ll t = a%b;</span><br><span class="line">        a = b; b = t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">pollard_rho</span><span class="params">(ll x,ll c)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* è¿”å› x çš„ä¸€ä¸ªå› å­æˆ– x æœ¬èº« */</span></span><br><span class="line">    ll i = <span class="number">1</span>,k = <span class="number">2</span>;</span><br><span class="line">    ll tx = rand()%x;</span><br><span class="line">    ll y = tx;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">        i++;</span><br><span class="line">        tx = (fmul(tx,tx,x)+c)%x;</span><br><span class="line">        ll d = gcd(y-tx,x);</span><br><span class="line">        <span class="keyword">if</span>(d != <span class="number">1</span> &amp;&amp; d != x) <span class="keyword">return</span> d;</span><br><span class="line">        <span class="keyword">if</span>(y == tx) <span class="keyword">return</span> x;       <span class="comment">//å¯»æ‰¾å¤±è´¥</span></span><br><span class="line">        <span class="keyword">if</span>(i == k) y = tx, k += k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">findFac</span><span class="params">(ll n)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* å¯¹ n è¿›è¡Œè´¨å› æ•°åˆ†è§£ */</span></span><br><span class="line">    <span class="keyword">if</span>(isPrime(n))&#123;</span><br><span class="line">        factors[++tot] = n;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    ll p = n;</span><br><span class="line">    <span class="comment">/* é€šè¿‡pollard_rhoç®—æ³•æ‰¾åˆ° n çš„ä¸€ä¸ªå› å­ p */</span></span><br><span class="line">    <span class="keyword">while</span>(p &gt;= n) p = pollard_rho(p,rand()%(n<span class="number">-1</span>)+<span class="number">1</span>);</span><br><span class="line">    findFac(p);     <span class="comment">//é€’å½’åˆ†è§£</span></span><br><span class="line">    findFac(n/p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t;ll n,ans;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n);</span><br><span class="line">        <span class="keyword">if</span>(isPrime(n)) <span class="built_in">puts</span>(<span class="string">"Prime"</span>);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            tot = <span class="number">0</span>; ans = <span class="number">1e18</span>; findFac(n);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= tot;i++) ans = <span class="built_in">std</span>::min(ans,factors[i]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°è®º </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ’åˆ†æ ‘æ¨¡æ¿</title>
      <link href="/2019/08/11/hfs/"/>
      <url>/2019/08/11/hfs/</url>
      
        <content type="html"><![CDATA[<h3 id="åˆ’åˆ†æ ‘ç¬”è®°"><a href="#åˆ’åˆ†æ ‘ç¬”è®°" class="headerlink" title="åˆ’åˆ†æ ‘ç¬”è®°"></a>åˆ’åˆ†æ ‘ç¬”è®°</h3><h4 id="é—®é¢˜æ¨¡å‹ï¼š"><a href="#é—®é¢˜æ¨¡å‹ï¼š" class="headerlink" title="é—®é¢˜æ¨¡å‹ï¼š"></a>é—®é¢˜æ¨¡å‹ï¼š</h4><blockquote><p>å¯¹äºç»™å®šçš„nä¸ªå…ƒç´ çš„åºåˆ—Aï¼Œæœ‰mæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™L ï¼ŒRï¼ŒKï¼Œè¯·æ±‚å‡ºä½äº[L,R]å†…ç¬¬Kå¤§çš„æ•°ã€‚</p></blockquote><h4 id="è§£é¢˜æ€è·¯ï¼š"><a href="#è§£é¢˜æ€è·¯ï¼š" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p><strong>æœ´ç´ ç®—æ³•ï¼š</strong><br>ç”¨å¿«é€Ÿæ’åºã€‚ç”±äºæˆ‘ä»¬æœ‰mæ¬¡è¯¢é—®ï¼Œè€Œæ¯æ¬¡è¯¢é—®åŒºé—´å·¦å³ç«¯ç‚¹æ˜¯ä¸åŒçš„ï¼Œæ•…å¦‚æœå¯¹æ¯ä¸ªè¯¢é—®è¿›è¡Œæ’åºï¼Œæˆ‘ä»¬åœ¨å¾—åˆ°ç­”æ¡ˆåè¿˜éœ€è¦å°†åºåˆ—æ¢å¤åŸçŠ¶ã€‚æŒ‰ç…§å¿«é€Ÿæ’åºçš„æ•ˆç‡O(nlgn)ï¼Œmæ¬¡è¯¢é—®å°±æ˜¯O(mnlgn)ã€‚å¦‚æœmå’Œnéƒ½å¾ˆå¤§ï¼Œæ•ˆç‡å°±ä½çš„å¯æ€œã€‚<br><strong>åˆ’åˆ†æ ‘ï¼š</strong><br>ç”±äºåˆ’åˆ†æ ‘æ˜¯åŸºäºçº¿æ®µæ ‘çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥å…ˆå›å¿†ä¸€ä¸‹çº¿æ®µæ ‘ã€‚çº¿æ®µæ ‘æ˜¯å°†ä¸€ä¸ªåŒºé—´åˆ’åˆ†æˆè‹¥å¹²å•å…ƒåŒºé—´ï¼Œå¹¶ç”¨äºŒå‰æ ‘ç»“æ„å‚¨å­˜ï¼Œå› è€Œå¯ä»¥å¿«é€Ÿä¿®æ”¹å’ŒæŸ¥è¯¢ã€‚åˆ’åˆ†æ ‘æ˜¯å¯¹ä¸€ä¸ªåºåˆ—è¿›è¡Œåˆ’åˆ†ï¼Œæ¯ä¸ªåºåˆ—æœ‰ä¸¤ä¸ªå­åºåˆ—ï¼Œå·¦å­åºåˆ—ä¸­çš„å…ƒç´ ä¸å¤§äºå³å­åºåˆ—æ‰€æœ‰å…ƒç´ ã€‚<br>å¦‚æœæˆ‘ä»¬ç”¨ä¸€ä¸ªæ•°ç»„tree[25][MAXN]æ¥å­˜æ”¾æ¯å±‚å¯¹åº”ä½ç½®çš„å…ƒç´ ï¼›åˆ›å»ºtoLeft[25][MAXN]ï¼Œå…¶ä¸­toLeft[dep][i]è¡¨ç¤ºç¬¬depå±‚ç¬¬1~iä¸ªå…ƒç´ æœ‰å¤šå°‘ä¸ªè¿›å…¥å·¦å­åºåˆ—ã€‚å‡è®¾æˆ‘ä»¬åŸå§‹åºåˆ—åŒºé—´ä¸º[L,R]ï¼ˆåˆå§‹æ—¶æ˜¯[1,n]ï¼‰ï¼Œè€Œæˆ‘ä»¬è¦æ‰¾åˆ°[l,r]ä¸­ç¬¬kå¤§çš„æ•°; <strong>è®¾cnt = toLeft[r] - toLeft[l-1]ï¼Œé‚£ä¹ˆè¯´æ˜[l,r]åŒºé—´å†…å‰cntå°çš„æ•°éƒ½åœ¨å·¦å­åºåˆ—ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸‹ä¸€æ­¥å°±å¯ä»¥æ ¹æ®kå’Œcntçš„å¤§å°å…³ç³»é€‰æ‹©èµ°å·¦å­åºåˆ—æˆ–å³å­åºåˆ—ï¼Œç›´è‡³æ‰¾åˆ°è¯¥å…ƒç´ ã€‚</strong> </p><h4 id="å»ºæ ‘ï¼š"><a href="#å»ºæ ‘ï¼š" class="headerlink" title="å»ºæ ‘ï¼š"></a>å»ºæ ‘ï¼š</h4><p><strong>å»ºæ ‘æ€è·¯ï¼š</strong><br>å»ºæ ‘è¿‡ç¨‹å¾ˆç®€å•ï¼Œå’Œçº¿æ®µæ ‘ç±»ä¼¼ï¼Œå°†ä¸€ä¸ªå¤§åŒºé—´åˆ’åˆ†æˆè‹¥å¹²å•ä½åŒºé—´ï¼Œè¿™é‡Œå•ä½åŒºé—´æ˜¯åªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶ã€‚åŠ ä¸Šæˆ‘ä»¬ä¹‹å‰è¯´äº†ï¼Œåˆ’åˆ†æ ‘çš„ å·¦å­åŒºé—´æ‰€æœ‰å…ƒç´  å°äº å³åŒºé—´çš„å…ƒç´ ï¼Œè€Œä¸ºäº†æ ‘çš„å¹³è¡¡ï¼ˆå¹³è¡¡æ‰æ˜¯æ•ˆç‡çš„ä¿è¯ï¼ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å–ä¸€ä¸ª<strong>ä¸­ä½æ•°</strong>ï¼Œå°†å½“å‰åŒºé—´ä¸­æ‰€æœ‰å°äºä¸­ä½æ•°çš„æ”¾åœ¨å·¦å­åºåˆ—ï¼Œåä¹‹æ”¾åœ¨å³å­åºåˆ—ã€‚å¦‚æ­¤åå¤äºŒåˆ†é€’å½’ç›´è‡³å½“å‰åŒºé—´åªæœ‰ä¸€ä¸ªå…ƒç´ ç»ˆæ­¢ã€‚<br>ä¹‹å‰æˆ‘ä»¬å¼€æ•°ç»„æ—¶ï¼Œåªå¼€äº†25å±‚ï¼Œå³tree[25][MAXN]ï¼Œå› ä¸ºå¦‚æœæˆ‘ä»¬çš„æ ‘æ„å»ºçš„è¶³å¤Ÿå¥½ï¼ˆå·¦å³å­æ ‘å…ƒç´ ä¸ªæ•°ç›¸è¿‘ï¼‰ï¼Œé‚£ä¹ˆ1e5è§„æ¨¡ä¸‹æ ‘é¡¶å¤š20å±‚ã€‚ï¼ˆè¿™é‡Œæˆ‘å°†æ ‘çš„æœ¯è¯­å’Œåºåˆ—ã€åŒºé—´æ··ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ç”¨æ•°ç»„æ¨¡æ‹Ÿå»ºæ ‘ï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šæ²¡ä»€ä¹ˆä¸åŒï¼Œé‡è¦çš„æ˜¯é€»è¾‘ç»“æ„è€Œä¸æ˜¯ç‰©ç†ç»“æ„ï¼‰<br><strong>ä¸­ä½æ•°ä¸å”¯ä¸€ï¼š</strong><br>æˆ‘ä»¬è¯´äº†å·¦å³å­æ ‘å…ƒç´ ä¸ªæ•°ç›¸è¿‘çš„æ ‘æ‰æ˜¯æœ€å¤Ÿå¥½çš„æ ‘ï¼Œå› ä¸ºè¿™æ ·æ ‘çš„æ·±åº¦æœ€å°ï¼Œè€Œæˆ‘ä»¬æŸ¥è¯¢æ“ä½œå’Œæ ‘çš„æ·±åº¦æˆæ­£æ¯”ã€‚å¦‚æœä¸­ä½æ•°å”¯ä¸€ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶å·¦å³å­åŒºé—´å…ƒç´ ä¸ªæ•°æœ€å¤šç›¸å·®1ï¼›å¦‚æœä¸å”¯ä¸€ï¼Œæ ¹æ®æˆ‘ä»¬çš„å®šä¹‰ï¼Œå·¦å­åŒºé—´æ”¾å°äºä¸­ä½æ•°çš„æ•°ï¼Œè¿™æ ·å¯èƒ½é€ æˆå·¦å³å­åŒºé—´å…ƒç´ ä¸ªæ•°ç›¸å·®è¿‡å¤§ï¼ˆè€ƒè™‘1ï¼Œ2ï¼Œ2ï¼Œ2ï¼Œ2ï¼Œ2ï¼Œ2ï¼Œ2ï¼Œ3ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç­–ç•¥æ¥åœ¨è¿™ç§æƒ…å†µä¸‹ä¿è¯æ•°ä»ç„¶å¹³è¡¡ã€‚<br>æƒ³è¦æ ‘å¹³è¡¡ï¼Œåªéœ€è®©å·¦å³å­æ ‘å…ƒç´ ä¸ªæ•°ç›¸è¿‘å°±è¡Œäº†ï¼Œå‡è®¾å½“å‰åŒºé—´æœ‰Nä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆå°±è¦åˆ†ç»™å·¦å­åŒºé—´N/2ä¸ªï¼Œå‰©ä¸‹çš„åˆ†ç»™å³åŒºé—´ã€‚æ‰€ä»¥æˆ‘ä»¬è®¾same = N/2ï¼Œå¦‚æœæˆ‘ä»¬å°†å½“å‰åŒºé—´æ‰€æœ‰å°äºä¸­ä½æ•°çš„å…ƒç´ éƒ½åˆ†ç»™äº†å·¦å­åŒºé—´ï¼Œä½†æ˜¯sameä»ä¸ä¸º0ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦å†åˆ†sameä¸ªä¸­ä½æ•°ç»™å·¦å­åŒºé—´ï¼Œç„¶åå†å°†å‰©ä¸‹çš„æ•°åˆ†ç»™å³å­åŒºé—´ã€‚å¦‚æ­¤ä¸€æ¥å·¦å­åŒºé—´å…ƒç´ ä¸ªæ•°ä¸ºsameï¼Œå³å­åŒºé—´ä¹Ÿä¸ºN-sameï¼Œæœ€å¤§ç›¸å·®1ã€‚</p><h4 id="æŸ¥è¯¢ï¼š"><a href="#æŸ¥è¯¢ï¼š" class="headerlink" title="æŸ¥è¯¢ï¼š"></a>æŸ¥è¯¢ï¼š</h4><p>å¯¹äºæŸ¥è¯¢ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“6ä¸ªä¿¡æ¯ï¼šå½“å‰åŒºé—´çš„å·¦å³ç«¯ç‚¹[L,R]ï¼Œéœ€è¦æŸ¥è¯¢çš„åŒºé—´[l,r]ï¼Œå½“å‰åŒºé—´æ‰€åœ¨çš„å±‚æ•°depï¼Œä»¥åŠkã€‚<strong>æˆ‘ä»¬æƒ³çŸ¥é“åœ¨åŒºé—´[L,R]å†…çš„å°åŒºé—´[l,r]å†…ç¬¬kå¤§çš„æ•°æ˜¯è°ã€‚</strong><br>è®¾cnt = toLeft[dep][r] - toLeft[dep][l-1]ï¼Œé‚£ä¹ˆè¯´æ˜[l,r]åŒºé—´å†…å‰cntå°çš„æ•°éƒ½åœ¨å·¦å­åºåˆ—ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸‹ä¸€æ­¥å°±å¯ä»¥æ ¹æ®kå’Œcntçš„å¤§å°å…³ç³»é€‰æ‹©èµ°å·¦å­åºåˆ—æˆ–å³å­åºåˆ—ï¼Œç›´è‡³æ‰¾åˆ°è¯¥å…ƒç´ ã€‚å…·ä½“å®ç°æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘Lå’ŒRå¦‚ä½•å˜åŒ–ï¼Œä»¥åŠå­åŒºé—´å†…lå’Œrä»¥åŠkå¦‚ä½•å˜åŒ–ï¼ˆå³å¦‚ä½•ç¼©å°å¯è¡ŒåŒºé—´ï¼‰ï¼Œè¯¦æƒ…è¯·å‚ç…§ä»£ç ç†è§£ã€‚</p><h4 id="ä»£ç æ¨¡æ¿ï¼š"><a href="#ä»£ç æ¨¡æ¿ï¼š" class="headerlink" title="ä»£ç æ¨¡æ¿ï¼š"></a>ä»£ç æ¨¡æ¿ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">åˆ’åˆ†æ ‘æ¨¡æ¿</span></span><br><span class="line"><span class="comment">åˆ›å»ºäºï¼š2019/4/10</span></span><br><span class="line"><span class="comment">æœ€åæ›´æ–°ï¼š2019/4/10 </span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100100</span>;</span><br><span class="line"><span class="keyword">int</span> tree[<span class="number">20</span>][MAXN];<span class="comment">//è¡¨ç¤ºæ¯å±‚æ¯ä¸ªä½ç½®çš„å€¼ </span></span><br><span class="line"><span class="keyword">int</span> toLeft[<span class="number">20</span>][MAXN]; <span class="comment">//å·²ç»æ’å¥½åºçš„æ•° </span></span><br><span class="line"><span class="comment">//toLeft[dep][i]ä¸ºdepå±‚[1,i]æœ‰å‡ ä¸ªèŠ‚ç‚¹åˆ†åˆ°å·¦å­åŒºé—´ </span></span><br><span class="line"><span class="keyword">int</span> sorted[MAXN];</span><br><span class="line"><span class="comment">//å½“å‰åºåˆ—çš„å·¦å³ç«¯ç‚¹ã€å±‚æ•° </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> dep)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> same = mid - l + <span class="number">1</span>;<span class="comment">//ç”¨äºå¤„ç†å¤šä¸ªä¸­ä½æ•°ç›¸ç­‰ </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = l;i &lt;= r;i++) </span><br><span class="line"><span class="keyword">if</span>(tree[dep][i]  &lt; sorted[mid]) same--;</span><br><span class="line"><span class="keyword">int</span> lpos = l;</span><br><span class="line"><span class="keyword">int</span> rpos = mid+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = l;i &lt;= r;i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(tree[dep][i] &lt; sorted[mid]) tree[dep+<span class="number">1</span>][lpos++] = tree[dep][i];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(tree[dep][i] == sorted[mid] &amp;&amp; same &gt; <span class="number">0</span>)&#123;</span><br><span class="line">tree[dep+<span class="number">1</span>][lpos++] = tree[dep][i];</span><br><span class="line">same--;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">tree[dep+<span class="number">1</span>][rpos++] = tree[dep][i];</span><br><span class="line">&#125;</span><br><span class="line">toLeft[dep][i] = toLeft[dep][l<span class="number">-1</span>] + lpos - l;</span><br><span class="line">&#125;</span><br><span class="line">build(l,mid,dep+<span class="number">1</span>);</span><br><span class="line">build(mid+<span class="number">1</span>,r,dep+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æŸ¥è¯¢åŒºé—´ç¬¬Kå¤§çš„æ•°ï¼Œ[L,R]æ˜¯å¤§åŒºé—´ï¼Œ[l,r]æ˜¯è¦æŸ¥è¯¢çš„å°åŒºé—´ </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> dep,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l == r) <span class="keyword">return</span> tree[dep][l];</span><br><span class="line"><span class="keyword">int</span> mid = (L+R)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> cnt = toLeft[dep][r] - toLeft[dep][l<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span>(cnt &gt;= k)&#123;</span><br><span class="line"><span class="keyword">int</span> newl = L + toLeft[dep][l<span class="number">-1</span>] - toLeft[dep][L<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">int</span> newr = newl + cnt - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> query(L,mid,newl,newr,dep+<span class="number">1</span>,k);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> newr = r + toLeft[dep][R] - toLeft[dep][r];</span><br><span class="line"><span class="keyword">int</span> newl = newr - (r-l-cnt);</span><br><span class="line"><span class="keyword">return</span> query(mid+<span class="number">1</span>,R,newl,newr,dep+<span class="number">1</span>,k-cnt);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n,m;<span class="comment">//nä¸ªå…ƒç´ ï¼Œmæ¬¡è¯¢é—® </span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;tree[<span class="number">0</span>][i]);</span><br><span class="line">sorted[i] = tree[<span class="number">0</span>][i];</span><br><span class="line">&#125; </span><br><span class="line">sort(sorted+<span class="number">1</span>,sorted+n+<span class="number">1</span>);</span><br><span class="line">build(<span class="number">1</span>,n,<span class="number">0</span>);<span class="comment">//å·¦é—­å³é—­ </span></span><br><span class="line"><span class="keyword">int</span> s,t,k;</span><br><span class="line"><span class="keyword">while</span>(m--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;s,&amp;t,&amp;k);</span><br><span class="line"><span class="comment">//åœ¨1~nä½ç½®ä¸­æ‰¾åˆ°s~tä½ç½®å†…ç¬¬kå¤§çš„æ•° </span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,query(<span class="number">1</span>,n,s,t,<span class="number">0</span>,k));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cdqåˆ†æ²»</title>
      <link href="/2019/08/11/cdq/"/>
      <url>/2019/08/11/cdq/</url>
      
        <content type="html"><![CDATA[<h2 id="CDQåˆ†æ²»ç¬”è®°"><a href="#CDQåˆ†æ²»ç¬”è®°" class="headerlink" title="CDQåˆ†æ²»ç¬”è®°"></a>CDQåˆ†æ²»ç¬”è®°</h2><h3 id="1-ç»“è®º"><a href="#1-ç»“è®º" class="headerlink" title="1.ç»“è®º"></a>1.ç»“è®º</h3><ul><li>CDQåˆ†æ²»å¯ä»¥ç”¨æ¥è§£å†³ååºé—®é¢˜ï¼Œå°¤å…¶å¯¹äºä¸‰ç»´ååºé—®é¢˜é€‚ç”¨ã€‚</li><li>CDQåˆ†æ²»é‡è¦æ€æƒ³ï¼šè®¡ç®—ä¸€ä¸ªå­é—®é¢˜å¯¹å¦ä¸€ä¸ªå­é—®é¢˜çš„è´¡çŒ®ã€‚</li><li>CDQåˆ†æ²»çš„ä¼˜åŠ£ï¼šå†™èµ·æ¥è¾ƒä¸ºç®€å•ï¼Œå¯¹æ—¶ç©ºæœ‰å¾ˆå¤§çš„ä¼˜åŒ–ï¼›ç¼ºç‚¹æ˜¯å¿…é¡»ç¦»çº¿æ“ä½œã€‚</li></ul><h3 id="2-äºŒç»´ååºé—®é¢˜"><a href="#2-äºŒç»´ååºé—®é¢˜" class="headerlink" title="2.äºŒç»´ååºé—®é¢˜"></a>2.äºŒç»´ååºé—®é¢˜</h3><h4 id="2-1é€†åºå¯¹"><a href="#2-1é€†åºå¯¹" class="headerlink" title="2.1é€†åºå¯¹"></a>2.1é€†åºå¯¹</h4><p><strong>é€†åºå¯¹:</strong> </p><blockquote><p>&emsp;&emsp;è®¾ A ä¸ºä¸€ä¸ªæœ‰ n ä¸ªæ•°å­—çš„æœ‰åºé›† (n&gt;1)ï¼Œå…¶ä¸­æ‰€æœ‰æ•°å­—å„ä¸ç›¸åŒã€‚å¦‚æœå­˜åœ¨æ­£æ•´æ•° i, j ä½¿å¾— 1 â‰¤ i &lt; j â‰¤ n è€Œä¸” A[i] &gt; A[j]ï¼Œåˆ™ <a[i], a[j]> è¿™ä¸ªæœ‰åºå¯¹ç§°ä¸º A çš„ä¸€ä¸ªé€†åºå¯¹ï¼Œä¹Ÿç§°ä½œé€†åºæ•°ã€‚</a[i],></p><p>ä¾‹å¦‚ï¼Œæ•°ç»„ï¼ˆ3ï¼Œ1ï¼Œ4ï¼Œ5ï¼Œ2ï¼‰çš„é€†åºå¯¹æœ‰(3,1),(3,2),(4,2),(5,2)ï¼Œå…±4ä¸ªã€‚<br>æ‰€è°“é€†åºå¯¹çš„é—®é¢˜ï¼Œå³å¯¹ç»™å®šçš„æ•°ç»„åºåˆ—ï¼Œæ±‚å…¶é€†åºå¯¹çš„æ•°é‡ã€‚</p></blockquote><p><strong>é€†åºå¯¹æ±‚è§£:</strong><br>&emsp;&emsp;æ­£å¦‚æˆ‘ä»¬åœ¨å½’å¹¶æ’åºç« èŠ‚æ‰€æ¥è§¦çš„é‚£æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ¨¡ä»¿å½’å¹¶æ’åºæ¥æ±‚è§£é€†åºå¯¹ï¼Œå…·ä½“è¯·å¤ä¹ å½’å¹¶æ’åºç›¸å…³å†…å®¹ã€‚<br>&emsp;&emsp;åœ¨ç”¨å½’å¹¶æ’åºè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ±‚é€†åºå¯¹çš„è¿‡ç¨‹å¯ä»¥çœ‹ä½œï¼šæ‰¾åˆ°ä¸€å¯¹æ•°ï¼Œä½¿å¾— i  &lt; j , ä¸” a[i] &gt; a[j]ã€‚è¿™é‡Œå®é™…ä¸Šæ˜¯äºŒä½ååºé—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬æ¶‰åŠåˆ°ä¸¤ä¸ªç»´åº¦çš„æ¯”è¾ƒï¼Œå³ä¸‹æ ‡å¤§å°ï¼ˆé»˜è®¤å‡åºï¼‰å’Œå€¼ã€‚åœ¨ç”¨å½’å¹¶æ€æƒ³æ±‚é€†åºå¯¹ï¼Œæˆ‘ä»¬æ˜¯æ ¹æ®â€å·¦åŒºé—´çš„ä¸‹æ ‡å¿…ç„¶å°äºå³åŒºé—´çš„ä¸‹æ ‡â€œè¿™ä¸ªç»“è®ºæ¥å½’å¹¶ç»Ÿè®¡é€†åºå¯¹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¿½ç•¥äº†â€œä¸‹æ ‡â€è¿™ä¸ªç»´åº¦çš„å½±å“ï¼Œå°†äºŒç»´ååºé—®é¢˜é™åˆ°äº†ä¸€ç»´ã€‚<br><strong>é€†åºå¯¹é—®é¢˜çš„å¯å‘:</strong><br>&emsp;&emsp;ç°åœ¨æˆ‘ä»¬å°†é—®é¢˜ç»™å‡ºï¼šâ€œæ±‚æ‰€æœ‰æ»¡è¶³a &lt; a0 ä¸” b &gt; b0çš„æœ‰åºå¯¹<a,b>å’Œ<a0,b0>â€ã€‚<br>&emsp;&emsp;æˆ‘ä»¬å¯ä»¥å‘ç°ä¸Šè¿°é—®é¢˜å’Œé€†åºå¯¹æœ‰ç›¸ä¼¼å¤„ä¹Ÿæœ‰ä¸åŒä¹‹å¤„ã€‚ç›¸ä¼¼åœ¨äºä»–ä»¬éƒ½æ˜¯æ±‚ååºé—®é¢˜ï¼Œå…·ä½“è¯´éƒ½æ˜¯æ±‚äºŒç»´ååºé—®é¢˜ï¼›ä¸åŒä¹‹å¤„åœ¨äºé€†åºå¯¹é—®é¢˜ä¸­ï¼Œæ•°ç»„ä¸‹æ ‡æ˜¯é»˜è®¤å‡åºçš„ï¼Œæ•…å¯ä»¥ç›´æ¥å½’å¹¶æ±‚è§£ï¼Œè€Œä¸Šè¿°é—®é¢˜å¹¶æ²¡æœ‰è¯´æ‰€æœ‰æ•°å¯¹æŒ‰ç…§ä»€ä¹ˆè§„åˆ™æ’åºï¼Œè¯´ç™½äº†å…¶å°±æ˜¯ä¹±åºçš„ã€‚<br>&emsp;&emsp;ä½†å®é™…ä¸Šæˆ‘ä»¬è€ƒè™‘åˆ°äºŒç»´ååºé—®é¢˜ï¼Œç”±äºæˆ‘ä»¬æ˜¯åœ¨ä¸€ä¸ªæ•°å¯¹é›†åˆï¼ˆå‡è®¾ä¸ºSï¼‰ä¸­æ‰¾æ‰€æœ‰æ»¡è¶³a &lt; a0 ä¸” b &gt; b0çš„æœ‰åºå¯¹<a,b>å’Œ<a0,b0>çš„é›†åˆTï¼Œé‚£ä¹ˆSé›†åˆå†…å…ƒç´ çš„æ’åºè§„åˆ™å®é™…ä¸Šå¯¹æœ€ç»ˆç»“æœé›†åˆTæ¯«æ— å½±å“ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†Sé›†åˆå†…çš„æ•°å¯¹æŒ‰ç…§aå‡åºæ’åˆ—ï¼Œè¿™æ ·å°±å°†äºŒç»´æ¯”è¾ƒé™åˆ°ä¸€ç»´ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ç±»ä¼¼æ±‚é€†åºå¯¹ä¸€æ ·ä½¿ç”¨å½’å¹¶æ€æƒ³æ±‚è§£äº†ã€‚<br><strong>å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œä¸€ä¸ªæ˜¯æŒ‰ç…§aå‡åºæ’åˆ—ï¼Œä¸€ä¸ªæ˜¯ä¹±åºï¼Œå…¶æœ€ç»ˆç»“æœç›¸åŒ</strong><br>è¡¨1ï¼šSé›†åˆä¸­æ•°å¯¹<a,b>æŒ‰ç…§aå‡åºæ’åˆ—</a,b></a0,b0></a,b></a0,b0></a,b></p><div class="table-container"><table><thead><tr><th>a</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th></tr></thead><tbody><tr><td>b</td><td>4</td><td>3</td><td>2</td><td>5</td><td>1</td></tr></tbody></table></div><p>è¡¨2ï¼šSé›†åˆä¸­æ•°å¯¹<a,b>ä¹±åºæ’åˆ—</a,b></p><div class="table-container"><table><thead><tr><th>a</th><th>1</th><th>3</th><th>5</th><th>4</th><th>2</th></tr></thead><tbody><tr><td>b</td><td>4</td><td>2</td><td>1</td><td>5</td><td>3</td></tr></tbody></table></div><p>ç»“æœé›†åˆT:</p><div class="table-container"><table><thead><tr><th>a</th><th>b</th><th>a0</th><th>b0</th></tr></thead><tbody><tr><td>1</td><td>4</td><td>2</td><td>3</td></tr><tr><td>1</td><td>4</td><td>3</td><td>2</td></tr><tr><td>2</td><td>3</td><td>3</td><td>2</td></tr><tr><td>1</td><td>4</td><td>5</td><td>1</td></tr><tr><td>2</td><td>3</td><td>5</td><td>1</td></tr><tr><td>3</td><td>2</td><td>5</td><td>1</td></tr><tr><td>4</td><td>5</td><td>5</td><td>1</td></tr></tbody></table></div><h4 id="2-2-CDQåˆ†æ²»æ±‚äºŒç»´ååº"><a href="#2-2-CDQåˆ†æ²»æ±‚äºŒç»´ååº" class="headerlink" title="2.2 CDQåˆ†æ²»æ±‚äºŒç»´ååº"></a>2.2 CDQåˆ†æ²»æ±‚äºŒç»´ååº</h4><p>&emsp;&emsp;å¦‚æœä¸Šé¢çš„é—®é¢˜ä½ çœ‹æ‡‚äº†ï¼Œé‚£ä¹ˆå…¶å®äºŒç»´çš„CDQåˆ†æ²»ä½ å°±å·²ç„¶äº†è§£äº†ã€‚å°†ä¸Šè¿°é—®é¢˜çš„è§£é¢˜æ€è·¯æ€»ç»“èµ·æ¥ï¼Œå°±æ˜¯ï¼š<strong>å…ˆæŒ‰ç…§ä¸€ç»´æ’åºï¼Œå†æŒ‰ç…§å¦ä¸€ç»´å½’å¹¶æ±‚ç»“æœé›†åˆTã€‚</strong> åœ¨ä¸Šè¿°åšæ³•ä¸­ï¼Œæˆ‘ä»¬çš„æ ¸å¿ƒæ€æƒ³æ˜¯ä½¿å¾—ä¸€ä¸ªç»´åº¦ï¼ˆå‡è®¾ä¸ºaï¼‰å¯¹æœ€ç»ˆç»“æœå˜å¾—æ¯«æ— å½±å“ï¼Œè¿™æ ·æˆ‘ä»¬å°±åªéœ€è¦åœ¨å¦ä¸€ç»´ï¼ˆå‡è®¾ä¸ºbï¼‰è€ƒè™‘æ¯”è¾ƒå³å¯ï¼Œæ­¤æ—¶å°±å¯ä»¥ç”¨å½’å¹¶äº†ã€‚</p><h4 id="2-3-äºŒç»´ååºé—®é¢˜çš„æ‹“å±•"><a href="#2-3-äºŒç»´ååºé—®é¢˜çš„æ‹“å±•" class="headerlink" title="2.3 äºŒç»´ååºé—®é¢˜çš„æ‹“å±•"></a>2.3 äºŒç»´ååºé—®é¢˜çš„æ‹“å±•</h4><p>&emsp;&emsp;æˆ‘ä»¬åœ¨ä¸Šè¿°è®¨è®ºçš„æ˜¯æ±‚æ»¡è¶³æ¡ä»¶çš„æœ‰åºå¯¹é›†åˆTçš„é—®é¢˜ã€‚ä½†æˆ‘ä»¬å¯ä»¥æ‹“å±•ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªæœ‰åºå¯¹<a,b>çœ‹ä½œæŸä¸ªæ•°æ®çš„ä¸‹æ ‡ï¼Œï¼ˆä¸€ä¸ªæ•°æ®æœ‰ä¿©ä¸ªå±æ€§ç»„æˆç ï¼‰é‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å°±å¯é€šè¿‡æ±‚è§£æ»¡è¶³æ¡ä»¶çš„é›†åˆTï¼Œå¹¶é€šè¿‡é›†åˆTä¸­çš„æ‰€æœ‰æœ‰åºå¯¹ï¼Œæ‰¾åˆ°å¯¹åº”çš„æ•°æ®å‘¢ï¼Ÿæ˜¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å½’å¹¶çš„æ–¹æ³•æ¥å¿«é€Ÿæ‰¾åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ®é›†åˆã€‚<br><strong>è€ƒè™‘å¦‚ä¸‹é—®é¢˜ï¼š</strong> </a,b></p><blockquote><p>ç»™å®šä¸€ä¸ªNä¸ªå…ƒç´ çš„åºåˆ—Aï¼Œåˆå§‹å€¼å…¨éƒ¨ä¸º0ï¼Œå¯¹è¿™ä¸ªåºåˆ—è¿›è¡Œä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š<br>ã€€ã€€æ“ä½œ1ï¼šæ ¼å¼ä¸º1 x kï¼ŒæŠŠä½ç½®xçš„å…ƒç´ åŠ ä¸Škï¼ˆä½ç½®ä»1æ ‡å·åˆ°Nï¼‰ã€‚<br>ã€€ã€€æ“ä½œ2ï¼šæ ¼å¼ä¸º2 x yï¼Œæ±‚å‡ºåŒºé—´[x,y]å†…æ‰€æœ‰å…ƒç´ çš„å’Œã€‚</p></blockquote><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>&emsp;&emsp;ä¸Šè¿°é—®é¢˜æ˜¯æ ‘çŠ¶æ•°ç»„çš„è£¸é¢˜ï¼Œä½†æˆ‘ä»¬ç”¨æ¥ç»ƒä¹ CDQåˆ†æ²»ï¼Œå¹¶è¿›ä¸€æ­¥äº†è§£å…¶æ€æƒ³ã€‚è€ƒè™‘åˆ°ç»™æˆ‘ä»¬çš„æ“ä½œé›†åˆï¼ˆè®¾ä¸ºQï¼‰æ˜¯æœ‰å…ˆåé¡ºåºçš„ï¼ˆä¾‹å¦‚å…ˆä¿®æ”¹ï¼Œå†æŸ¥è¯¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦å…ˆä¿®æ”¹å€¼å†æŸ¥è¯¢ï¼‰ï¼Œ<strong>æˆ‘ä»¬å‡è®¾å…¶åˆ°æ¥çš„æ—¶é—´ä¸ºtimeï¼Œé‚£ä¹ˆQé›†åˆä¸­æ‰€æœ‰å…ƒç´ å°±éƒ½æ˜¯æŒ‰ç…§timeå±æ€§é»˜è®¤å‡åºçš„äº†ã€‚</strong> ä½†æ˜¯ä»…ä»…ä¸€ä¸ªtimeå±æ€§è¿˜ä¸è¶³ä»¥è¡¨ç¤ºæ‰€æœ‰æ“ä½œï¼Œæˆ‘ä»¬å†è€ƒè™‘ç»™æ¯ä¸ªæ“ä½œåŠ ä¸€ä¸ªå±æ€§ï¼šposæ¥ä»£è¡¨æ“ä½œçš„ä½ç½®ã€‚<strong>é‚£ä¹ˆæ¯ä¸ªæ“ä½œå°±å¯ç”±timeå’Œposæ¥å”¯ä¸€æ ‡è¯†ï¼Œ</strong> è‡³äºæ“ä½œæ˜¯ä»€ä¹ˆæ“ä½œï¼ˆæ˜¯æ“ä½œ1è¿˜æ˜¯æ“ä½œ2ï¼Ÿï¼‰æš‚ä¸æ¢ç©¶ã€‚<br>&emsp;&emsp;<strong>å¦‚æ­¤ä¸€æ¥æ¯ä¸ªæ“ä½œqï¼Œéƒ½æœ‰ä¸€ä¸ªä¸‹æ ‡<time,pos>æ¥å”¯ä¸€æ ‡è¯†å®ƒã€‚</time,pos></strong> é‚£ä¹ˆæˆ‘ä»¬å°±åªéœ€å…ˆæ‰§è¡Œtimeå°çš„ï¼Œposé å‰çš„æ“ä½œï¼Œå°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆã€‚ï¼ˆä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾æœ‰ä¿©ä¸ªæ“ä½œï¼Œ1.ä¿®æ”¹ä½ç½®2ä¸Šçš„å€¼ä¸º4ï¼Œ2.æ±‚ä½äºåŒºé—´[1,3]æ‰€æœ‰æ•°çš„å’Œã€‚é‚£ä¹ˆæˆ‘ä»¬è‚¯å®šè¦å…ˆæ‰§è¡Œ1ï¼Œå†æ‰§è¡Œ2ï¼‰è€Œæ­¤æ—¶æˆ‘ä»¬åˆé‡åˆ°äº†ä¸€ä¸ªéº»çƒ¦ï¼Œæ“ä½œ2åŒºé—´æŸ¥è¯¢ï¼Œæ¶‰åŠåˆ°ä¸¤ä¸ªä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘å°†æ“ä½œ2åŒºé—´æŸ¥è¯¢æ“ä½œåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯æ“ä½œaï¼šå‡å»å½“å‰ä½ç½®å‰ç¼€å’Œï¼›å¦ä¸€ä¸ªæ˜¯æ“ä½œbï¼šåŠ ä¸Šå½“å‰ä½ç½®çš„å‰ç¼€å’Œã€‚<br>&emsp;&emsp;é‚£ä¹ˆæˆ‘ä»¬æ–°å»ºä¸€ä¸ªç»“æ„ä½“Node{ int type,pos,val; } æ¥ä»£è¡¨Qé›†åˆä¸­çš„ä¸€ä¸ªæ“ä½œã€‚å…¶å¯èƒ½æœ‰ä¸‰ç§æƒ…å†µï¼Œtype = 1æ—¶ä»£è¡¨ä¿®æ”¹æ“ä½œï¼Œæ­¤æ—¶å°†posä½ç½®ä¸Šçš„å…ƒç´ +valã€‚type = 2æ—¶ä»£è¡¨å‡å»posä½ç½®ä¸Šå‰ç¼€å’Œçš„æ“ä½œï¼Œtype = 3æ—¶è¡¨ç¤ºåŠ ä¸Šå½“å‰ä½ç½®ä¸Šå‰ç¼€å’Œçš„æ“ä½œï¼›è€Œå¯¹äº2ã€3ä¸¤ç§æ“ä½œï¼Œvalä¸ºç€æŸ¥è¯¢ç­”æ¡ˆæ‰€åœ¨çš„ä¸‹æ ‡ï¼Œå¦‚æ­¤ä¸€æ¥å°±å¯ä»¥å°†å‡å»å‰ç¼€å’Œæ“ä½œå’ŒåŠ ä¸Šå‰ç¼€å’Œæ“ä½œç»“æœç´¯åŠ åœ¨åŒä¸€ä¸ªä½ç½®ã€‚å¦‚æ­¤ä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å½’å¹¶æ¥å¿«é€Ÿæ±‚è§£ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">500050</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">500050</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXQ = MAXN*<span class="number">3</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> type,pos;</span><br><span class="line">    ll val;</span><br><span class="line">    Node(<span class="keyword">int</span> type,<span class="keyword">int</span> pos,ll val):type(type),pos(pos),val(val)&#123;&#125;</span><br><span class="line">    Node()&#123;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (Node b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(pos == b.pos) <span class="keyword">return</span> type &lt; b.type;</span><br><span class="line">        <span class="keyword">return</span> pos &lt; b.pos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> aidx = <span class="number">0</span>,qidx = <span class="number">0</span>;</span><br><span class="line">Node query[MAXQ];</span><br><span class="line">Node tmp[MAXQ];</span><br><span class="line">ll ans[MAXQ];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CDQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r<span class="number">-1</span>) <span class="keyword">return</span>;<span class="comment">//å·¦é—­å³å¼€å˜›</span></span><br><span class="line">    <span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">    CDQ(l,mid);</span><br><span class="line">    CDQ(mid,r);</span><br><span class="line">    <span class="keyword">int</span> p = l,q = mid,k = <span class="number">0</span>;</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(p &lt; mid &amp;&amp; q &lt; r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(query[p] &lt; query[q])&#123;</span><br><span class="line">            <span class="keyword">if</span>(query[p].type == <span class="number">1</span>)</span><br><span class="line">                sum += query[p].val;</span><br><span class="line">            tmp[k++] = query[p++];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> x = query[q].val;</span><br><span class="line">            <span class="keyword">if</span>(query[q].type == <span class="number">2</span>)</span><br><span class="line">                ans[x] -= sum;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(query[q].type == <span class="number">3</span>)</span><br><span class="line">                ans[x] += sum;</span><br><span class="line">            tmp[k++] = query[q++];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(p &lt; mid) tmp[k++] = query[p++];<span class="comment">//è¿™é‡Œä¸ç”¨å†ç´¯åŠ ä¿®æ”¹çš„å€¼ï¼Œå› ä¸ºç”¨ä¸åˆ°äº†å•Š </span></span><br><span class="line">    <span class="keyword">while</span>(q &lt; r)&#123;</span><br><span class="line">    <span class="comment">//è¿™é‡Œè¿˜éœ€å°†æˆ‘ä»¬ç´¯åŠ çš„ç»“æœè¿›è¡Œè¿ç®—ï¼Œæˆ‘ä»¬è§„å®šå°±æ˜¯è¦ç´¯åŠ å·¦åŒºé—´ï¼ŒæŸ¥è¯¢å³åŒºé—´å˜› </span></span><br><span class="line">        <span class="keyword">int</span> x = query[q].val;</span><br><span class="line">        <span class="keyword">if</span>(query[q].type == <span class="number">2</span>)</span><br><span class="line">            ans[x] -= sum;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(query[q].type == <span class="number">3</span>)</span><br><span class="line">            ans[x] += sum;</span><br><span class="line">        tmp[k++] = query[q++];</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; k;i++)</span><br><span class="line">        query[i+l] = tmp[i]; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">        query[qidx++] = Node(<span class="number">1</span>,i,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> a,b,c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line">        <span class="keyword">if</span>(a == <span class="number">1</span>)&#123;</span><br><span class="line">            query[qidx++] = Node(a,b,c);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            query[qidx++] = Node(<span class="number">2</span>,b<span class="number">-1</span>,aidx);</span><br><span class="line">            query[qidx++] = Node(<span class="number">3</span>,c,aidx);</span><br><span class="line">            aidx++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    CDQ(<span class="number">0</span>,qidx);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; aidx;i++) </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="3-ä¸‰ç»´ååºé—®é¢˜"><a href="#3-ä¸‰ç»´ååºé—®é¢˜" class="headerlink" title="3.ä¸‰ç»´ååºé—®é¢˜"></a>3.ä¸‰ç»´ååºé—®é¢˜</h3><h4 id="3-1-ä¾‹é¢˜"><a href="#3-1-ä¾‹é¢˜" class="headerlink" title="3.1 ä¾‹é¢˜"></a>3.1 ä¾‹é¢˜</h4><blockquote><p>&emsp;&emsp;å·²çŸ¥æœ‰nä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ æœ‰ä¸‰ä¸ªå±æ€§ï¼ˆai,bi,ciï¼‰ï¼Œç°åœ¨é—®å­˜åœ¨å¤šå°‘ä¸ªå…ƒç´ ï¼Œä½¿å¾—ai &lt; aj ä¸” bi &lt; bj ä¸” ci &lt; cjï¼Ÿè®¾f(i) ä¸ºå¯¹äºæ¯ä¸ªiï¼Œæ»¡è¶³æ¡ä»¶çš„jçš„ä¸ªæ•°ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>&emsp;&emsp;å’Œä¹‹å‰çš„äºŒç»´ååºé—®é¢˜ä¸åŒçš„æ˜¯ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦å¯¹ä¸‰ä¸ªç»´åº¦è¿›è¡Œæ¯”è¾ƒï¼Œå›æƒ³ä¸€ä¸‹å¯¹äºäºŒç»´æˆ‘ä»¬çš„å¤„ç†æ–¹æ³•ï¼šå…ˆå¯¹å…¶ä¸­ä¸€ä¸ªç»´åº¦è¿›è¡Œæ’åºï¼Œç„¶åé‡‡ç”¨å½’å¹¶çš„æ–¹æ³•æ¥å¯¹ç¬¬äºŒä¸ªç»´åº¦è¿›è¡Œç»Ÿè®¡ã€‚<br>&emsp;&emsp;å¦‚æœæˆ‘ä»¬è¿˜åƒä¹‹å‰é‚£æ ·æ“ä½œå¦‚ä½•å‘¢ï¼Ÿæˆ‘ä»¬æŒ‰ç…§aè¿›è¡Œæ’åºï¼Œç„¶åå†åˆ©ç”¨å½’å¹¶å¯¹å·¦è¾¹åŒºé—´å’Œå³è¾¹åŒºé—´è¿›è¡Œåˆå¹¶ï¼ˆæˆ‘ä»¬è¿™é‡Œç”¨å½’å¹¶é‡Œçš„è¯´æ³•ï¼‰ï¼Œåœ¨åˆå¹¶çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç”¨å’Œæ±‚é€†åºå¯¹ç±»ä¼¼çš„æ–¹æ³•ï¼Œæ¯”è¾ƒç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå³bï¼‰çš„å¤§å°ï¼Œæ­¤æ—¶é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•å¤„ç†cã€‚è¿™é‡Œæˆ‘ä»‹ç»çš„æ–¹æ³•æ˜¯åœ¨å¤„ç†cæ—¶ç”¨æ ‘çŠ¶æ•°ç»„ï¼Œæ ‘çŠ¶æ•°ç»„æ˜¯ç”¨æ¥å¿«é€Ÿæ±‚å‰ç¼€å’Œï¼Œå¹¶æ”¯æŒå¿«é€Ÿå•ç‚¹ä¿®æ”¹çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥<strong>ç”¨æ ‘çŠ¶æ•°ç»„æ¥å­˜æ”¾å°äºcçš„å…ƒç´ çš„ä¸ªæ•°ï¼Œå¦‚æ­¤ä¸€æ¥æ¯æ¬¡åœ¨å¯¹å³åŒºé—´è¿›è¡ŒæŸ¥æ‰¾æ‰€æœ‰å°äºciçš„cjçš„ä¸ªæ•°å³å¯ã€‚</strong> ï¼ˆå› ä¸ºajé»˜è®¤å°äºaiï¼Œæ‰€ä»¥å½“bj<biæ—¶ï¼Œæ‰¾åˆ°æ‰€æœ‰cj<ciå³å¯ï¼‰ &emsp;&emsp;**æ€»ç»“ï¼š** å¦‚æœç†è§£äº†cdqå¤„ç†äºŒç»´ååºå’Œæ ‘çŠ¶æ•°ç»„ï¼Œåè€Œè§‰å¾—ä¸‰ç»´ååºé—®é¢˜ç”¨cdq+æ ‘çŠ¶æ•°ç»„æ˜¯è‡ªç„¶è€Œç„¶ã€‚å†æ¥å½’çº³ä¸€ä¸‹cdqçš„ç‰¹ç‚¹ï¼Œ å³åŒºé—´é—´ä¼šç›¸äº’å½±å“ï¼Œåœ¨ä¸Šè¿°ä¾‹é¢˜ä¸­å…·ä½“ä½“ç°æ˜¯å·¦è¾¹çš„bå’Œcä¸å³è¾¹åŒºé—´çš„bå’Œcç»„æˆæœ€ç»ˆç­”æ¡ˆã€‚ **ä»£ç ç¤ºä¾‹ï¼š** <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æ´›è°·P3810</span></span><br><span class="line"><span class="comment">CDQåˆ†æ²»å†™æ³•</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">50</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> ll;</span><br><span class="line"><span class="keyword">int</span> n,k;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> a,b,c,val,id;</span><br><span class="line">    <span class="comment">//a,b,cä¸ºä¸‰ç»´æ•°å¯¹çš„ä¸‰ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment">//valä¸ºå‡ºç°æ¬¡æ•° </span></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node &amp;B) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(a == B.a)&#123;</span><br><span class="line">            <span class="keyword">if</span>(b == B.b) <span class="keyword">return</span> c &lt; B.c;</span><br><span class="line">            <span class="keyword">return</span> b &lt; B.b;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> a &lt; B.a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> Node&amp; B) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> a == B.a &amp;&amp; b == B.b &amp;&amp; c == B.c;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Node nodes[maxn];<span class="comment">//è¿›è¡Œå½’å¹¶æ’åºæ—¶ç”¨çš„æ•°ç»„ </span></span><br><span class="line">Node tmp[maxn];<span class="comment">//å½’å¹¶æ—¶ç”¨çš„ä¸´æ—¶æ•°ç»„ </span></span><br><span class="line">Node aa[maxn];<span class="comment">//è¯»å…¥æ•°ç»„ï¼Œæ­¤æ•°ç»„æœ‰é‡å¤å…ƒç´  </span></span><br><span class="line"><span class="keyword">int</span> stree[<span class="number">2</span>*maxn];<span class="comment">//æ ‘çŠ¶æ•°ç»„è¾…åŠ©æ•°ç»„ </span></span><br><span class="line"><span class="keyword">int</span> par[maxn];<span class="comment">//å»é‡æ—¶ä½¿ç”¨çš„è¾…åŠ©æ•°ç»„ </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[maxn],ans[maxn],ts[maxn],ff[maxn];</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">fæ•°ç»„æ˜¯ç”¨æ¥è®°å½•nodeså½’å¹¶çš„ç»“æœï¼Œå³å»é‡åçš„ç»“æœï¼Œå…¶ä»–å‡ ä¸ªç”¨æ¥è¾…åŠ©æ±‚æœ€ç»ˆç­”æ¡ˆ </span></span><br><span class="line"><span class="comment">ansæ˜¯æœ€ç»ˆç­”æ¡ˆæ•°ç»„</span></span><br><span class="line"><span class="comment">ts[i]å­˜æ”¾idä¸ºiçš„æ•°å¯¹é‡å¤å‡ºç°äº†å‡ æ¬¡ï¼ˆå€¼ç›¸ç­‰ï¼‰</span></span><br><span class="line"><span class="comment">par[i]æ˜¯idä¸ºiçš„æ•°å»é‡åæ‰€åœ¨nodesæ•°ç»„ä¸­çš„"ä»£è¡¨"çš„id </span></span><br><span class="line"><span class="comment">ffæ•°ç»„è®°å½•äº†æœ‰é‡å¤çš„æ•°æ®çš„ååºç»“æœï¼Œffå¯ç”±fã€tså’Œparå¾—åˆ° </span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(;x &lt; <span class="number">2</span>*maxn;x += x&amp;-x) stree[x] += y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;x;x -= x&amp;-x) ans += stree[x];</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;<span class="comment">//æˆ‘ä»¬è§„å®šå·¦é—­å³å¼€ï¼Œå–ä¸åˆ° r </span></span><br><span class="line">    <span class="keyword">if</span>(r-l &lt;= <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">    solve(l,mid);<span class="comment">//é€’å½’å·¦åŒºé—´ </span></span><br><span class="line">    solve(mid,r);<span class="comment">//é€’å½’å³åŒºé—´ </span></span><br><span class="line">    <span class="keyword">int</span> p = l,q = mid,k = l;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(p &lt; mid &amp;&amp; q &lt; r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nodes[p].b &lt;= nodes[q].b)&#123;</span><br><span class="line">            add(nodes[p].c,nodes[p].val);</span><br><span class="line">            tmp[k++] = nodes[p++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(nodes[p].b &gt; nodes[q].b)&#123;</span><br><span class="line">            f[nodes[q].id] += ask(nodes[q].c);</span><br><span class="line">            tmp[k++] = nodes[q++];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">while</span>(q &lt; r)&#123;</span><br><span class="line">        f[nodes[q].id] += ask(nodes[q].c);</span><br><span class="line">        tmp[k++] = nodes[q++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = l;i &lt; p;i++) add(nodes[i].c,-nodes[i].val);</span><br><span class="line">    <span class="comment">//ç”¨è¿™ç§æ–¹æ³•æ¥æ¸…ç©ºæ ‘çŠ¶æ•°ç»„ï¼Œå› ä¸ºmemsetæ˜¯O(n^2)ï¼Œä¼šè¶…æ—¶ </span></span><br><span class="line">    <span class="keyword">while</span>(p &lt; mid) tmp[k++] = nodes[p++];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = l;i &lt; r;i++)</span><br><span class="line">        nodes[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;aa[i].a,&amp;aa[i].b,&amp;aa[i].c);</span><br><span class="line">        aa[i].id = i,aa[i].val = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(aa+<span class="number">1</span>,aa+n+<span class="number">1</span>);<span class="comment">//å…ˆæŒ‰ç…§aæ’åºï¼Œè¿™æ ·å°±å¯ä»¥å¿½ç•¥açš„å½±å“äº† </span></span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    nodes[++cnt] = aa[<span class="number">1</span>];</span><br><span class="line">    <span class="comment">//ä»¥ä¸‹ä»£ç å—æ˜¯ç”¨æ¥å»é‡ï¼Œå¹¶è®°å½•å¿…è¦ä¿¡æ¯ </span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(aa[i] == aa[i<span class="number">-1</span>])&#123;</span><br><span class="line">    par[aa[i].id] = nodes[cnt].id;</span><br><span class="line">    ts[nodes[cnt].id]++;</span><br><span class="line">    nodes[cnt].val++;</span><br><span class="line">&#125; </span><br><span class="line">    <span class="keyword">else</span> nodes[++cnt] = aa[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    solve(<span class="number">1</span>,cnt+<span class="number">1</span>);</span><br><span class="line">    <span class="comment">//é€šè¿‡å»é‡åCDQåˆ†æ²»å¾—åˆ°çš„ç»“æœæ•°ç»„fï¼Œæ¥æ¨å‡ºæ²¡å»é‡çš„ç»“æœå¹¶å­˜æ”¾åœ¨ffä¸­ </span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(par[i]) ff[i] = f[par[i]] + ts[par[i]];</span><br><span class="line">    <span class="keyword">else</span> ff[i] = f[i] + ts[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æŒ‰ç…§é¢˜æ„è¦æ±‚è¾“å‡ºç­”æ¡ˆ </span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)ans[ff[i]]++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)<span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></biæ—¶ï¼Œæ‰¾åˆ°æ‰€æœ‰cj<ciå³å¯ï¼‰></p></blockquote><h4 id="3-2-ä¸‰ç»´ååºé—®é¢˜æ‹“å±•"><a href="#3-2-ä¸‰ç»´ååºé—®é¢˜æ‹“å±•" class="headerlink" title="3.2 ä¸‰ç»´ååºé—®é¢˜æ‹“å±•"></a>3.2 ä¸‰ç»´ååºé—®é¢˜æ‹“å±•</h4><p>&emsp;&emsp;åœ¨äºŒç»´ååºé—®é¢˜æ‹“å±•ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨äºŒç»´æœ‰åºå½“ä½œç´¢å¼•ï¼Œæ¥æŸ¥æ‰¾æƒ³è¦çš„ç»“æœã€‚ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä¸å¯ä»¥ç”¨ä¸‰ç»´æœ‰åºå¯¹æ¥å½“ä¸‹æ ‡ï¼Œæ‰¾å¯»æƒ³è¦çš„ç­”æ¡ˆé›†åˆTå‘¢ï¼Ÿ<br><strong>ä¾‹é¢˜ï¼š</strong> </p><blockquote><p>&emsp;&emsp;å¹³é¢ä¸Šæœ‰Nä¸ªç‚¹ï¼Œæ¯ä¸ªç‚¹çš„æ¨ªçºµåæ ‡åœ¨[0,1e7]ä¹‹é—´ï¼Œæœ‰Mä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®ä¸ºæŸ¥è¯¢åœ¨æŒ‡å®šçŸ©å½¢ä¹‹å†…æœ‰å¤šå°‘ä¸ªç‚¹ï¼ŒçŸ©å½¢ç”¨(x1,y1,x2,y2)çš„æ–¹å¼ç»™å‡ºï¼Œå…¶ä¸­(x1,y1)ä¸ºå·¦ä¸‹è§’åæ ‡ï¼Œ(x2,y2)ä¸ºå³ä¸Šè§’åæ ‡ã€‚</p></blockquote><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>&emsp;&emsp;æˆ‘ä»¬åŒæ ·å°†æŸ¥è¯¢åŒºé—´å†…ç‚¹æ•°é‡åˆ†æˆå››ä¸ªæ±‚å‰ç¼€å’Œæ“ä½œï¼ˆè¿™é‡Œéœ€è¦ç”¨å®¹æ–¥åŸç†ï¼‰ã€‚å°†å¹³é¢ä¸Šç‚¹çœ‹æˆæ’å…¥æ“ä½œï¼ŒæŸ¥è¯¢çŸ©å½¢å†…ç‚¹ä¸ªæ•°çœ‹æˆæŸ¥è¯¢æ“ä½œã€‚é‚£ä¹ˆå¯¹äºæ¯ä¸ªæ“ä½œï¼Œæœ‰<time , x y>ä¸‰ä¸ªç»´åº¦ä½œä¸ºç´¢å¼•ï¼ˆæˆ–è€…ä¸‹æ ‡ï¼‰ï¼Œåˆå› ä¸ºtimeæ˜¯é»˜è®¤æœ‰åºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ ¹æ®xå½’å¹¶ï¼ŒåŒæ—¶ç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤yçš„å‰ç¼€å’Œã€‚æˆ‘ä»¬æŒ‰ç…§CDQåˆ†æ²»çš„æ€æƒ³ï¼Œç»Ÿè®¡å·¦è¾¹åŒºé—´èŠ‚ç‚¹å¯¹å³è¾¹åŒºé—´æŸ¥è¯¢çš„è´¡çŒ®ã€‚ï¼ˆè¿™é‡Œæ‰€è¯´çš„å·¦å³åŒºé—´æ¦‚å¿µå¼•è‡ªå½’å¹¶æ’åºï¼‰è¯¦ç»†æ€æƒ³è¯·å¯¹ç…§ä»£ç ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">BZOJ1935</span></span><br><span class="line"><span class="comment">å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">CDQ+æ ‘çŠ¶æ•°ç»„ </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e5</span>+<span class="number">50</span>;<span class="comment">//æœ€å¤§èŠ‚ç‚¹æ•°é‡ </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> op,x,y,val;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">op = 1æ˜¯ä¿®æ”¹å€¼æ“ä½œï¼Œ2æ˜¯å‡å»å‰ç¼€å’Œæ“ä½œï¼Œ3æ˜¯åŠ ä¸Šå‰ç¼€å’Œæ“ä½œ</span></span><br><span class="line"><span class="comment">xã€yä»£è¡¨åæ ‡</span></span><br><span class="line"><span class="comment">valæœ‰ä¸¤é‡ç”¨æ³•ï¼Œ å½“æ˜¯ä¿®æ”¹å€¼æ“ä½œæ—¶ï¼Œvalä»£è¡¨è¦ä¿®æ”¹çš„å€¼ï¼› </span></span><br><span class="line"><span class="comment">å½“è¡¨ç¤ºæ±‚å‰ç¼€å’Œæ“ä½œæ—¶ï¼Œvalä»£è¡¨ç­”æ¡ˆæ•°ç»„ansçš„ä¸‹æ ‡ï¼ˆå› ä¸ºæœ€ç»ˆç»“æœè¦ç´¯åŠ ï¼‰ </span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> Node &amp;B) <span class="keyword">const</span>&#123; </span><br><span class="line"><span class="comment">//xä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œyä¸ºç¬¬äºŒå…³é”®å­—ï¼Œopä¸ºç¬¬ä¸‰å…³é”®å­—ï¼Œå‡åºæ’åº </span></span><br><span class="line"><span class="keyword">if</span>(x == B.x)&#123;</span><br><span class="line"><span class="keyword">if</span>(y == B.y) <span class="keyword">return</span> op &lt; B.op;</span><br><span class="line"> <span class="keyword">return</span> y &lt; B.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x &lt; B.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ„é€ å‡½æ•°ï¼Œæ— å‚çš„ç”¨æ¥åˆ›å»ºæ•°ç»„ï¼Œæœ‰å‚çš„ç”¨æ¥å¿«é€Ÿèµ‹å€¼ </span></span><br><span class="line">Node()&#123;&#125;</span><br><span class="line">Node(<span class="keyword">int</span> op,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> val):op(op),x(x),y(y),val(val)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">Node Q[<span class="number">7</span>*maxn];<span class="comment">//ä¸ºå•¥æ˜¯7å€ï¼Œå› ä¸ºæ¯ä¸ªæŸ¥è¯¢æ“ä½œè¢«åˆ†æˆå››ä¸ªå­æ“ä½œäº†å˜› </span></span><br><span class="line">Node tmp[<span class="number">7</span>*maxn];</span><br><span class="line"><span class="keyword">int</span> ans[maxn],st[<span class="number">10100000</span>];<span class="comment">//æ ‘çŠ¶æ•°ç»„æ²¡å¼€ç¦»æ•£åŒ–ï¼Œå½“ç„¶å¦‚æœèŒƒå›´å†å¤§ç‚¹å°±è¦å¼€äº† </span></span><br><span class="line"><span class="keyword">int</span> qidx = <span class="number">0</span>,aidx = <span class="number">2</span>;<span class="comment">//åˆ†åˆ«ä»£è¡¨æŸ¥è¯¢é›†åˆQå’Œç­”æ¡ˆé›†åˆansçš„ä¸‹æ ‡ </span></span><br><span class="line"><span class="comment">//ä»¥ä¸‹ä¿©ä¸ªå‡½æ•°æ˜¯æ ‘çŠ¶æ•°ç»„çš„å‡½æ•° </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x &lt; maxn;x += x&amp;-x) st[x] += y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x -= x&amp;-x) sum += st[x];</span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//CDQåˆ†æ²»çš„ç”¨æ³• </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(r-l &lt;= <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">solve(l,mid);</span><br><span class="line">solve(mid,r);</span><br><span class="line"><span class="keyword">int</span> p = l,q = mid,k = l;</span><br><span class="line"><span class="keyword">while</span>(p &lt; mid &amp;&amp; q &lt; r)&#123;</span><br><span class="line"><span class="keyword">if</span>(Q[p] &lt; Q[q])&#123;</span><br><span class="line"><span class="keyword">if</span>(Q[p].op == <span class="number">1</span>) add(Q[p].y,Q[p].val);</span><br><span class="line">tmp[k++] = Q[p++];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(Q[q].op == <span class="number">2</span>)  ans[Q[q].val] -= ask(Q[q].y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(Q[q].op == <span class="number">3</span>)ans[Q[q].val] += ask(Q[q].y);</span><br><span class="line">tmp[k++] = Q[q++];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(q &lt; r)&#123;</span><br><span class="line"><span class="keyword">if</span>(Q[q].op == <span class="number">2</span>)  ans[Q[q].val] -= ask(Q[q].y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(Q[q].op == <span class="number">3</span>) ans[Q[q].val] += ask(Q[q].y);</span><br><span class="line">tmp[k++] = Q[q++];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æˆ‘ä»¬ç”¨è¿™ç§æ–¹æ³•æ¥æ¸…ç©ºæ ‘çŠ¶æ•°ç»„ï¼Œå¯ä»¥èŠ‚çœæ—¶é—´ </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = l;i &lt; p;i++)</span><br><span class="line"><span class="keyword">if</span>(Q[i].op == <span class="number">1</span>) add(Q[i].y,-Q[i].val);</span><br><span class="line"><span class="keyword">while</span>(p &lt; mid) tmp[k++] = Q[p++];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = l;i &lt; r;i++) Q[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">Q[qidx++] = Node(<span class="number">1</span>,x+<span class="number">1</span>,y+<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> x1,y1,x2,y2;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;x1,&amp;y1,&amp;x2,&amp;y2);</span><br><span class="line">Q[qidx++] = Node(<span class="number">3</span>,x1,y1,aidx);</span><br><span class="line">Q[qidx++] = Node(<span class="number">2</span>,x1,y2+<span class="number">1</span>,aidx);</span><br><span class="line">Q[qidx++] = Node(<span class="number">2</span>,x2+<span class="number">1</span>,y1,aidx);</span><br><span class="line">Q[qidx++] = Node(<span class="number">3</span>,x2+<span class="number">1</span>,y2+<span class="number">1</span>,aidx++);</span><br><span class="line">&#125;</span><br><span class="line">solve(<span class="number">0</span>,qidx);<span class="comment">//ä¾æ—§å·¦é—­å³å¼€ </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; aidx;i++) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></time></p><h5 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h5><ul><li><p><a href="http://www.cnblogs.com/mlystdcall/p/6219421.html" target="_blank" rel="noopener">åšå®¢</a></p></li><li><p>ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹-æç…œä¸œ.P197(æ ‘çŠ¶æ•°ç»„)</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>stè¡¨ï¼ˆä¸€ç»´ï¼‰</title>
      <link href="/2019/08/11/st/"/>
      <url>/2019/08/11/st/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>STè¡¨æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†åŒºé—´æœ€å€¼æŸ¥è¯¢ï¼ˆRange Maximum/Minimum Queryï¼‰çš„ç¦»çº¿ç®—æ³•ã€‚è¯¥ç®—æ³•åˆ†ä¸ºç¦»çº¿é¢„å¤„ç†O(n log n)å’ŒæŸ¥è¯¢O(1)ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå…¶ç”¨åˆ°äº†å€å¢çš„æ€æƒ³ã€‚<br>æŸä¸ªåŒºé—´æŸ¥è¯¢é—®é¢˜æ˜¯å¦é€‚ç”¨STè¡¨ï¼Œå…³é”®åœ¨äºå…¶è¿›è¡Œçš„æ“ä½œæ˜¯å¦å…è®¸åŒºé—´é‡å ï¼Œä¾‹å¦‚max(a,b,c) = max{max(a,b),max(b,c)}å°±å¯ä»¥ç”¨STè¡¨ç»´æŠ¤ï¼Œè€ŒåŒºé—´å’Œé—®é¢˜åˆ™ä¸èƒ½ç»´æŠ¤ã€‚</p><h4 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h4><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnçš„åºåˆ—ï¼Œæœ‰mæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡ç»™å®šåŒºé—´[L , R]ï¼Œæ±‚åŒºé—´å†…æœ€å¤§å€¼ã€‚</p><h4 id="ç®—æ³•æ€è·¯"><a href="#ç®—æ³•æ€è·¯" class="headerlink" title="ç®—æ³•æ€è·¯"></a>ç®—æ³•æ€è·¯</h4><p><strong>å®šä¹‰stè¡¨</strong><br>æˆ‘ä»¬è®¾ st[i][j] ä¸ºä» i å¼€å§‹çš„ 2^j ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼ã€‚å‡è®¾è¿™nä¸ªæ•°å­˜æ”¾çš„åºåˆ—aä¸­ï¼Œæ ¹æ®å®šä¹‰ st[i][j] = max{a[k] | i &lt;= k &lt;= i+2^j - 1}ã€‚<br><strong>æŸ¥è¯¢æ“ä½œ</strong><br>å‡è®¾æˆ‘ä»¬å·²ç»æ›´æ–°å®Œstè¡¨ï¼ˆä¸‹æ–‡ä¼šè®²å¦‚ä½•åœ¨O(n log n)æ—¶é—´å†…æ›´æ–°ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å¦‚ä½•åˆ©ç”¨ä¸Šè¿°å®šä¹‰çš„stè¡¨æŸ¥è¯¢[L , R]å†…çš„æœ€å¤§å€¼å‘¢ï¼Ÿ<br>æ ¹æ®æˆ‘ä»¬ä¸Šè¿°stè¡¨çš„å®šä¹‰ï¼Œæˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬èƒ½åœ¨stè¡¨ä¸­æŸ¥è¯¢çš„åŒºé—´ï¼ˆå‡è®¾ä¸º[a,b]ï¼‰éƒ½åªèƒ½ä»æŸä¸ªä½ç½®aå¼€å§‹å‘å$2^k-1$ä¸ªåŒºé—´ï¼ˆkæ˜¯è‡ªç„¶æ•°ï¼‰ï¼Œæ‰€ä»¥å¦‚æœa-b å¹¶ä¸æ°å¥½ç­‰äº $2^k$ï¼Œé‚£ä¹ˆå¤šå‡ºæ¥çš„éƒ¨åˆ†ï¼ˆå³$[a+2^k , b]$ï¼‰æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥æ±‚å‡ºæ¥ï¼Œåªèƒ½ç”¨ç±»ä¼¼çš„æ–¹æ³•æ±‚å‡º$[b-2^k+1,b]$çš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆæœ€ç»ˆ[a,b]çš„æœ€å¤§å€¼ä¸å°±æ˜¯ä»¥ä¸Šä¸¤æ®µåŒºé—´çš„maxå—ï¼Ÿå½“ç„¶è¿™é‡Œçš„kè¦å–ä½¿å¾—$a+2^k &lt; b$æˆç«‹çš„æœ€å¤§å€¼ï¼Œå³$log_2^{b-a+1}$ã€‚<br>ä¸¾ä¸ªä¾‹å­ï¼Œæ±‚[2 , 10]çš„æœ€å¤§å€¼å¯ä»¥æ‹†åˆ†ä¸ºæ±‚[2 , 9]çš„æœ€å¤§å€¼å’Œ[3 , 10]çš„æœ€å¤§å€¼ã€‚<br>äºæ˜¯æŸ¥è¯¢æ“ä½œï¼ˆæŸ¥è¯¢[L , R] ï¼‰å°±é¡ºåˆ©æˆç« çš„æ˜¯max(st[L][k] , st[R-(1&lt;&lt;k) + 1][k])ã€‚<br><strong>é¢„å¤„ç†</strong><br>æˆ‘ä»¬åœ¨ä¸Šè¿°è¯æ˜äº†æŸ¥è¯¢æ“ä½œç¡®å®æ˜¯O(1)çš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬çœŸçš„èƒ½æŒ‰ç…§stè¡¨å®šä¹‰çš„é‚£æ ·å»æ›´æ–°å®ƒï¼Œé‚£ä¹ˆè¯¥ç®—æ³•å°±çœŸæ­£çš„å®Œæˆäº†ã€‚æ›´æ–°stè¡¨ç”¨åˆ°äº†åŠ¨æ€è§„åˆ’çš„æ€æƒ³ã€‚<br>æ›´æ–°ä¸­ä»ç„¶ç”¨åˆ°äº†å€å¢çš„æ€æƒ³ï¼Œä½¿å¾—æ›´æ–°æ“ä½œä»O(n^2)ä¼˜åŒ–åˆ°äº†O(n log n)ï¼Œåˆå§‹çŠ¶æ€st[x][0] = a[x]ï¼Œst[x][j] = max(st[x][j-1] , st[x + (1&lt;&lt;(j-1)) ][j-1])ã€‚å…¶æ€æƒ³å’Œä¸Šè¿°é‡å æŸ¥è¯¢ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚ä½†æ˜¯è¦æ³¨æ„æ›´æ–°é¡ºåºï¼Œå› ä¸ºå…¶ä¸­ j ï¼ˆç¬¬äºŒç»´ï¼‰æ‰æ˜¯é˜¶æ®µï¼Œè€Œç¬¬ä¸€ç»´ x æ˜¯çŠ¶æ€ï¼Œæ‰€ä»¥å¯¹äº j çš„å¾ªç¯è¦æ”¾åœ¨æœ€å¤–å±‚ã€‚</p><h4 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> a[N],st[N][<span class="number">25</span>],Log[N];<span class="comment">//2^20å°±è¿‡ä¸€ç™¾ä¸‡äº†ï¼Œå®Œå…¨å¤Ÿç”¨ </span></span><br><span class="line"><span class="comment">//åˆå§‹åŒ–stè¡¨ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">Log[<span class="number">1</span>] = <span class="number">0</span>;<span class="comment">//é¢„å¤„ç†logå‡½æ•° </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n+<span class="number">1</span>;i++) Log[i] = Log[i/<span class="number">2</span>]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) st[i][<span class="number">0</span>] = a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; (<span class="number">1</span>&lt;&lt;j) &lt;= n;j++)&#123;<span class="comment">//æ¶‰åŠåˆ°ä½è¿ç®—å¤šåŠ æ‹¬å·! </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>)) &lt;= n;i++)&#123;</span><br><span class="line">st[i][j] = max(st[i][j<span class="number">-1</span>],st[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = Log[r-l+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> mx = max(st[l][k],st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line"><span class="comment">//printf("%d %d\n",k,mx);</span></span><br><span class="line"><span class="keyword">return</span> mx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,l,r;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;l,&amp;r);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(l,r));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>A* ä¸ IDA*</title>
      <link href="/2019/08/11/IDA/"/>
      <url>/2019/08/11/IDA/</url>
      
        <content type="html"><![CDATA[<h4 id="IDA"><a href="#IDA" class="headerlink" title="IDA*"></a>IDA*</h4><p>è™½ç„¶å‰ªæåœ¨è¾ƒå¿«æ‰¾åˆ°æ¥è¿‘æœ€ä¼˜è§£çš„è§£æ—¶èƒ½å¤Ÿæœ‰æ•ˆå‡å°‘çŠ¶æ€æ•°ï¼Œä½†æ˜¯åœ¨å°šæœªæ‰¾åˆ°è¾ƒå¥½çš„è§£æ—¶ï¼Œä¾ç„¶ä¼šå°è¯•è®¸å¤šä¸å¿…è¦çš„çŠ¶æ€ã€‚è™½ç„¶æˆ‘ä»¬åœ¨ä¸‹ç•Œæ¯”æœ€ä¼˜è§£æ›´å¤§æ—¶å¯ä»¥å‰ªæï¼Œä½†æ˜¯ä¸çŸ¥é“æœ€ä¼˜è§£çš„è¯å°±æ²¡æ³•åšåˆ°äº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç›´æ¥å»æ±‚æœ€ä¼˜è§£ï¼Œè€Œæ˜¯æ”¹æˆé€šè¿‡æœç´¢åˆ¤æ–­æ˜¯å¦æœ‰ä¸è¶…è¿‡æŸä¸ªxçš„è§£ã€‚æŠŠxä»0å¼€å§‹æ¯æ¬¡å¢åŠ 1ï¼Œé‚£ä¹ˆé¦–æ¬¡æ‰¾åˆ°è§£æ—¶çš„xå°±æ˜¯æœ€ä¼˜è§£ã€‚è¿™æ ·ï¼Œæœç´¢è¿‡ç¨‹ä¸­å°±ä¸ä¼šè®¿é—®é‚£äº›ä¸‹ç•Œæ¯”æœ€ä¼˜è§£æ›´å¤§çš„çŠ¶æ€äº†ã€‚<br>å°†ç¨‹åºæ”¹æˆåˆ¤æ–­æ˜¯å¦æœ‰ä¸è¶…è¿‡æŸä¸ªxçš„è§£ï¼Œåªéœ€è¦åœ¨ä¸‹ç•Œè¶…è¿‡xæ—¶ï¼Œåœæ­¢æœç´¢å°±å¥½äº†ï¼Œä»£ç å‡ ä¹æ²¡æœ‰ä»€ä¹ˆå˜åŠ¨ã€‚<br>è€ƒè™‘å¹³å‡¡ä¸‹ç•Œçš„æƒ…å†µï¼ˆå³ä½¿å¾—æ‰€æœ‰çŠ¶æ€éƒ½æ»¡è¶³çš„ä¸‹ç•Œï¼‰ï¼Œæ­¤æ—¶ï¼Œç¨‹åºå°±ä¼šåƒå®½åº¦ä¼˜å…ˆæœç´¢ä¸€æ ·ï¼ŒæŒ‰ç…§è·ç¦»åˆå§‹çŠ¶æ€çš„è¿œè¿‘é¡ºåºè®¿é—®å„ä¸ªçŠ¶æ€ã€‚è¿™è¢«ç§°ä¸ºè¿­ä»£åŠ æ·±æœç´¢ï¼ˆIDDFSï¼ŒInterative Deepening Depth-First Searchï¼‰ã€‚<br>è€Œåƒè¿™æ ·é€šè¿‡ä¼°ç®—ä¸‹ç•Œæå‰å‰ªæä¼˜åŒ–åçš„ç®—æ³•åˆ™ç§°ä¸ºIDA* ã€‚å®ƒé€šå¸¸å¯ä»¥è¡¨è¿°å¦‚ä¸‹ï¼š</p><ol><li>ç»™å‡ºçŠ¶æ€våˆ°ç›®æ ‡çŠ¶æ€çš„è·ç¦»ä¸‹ç•Œçš„ä¼°ç®—å‡½æ•°hï¼ˆvï¼‰ã€‚</li><li>ä»¤x = 0ã€‚</li><li>å †æ»¡è¶³dï¼ˆvï¼‰ + hï¼ˆvï¼‰ &lt;= xçš„çŠ¶æ€è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ä¸è¶…è¿‡xçš„è§£ï¼ˆd(v) è¡¨ç¤ºåˆå§‹çŠ¶æ€åˆ°ç›®æ ‡çŠ¶æ€çš„è·ç¦»ï¼‰ã€‚</li><li>å¦‚æœæ‰¾åˆ°è§£ï¼Œåˆ™xå°±æ˜¯æœ€ä¼˜è§£ï¼Œç¨‹åºç»“æŸã€‚</li><li>å¦åˆ™ï¼Œå°†xå¢åŠ 1å¹¶å›åˆ°ç¬¬3æ­¥ã€‚</li></ol><p>IDA* ä¸­æ‰€è®¿é—®çš„çŠ¶æ€æ€»æ˜¯æ»¡è¶³d(v) + h(v) &lt;= æœ€ä¼˜è§£ï¼Œè€Œh(v)çš„ä¼°å€¼è¶Šæ¥è¿‘åˆ°ç›®æ ‡çŠ¶æ€çš„å®é™…è·ç¦»ï¼Œåˆ™æœç´¢æ‰€ç»è¿‡çš„çŠ¶æ€æ•°å°±è¶Šå°‘ã€‚</p><p>å¯èƒ½ä¼šæœ‰ä¸€ä¸ªç–‘é—®ï¼Œå°±æ˜¯ä¸Šè¿°xä¸æ–­+1å†åˆ¤æ–­æ˜¯å¦æœ‰è§£çš„è¿‡ç¨‹å’ŒäºŒåˆ†æœç´¢å¾ˆç±»ä¼¼ï¼Œé‚£èƒ½å¦ç”¨äºŒåˆ†æœç´¢æ¥åšå‘¢ï¼Ÿä¸èƒ½ï¼Œå› ä¸ºéšç€xçš„å¢å¤§ï¼Œæœç´¢çŠ¶æ€æ˜¯æŒ‡æ•°çº§ä¸Šå‡ï¼Œæ‰€ä»¥xè¦è¶Šå°è¶Šå¥½ï¼ˆå³ä½¿æœç´¢äº†xä»1~1000ï¼Œä¹Ÿæ¯”æœç´¢ä¸€æ¬¡x = 1100è¦å¿«ï¼‰ã€‚</p><h4 id="A"><a href="#A" class="headerlink" title="A *"></a>A *</h4><p>æ­£å¦‚æ·±åº¦ä¼˜å…ˆç®—æ³•å¯ä»¥åˆ©ç”¨ä¸‹ç•Œä¼˜åŒ–ä¸€æ ·ï¼Œå®½åº¦ä¼˜å…ˆæœç´¢å’Œ Dijkstra ç®—æ³•ä¹Ÿå¯ä»¥åˆ©ç”¨ä¸‹ç•Œä¼˜åŒ–ã€‚åªè¦å°†ä¼˜å…ˆé˜Ÿåˆ—ä¸­çš„é”®æ”¹æˆ d(v) + h(v) å°±å¯ä»¥äº†ï¼Œå…¶ä¸­ d(v) æ˜¯åˆå§‹çŠ¶æ€åˆ°çŠ¶æ€ v çš„è·ç¦»ï¼Œh(v) æ˜¯åˆ°ç›®æ ‡çŠ¶æ€çš„è·ç¦»ä¸‹ç•Œã€‚è¿™ç§ç®—æ³•ç§°ä¸ºA *  ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸å®½åº¦ä¼˜å…ˆæœç´¢å’Œ Dijkstra ç®—æ³•ä¸åŒï¼Œåœ¨é€‰ç”¨æŸäº›ä¸‹ç•Œè¿›è¡Œä¼°ç®—çš„æƒ…å†µä¸‹ï¼Œä¼˜å…ˆé˜Ÿåˆ—é¡¶ç«¯çš„å…ƒç´ å¯¹åº”çš„ d(v) æœªå¿…å·²ç»æ˜¯åˆå§‹çŠ¶æ€åˆ° v çš„æœ€çŸ­è·ç¦»ã€‚</p><p>å¦‚æœå¯¹äºæ‰€æœ‰çš„è¾¹ï¼ˆuï¼Œvï¼‰éƒ½æœ‰cost(u , v)+h(u) - h(v) &gt;= 0æˆç«‹ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡å–å‡ºæŸä¸ªèŠ‚ç‚¹æ—¶ï¼Œå¯¹åº”çš„ d(v) å°±ä¸€å®šæ˜¯æœ€çŸ­è·ç¦»ã€‚</p><h4 id="A-ä¸-IDA-çš„æ¯”è¾ƒ"><a href="#A-ä¸-IDA-çš„æ¯”è¾ƒ" class="headerlink" title="A  ä¸ IDA  çš„æ¯”è¾ƒ"></a>A <em> ä¸ IDA </em> çš„æ¯”è¾ƒ</h4><p>A <em>  å’ŒIDA </em>  åˆ†åˆ«æ˜¯é’ˆå¯¹å®½åº¦ä¼˜å…ˆæœç´¢å’Œæ·±åº¦ä¼˜å…ˆæœç´¢çš„ç®—æ³•ã€‚æˆ‘ä»¬å¯ä¹Ÿiå¾ˆå®¹æ˜“åœ°æŠŠæ·±åº¦ä¼˜å…ˆæœç´¢æ”¹å†™æˆIDA <em>  ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“çš„æŠŠå®½åº¦ä¼˜å…ˆæœç´¢æˆ–è€…Dijkstraæ”¹å†™æˆA </em>  ã€‚</p><p>å½“ç„¶ï¼Œä¸ä»…åœ¨ä»£ç ä¸Šæ”¹å†™å®¹æ˜“ï¼Œå®ƒä»¬ä¹Ÿå„è‡ªç»§æ‰¿äº†ä¸€äº›æ”¹å†™å‰ç®—æ³•çš„ç‰¹ç‚¹ã€‚ä¾‹å¦‚ï¼ŒIDA <em>  åŸºæœ¬ä¸æ€ä¹ˆèŠ±è´¹å†…å­˜ï¼Œè€ŒA </em> åˆ™è¦èŠ±è´¹å…³äºæœç´¢ç©ºé—´çš„çº¿æ€§çš„å†…å­˜ã€‚å¦ä¸€æ–¹é¢ï¼Œå¯ä»¥é€šè¿‡ä¸åŒè·¯å¾„è¾¾åˆ°åŒä¸€çŠ¶æ€æ—¶ï¼ŒIDA <em> å¯èƒ½ä¼šé‡å¤å¤šæ¬¡ç»è¿‡æŸäº›çŠ¶æ€è€Œå¯¼è‡´æ•ˆç‡ä¸€è½åƒä¸ˆï¼Œè€ŒA</em> é€šè¿‡é€‰å–åˆé€‚çš„ä¸‹ç•Œåˆ™å¯ä»¥ä¿è¯æ¯ä¸ªçŠ¶æ€è‡³å¤šæ£€æŸ¥ä¸€æ¬¡ã€‚</p><p>é€šå¸¸æ¥è¯´ï¼Œéšç€æœç´¢æ·±åº¦çš„å¢åŠ ï¼Œæœç´¢ç©ºé—´çš„å¤§å°å‘ˆæŒ‡æ•°çº§åˆ«å¢é•¿ã€‚æ‰€ä»¥ï¼Œè™½ç„¶IDA * ä¸æ–­å¢åŠ é€’å½’æ·±åº¦é™åˆ¶çš„è¿‡ç¨‹é‡å¤æœç´¢äº†å¾ˆå¤šçŠ¶æ€ï¼Œä½†æ€»çš„è®¿é—®çŠ¶æ€æ•°å’Œæœ€åä¸€æ¬¡è®¿é—®çŠ¶æ€æ•°è¿˜æ˜¯åŒä¸€æ•°é‡çº§çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬›å¡å°”æ ‘</title>
      <link href="/2019/08/11/cartesin/"/>
      <url>/2019/08/11/cartesin/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>ç¬›å¡å°”æ ‘ï¼ˆCartesian Treeï¼‰æ˜¯ä¸€ç§æ ‘å½¢æ•°æ®ç»“æ„ã€‚ç”±äºå…¶å…·æœ‰äºŒå‰æœç´¢æ ‘å’Œå †çš„æ€§è´¨ï¼Œå¦‚æœä»¥ä¸€æ£µç¬›å¡å°”æ ‘å¯¹åº”ä¸€æ®µåŒºé—´çš„è¯ï¼Œé‚£ä¹ˆæ•´æ®µåŒºé—´çš„æå€¼å°±æ˜¯æ ¹èŠ‚ç‚¹Aï¼ŒåŒæ—¶åˆæ»¡è¶³Açš„å·¦å­æ ‘å¯¹åº”æå€¼å·¦è¾¹åŒºé—´ï¼Œå³å­æ ‘å¯¹åº”å³è¾¹åŒºé—´ã€‚è¿™æ ·é€’å½’å®šä¹‰ï¼Œå°±ä¼šå°†ä¸€ä¸ªåŒºé—´åˆ’åˆ†è‹¥å¹²æ®µã€‚è€Œç¬›å¡å°”æ ‘ä¹‹æ‰€ä»¥å…·æœ‰ä¸Šè¿°æ€§è´¨æˆ‘ä»¬ä¼šåœ¨æ¥ä¸‹æ¥è®²è§£ã€‚<br>æœ¬æ–‡é¦–å…ˆä»‹ç»ç¬›å¡å°”æ ‘çš„æ¦‚å¿µä»¥åŠå®ƒå…·æœ‰çš„æ€§è´¨ï¼Œç„¶åä»‹ç»å¦‚ä½•æ¥æ„é€ ä¸€æ£µç¬›å¡å°”æ ‘ï¼Œå½“ç„¶ï¼Œå¯¹ç¬›å¡å°”æ ‘ç»“æ„çš„åˆ†æä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ã€‚</p><h4 id="ç¬›å¡å°”æ ‘çš„æ¦‚å¿µ"><a href="#ç¬›å¡å°”æ ‘çš„æ¦‚å¿µ" class="headerlink" title="ç¬›å¡å°”æ ‘çš„æ¦‚å¿µ"></a>ç¬›å¡å°”æ ‘çš„æ¦‚å¿µ</h4><p>ç¬›å¡å°”æ ‘ï¼ˆCartesian Treeï¼‰æ˜¯ä¸€ç§åŒæ—¶æ»¡è¶³å †æ€§è´¨å’ŒäºŒå‰æœç´¢æ ‘æ€§è´¨çš„ä¸€æ£µäºŒå‰æ ‘ã€‚å› æ­¤ç¬›å¡å°”æ ‘çš„æ ‘æ ¹å¯¹åº”ç€è¯¥æ ‘çš„æå€¼ï¼ˆå †æ€§è´¨ï¼‰ï¼Œå¹¶ä¸”å¯¹å…¶ä¸­åºéå†å¾—åˆ°çš„æ˜¯åŸåºåˆ—ä¸€æ®µè¿ç»­çš„åŒºé—´ï¼ˆäºŒå‰æœç´¢æ ‘æ€§è´¨ï¼‰ã€‚<br>æˆ‘ä»¬å‡è®¾åˆ©ç”¨ä¸€ä¸ªæ•´æ•°åºåˆ—Aï¼ša1~an å»ºç«‹ç¬›å¡å°”æ ‘ï¼Œé‚£ä¹ˆæ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹æœ‰2ä¸ªé”®å€¼ï¼Œidxï¼ˆä¸‹æ ‡ï¼‰å’Œ valï¼ˆå€¼ï¼‰ã€‚æˆ‘ä»¬ä½¿æ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹çš„idxæ»¡è¶³äºŒå‰æœç´¢æ ‘æ€§è´¨ï¼Œè€Œvalæ»¡è¶³å †æ€§è´¨ï¼Œäºæ˜¯ç¬›å¡å°”æ ‘å°±å»ºæˆäº†ã€‚</p><h4 id="ç¬›å¡å°”æ ‘å…·æœ‰çš„æ€§è´¨"><a href="#ç¬›å¡å°”æ ‘å…·æœ‰çš„æ€§è´¨" class="headerlink" title="ç¬›å¡å°”æ ‘å…·æœ‰çš„æ€§è´¨"></a>ç¬›å¡å°”æ ‘å…·æœ‰çš„æ€§è´¨</h4><p>å¦‚æœæˆ‘ä»¬ä»¥Aåºåˆ—å»ºç«‹ä¸€æ£µç¬›å¡å°”æ ‘çš„è¯ï¼Œæ˜¾ç„¶ç¬›å¡å°”æ ‘å…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š</p><ul><li>çˆ¶äº²èŠ‚ç‚¹çš„é”®å€¼valå‡å°äºï¼ˆæˆ–å¤§äºï¼‰å…¶å·¦å³å­èŠ‚ç‚¹çš„é”®å€¼ã€‚</li><li>èŠ‚ç‚¹çš„å·¦å„¿å­idxæ¯”å…¶å°ï¼Œå³å„¿å­çš„idxæ¯”å…¶å¤§ã€‚ä¸­åºéå†å³ä¸ºåŸåºåˆ—Aã€‚</li></ul><p>ä¸Šè¿°ä¸¤æ¡æ€§è´¨åˆ†åˆ«æ˜¯å †å’ŒäºŒå‰æœç´¢æ ‘çš„æ€§è´¨ï¼Œè€Œæˆ‘ä»¬é€šè¿‡å¯¹ä¸¤ä¸ªé”®å€¼è¿›è¡Œä¸åŒçº¦æŸï¼Œä½¿å¾—è¿™ä¸¤ç§æ•°æ®ç»“æ„ç»“åˆåœ¨äº†ä¸€èµ·ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„æ±‚å‡ºä¸€æ®µåŒºé—´çš„æå€¼ã€‚</p><p>ç±»ä¼¼ç¬›å¡å°”æ ‘çš„æ•°æ®ç»“æ„æœ‰æ ‘å †ï¼ˆTreapï¼‰ï¼Œå®ƒä¹Ÿæ˜¯å°†äºŒå‰æœç´¢æ ‘å’Œå †ç»“åˆåœ¨ä¸€èµ·ï¼Œåªä¸è¿‡å…¶æ˜¯åˆ©ç”¨å †æ¥ç»´æŒæœç´¢æ ‘ä¸è‡³äºé€€åŒ–ä¸¥é‡ï¼Œå¹¶æ²¡æœ‰åˆ©ç”¨å…¶æ¥æ±‚æå€¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ç†è§£ã€‚</p><h4 id="å¦‚ä½•å»ºç«‹ç¬›å¡å°”æ ‘"><a href="#å¦‚ä½•å»ºç«‹ç¬›å¡å°”æ ‘" class="headerlink" title="å¦‚ä½•å»ºç«‹ç¬›å¡å°”æ ‘"></a>å¦‚ä½•å»ºç«‹ç¬›å¡å°”æ ‘</h4><p>å¯¹äºç»™å®šåºåˆ—Aï¼Œå»ºç«‹ä¸€æ£µç¬›å¡å°”æ ‘çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N)ã€‚é¦–å…ˆï¼Œå¦‚æœç±»ä¼¼äºTreapä¸­æ’å…¥æ“ä½œæ¥å»ºç«‹ä¸€æ£µç¬›å¡å°”æ ‘çš„è¯ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(N* log N)ï¼Œä½†æ˜¯ç”±äºç»™å®šåºåˆ—çš„ä¸‹æ ‡idxæ˜¯é€’å¢çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å•è°ƒæ ˆåœ¨çº¿æ€§æ—¶é—´å†…å»ºæ ‘ã€‚</p><p>é¦–å…ˆè€ƒè™‘å¯¹äºä¸€æ£µå·²ç»å»ºå¥½çš„å­æ ‘$T_i$ï¼Œå¯¹äºæ–°æ¥çš„èŠ‚ç‚¹x = Node(idx = i+1ï¼Œval = value)ï¼Œå…¶ä¸€å®šæ˜¯è¦æ²¿ç€å½“å‰èŠ‚ç‚¹çš„æ ¹ä¸€è·¯å‘å³èµ°ï¼Œç›´è‡³æ‰¾åˆ°åˆé€‚çš„ä½ç½®ã€‚å‡è®¾æˆ‘ä»¬æŠŠèŠ‚ç‚¹xæ’å…¥åˆ°æœ€å³è¾¹ï¼Œé‚£ä¹ˆé¦–å…ˆå¯çŸ¥åœ¨idxç»´åº¦æ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯å…¶valå¹¶ä¸ä¸€å®šæ¯”èµ·çˆ¶äº²èŠ‚ç‚¹è¦å¤§ï¼ˆå‡è®¾è¿™é¢—ç¬›å¡å°”æ ‘æ˜¯å°æ ¹å †ï¼‰ï¼Œå› æ­¤å¦‚æœx.val å°äºå…¶çˆ¶äº²çš„valï¼Œé‚£ä¹ˆå°±éœ€è¦äº¤æ¢ä½ç½®ï¼ŒåŒç†ï¼Œå°±åƒåœ¨Treapä¸­ä¸€æ ·ä¸€ç›´äº¤æ¢åˆ°åˆé€‚çš„ä½ç½®ã€‚</p><p>è€Œå¦‚æœæˆ‘ä»¬æ ˆSä¸­å­˜æ”¾çš„æ˜¯å½“å‰æœ€å³è¾¹å­æ ‘ï¼ˆå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼‰çš„æ ¹èŠ‚ç‚¹yï¼Œé‚£ä¹ˆå¦‚æœxä½ç½®åˆæ³•ï¼Œåˆ™å°†xå‹å…¥Sï¼Œä½œä¸ºyçš„å³å­æ ‘ï¼Œæ­¤æ—¶xæˆä¸ºäº†æ–°çš„æ ¹èŠ‚ç‚¹ï¼›å¦‚æœxä¸åˆæ³•ï¼Œåˆ™å°†æ ˆé¡¶å…ƒç´ å¼¹å‡ºï¼Œå†ä¸ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ¯”è¾ƒï¼Œç›´è‡³æ‰¾åˆ°åˆæ³•ä½ç½®å†å°†xå‹å…¥ï¼Œè€Œå¼¹å‡ºçš„èŠ‚ç‚¹åˆ™åº”è¯¥æ”¾åœ¨èŠ‚ç‚¹xçš„å·¦è¾¹ã€‚ï¼ˆå¦‚æœå¼¹å‡ºä¸æ­¢ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™åº”è¯¥ä½œä¸ºxèŠ‚ç‚¹çš„å·¦å­æ ‘ï¼‰</p><p>è€Œæ¯ä¸ªç‚¹è¿›æ ˆå’Œå‡ºæ ˆè‡³å¤šä¸€æ¬¡ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦æ˜¯O(N)ã€‚</p><p><strong>å»ºç«‹ä¸€æ£µä¿å­˜åŒºé—´æœ€å°å€¼çš„ç¬›å¡å°”æ ‘å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p><ol><li>å°†å¾…æ’å…¥èŠ‚ç‚¹ x ä¸å½“å‰æ ˆé¡¶å…ƒç´ æ¯”è¾ƒï¼Œè‹¥å…¶valå¤§äºå½“å‰æ ˆé¡¶å…ƒç´ ï¼Œåˆ™ä½œä¸ºæ ˆé¡¶å…ƒç´ çš„å³å„¿å­ï¼Œå¹¶å…¥æ ˆï¼Œæ’å…¥ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¦åˆ™è½¬2ã€‚</li><li>è‹¥å¾…æ’å…¥èŠ‚ç‚¹ x çš„ val å°äºå½“å‰æ ˆé¡¶å…ƒç´ ï¼Œåˆ™å°†æ ˆé¡¶å…ƒç´ å¼¹å‡ºï¼Œä¸æ–­é‡å¤ç›´è‡³æ ˆé¡¶å…ƒç´ çš„ val å°äºèŠ‚ç‚¹ x çš„valï¼Œæ­¤æ—¶æœ€åä¸€ä¸ªå¼¹å‡ºçš„æ ˆé¡¶å…ƒç´ ä½œä¸ºèŠ‚ç‚¹ x çš„å·¦å„¿å­ã€‚</li><li>å½“æ‰€æœ‰èŠ‚ç‚¹æ’å…¥å®Œæ¯•åï¼Œæ ˆåº•èŠ‚ç‚¹åˆ™ä¸ºè¿™é¢—ç¬›å¡å°”æ ‘çš„æ ¹èŠ‚ç‚¹ã€‚</li></ol><p>å½“ç„¶ä¸Šè¿°åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©ºçš„æ­¥éª¤å¹¶æœªåŠ ä¸Šï¼Œå®é™…ä¹¦å†™ä»£ç æ—¶åº”è¯¥æ³¨æ„è¿™ç‚¹ã€‚</p><h4 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h4><p>æˆ‘ä»¬ä»¥HDU1506ä¸ºä¾‹ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> a[N],tot = <span class="number">0</span>,n;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function">ll <span class="title">max</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a &lt; b?b:a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> idx,val;<span class="comment">//ä¸‹æ ‡ã€æƒå€¼ </span></span><br><span class="line"><span class="keyword">int</span> l,r,par;<span class="comment">//å·¦å„¿å­ã€å³å„¿å­ã€çˆ¶äº²èŠ‚ç‚¹çš„ç¼–å· </span></span><br><span class="line">Node()&#123;&#125;</span><br><span class="line">Node(<span class="keyword">int</span> idx,<span class="keyword">int</span> val)</span><br><span class="line">:idx(idx),val(val)&#123;</span><br><span class="line">l = r = par = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BuildTree</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> k = i<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">while</span>(t[k].val &gt; t[i].val) k = t[k].par;</span><br><span class="line">t[i].l = t[k].r;<span class="comment">//kçš„å³å­æ ‘ä½œä¸ºiçš„å·¦å­æ ‘ </span></span><br><span class="line">t[k].r = i;<span class="comment">//iä½œä¸ºkçš„å³å­æ ‘ </span></span><br><span class="line">t[i].par = k;<span class="comment">//içš„çˆ¶äº²æ˜¯k </span></span><br><span class="line">t[t[i].l].par = i;<span class="comment">//içš„å·¦å­æ ‘çš„çˆ¶äº²æ˜¯i </span></span><br><span class="line"><span class="comment">//printf("%d %d\n",i,k);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> t[<span class="number">0</span>].r;<span class="comment">//æœ€ç»ˆæ ‘çš„æ ¹èŠ‚ç‚¹çš„ç¼–å· </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line"><span class="comment">//printf("%d\n",rt);</span></span><br><span class="line"><span class="keyword">if</span>(rt == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">ll sz = <span class="number">1</span>;</span><br><span class="line">sz += dfs(t[rt].l);</span><br><span class="line">sz += dfs(t[rt].r);</span><br><span class="line">ans = max(ans,sz*(t[rt].val));</span><br><span class="line"><span class="keyword">return</span> sz;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)</span><br><span class="line">t[i] = Node(i,a[i]);</span><br><span class="line">tot = ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> rt = BuildTree();</span><br><span class="line">dfs(rt);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n) &amp;&amp; n)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">solve();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‘çŠ¶æ•°ç»„åŒºé—´ä¿®æ”¹+åŒºé—´æŸ¥è¯¢</title>
      <link href="/2019/08/11/BIT2/"/>
      <url>/2019/08/11/BIT2/</url>
      
        <content type="html"><![CDATA[<h3 id="æ•°ç»„æ•°ç»„åŒºé—´ä¿®æ”¹-åŒºé—´æŸ¥è¯¢"><a href="#æ•°ç»„æ•°ç»„åŒºé—´ä¿®æ”¹-åŒºé—´æŸ¥è¯¢" class="headerlink" title="æ•°ç»„æ•°ç»„åŒºé—´ä¿®æ”¹+åŒºé—´æŸ¥è¯¢"></a>æ•°ç»„æ•°ç»„åŒºé—´ä¿®æ”¹+åŒºé—´æŸ¥è¯¢</h3><p>åœ¨ä¹‹å‰æ•´ç†æ ‘çŠ¶æ•°ç»„ç¬”è®°æ—¶ï¼Œå·²ç»å°†å•ç‚¹ä¿®æ”¹ä»¥åŠåŒºé—´æŸ¥è¯¢å†™çš„å¾ˆæ¸…æ¥šäº†ã€‚æ ‘çŠ¶æ•°ç»„æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨çº¿ å¿«é€ŸæŸ¥è¯¢å‰ç¼€å’Œï¼Œå¹¶å¯ä»¥å¿«é€Ÿæ›´æ–°æ•°å€¼å¹¶ç»´æŠ¤çš„æ•°æ®ç»“æ„ã€‚æˆ‘ä»¬å–œæ¬¢ç”¨æ ‘çŠ¶æ•°ç»„æ˜¯å› ä¸ºå…¶ä»£ç ç®€å•æ˜“è®°ï¼Œå‡ºé”™ç‡ä½ï¼Œå¹¶ä¸”æ•ˆç‡è¿˜ä¸é”™ã€‚</p><h4 id="ç†è®ºæ¨å¯¼"><a href="#ç†è®ºæ¨å¯¼" class="headerlink" title="ç†è®ºæ¨å¯¼"></a>ç†è®ºæ¨å¯¼</h4><p>å¦‚æœæ¶‰åŠå•ç‚¹ä¿®æ”¹ã€åŒºé—´æŸ¥è¯¢ï¼Œé‚£ä¹ˆä»£ç å¾ˆç®€å•ã€‚ä½†æ˜¯å¦‚æœæ˜¯åŒºé—´ä¿®æ”¹ï¼Œå°±éœ€è¦åšä¸€äº›æ”¹å˜äº†ã€‚é¦–å…ˆè¿›è¡Œå¦‚ä¸‹æ¨å¯¼ï¼šï¼ˆå‰ç½®çŸ¥è¯†ï¼šå‰ç¼€å’Œã€å·®åˆ†æ•°ç»„ï¼‰<br><strong>å‡è®¾æ•°ç»„aæ˜¯å­˜æ”¾åˆå§‹æ•°æ®ï¼Œsumå­˜æ”¾aæ•°ç»„çš„å‰ç¼€å’Œï¼Œè€Œbæ•°ç»„ä¸ºå·®åˆ†æ•°ç»„</strong>ï¼Œå³æ¯å½“ä¸º[l,r]ä½ç½®æ‰€æœ‰å…ƒç´ +valæ—¶ï¼Œb[l]+= val,b[r] -= valã€‚è€Œsumbä¸ºbæ•°ç»„çš„å‰ç¼€å’Œæ•°ç»„ï¼Œè¿™æ ·sumb[i]å°±å­˜æ”¾ç€a[i]ä¿®æ”¹å€¼ã€‚é‚£ä¹ˆå¾ˆæ˜¾ç„¶æœ€åa[i]çš„å€¼ä¸ºa[i]+sumb[i]ï¼Œå³åˆå§‹å€¼+ä¿®æ”¹å€¼ã€‚æ­¤æ—¶å†æ¥è€ƒå¯Ÿaæ•°ç»„çš„å‰ç¼€å’Œï¼Œsum[i]å­˜æ”¾çš„æ˜¯a[1]+a[2]+â€¦+a[i]ï¼Œï¼ˆè¯·æ³¨æ„aæ•°ç»„å§‹ç»ˆæœªä½œæ”¹å˜ï¼Œå…¶æ”¹å˜çš„å€¼å­˜æ”¾åœ¨sumbæ•°ç»„ä¸­ï¼‰ï¼Œå¾ˆæ˜¾ç„¶æˆ‘ä»¬è¦æ±‚çš„ç»“æœ(æ•°ç»„açš„æœ€ç»ˆå‰ç¼€å’Œ)</p><script type="math/tex; mode=display">ans = sum[ i ]+\sum_{j = 1}^i sumb[ j ]</script><p>åˆç”±äº</p><script type="math/tex; mode=display">sumb[i] = \sum_{ j = 1}^i b[j]</script><p>æ‰€ä»¥</p><script type="math/tex; mode=display">ans = sum[i] + \sum_{j = 1}^i \sum_{k = 1}^j b[k]</script><p>è‡³æ­¤æˆ‘ä»¬å·²ç»æŠ›å¼ƒäº†sumbè¿™ä¸ªä¿å­˜bæ•°ç»„å‰ç¼€å’Œçš„æ•°ç»„ï¼Œokå—ï¼Ÿæˆ‘ä»¬å¾—åˆ°çš„å…¬å¼æ˜¯æ ¹æ®ä¸€ä¸ªå¸¸é‡æ•°ç»„sumå’Œä¸€ä¸ªä¸æ–­è¢«ä¿®æ”¹çš„bæ•°ç»„æ¥æ±‚ansçš„ã€‚<strong>ï¼ˆæ³¨ï¼šè¿™é‡Œansä¸ºaæ•°ç»„çš„æœ€ç»ˆå‰ç¼€å’Œï¼‰</strong><br>å¦‚æœä¸Šé¢çš„å…¬å¼æ²¡æœ‰é—®é¢˜ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯<strong>æ±‚bæ•°ç»„çš„äºŒé‡å’Œå¼ã€‚</strong> æ¥å˜å½¢ï¼š</p><script type="math/tex; mode=display">\sum_{j = 1}^i \sum_{k = 1}^j b[k] = \sum_{j = 1}^i (i - j + 1)* b[j] = (i +1)\sum_{j = 1}^ib[j] - \sum_{j = 1}^i j* b[j]</script><p>é¦–å…ˆï¼Œè¿™ä¸ªå…¬å¼å˜æ¢æ˜¯å¸¸ç”¨å¥—è·¯ï¼Œå¦‚æœæœ‰é—®é¢˜å¯ä»¥è‡ªå·±ç”¨çŸ©é˜µæ±‚å’Œæ¥æ¨ä¸€ä¸‹ã€‚å…¶æ¬¡ï¼Œå˜æ¢æˆè¿™ä¸ªå…¬å¼çš„å¥½å¤„æ˜¯æˆ‘ä»¬<strong>åªéœ€ç»´æŠ¤ j * b[j] çš„å‰ç¼€å’Œ</strong>å°±å¯ä»¥ç›´æ¥æ±‚å‡ºaæ•°ç»„ä¿®æ”¹åçš„å‰ç¼€å’Œäº†ã€‚</p><h4 id="å…·ä½“å®ç°ï¼š"><a href="#å…·ä½“å®ç°ï¼š" class="headerlink" title="å…·ä½“å®ç°ï¼š"></a>å…·ä½“å®ç°ï¼š</h4><p>å…·ä½“æ“ä½œæ˜¯ï¼Œæˆ‘ä»¬å»ºç«‹ä¸¤ä¸ªæ ‘çŠ¶æ•°ç»„c0å’Œc1ã€‚å…¶ä¸­c0æ˜¯ç”¨æ¥æ±‚b[j]å‰ç¼€å’Œçš„ï¼Œè€Œc1æ˜¯ç”¨æ¥æ±‚j * b[j]å‰ç¼€å’Œçš„ã€‚é‚£ä¹ˆå¯¹äºæ¯ä¸ªåŒºé—´ä¿®æ”¹ï¼ˆä¸º[l,r]ä¸Šæ‰€æœ‰æ•°å­—+valï¼‰ï¼Œæˆ‘ä»¬æ‰§è¡Œ4ä¸ªæ“ä½œï¼š</p><ol><li>åœ¨æ ‘çŠ¶æ•°ç»„c0ä¸­ï¼ŒæŠŠä½ç½®lä¸Šçš„æ•° + valã€‚</li><li>åœ¨æ ‘çŠ¶æ•°ç»„c0ä¸­ï¼ŒæŠŠä½ç½®r+1ä¸Šçš„æ•° - valã€‚</li><li>åœ¨æ ‘çŠ¶æ•°ç»„c1ä¸­ï¼ŒæŠŠä½ç½®lä¸Šçš„æ•° + l* valã€‚</li><li>åœ¨æ ‘çŠ¶æ•°ç»„c1ä¸­ï¼ŒæŠŠä½ç½®r+1ä¸Šçš„æ•° -ï¼ˆr+1ï¼‰* val</li></ol><p>å¦å¤–ï¼Œsumæ•°ç»„å­˜æ”¾åºåˆ—açš„åŸå§‹å‰ç¼€å’Œã€‚æ‰€ä»¥æ¯æ¬¡æŸ¥è¯¢[l,r]å‰ç¼€å’Œï¼Œå½“ç„¶è¿˜æ˜¯æ‹†åˆ†æˆæ±‚[1,r]å’Œ[1,l-1]çš„å‰ç¼€å’Œï¼ŒäºŒè€…ç›¸å‡ã€‚å†™æˆå¼å­å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">(sum[r] + (r+1) * ask(c0,r) - ask(c1,r) ) - (sum[l-1] + l * ask(c0,l-1) - ask(c1,l-1) )</script><h4 id="ä»£ç ç¤ºä¾‹ï¼š"><a href="#ä»£ç ç¤ºä¾‹ï¼š" class="headerlink" title="ä»£ç ç¤ºä¾‹ï¼š"></a>ä»£ç ç¤ºä¾‹ï¼š</h4><p>è¿™é‡Œä»¥POJ3468ä¸ºä¾‹ï¼š<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll c[<span class="number">2</span>][MAXN];</span><br><span class="line">ll a[MAXN],sum[MAXN];</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x &lt;= n;x += x&amp;-x) c[k][x] += y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x -= x&amp;-x) ans += c[k][x];</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,a+i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) sum[i] += sum[i<span class="number">-1</span>] + a[i];</span><br><span class="line"><span class="keyword">while</span>(m--)&#123;</span><br><span class="line"><span class="keyword">char</span> op[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> l,r,val;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>,op);</span><br><span class="line"><span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">'C'</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;l,&amp;r,&amp;val);</span><br><span class="line">add(<span class="number">0</span>,l,val);</span><br><span class="line">add(<span class="number">0</span>,r+<span class="number">1</span>,-val);</span><br><span class="line">add(<span class="number">1</span>,l,l*val);</span><br><span class="line">add(<span class="number">1</span>,r+<span class="number">1</span>,-(r+<span class="number">1</span>)*val);</span><br><span class="line">&#125; <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;l,&amp;r);</span><br><span class="line">ll ans = sum[r] + (r+<span class="number">1</span>)*ask(<span class="number">0</span>,r) - ask(<span class="number">1</span>,r);</span><br><span class="line">ans -= sum[l<span class="number">-1</span>] + l*ask(<span class="number">0</span>,l<span class="number">-1</span>) - ask(<span class="number">1</span>,l<span class="number">-1</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>å‚è€ƒä¹¦ç›®ï¼š</strong></p><ul><li>ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹.æç…œä¸œ.P200</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‘çŠ¶æ•°ç»„æ¨¡æ¿1</title>
      <link href="/2019/08/11/BIT/"/>
      <url>/2019/08/11/BIT/</url>
      
        <content type="html"><![CDATA[<h4 id="æµ‹è¯•åœ°å€ï¼šæ´›è°·P3374"><a href="#æµ‹è¯•åœ°å€ï¼šæ´›è°·P3374" class="headerlink" title="æµ‹è¯•åœ°å€ï¼šæ´›è°·P3374"></a>æµ‹è¯•åœ°å€ï¼šæ´›è°·P3374</h4><h4 id="æ¨¡æ¿è¯´æ˜ä¹¦ï¼š"><a href="#æ¨¡æ¿è¯´æ˜ä¹¦ï¼š" class="headerlink" title="æ¨¡æ¿è¯´æ˜ä¹¦ï¼š"></a>æ¨¡æ¿è¯´æ˜ä¹¦ï¼š</h4><ul><li>æœ¬æ¨¡æ¿ä»…ä½¿ç”¨å•ç‚¹ä¿®æ”¹ä»¥åŠæŸ¥è¯¢å‰ç¼€å’Œï¼Œå…¶ä»–ç”¨é€”éœ€æŒ‰éœ€ä¿®æ”¹ã€‚</li><li>æœ¬æ¨¡æ¿å»ºæ ‘é‡‡ç”¨äº†å°†åˆå§‹å€¼å½“æˆä¿®æ”¹å€¼æ’å…¥çš„æ–¹æ³•ï¼Œå¤æ‚åº¦Oï¼ˆNlgNï¼‰<h4 id="ä»£ç ç¤ºä¾‹ï¼š"><a href="#ä»£ç ç¤ºä¾‹ï¼š" class="headerlink" title="ä»£ç ç¤ºä¾‹ï¼š"></a>ä»£ç ç¤ºä¾‹ï¼š</h4></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">500050</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> a[MAXN],c[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;<span class="comment">//åˆå§‹åŒ–å‡½æ•°ï¼Œé¡ºä¾¿ç¦»çº¿ä»¥ä¸‹lowbitæ•°ç»„</span></span><br><span class="line"><span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="keyword">sizeof</span> a);</span><br><span class="line"><span class="built_in">memset</span>(c,<span class="number">0</span>,<span class="keyword">sizeof</span> c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x &lt;= n;x += x&amp;-x) c[x] += y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x -= x&amp;-x) ans += c[x];</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">init();</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) add(i,a[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> a,b,c;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line"><span class="keyword">if</span>(a == <span class="number">1</span>) add(b,c);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ask(c)-ask(b<span class="number">-1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒåˆ†ç®—æ³•æ¨¡æ¿</title>
      <link href="/2019/08/11/erfen/"/>
      <url>/2019/08/11/erfen/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>ä¹‹å‰æ•´ç†çš„äºŒåˆ†æœç´¢æ¨¡æ¿åœ¨å¯¹æ‰¾xçš„å‰é©±ã€åç»§ä»¥åŠå®æ•°åŸŸä¸Šçš„äºŒåˆ†éƒ½æœ‰å„è‡ªä¸åŒçš„ä»£ç ï¼Œå…¶ä¸­ä¸€äº›å°ç»†èŠ‚éœ€è¦æˆ‘ä»¬ä¸æ–­å»æµ‹è¯•ä¿®æ”¹æœ€ç»ˆå¾—ä»¥å®ç°ä¸é—æ¼ä¸”ä¿è¯ç­”æ¡ˆæ­£ç¡®æ€§ã€‚è€Œç°åœ¨æˆ‘ä»¬å¯ä»¥å°†ä¸Šè¿°å‡ ç§ä¸åŒçš„äºŒåˆ†æœç´¢ä»£ç æ•´åˆåœ¨ä¸€èµ·ï¼Œå¯¹äºä¸åŒçš„ä½¿ç”¨æƒ…å†µåªéœ€ç¨å¾®ä¿®æ”¹ä¸€ä¸‹â€œç²¾åº¦â€å³å¯ã€‚</p><h4 id="ä»£ç æ¨¡æ¿"><a href="#ä»£ç æ¨¡æ¿" class="headerlink" title="ä»£ç æ¨¡æ¿"></a>ä»£ç æ¨¡æ¿</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> low = <span class="number">0</span>,high = n;</span><br><span class="line"><span class="keyword">while</span>(low &lt;= high)&#123;</span><br><span class="line"><span class="keyword">int</span> mid = (low + high)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span>(check(mid)) low = mid+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> high = mid<span class="number">-1</span>;<span class="comment">//EPS</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> high;</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨è¯´æ˜"><a href="#ä½¿ç”¨è¯´æ˜" class="headerlink" title="ä½¿ç”¨è¯´æ˜"></a>ä½¿ç”¨è¯´æ˜</h4><p>å½“å¾ªç¯é€€å‡ºæ—¶ï¼Œä¸€å®šæ˜¯low &gt; highï¼Œæˆ–è€…è¯´low = high + EPSã€‚<br>è‹¥æ˜¯æ±‚å¤§äºxçš„æœ€å°å€¼ï¼Œç”±äºæ¯æ¬¡æ˜¯midä½ç½®çš„æ•°å¤§äºxæ—¶æ”¶ç¼©highçš„å€¼ï¼Œäºæ˜¯æœ€ç»ˆä¸€å®šæ˜¯highä¸æ»¡è¶³æ¡ä»¶æ—¶é€€å‡ºï¼Œæ•…ç­”æ¡ˆåº”è¯¥åœ¨lowã€‚<br>è‹¥æ˜¯æ±‚å°äºxçš„æœ€å¤§å€¼ï¼Œç”±äºæ¯æ¬¡æ˜¯midä½ç½®çš„æ•°å°äºxæ—¶æ”¶ç¼©lowçš„å€¼ï¼Œå› æ­¤æœ€åä¸€å®šæ˜¯lowåç¦»æ­£ç¡®ç­”æ¡ˆï¼Œå³highä¸Šæ˜¯ç­”æ¡ˆã€‚<br>è€Œå¯¹äºå®æ•°åŸŸä¸Šçš„é—®é¢˜ï¼Œå¯¹EPSè¿›è¡Œç²¾åº¦çº¦æŸå³å¯ï¼Œä¸€èˆ¬æ¯”æ‰€æ±‚ç²¾åº¦å°10å€å³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å€å¢æ±‚LCA</title>
      <link href="/2019/08/11/lca/"/>
      <url>/2019/08/11/lca/</url>
      
        <content type="html"><![CDATA[<p>LCAï¼šå³æ±‚ä¸€æ£µæœ‰æ ¹æ ‘ä¸­ä¸¤ä¸ªèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚</p><h4 id="æ ‘ä¸Šå€å¢æ³•"><a href="#æ ‘ä¸Šå€å¢æ³•" class="headerlink" title="æ ‘ä¸Šå€å¢æ³•"></a>æ ‘ä¸Šå€å¢æ³•</h4><p>æ ‘ä¸Šå€å¢æ³•æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„ç®—æ³•ã€‚é™¤äº†æ±‚LCAå¤–ï¼Œåœ¨å¾ˆå¤šé—®é¢˜ä¸­éƒ½æœ‰å¹¿æ³›åº”ç”¨ã€‚è®¾F[x,k]è¡¨ç¤ºxçš„2^kå€ç¥–å…ˆï¼Œå³ä»xå‘æ ¹èŠ‚ç‚¹èµ°2^kæ­¥åˆ°è¾¾çš„èŠ‚ç‚¹ã€‚ç‰¹åˆ«çš„ï¼Œè‹¥è¯¥èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œåˆ™ä»¤F[x,k] = 0ã€‚F[x,0]å°±æ˜¯xçš„çˆ¶èŠ‚ç‚¹ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå¯¹äºä»»æ„çš„1 &lt;= k &lt;= log nï¼ŒF[x,k] = F[F[x,k-1],k-1]ã€‚<br>è¿™å°±ç±»ä¼¼äºä¸€ä¸ªåŠ¨æ€è§„åˆ’çš„è¿‡ç¨‹ï¼Œâ€œé˜¶æ®µâ€å°±æ˜¯èŠ‚ç‚¹çš„æ·±åº¦ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ ‘è¿›è¡Œå¹¿åº¦ä¼˜å…ˆéå†ï¼ŒæŒ‰ç…§å±‚æ¬¡é¡ºåºï¼Œåœ¨èŠ‚ç‚¹å…¥é˜Ÿä¹‹å‰ï¼Œè®¡ç®—å®ƒåœ¨Fæ•°ç»„ä¸­ç›¸åº”çš„ä½ç½®ã€‚<br>ä»¥ä¸Šéƒ¨åˆ†æ˜¯é¢„å¤„ç†ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N log N)ï¼Œä¹‹åå¯ä»¥å¤šæ¬¡å¯¹ä¸åŒçš„xï¼Œyè®¡ç®—LCAï¼Œæ¯æ¬¡è¯¢é—®çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(log N)ã€‚<br><strong>ç®—æ³•æ­¥éª¤ï¼š</strong></p><ol><li>è®¾d[x] è¡¨ç¤º x çš„æ·±åº¦ã€‚è®¾ d[x] &gt;= d[y] ï¼ˆå¦åˆ™å¯ä»¥äº¤æ¢xï¼Œyï¼‰ã€‚</li><li>ç”¨äºŒè¿›åˆ¶æ‹†åˆ†æ€æƒ³ï¼ŒæŠŠ x å‘ä¸Šè°ƒæ•´åˆ°ä¸ y åŒä¸€æ·±åº¦ã€‚</li><li>è‹¥æ­¤æ—¶ x = yï¼Œè¯´æ˜å·²ç»æ‰¾åˆ°äº†LCAï¼ŒLCAå°±ç­‰äºyã€‚</li><li>ç”¨äºŒè¿›åˆ¶æ‹†åˆ†æ€æƒ³ï¼ŒæŠŠxï¼ŒyåŒæ—¶å‘ä¸Šè°ƒæ•´ï¼Œå¹¶ä¿æŒæ·±åº¦ä¸€è‡´ä¸”äºŒè€…ä¸ç›¸ä¼šã€‚</li><li>æ­¤æ—¶xï¼Œyå¿…å®šåªå·®ä¸€æ­¥å°±ç›¸ä¼šäº†ï¼Œä»–ä»¬çš„çˆ¶èŠ‚ç‚¹F[x,0]å°±æ˜¯LCAã€‚</li></ol><p><strong>ä»£ç æ¨¡æ¿ï¼š</strong> HDU2586</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2</span>*<span class="number">41000</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],ver[N],nex[N],edge[N],tot = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> deep[N],anc[N][<span class="number">25</span>],dis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span>&#123;x ^= y;y^=x;x^=y;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    ver[++tot] = y,edge[tot] = z;</span><br><span class="line">    nex[tot] = head[x],head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        1.åˆå§‹åŒ–ancæ•°ç»„ï¼Œ</span></span><br><span class="line"><span class="comment">        2.åˆå§‹åŒ–deepæ•°ç»„</span></span><br><span class="line"><span class="comment">        3.åˆå§‹åŒ–disæ•°ç»„</span></span><br><span class="line"><span class="comment">        ä»¥ä¸Šä¸‰ä¸ªéƒ½å¯ä»¥é€šè¿‡dfsæ¥å®ç°</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">22</span>;i++)</span><br><span class="line">        anc[x][i] = anc[anc[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x]; i;i = nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y = ver[i],z = edge[i];</span><br><span class="line">        <span class="keyword">if</span>(dis[y] || y == <span class="number">1</span>) <span class="keyword">continue</span>;<span class="comment">//é˜²æ­¢é‡å¤è®¿é—®</span></span><br><span class="line">        deep[y] = deep[x]+<span class="number">1</span>;</span><br><span class="line">        dis[y] = dis[x] + z;</span><br><span class="line">        anc[y][<span class="number">0</span>] = x;</span><br><span class="line">        dfs(y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        å…ˆæŠŠæ·±åº¦è°ƒåˆ°ä¸€è‡´ï¼Œå†æŒ‰ç…§äºŒè¿›åˆ¶æ‹†åˆ†æ€æƒ³æ‰¾å¯»æœ€è¿‘å…¬å…±ç¥–å…ˆ</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span>(deep[u] &lt; deep[v]) swap(u,v);    <span class="comment">//uæ˜¯è¾ƒæ·±çš„èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(deep[anc[u][i]] &gt;= deep[v]) u = anc[u][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(u == v) <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">22</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(anc[u][i] != anc[v][i])&#123;</span><br><span class="line">            u = anc[u][i];</span><br><span class="line">            v = anc[v][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> anc[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dis[u] + dis[v] <span class="number">-2</span>*dis[Lca(u,v)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t,n,m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">memset</span>(dis,<span class="number">0</span>,<span class="keyword">sizeof</span> dis);</span><br><span class="line">        <span class="built_in">memset</span>(deep,<span class="number">0</span>,<span class="keyword">sizeof</span> deep);</span><br><span class="line">        <span class="built_in">memset</span>(anc,<span class="number">0</span>,<span class="keyword">sizeof</span> anc);</span><br><span class="line">        <span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span> head);<span class="comment">//headä¹Ÿè¦åˆå§‹åŒ–</span></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);tot = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y,z;i &lt; n;i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">            addEdge(x,y,z);</span><br><span class="line">            addEdge(y,x,z);</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,x,y;i &lt;= m;i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(x,y));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é«˜åº¦æ•°ç»„ä¸æœ€é•¿å…¬å…±å‰ç¼€</title>
      <link href="/2019/08/10/lcp/"/>
      <url>/2019/08/10/lcp/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>æœ¬æ–‡æ˜¯å…³äºåç¼€æ•°ç»„çš„ä¸€ä¸ªæ‹“å±•ï¼Œé—®é¢˜æ¨¡å‹æ¥è‡ªäºæœ€é•¿å…¬å…±å‰ç¼€ï¼ˆLongest Common Prefix Arrayï¼‰é—®é¢˜ï¼Œæˆ‘ä»¬ä¸ºè§£å†³è¯¥æ¨¡å‹ï¼Œåœ¨åç¼€æ•°ç»„çš„åŸºç¡€ä¸Šè®¾è®¡äº†ä¸€ä¸ªç²¾å·§çš„æ•°ç»„â€”â€”é«˜åº¦æ•°ç»„ï¼ˆlcpï¼‰ï¼ŒåŒæ—¶ç”±äºè¯¥æ•°ç»„åœ¨å¤„ç†å„ç±»å­—ç¬¦ä¸²ç›¸å…³é—®é¢˜æ—¶æœ‰ç€è¾ƒå¥½çš„ç”¨é€”ï¼Œå› æ­¤å€¼å¾—æŒæ¡ã€‚</p><p>æœ¬æ–‡å°†ç›´æ¥ä»é«˜åº¦æ•°ç»„è®²èµ·ï¼Œå‡è®¾è¯»è€…å…·æœ‰åç¼€æ•°ç»„çš„åŸºç¡€çŸ¥è¯†ã€‚é¦–å…ˆæœ¬æ–‡ä¼šä»‹ç»é«˜åº¦æ•°ç»„çš„å®šä¹‰ä»¥åŠç”¨é€”ï¼Œæ¥ç€è®²è§£å¦‚ä½•åœ¨O(N)æ—¶é—´å†…æ±‚å‡ºé«˜åº¦æ•°ç»„ï¼Œæœ€åå°†ä»‹ç»é«˜åº¦æ•°ç»„çš„åº”ç”¨ã€‚</p><h4 id="é«˜åº¦æ•°ç»„ï¼ˆLCP-Array-ï¼ŒLongest-Common-Prefix-Arrayï¼‰"><a href="#é«˜åº¦æ•°ç»„ï¼ˆLCP-Array-ï¼ŒLongest-Common-Prefix-Arrayï¼‰" class="headerlink" title="é«˜åº¦æ•°ç»„ï¼ˆLCP Array ï¼ŒLongest Common Prefix Arrayï¼‰"></a>é«˜åº¦æ•°ç»„ï¼ˆLCP Array ï¼ŒLongest Common Prefix Arrayï¼‰</h4><p>æ‰€è°“çš„é«˜åº¦æ•°ç»„ï¼ŒæŒ‡çš„æ˜¯ç”±åç¼€æ•°ç»„ä¸­ç›¸é‚»ä¸¤ä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼ˆLCPï¼‰çš„é•¿åº¦ç»„æˆçš„æ•°ç»„ã€‚è®°åç¼€æ•°ç»„ä¸ºsaï¼Œé«˜åº¦æ•°ç»„ä¸ºlcpï¼Œåˆ™æœ‰åç¼€S[ sa[i]â€¦ ] ä¸ S[sa[i+1] â€¦ ] çš„æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦ä¸ºlcp[i] ã€‚æˆ‘ä»¬å¯ä»¥åœ¨O(n)æ—¶é—´å†…é«˜æ•ˆåœ°æ±‚å¾—é«˜åº¦æ•°ç»„ï¼Œæœ‰äº†é«˜åº¦æ•°ç»„ï¼Œåç¼€æ•°ç»„å°†æˆä¸ºä¸€ä¸ªæ›´åŠ æœ‰åŠ›çš„å·¥å…·ã€‚é«˜åº¦æ•°æ®è™½ç„¶è®¡ç®—ç®€å•ï¼Œä½†éå¸¸å·§å¦™ï¼Œä½¿ç”¨äº†ç±»ä¼¼å°ºå–æ³•çš„æŠ€å·§ã€‚è®°rank[i] ä¸ºä½ç½® i å¼€å§‹çš„åç¼€åœ¨åç¼€æ•°ç»„ä¸­çš„é¡ºåºï¼Œå³æœ‰rank[ sa[i] ] = iã€‚</p><h4 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h4><p>æˆ‘ä»¬ä»ä½ç½®0çš„åç¼€å¼€å§‹ï¼Œä»å‰å¾€åä¾æ¬¡è®¡ç®—åç¼€S[iâ€¦]ä¸åç¼€S[sa[rank[i]-1]â€¦]ï¼ˆå³åç¼€æ•°ç»„ä¸­çš„å‰ä¸€ä¸ªåç¼€ï¼‰çš„æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦ã€‚æ­¤æ—¶ï¼Œå‡è®¾æˆ‘ä»¬å·²ç»æ±‚å¾—äº†ä½ç½® i å¯¹åº”çš„é«˜åº¦<script type="math/tex">h_i</script>ï¼Œ<strong>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¯æ˜ä½ç½® i+1 å¯¹åº”çš„é«˜åº¦åº”è¯¥ä¸å°äº<script type="math/tex">h_i-1</script>ã€‚</strong></p><p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè®°k = sa[rank[i] - 1] ï¼Œå·²çŸ¥åç¼€S[iâ€¦]å’ŒS[kâ€¦]çš„å¤´éƒ¨<script type="math/tex">h_i</script>ä¸ªå­—ç¬¦æ˜¯ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆåç¼€S[i+1â€¦]å’ŒS[k+1â€¦]åˆ†åˆ«æ˜¯äºŒè€…å»é™¤é¦–å­—ç¬¦çš„ç»“æœï¼Œæ‰€ä»¥å®ƒä»¬å¤´éƒ¨<script type="math/tex">h_i-1</script>ä¸ªå­—ç¬¦æ˜¯ç›¸ç­‰çš„ã€‚è™½ç„¶åœ¨åç¼€æ•°ç»„ä¸­ï¼ŒS[i+1â€¦]å‰é¢ä¸€ä¸ªå…ƒç´ æœªå¿…å°±æ˜¯S[k+1â€¦]ï¼Œä½†å³ä¾¿å¦‚æ­¤ï¼Œå…¬å…±å‰ç¼€çš„é•¿åº¦ä¹Ÿæ˜¯åªå¢ä¸å‡çš„ã€‚å› æ­¤ï¼Œåªè¦ä»<script type="math/tex">h_i-1</script>å¼€å§‹æ£€æŸ¥ï¼Œè®¡ç®—æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦å°±å¥½äº†ã€‚</p><h4 id="ä»£ç æ¨¡æ¿"><a href="#ä»£ç æ¨¡æ¿" class="headerlink" title="ä»£ç æ¨¡æ¿"></a>ä»£ç æ¨¡æ¿</h4><p>å› ä¸ºé«˜åº¦æœ€å¤šå¢åŠ næ¬¡ï¼Œæ‰€ä»¥æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚å¦‚æœæŠŠè¿™ä¸ªé—®é¢˜å½“ä½œä½ç½®iå¯¹åº”çš„åŒºé—´æ˜¯[i,i+h)çš„å°ºå–æ³•æ¥çœ‹ï¼Œå°±å¾ˆå®¹æ˜“ç†è§£ã€‚åŒºé—´çš„å·¦å³ç«¯ç‚¹å§‹ç»ˆä¸ä¼šå‘å·¦ç§»ï¼Œå¹¶ä¸”æ˜¯ä¸è¶…è¿‡nçš„æ•´æ•°ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,k;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">sa[i]è¡¨ç¤ºæ’åä¸ºiçš„åç¼€èµ·å§‹ä½ç½®æ˜¯å¤šå°‘</span></span><br><span class="line"><span class="comment">rank[i]è¡¨ç¤ºèµ·å§‹ä½ç½®æ˜¯içš„ä¸²æ’åæ˜¯å¤šå°‘</span></span><br><span class="line"><span class="comment">rank[sa[i] ] = i , sa[rank[i] ] = i,rankä¸saäº’é€† </span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"><span class="keyword">int</span> sa[N],rank[N],tmp[N],lcp[N];</span><br><span class="line"><span class="comment">//æ¯”è¾ƒ(rank[i],rank[i+k])å’Œ(rank[j],rank[j+k]) </span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rank[i] != rank[j]) <span class="keyword">return</span> rank[i] &lt; rank[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n ? rank[i+k] : <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= n ? rank[j+k] : <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è®¡ç®—å­—ç¬¦ä¸²Sçš„åç¼€æ•°ç»„ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">char</span>* S,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line">n = <span class="built_in">strlen</span>(str);</span><br><span class="line"><span class="comment">//åˆå§‹é•¿åº¦ä¸º1ï¼Œrankç›´æ¥å–å­—ç¬¦çš„ç¼–ç </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rank[i] = i &lt; n ? S[i] : <span class="number">-1</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//åˆ©ç”¨å¯¹é•¿åº¦ä¸ºkçš„æ’åºç»“æœå¯¹é•¿åº¦ä¸º2kçš„æ’åº</span></span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+n+<span class="number">1</span>,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + (compare_sa(sa[i<span class="number">-1</span>],sa[i])?<span class="number">1</span>:<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rank[i] = tmp[i];</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æœ€é•¿å…¬å…±å‰ç¼€æ¨¡æ¿,å…¶ä¸­saä¸ºåç¼€æ•°ç»„,æ±‚å¾—ç»“æœå­˜æ”¾åœ¨lcp </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="keyword">char</span> *S,<span class="keyword">int</span> sa[],<span class="keyword">int</span> lcp[])</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="built_in">strlen</span>(S);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rank[sa[i]] = i;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>;lcp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="comment">/*lcp[i] è¡¨ç¤ºèµ·å§‹ä½ç½®ä¸ºsa[i]ä¸</span></span><br><span class="line"><span class="comment">èµ·å§‹ä½ç½®ä¸ºsa[i+1]çš„ä¸²çš„æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦*/</span> </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"><span class="keyword">int</span> j = sa[rank[i]<span class="number">-1</span>];</span><br><span class="line"><span class="comment">/*æ­¤å¤„jè¡¨ç¤ºæ’åœ¨"ä»¥iå¼€å§‹çš„åç¼€"å‰é¢ä¸€åçš„å­ä¸²çš„èµ·å§‹ä½ç½®*/</span> </span><br><span class="line"><span class="keyword">if</span>(h &gt; <span class="number">0</span>) h--;</span><br><span class="line"><span class="keyword">for</span>(;j + h &lt; n &amp;&amp; i+h &lt; n;h++)&#123;</span><br><span class="line"><span class="keyword">if</span>(S[j+h] != S[i+h]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*hä¸ºä»¥iå¼€å¤´çš„åç¼€ä¸ä»¥jå¼€å¤´çš„åç¼€çš„"æœ€é•¿å…¬å…±å‰ç¼€"çš„é•¿åº¦*/</span> </span><br><span class="line">lcp[rank[i]<span class="number">-1</span>] = h;</span><br><span class="line"><span class="comment">/*äºæ˜¯ä»¥jå¼€å¤´çš„åç¼€ ä¸ä»¥iå¼€å¤´çš„åç¼€ çš„ æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">è¢«å­˜æ”¾åœ¨lcp[rank[i]-1]ä¸­,å› ä¸ºlcpå®šä¹‰çš„å°±æ˜¯: </span></span><br><span class="line"><span class="comment">lcp[k] ä¸ºæ’åä¸ºiçš„åç¼€ä¸æ’åä¸ºi+1çš„åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦*/</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str) != EOF)&#123;</span><br><span class="line">construct_sa(str,sa);</span><br><span class="line">construct_lcp(str,sa,lcp);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>,lcp[i]);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>ç§‹å¶æ‹“å“‰ï¼ŒæŒ‘æˆ˜ç¨‹åºè®¾è®¡ç«èµ›ç¬¬2ç‰ˆï¼ŒåŒ—äº¬ï¼šäººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾ï¼Œ2013.6ï¼Œ378-381</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åç¼€æ•°ç»„ç¬”è®°</title>
      <link href="/2019/08/10/sa/"/>
      <url>/2019/08/10/sa/</url>
      
        <content type="html"><![CDATA[<h4 id="ä»€ä¹ˆæ˜¯åç¼€æ•°ç»„"><a href="#ä»€ä¹ˆæ˜¯åç¼€æ•°ç»„" class="headerlink" title="ä»€ä¹ˆæ˜¯åç¼€æ•°ç»„"></a>ä»€ä¹ˆæ˜¯åç¼€æ•°ç»„</h4><p>å­—ç¬¦ä¸²åç¼€ï¼ˆSuffixï¼‰æŒ‡çš„æ˜¯ä»å­—ç¬¦ä¸²çš„æŸä¸ªä½ç½®å¼€å§‹åˆ°å…¶æœ«å°¾çš„å­—ç¬¦ä¸²å­ä¸²ã€‚æˆ‘ä»¬è®¤ä¸ºåŸä¸²å’Œç©ºä¸²ä¹Ÿæ˜¯åç¼€ã€‚åä¹‹ï¼Œä»å­—ç¬¦ä¸²å¼€å¤´åˆ°æŸä¸ªä½ç½®çš„å­—ç¬¦ä¸²å­ä¸²åˆ™ç§°ä¸ºå‰ç¼€ã€‚</p><p>åç¼€æ•°ç»„ï¼ˆSuffix Arrayï¼‰æŒ‡çš„æ˜¯å°†æŸä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰åç¼€æŒ‰å­—å…¸åºæ’åºåå¾—åˆ°çš„æ•°ç»„ã€‚ä¸è¿‡æ•°ç»„ä¸­å¹¶ä¸éœ€è¦ç›´æ¥ä¿å­˜æ‰€æœ‰çš„åç¼€å­—ç¬¦ä¸²ï¼Œåªè¦è®°å½•å¯¹åº”çš„èµ·å§‹ä½ç½®å°±å¥½äº†ã€‚</p><h4 id="åç¼€æ•°ç»„çš„è®¡ç®—"><a href="#åç¼€æ•°ç»„çš„è®¡ç®—" class="headerlink" title="åç¼€æ•°ç»„çš„è®¡ç®—"></a>åç¼€æ•°ç»„çš„è®¡ç®—</h4><p>å‡è®¾æˆ‘ä»¬è¦è®¡ç®—é•¿åº¦ä¸ºnçš„å­—ç¬¦ä¸²Sçš„åç¼€æ•°ç»„ã€‚æœ€æœ´ç´ çš„åšæ³•å°±æ˜¯ç›´æ¥æŠŠæ‰€æœ‰åç¼€è¿›è¡Œæ’åºï¼Œå°†nä¸ªé•¿åº¦ä¸ºO(n)çš„å­—ç¬¦ä¸²è¿›è¡Œæ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸º<script type="math/tex">O(N^2logN)</script>ã€‚è€Œå¦‚æœçµæ´»è¿ç”¨æ‰€æœ‰çš„å­—ç¬¦ä¸²éƒ½æ˜¯Sçš„åç¼€è¿™ä¸€æ€§è´¨ï¼Œå°±å¯ä»¥å¾—åˆ°æ›´é«˜æ•ˆçš„ç®—æ³•ã€‚ä¸‹é¢ä»‹ç»ä¸€ç§ç”±Manverå’ŒMyerså‘æ˜çš„O(N log N)å¤æ‚åº¦çš„ç®—æ³•ã€‚</p><p>è¯¥ç®—æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯å€å¢ã€‚é¦–å…ˆè®¡ç®—ä»æ¯ä¸ªä½ç½®å¼€å§‹çš„é•¿åº¦ä¸º2çš„å­ä¸²çš„é¡ºåºï¼Œå†åˆ©ç”¨è¿™ä¸ªç»“æœè®¡ç®—é•¿åº¦ä¸º4çš„å­ä¸²çš„é¡ºåºï¼Œæ¥ä¸‹æ¥è®¡ç®—é•¿åº¦ä¸º8çš„å­ä¸²çš„é¡ºåºï¼Œä¸æ–­å€å¢ï¼Œç›´åˆ°é•¿åº¦å¤§äºç­‰äºnå°±å¾—åˆ°äº†åç¼€æ•°ç»„ã€‚ä¸‹é¢ï¼Œ<strong>æˆ‘ä»¬ç”¨ S[i , k] è¡¨ç¤ºä»ä½ç½®iå¼€å§‹çš„é•¿åº¦ä¸ºkçš„å­—ç¬¦ä¸²å­ä¸²ã€‚</strong> å…¶ä¸­ï¼Œå‰©ä½™å­—ç¬¦ä¸è¶³kä¸ªæ—¶ï¼Œè¡¨ç¤ºçš„æ˜¯ä»ä½ç½® i å¼€å§‹åˆ°å­—ç¬¦ä¸²æœ«å°¾çš„å­ä¸²ã€‚</p><p>è¦è®¡ç®—é•¿åº¦ä¸º 2 çš„å­ä¸²é¡ºåºï¼Œåªè¦æ’åºä¸¤ä¸ªå­—ç¬¦ç»„æˆçš„æ•°å¯¹å°±å¥½äº†ã€‚ç°åœ¨å‡è®¾å·²ç»æ±‚å¾—äº†é•¿åº¦ä¸º k çš„å­—ä¸²çš„é¡ºåºï¼Œè¦æ±‚é•¿åº¦ä¸º 2k çš„å­ä¸²é¡ºåºã€‚è®°$rank_k$ä¸ºS[i , k] åœ¨æ‰€æœ‰æ’å¥½åºçš„é•¿åº¦ä¸ºkçš„å­ä¸²ä¸­æ˜¯ç¬¬å‡ å°çš„ã€‚è¦è®¡ç®—é•¿åº¦ä¸º 2k çš„å­ä¸²çš„é¡ºåºï¼Œå°±åªè¦å¯¹ä¸¤ä¸ªrankç»„æˆçš„æ•°å¯¹è¿›è¡Œæ’åºå°±å¥½äº†ã€‚æˆ‘ä»¬é€šè¿‡å¯¹<script type="math/tex">rank_k(i)</script> ä¸ <script type="math/tex">rank_k(j+k)</script> çš„æ•°å¯¹çš„æ¯”è¾ƒæ¥ æ›¿ä»£å¯¹ S[i , 2k] å’Œ S[j , 2k] ï¼Œæ¯”è¾ƒ<script type="math/tex">randk_k(i+k)</script>å’Œ<script type="math/tex">rank_j(j+k)</script>å°±ç›¸å½“äºæ¯”è¾ƒS[i+k , k] å’Œ S[j+k , k] ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·é«˜æ•ˆçš„æ¯”è¾ƒé•¿åº¦ä¸º 2k çš„<strong>å­ä¸²</strong> ï¼Œå¹¶å°†å®ƒä»¬æ’åºã€‚</p><h4 id="ç®—æ³•æ¨¡æ¿"><a href="#ç®—æ³•æ¨¡æ¿" class="headerlink" title="ç®—æ³•æ¨¡æ¿"></a>ç®—æ³•æ¨¡æ¿</h4><p>è¯¥ä»£ç å…±ç”¨åˆ°äº†ä¸‰ä¸ªæ•°ç»„ï¼Œtmp , sa  ,  rankï¼›å…¶ä¸­tmpæ•°ç»„æ˜¯ç”¨æ¥ä¸´æ—¶å­˜æ”¾æ–°è®¡ç®—çš„rankçš„ï¼Œè€Œ sa[i] åˆ™å­˜æ”¾çš„å½“å‰é•¿åº¦ä¸ºkæ—¶å­—å…¸åºç¬¬ i å°çš„å­—ç¬¦èµ·å§‹ä½ç½®æ˜¯sa[i]ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,k;</span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="keyword">int</span> sa[N],rank[N],tmp[N];</span><br><span class="line"><span class="comment">//æ¯”è¾ƒ(rank[i],rank[i+k])å’Œ(rank[j],rank[j+k]) </span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rank[i] != rank[j]) <span class="keyword">return</span> rank[i] &lt; rank[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n ? rank[i+k] : <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= n ? rank[j+k] : <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è®¡ç®—å­—ç¬¦ä¸²Sçš„åç¼€æ•°ç»„ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">char</span>* S,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line">n = <span class="built_in">strlen</span>(str);</span><br><span class="line"><span class="comment">//åˆå§‹é•¿åº¦ä¸º1ï¼Œrankç›´æ¥å–å­—ç¬¦çš„ç¼–ç </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rank[i] = i &lt; n ? S[i] : <span class="number">-1</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//åˆ©ç”¨å¯¹é•¿åº¦ä¸ºkçš„æ’åºç»“æœå¯¹é•¿åº¦ä¸º2kçš„æ’åº</span></span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+n+<span class="number">1</span>,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + (compare_sa(sa[i<span class="number">-1</span>],sa[i])?<span class="number">1</span>:<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rank[i] = tmp[i];</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str) != EOF)&#123;</span><br><span class="line">construct_sa(str,sa);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>,sa[i]+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h4><p><strong>POJ3518ï¼šSequence</strong><br><a href="http://poj.org/problem?id=3581" target="_blank" rel="noopener">æµ‹è¯•åœ°å€</a><br><strong>é¢˜æ„ç®€è¿°ï¼š</strong><br>ç»™å®š N ä¸ªæ•°å­—ç»„æˆçš„åºåˆ—$A_1 , A_2 , â€¦ , A_n$ã€‚å…¶ä¸­$A_1$æ¯”å…¶å®ƒæ•°å­—éƒ½å¤§ã€‚ç°åœ¨è¦æŠŠè¿™ä¸ªåºåˆ—åˆ†æˆä¸‰ä¸ªå­æ®µï¼Œå¹¶å°†æ¯æ®µåˆ†åˆ«åè½¬ï¼Œæ±‚èƒ½å¾—åˆ°çš„å­—å…¸åºæœ€å°çš„åºåˆ—æ˜¯ä»€ä¹ˆï¼Ÿè¦æ±‚åˆ†å¾—çš„æ¯æ®µéƒ½ä¸ä¸ºç©ºã€‚<br><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>ç¡®å®šç¬¬ä¸€æ®µæ˜¯å¾ˆç®€å•çš„ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªæ•°æœ€å¤§ï¼Œæ‰€ä»¥è‚¯å®šæ—‹è½¬åè¦åœ¨æœ«å°¾ï¼Œæ‰€ä»¥åªè¦æŠŠAæ•°ç»„å€’ç½®åæ±‚åç¼€æ•°ç»„ï¼Œå–å­—å…¸åºæœ€å°ä¸”åˆæ³•çš„åç¼€ï¼Œå³ä¸ºç¬¬ä¸€æ®µçš„ç­”æ¡ˆã€‚è¿™é‡Œçš„åˆæ³•æ˜¯æŒ‡å‰©ä¸‹çš„å…ƒç´ ä¸ªæ•°è¦å¤§äº2ï¼Œä¸ç„¶æ²¡æ³•åˆ†æˆ3æ®µã€‚</p><p>ç„¶åè¦æƒ³æŠŠå‰©ä½™çš„éƒ¨åˆ†åˆ†æˆä¸¤æ®µã€‚ä¸è¿‡è¿™æ¬¡çš„ä¸¤ç«¯å¹¶ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œä¸èƒ½ç®€å•çš„æ¯”è¾ƒå‰åŠéƒ¨åˆ†çš„å­—å…¸åºå–æœ€å°è€…ã€‚ä¸è¿‡ï¼Œå°†åºåˆ—åˆ†å‰²æˆä¸¤ç«¯å†åˆ†åˆ«åè½¬å¾—åˆ°çš„åºåˆ—ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸¤ä¸ªåŸåºåˆ—æ‹¼æ¥åå¾—åˆ°çš„æ–°åºåˆ—ä¸­çš„æŸä¸ªå­ä¸²åè½¬åå¾—åˆ°çš„åºåˆ—ã€‚å› æ­¤ï¼Œåªéœ€è¦è®¡ç®—æ‹¼æ¥åçš„åºåˆ—çš„åç¼€æ•°ç»„ï¼Œä»ä¸­é€‰æ‹©å­—å…¸åºå°½é‡å°å¹¶ä¸”åˆæ³•çš„å³å¯ã€‚</p><p>æ¯”å¦‚ï¼šä»ABCDEä¸­é€‰ä¿©æ®µåè½¬åå­—å…¸åºæœ€å°ã€‚ç­‰åŒäºä»EDCBAEDCBAä¸­é€‰æ‹©ä¸€ä¸ªå­—å…¸åºæœ€å°çš„åˆæ³•å­ä¸²ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> A[N],rev[<span class="number">2</span>*N],sa[<span class="number">2</span>*N];</span><br><span class="line"><span class="keyword">int</span> n,k,m,tmp[<span class="number">2</span>*N],rank[<span class="number">2</span>*N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(rank[i] != rank[j]) <span class="keyword">return</span> rank[i] &lt; rank[j];</span><br><span class="line"><span class="keyword">int</span> ri = i+k &lt;= n ? rank[i+k]:-INF<span class="number">-1</span>;<span class="comment">//è¿™é‡Œä¸è¦æé”™ </span></span><br><span class="line"><span class="keyword">int</span> rj = j+k &lt;= n ? rank[j+k]:-INF<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ³¨æ„Açš„ä¸‹æ ‡æ˜¯[0,len)çš„ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="keyword">int</span> A[],<span class="keyword">int</span> len,<span class="keyword">int</span> sa[])</span></span>&#123;</span><br><span class="line">n = len;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)&#123;</span><br><span class="line">sa[i] = i;</span><br><span class="line">rank[i] = i &lt; n ? A[i] : -INF;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>;k &lt;= n;k *= <span class="number">2</span>)&#123;</span><br><span class="line">sort(sa,sa+n+<span class="number">1</span>,compare_sa);</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]] + (compare_sa(sa[i<span class="number">-1</span>],sa[i])?<span class="number">1</span>:<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++) rank[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">reverse_copy(A,A+m,rev);</span><br><span class="line">construct_sa(rev,m,sa);</span><br><span class="line"><span class="keyword">int</span> p1,p2;</span><br><span class="line"><span class="comment">//è€ƒè™‘ä¸€ä¸‹p1éœ€è¦æ»¡è¶³çš„æ¡ä»¶ </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">p1 = m-sa[i];</span><br><span class="line"><span class="keyword">if</span>(p1 &gt;= <span class="number">1</span> &amp;&amp; m-p1 &gt;= <span class="number">2</span>) <span class="keyword">break</span>;</span><br><span class="line">&#125; </span><br><span class="line">reverse_copy(p1+A,A+m,rev);</span><br><span class="line">reverse_copy(p1+A,A+m,rev+m-p1); </span><br><span class="line">construct_sa(rev,<span class="number">2</span>*(m-p1),sa);</span><br><span class="line"><span class="comment">//è€ƒè™‘p2çš„èŒƒå›´ </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">2</span>*(m-p1);i++)&#123;</span><br><span class="line">p2 = sa[i];</span><br><span class="line"><span class="keyword">if</span>(p2 &gt; <span class="number">0</span> &amp;&amp; p2 &lt; m-p1) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">reverse(A,A+p1);</span><br><span class="line"><span class="comment">//è¾“å‡ºç­”æ¡ˆ </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; p1;i++) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,A[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = p2;i &lt; p2+m-p1;i++) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,rev[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,A+i);</span><br><span class="line">solve();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>ç§‹å¶æ‹“å“‰ï¼ŒæŒ‘æˆ˜ç¨‹åºè®¾è®¡ç«èµ›ç¬¬2ç‰ˆï¼ŒåŒ—äº¬ï¼šäººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾ï¼Œ2013.6ï¼Œ378-381</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Miller_Rabinæ¨¡æ¿</title>
      <link href="/2019/08/08/Miller-Rabin/"/>
      <url>/2019/08/08/Miller-Rabin/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>Miller-Rabinç´ æ€§æµ‹è¯•æ˜¯ä¸€ç§ç”¨æ¥æ£€éªŒä¸€ä¸ªæ•°  Q  æ˜¯å¦ä¸ºç´ æ•°çš„éšæœºç®—æ³•ã€‚å…¶æ—¶é—´å¤æ‚åº¦ä¸º$O(log^3Q)$ã€‚å…¶æ­£ç¡®æ€§ä¸º $1-4^{-k}$ å…¶ä¸­ k ä¸ºæ£€éªŒæ¬¡æ•°ã€‚<br>è¯¥ç®—æ³•åŸæœ¬æ˜¯ç”±Gary Lee Miller åŸºäºå¹¿ä¹‰é»æ›¼çŒœæƒ³å‘æ˜ï¼Œåç»ç”±Micheal O.Rabinæ”¹ä¸ºä¸ä¾èµ–è¯¥å‡è®¾çš„éšæœºåŒ–ç®—æ³•ã€‚<br>è¯¥ç®—æ³•çš„é«˜æ•ˆåŸºäº<strong>è´¹é©¬å°å®šç†</strong> ä»¥åŠ <strong>äºŒæ¬¡æ¢æµ‹æ³•</strong> ï¼Œæœ¬æ–‡å°†é¦–å…ˆç®€å•ä»‹ç»è¿™ä¸¤ä¸ªåŸºæœ¬ç†è®ºï¼Œè€Œåç»™å‡ºç®—æ³•æµç¨‹ä»¥åŠä»£ç æ¨¡æ¿ã€‚</p><h4 id="é—®é¢˜æ¨¡å‹"><a href="#é—®é¢˜æ¨¡å‹" class="headerlink" title="é—®é¢˜æ¨¡å‹"></a>é—®é¢˜æ¨¡å‹</h4><p>ä¾‹1ï¼šç»™å®šä¸€ä¸ªæ•°Qï¼Œè¯·åˆ¤æ–­å…¶æ˜¯å¦ä¸ºç´ æ•°(1e10 &lt; Q &lt; 1e14)ã€‚</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºç´ æ•°ï¼Œæˆ‘ä»¬æœ‰åœ¨æ­¤ä¹‹å‰æ˜¯æœ‰$O(\sqrt{N})$çš„è§£é¢˜ç­–ç•¥çš„ï¼Œå½“ç„¶ä¹Ÿæœ‰O(N)æ±‚å‡º1~Næ‰€æœ‰ç´ æ•°çš„çº¿æ€§ç­›æ³•ï¼Œä½†æ˜¯å¯¹äºåœ¨1e10çº§åˆ«çš„å¾…æµ‹æ•°Qï¼Œè¿™ä¸¤è€…éƒ½æ˜¾å¾—è¿‡äºä½æ•ˆï¼Œéš¾ä»¥è¾¾åˆ°æˆ‘ä»¬æœŸæœ›çš„æ•ˆæœã€‚<br>Miller-Rabinç®—æ³•æ˜¯ä¸€ç§å¿«é€Ÿçš„å¤§ç´ æ•°åˆ¤æ–­ç®—æ³•ï¼Œåˆ¤æ–­æ¯ä¸ªç´ æ•°ä»…éœ€$O(log^3Q)$çš„æ—¶é—´ï¼Œå¯¹äºåˆ¤æ–­å¤§ç´ æ•°è€Œè¨€æœ‰ç€ä»¤äººæ»¡æ„çš„æ•ˆç‡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é‡‡ç”¨è¯¥ç®—æ³•ã€‚</p><h4 id="è´¹é©¬å°å®šç†ä¸äºŒæ¬¡æ¢æµ‹æ³•"><a href="#è´¹é©¬å°å®šç†ä¸äºŒæ¬¡æ¢æµ‹æ³•" class="headerlink" title="è´¹é©¬å°å®šç†ä¸äºŒæ¬¡æ¢æµ‹æ³•"></a>è´¹é©¬å°å®šç†ä¸äºŒæ¬¡æ¢æµ‹æ³•</h4><p><strong>è´¹é©¬å°å®šç†ï¼š</strong> $a^{p-1} \equiv 1(mod p)$<br>å…¶ä¸­ p æ˜¯ç´ æ•°æ—¶è´¹é©¬å°å®šç†æ‰ä¸€å®šæˆç«‹ã€‚äºæ˜¯å¾—ä»¥å¾—åˆ°â€œ p æ˜¯ç´ æ•°â€æ˜¯â€œè´¹é©¬å°å®šç†æˆç«‹â€çš„å……åˆ†ä¸å¿…è¦æ¡ä»¶ã€‚å³å­˜åœ¨ä¸€ä¸ªæ•° p ï¼Œä½¿å¾—$a^{p-1} \equiv 1(mod p)$ï¼Œä½†pä¸æ˜¯ç´ æ•°ã€‚<br>æœ¬æ¥æˆ‘ä»¬æ˜¯ä»…æ ¹æ®â€œp æ˜¯å¦èƒ½ä½¿å¾—è´¹é©¬å°å®šç†æˆç«‹â€æ¥åˆ¤æ–­ p æ˜¯å¦ä¸ºç´ æ•°ï¼Œä½†è¿™æ ·é”™è¯¯ç‡æœ‰ç‚¹é«˜ï¼Œäºæ˜¯ä¾¿æœ‰äº†äºŒæ¬¡æ¢æµ‹æ³•ã€‚</p><p><strong>äºŒæ¬¡æ¢æµ‹æ³•ï¼š</strong> å¦‚æœ p æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œä¸” 0 &lt; x &lt; pï¼Œåˆ™æ–¹ç¨‹$a^2 \equiv1(mod p)$çš„è§£ä¸º a = 1 æˆ– a = p - 1ã€‚</p><p><strong>è¯æ˜ï¼š</strong><br>æ˜“å¾—ï¼š$a^2 - 1 \equiv 0(mod p)$<br>æ‰€ä»¥ $(a+1)(a-1)\equiv0(mod p)$<br>æ‰€ä»¥ $p|(a-1)(a+1)$<br>åˆå› ä¸ºpæ˜¯è´¨æ•°<br>æ‰€ä»¥ a = 1 æˆ– a = p-1</p><p><em>æ³¨ï¼šå…¶ä¸­ | ä¸ºæ•´é™¤ç¬¦å·ï¼Œä»£è¡¨ p èƒ½æ•´æ•°(a-1)(a+1)æˆ–è€…(a-1)(a+1)èƒ½è¢« p æ•´é™¤ã€‚</em></p><h4 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h4><p>æœ‰äº†è´¹é©¬å°å®šç†ï¼Œæˆ‘ä»¬çš„ç®—æ³•æ¨¡å‹å°±åˆæ­¥æˆå‹äº†ï¼Œå³æµ‹è¯•ä¸€ä¸ªæ•°æ˜¯å¦æ»¡è¶³è´¹é©¬å°å®šç†æ¥åˆ¤æ–­å…¶æ˜¯å¦å¯èƒ½ä¸ºç´ æ•°ã€‚å‡è®¾è¿™ä¸ªæ•°é€šè¿‡äº†è´¹é©¬å°å®šç†çš„æµ‹è¯•ï¼Œé‚£ä¹ˆå…¶æœ‰å¯èƒ½ä¸ºç´ æ•°ï¼Œäºæ˜¯å¯¹å…¶è¿›è¡ŒäºŒæ¬¡æ¢æµ‹ï¼Œå¦‚æœä»ç„¶é€šè¿‡ï¼Œåˆ™æ˜¯ç´ æ•°çš„å¯èƒ½å°±å¾ˆå¤§ï¼ˆå°±å¯ä»¥åŸºæœ¬è®¤å®šå…¶ä¸ºç´ æ•°ï¼‰ï¼Œæœ‰æ•ˆçš„æé«˜äº†æ­£ç¡®ç‡ã€‚<br>ä½†æ˜¯ç”±äºæˆ‘ä»¬çš„è´¹é©¬å°å®šç†å¯¹äºåº• a æ˜¯æ²¡æœ‰è¦æ±‚çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¤šæŒ‘å‡ ä¸ªåº•æ¥åšæµ‹è¯•ï¼Œæé«˜ç®—æ³•æ­£ç¡®æ€§ã€‚ç½‘ä¸Šæœ‰äº›ç»“è®ºï¼Œå¯¹äº4,759,123,141ä»¥å†…çš„æ•°ï¼Œéƒ½å¯ä»¥é€šè¿‡ä»¥2ï¼Œ7ï¼Œ61ä¸ºåº•çš„Miller-Rabinç®—æ³•æ¥è¿›è¡Œåˆ¤æ–­ã€‚<br>ä¸è¿‡å¸¸ç”¨çš„è¿˜æ˜¯å–éšæœºæ•°ï¼Œå–kæ¬¡æ­£ç¡®ç‡å°±æ˜¯$1-4^{-k}$ï¼Œåœ¨å‡ºé¢˜äººä¸çŸ¥é“ä½ çš„éšæœºæ•°æ˜¯å¤šå°‘çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯å¾ˆéš¾hackæ‰ä½ çš„ã€‚</p><p>ç°åœ¨ï¼Œå¦‚æœæœ‰ä¸€ä¸ªå¤§äº 2 çš„è´¨æ•° nï¼Œä»¤<script type="math/tex">n-1 = 2^s *  d</script>ï¼Œå…¶ä¸­ d ä¸ºå¥‡æ•°ï¼Œåˆ™æ ¹æ®è´¹é©¬å°å®šç†ï¼Œå¦‚æœaä¸èƒ½è¢«ç´ æ•° n æ•´é™¤ï¼Œåˆ™<script type="math/tex">a^{n-1} \equiv 1 (mod n)</script>ã€‚äºæ˜¯å¯ä»¥æ¨å‡ºï¼š</p><p><script type="math/tex">a^d\equiv1(mod n)</script> æˆ–è€… <script type="math/tex">a^2 \equiv 1 (mod n)</script>ï¼Œ<script type="math/tex">a^{2^r  * d}\equiv n-1(mod \:n)</script>ï¼Œ0 &lt;= r &lt; sï¼Œå…¶ä¸­aä¸ºä»»æ„è‡ªç„¶æ•°ã€‚<br>äºæ˜¯æˆ‘ä»¬åªéœ€æ‰¾åˆ°ä¸€ä¸ªaï¼Œæ»¡è¶³<script type="math/tex">a^{n-1} \neq1(modn)</script>æˆ–è€…å­˜åœ¨ä¸€ä¸ªè‡ªç„¶æ•°r(0&lt;= r &lt;s)ï¼Œä½¿å¾—<script type="math/tex">a^{2^r  * d} \neq n-1(modn)</script>ï¼Œå°±å¯ä»¥è¯´æ˜ n ä¸€å®šä¸æ˜¯ç´ æ•°ã€‚</p><p><strong>ä¼ªä»£ç ï¼š</strong><br>isPrime(n):<br>&emsp;1.å¦‚æœnä¸ºå¶æ•°ï¼Œè¿”å›falseï¼›<br>&emsp;2.æ±‚å‡ºdã€tï¼Œdä¸ºn-1å»æ‰æ‰€æœ‰å› å­2åçš„å€¼ï¼ŒåŒæ ·çš„ï¼Œtä¸ºn-1ä¸­å› å­2çš„ä¸ªæ•°ï¼›<br>&emsp;3.å–ä¸€ä¸ªéšæœºæ•°aï¼Œä»¤x = <script type="math/tex">a^d mod n</script>ï¼›<br>&emsp;4.å¯¹äºæ‰€æœ‰çš„ r (0 &lt;= r &lt; t)ï¼Œä»¤<script type="math/tex">y = a^{2^r * d} mod n</script>ï¼Œå³<script type="math/tex">y = x *  x mod n</script>ï¼Œè‹¥y = 1ï¼Œåˆ™æ ¹æ®äºŒæ¬¡æ¢æµ‹å®šç†ï¼Œxå¿…é¡»ä¸º1æˆ–n-1ï¼Œå¦åˆ™nä¸æ˜¯ç´ æ•°ï¼Œè¿”å›falseï¼›<br>&emsp;5.è‹¥x != 1ï¼Œåˆ™ä¸æ»¡è¶³è´¹é©¬å°å®šç†ï¼Œè¿”å›falseï¼Œå¦åˆ™èµ°3æˆ–è¿”å›trueã€‚</p><h4 id="ç®—æ³•æ¨¡æ¿"><a href="#ç®—æ³•æ¨¡æ¿" class="headerlink" title="ç®—æ³•æ¨¡æ¿"></a>ç®—æ³•æ¨¡æ¿</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">APIï¼š</span></span><br><span class="line"><span class="comment">fuml(a,b,p)è¿”å› a*b%p çš„å€¼,åœ¨ä¸­é—´ç»“æœæº¢å‡ºlonglongæ—¶ä½¿ç”¨</span></span><br><span class="line"><span class="comment">qpow(a,b,p)è¿”å› a^b%p çš„å¿«é€Ÿå¹‚å‡½æ•° </span></span><br><span class="line"><span class="comment">isPrime(n)å°†åœ¨O(log^3 n)æ—¶é—´å†…åˆ¤æ–­å‡ºnæ˜¯å¦ä¸ºç´ æ•°ï¼Œå¹¶è¿”å›ç»“æœ</span></span><br><span class="line"><span class="comment">typedef long long ll</span></span><br><span class="line"><span class="comment">å¤´æ–‡ä»¶ï¼šcstdilb, </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> testnum[] = &#123;<span class="number">2</span>,<span class="number">7</span>,<span class="number">61</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>&#125;;</span><br><span class="line"><span class="function">ll <span class="title">fmul</span><span class="params">(ll a,ll b,ll p)</span></span>&#123;</span><br><span class="line"><span class="comment">/*return a*b%p*/</span></span><br><span class="line">ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = (res+a)%p;</span><br><span class="line">        a = (a+a)%p;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b,ll m)</span></span>&#123;</span><br><span class="line"><span class="comment">/*return a^b %m*/</span></span><br><span class="line">ll res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(b)&#123;</span><br><span class="line"><span class="keyword">if</span>(b&amp;<span class="number">1</span>)res = fmul(res,a,m);</span><br><span class="line">a = fmul(a,a,m);</span><br><span class="line">b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isPrime</span><span class="params">(ll n)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(n == <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span>(n &lt; <span class="number">2</span> || n%<span class="number">2</span> == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">ll d = n<span class="number">-1</span> , a, x, y; <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>((d&amp;<span class="number">1</span>) == <span class="number">0</span>) d &gt;&gt;= <span class="number">1</span>,t++;</span><br><span class="line"><span class="comment">//æ­¤æ—¶bä¸ºæ²¡æœ‰å› å­2çš„å¥‡æ•° </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">3</span>;i++)&#123;</span><br><span class="line">a = testnum[i];</span><br><span class="line"><span class="keyword">if</span>(n == a) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="comment">/*ä»¥æœ¬èº«ä¸ºåº•æ˜¯ä¸€å®šä¸æˆç«‹çš„å“¦,éœ€ç‰¹åˆ¤*/</span></span><br><span class="line">x = qpow(a,d,n);</span><br><span class="line"><span class="comment">/*æˆ‘ä»¬è¦ä½¿å¾—æ‰€æœ‰çš„a(^(2^r)*d)éƒ½æ»¡è¶³äºŒæ¬¡æ¢æµ‹å®šç†*/</span> </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; t;j++)&#123;</span><br><span class="line">y = fmul(x,x,n);</span><br><span class="line"><span class="keyword">if</span>(y == <span class="number">1</span> &amp;&amp; x != <span class="number">1</span> &amp;&amp; x != n<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">x = y;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span>(x != <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="comment">/*ä¸æ»¡è¶³è´¹é©¬å°å®šç†*/</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="comment">/*å½“x=n-1ï¼Œæˆ–bä¸ºå¥‡æ•°æ—¶è¿”å›true*/</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li>ç®—æ³•è®¾è®¡ç¼–ç¨‹å®éªŒï¼Œå´æ°¸è¾‰ï¼ŒåŒ—äº¬ï¼šæœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾ï¼Œ2013ï¼Œ79-80</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•æ¨¡æ¿ </tag>
            
            <tag> æ•°è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ€§åŸº</title>
      <link href="/2019/07/26/xxj/"/>
      <url>/2019/07/26/xxj/</url>
      
        <content type="html"><![CDATA[<h4 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h4><p>çº¿æ€§åŸºç±»ä¼¼äºçº¿æ€§ç©ºé—´ä¸­åŸºåº•çš„ä¸€ä¸ªæ¦‚å¿µã€‚è€Œåœ¨è¿™é‡Œï¼Œçº¿æ€§åŸºç‰¹æŒ‡ç”¨æ¥å¤„ç†â€œé›†åˆä¸ºéè´Ÿæ•´æ•°ï¼Œè¿ç®—ä¸ºå¼‚æˆ–â€çš„ä¸€ç±»é—®é¢˜ã€‚åœ¨çº¿æ€§ä»£æ•°ä¸­æœ‰çº¿æ€§æ— å…³å’Œæå¤§çº¿æ€§æ— å…³ç»„çš„æ¦‚å¿µï¼Œè¿™é‡Œçš„çº¿æ€§åŸºä¸ä¹‹ç±»ä¼¼ã€‚<br>é¦–å…ˆæœ¬æ–‡ä¼šä»ç†è®ºä¸Šä»‹ç»çº¿æ€§åŸºæ‰€å…·æœ‰çš„æ€§è´¨ä»¥åŠå…¶æ„é€ æ–¹æ³•ï¼Œæ¥ç€ä¼šä»‹ç»çº¿æ€§åŸºçš„å¸¸è§æ“ä½œä»¥åŠå…¶é€‚ç”¨çš„é—®é¢˜èŒƒå›´ã€‚æœ€ç»ˆä»¥ä¾‹é¢˜è®²è§£ç»“æŸã€‚</p><h4 id="ä»€ä¹ˆæ˜¯çº¿æ€§åŸº"><a href="#ä»€ä¹ˆæ˜¯çº¿æ€§åŸº" class="headerlink" title="ä»€ä¹ˆæ˜¯çº¿æ€§åŸº"></a>ä»€ä¹ˆæ˜¯çº¿æ€§åŸº</h4><p>çº¿æ€§åŸºæ˜¯ä¸€ç§ç‰¹æ®Šçš„åŸºï¼Œå®ƒé€šå¸¸å‡ºç°åœ¨å¼‚æˆ–è¿ç®—ä¸­ï¼Œå®ƒçš„æ„ä¹‰ä¸ºï¼šé€šè¿‡åŸé›†åˆçš„æŸä¸€æœ€å°å­é›†S1ä½¿å¾—S1å†…å…ƒç´ ç›¸äº’å¼‚æˆ–å¾—åˆ°çš„å€¼åŸŸä¸åŸé›†åˆSç›¸äº’å¼‚æˆ–å¾—åˆ°çš„å€¼åŸŸç›¸åŒã€‚<br>å¦‚æœæŒ‰ç…§çº¿æ€§ä»£æ•°ä¸­çš„è¯´æ³•ï¼Œä¹Ÿå¯ä»¥è¡¨è¿°ä¸ºï¼šé€šè¿‡S1å†…å…ƒç´ çš„ç»„åˆå¼‚æˆ–å¯ä»¥å¾—åˆ°åŸé›†åˆSä¸­æ‰€æœ‰çš„å…ƒç´ ã€‚<br>é‚£ä¹ˆS-S1å…¶å®å°±æ˜¯å†—ä½™å…ƒç´ äº†ï¼Œå› ä¸ºè¿™äº›å…ƒç´ éƒ½å¯ä»¥é€šè¿‡çº¿ç»„åˆå¼‚æˆ–S1ä¸­çš„å…ƒç´ å¾—åˆ°ã€‚</p><h4 id="çº¿æ€§åŸºçš„æ€§è´¨"><a href="#çº¿æ€§åŸºçš„æ€§è´¨" class="headerlink" title="çº¿æ€§åŸºçš„æ€§è´¨"></a>çº¿æ€§åŸºçš„æ€§è´¨</h4><p>ä¸‹æ–‡ä¸­â€œæœ€é«˜ä½â€è‹¥æ— ç‰¹æ®Šè¯´æ˜ï¼Œçš†æŒ‡äºŒè¿›åˆ¶ä¸‹æ‰€æœ‰å€¼ä¸º1çš„æœ€é«˜ä½ï¼Œå¦‚10110çš„æœ€é«˜ä½å°±æ˜¯ç¬¬4ä½ï¼ˆä»å³å‘å·¦æ˜¯ç¬¬0~4ä½ï¼‰ã€‚</p><ol><li>çº¿æ€§åŸºæ²¡æœ‰å¼‚æˆ–å’Œä¸º0çš„å­é›†ã€‚</li><li>çº¿æ€§åŸºçš„å¼‚æˆ–é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„å¼‚æˆ–æ–¹æ¡ˆå”¯ä¸€ï¼ˆä¸æ€§è´¨1ç­‰ä»·ï¼‰ã€‚</li><li>çº¿æ€§åŸºä¸­çš„å…ƒç´ é€šè¿‡ç»„åˆå¼‚æˆ–å¾—åˆ°çš„å€¼åŸŸå’ŒåŸé›†åˆç»„åˆå¼‚æˆ–å¾—åˆ°çš„å€¼åŸŸç›¸åŒã€‚</li><li>çº¿æ€§åŸºä¸­æ¯ä¸ªåŸºçš„äºŒè¿›åˆ¶æœ€é«˜ä½ä¸åŒã€‚</li><li>å¦‚æœçº¿æ€§åŸºæ˜¯æ»¡çº¿æ€§åŸºï¼Œåˆ™å®ƒçš„å¼‚æˆ–é›†åˆä¸ºåŒºé—´$[1,2^n-1]$ï¼ˆnä¸ªåŸºï¼‰ã€‚</li></ol><p>æ€§è´¨5å¾ˆå¥½è¯æ˜ï¼Œå°±åƒ8ä¸ªäºŒè¿›åˆ¶ä½å¯ä»¥è¡¨ç¤ºçš„èŒƒå›´æ˜¯$[0,2^8-1]$ï¼Œè€Œæˆ‘ä»¬è¿™é‡Œçš„çº¿æ€§åŸºä¸åŒ…å«0ï¼Œå› æ­¤å°±æ˜¯$[1 , 2^n-1]$ã€‚</p><p>æ€§è´¨4ä¹Ÿæ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚æ ¹æ®æˆ‘ä»¬çº¿æ€§åŸºçš„å®šä¹‰ï¼Œå…¶æ˜¯åŸé›†åˆçš„æœ€å°å­é›†ï¼Œè‹¥æœ‰ä¿©ä¸ªæœ€é«˜ä½pï¼ˆäºŒè¿›åˆ¶ä»å³å‘å·¦ç¬¬pä½ï¼‰ä¸Šä¸º1ï¼Œé‚£ä¹ˆå®ƒä»¬å¯¹å€¼åŸŸçš„è´¡çŒ®é‡å¤äº†ï¼Œå°±ä¸ç¬¦åˆæœ€å°å­é›†è¿™ä¸€æ€§è´¨äº†ã€‚</p><p>æ€§è´¨3ä¸éœ€è¦è§£é‡Šäº†å§ã€‚æ€§è´¨1ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬çº¿æ€§åŸºä¸­æ˜¯æ²¡æœ‰0å‘é‡çš„ï¼Œè€Œåˆç”±äºæ€§è´¨4ï¼Œæ‰€ä»¥ä¸å¯èƒ½ç»„åˆå‡º0å‘é‡ã€‚</p><p>å¯¹äºæ€§è´¨2çš„è¯æ˜ï¼šå¦‚æœæˆ‘ä»¬è¦ä»çº¿æ€§åŸºä¸­æŒ‘è‹¥å¹²ä¸ªåŸºå¼‚æˆ–å¾—åˆ°xï¼Œé‚£ä¹ˆå‡è®¾$a_1$ xor $a_2$ xor â€¦ xor $a_p$ =$b_1$ xor $b_2$ xor â€¦ xor $b_q$ = xï¼Œé‚£ä¹ˆæ˜¾ç„¶$a_1$ xor $a_2$ xor â€¦ xor $a_p$ xor$b_1$ xor $b_2$ xor â€¦ xor $b_q$ = 0ã€‚ä¸æ€§è´¨1çŸ›ç›¾ï¼Œæ•…æ€§è´¨2æˆç«‹ã€‚</p><p>è‡³æ­¤æˆ‘ä»¬ç®€å•å´æ­£ç¡®çš„è¯æ˜äº†ä¸Šè¿°5ä¸ªæ€§è´¨çš„æ­£ç¡®æ€§ã€‚</p><h4 id="çº¿æ€§åŸºçš„æ„é€ æ–¹æ³•"><a href="#çº¿æ€§åŸºçš„æ„é€ æ–¹æ³•" class="headerlink" title="çº¿æ€§åŸºçš„æ„é€ æ–¹æ³•"></a>çº¿æ€§åŸºçš„æ„é€ æ–¹æ³•</h4><p>è¦ç»™å‡ºä¸ª<strong>ç»“è®ºâ‘ ï¼š</strong> è‹¥å‘é‡ç»„ä¸­æœ‰aå’Œbï¼Œé‚£ä¹ˆè‹¥æŠŠbæ›¿æ¢ä¸ºa xor bï¼Œæ›¿æ¢å‰åå‘é‡ç»„ä¸­çš„å‘é‡çº¿æ€§ç»„åˆå¾—åˆ°çš„ç©ºé—´ç›¸åŒã€‚<br><strong>è¯æ˜ï¼š</strong><br>è‹¥c = a xor bï¼Œç”¨cæ›¿ä»£bï¼Œè¿™æ ·åŸå‘é‡ç»„ä» aã€b å˜æˆäº† a ã€cï¼›<br>è€Œaã€cå¯ä»¥å¾—åˆ°aã€a xor cï¼Œå³ aã€bï¼Œå› æ­¤aã€cå‘é‡ç»„å®é™…ç­‰äºaã€bã€‚</p><p>æˆ‘ä»¬çŸ¥é“äºŒè¿›åˆ¶ä½ä»å³å‘å·¦æ˜¯ä½ä½åˆ°é«˜ä½ï¼Œç°åœ¨æˆ‘ä»¬ä»å·¦å‘å³éå†æ¯ä¸€ä¸ªæ•°xçš„äºŒè¿›åˆ¶ä½ï¼Œä¸‹åŒã€‚å‡è®¾å¾…æ’å…¥çº¿æ€§åŸºé›†åˆä¸­çš„å…ƒç´ ä¸ºxã€‚</p><p>ç”±äºæ€§è´¨4ï¼Œæ‰€ä»¥è‹¥ x å½“å‰ä½ç½®pä¸Šä¸º1ï¼Œå®ƒè¦ä¹ˆä½œä¸ºæœ€é«˜ä½ä¸º p çš„åŸºï¼Œè¦ä¹ˆå°±ä¹–ä¹–çš„æŠŠç¬¬pä½æ¶ˆä¸º0ï¼Œè½¬è€Œçœ‹çœ‹èƒ½ä¸èƒ½å½“æœ€é«˜ä½ä¸º p-1çš„åŸºã€‚è€Œè¿™é‡Œæ¶ˆæ‰ x ç¬¬ p ä½çš„æ–¹æ³•æ˜¯ä¸å½“å‰æœ€é«˜ä½ä¸º p çš„å…ƒç´ å¼‚æˆ–ï¼Œä¾æ®ä¸Šè¿°ç»“è®ºâ‘ ï¼Œæ˜¾ç„¶è¿™æ ·æ¶ˆæ­£ç¡®çš„ï¼Œä¸ä¼šå½±å“æœ€ç»ˆç»“æœã€‚</p><p>å‡è®¾æˆ‘ä»¬å·²ç»æœ‰åŸºï¼š1010ã€101ï¼Œé‚£ä¹ˆå¦‚æœæƒ³æ’å…¥1110ï¼Œé¦–å…ˆå·²ç»æœ‰1010äº†ï¼Œæ‰€ä»¥å…¶ä¸èƒ½åšæœ€é«˜ä½ä¸º3çš„åŸºï¼Œäºæ˜¯æ¶ˆæ‰å˜ä¸º0110ï¼Œåˆå‘ç°ä¸èƒ½ä½œä¸ºæœ€é«˜ä½ä¸º2çš„åŸºï¼Œè½¬è€Œçœ‹çœ‹ç¬¬1ä½ï¼Œå‘ç°å¯ä»¥ï¼Œäºæ˜¯ä»–å°±æˆäº†10ã€‚è¿™æ ·æˆ‘ä»¬å°±æœ‰äº†æœ€é«˜ä½æ˜¯1ã€2ã€3 çš„åŸºã€‚</p><p>äºæ˜¯æˆ‘ä»¬åˆå‘ç°æˆ‘ä»¬åªéœ€æ ¹æ®æ€§è´¨4ï¼Œè®°å½•æœ€é«˜ä½ä¸º p çš„æ•°æ˜¯å¤šå°‘å°±å¯ä»¥äº†ï¼Œäºæ˜¯ç”¨ä¸€ç»´æ•°ç»„P[ i ]æ¥è¡¨ç¤ºæœ€é«˜ä½ä¸º i çš„æ•°æ˜¯å¤šå°‘ã€‚</p><p><strong>ä¼ªä»£ç ï¼š</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">for( j = æœ€é«˜ä½; j &gt;= 0 ; j-- )&#123;</span><br><span class="line">    if(xçš„ç¬¬jä½ä¸º1)&#123;</span><br><span class="line">        if(çº¿æ€§åŸºä¸­æœ‰æœ€é«˜ä½ä¸ºç¬¬ j ä½çš„å…ƒç´ P[ j ])&#123;</span><br><span class="line">             x = P[j] xor x;</span><br><span class="line">             break;</span><br><span class="line">        &#125;else P[j] = x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="çº¿æ€§åŸºçš„å¸¸ç”¨æ“ä½œ"><a href="#çº¿æ€§åŸºçš„å¸¸ç”¨æ“ä½œ" class="headerlink" title="çº¿æ€§åŸºçš„å¸¸ç”¨æ“ä½œ"></a>çº¿æ€§åŸºçš„å¸¸ç”¨æ“ä½œ</h4><p><strong>æ’å…¥ï¼š</strong><br>æ­£å¦‚ä¸Šè¿°ä¼ªä»£ç æ‰€è¿°ï¼Œæ’å…¥ä¸€ä¸ªæ•°xï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¸ºO(log x)ã€‚</p><p><strong>åˆ é™¤ï¼š</strong> é¦–å…ˆæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ä¸Šè¿°åšæ³•æ„é€ å‡ºæ¥çš„çº¿æ€§åŸºå¾ˆéš¾æ”¯æŒåˆ é™¤æ“ä½œã€‚<br><strong>åˆå¹¶çº¿æ€§åŸºï¼š</strong> å°†ä¸€ä¸ªçº¿æ€§åŸºä¸­çš„æ‰€æœ‰åŸºç”¨<strong>æ’å…¥æ“ä½œ</strong>æ’å…¥å¦ä¸€ä¸ªçº¿æ€§åŸºã€‚æ—¶é—´å¤æ‚åº¦ä¸ºO(log n)ã€‚<br><strong>å­˜åœ¨æ€§æŸ¥è¯¢ï¼š</strong> å¯ä»¥å‘ç°ï¼Œå¦‚æœ x æ— æ³•æ’å…¥ï¼Œé‚£ä¹ˆæ˜¾ç„¶è¯´æ˜çº¿æ€§åŸºå¯ä»¥æ„é€ å‡ºæ¥xã€‚O(log n)ã€‚<br><strong>æ±‚çº¿æ€§åŸºèƒ½å¤Ÿç»„æˆçš„æœ€å¤§å€¼ï¼š</strong> ä»é«˜ä½åˆ°ä½ä½æ‰«æï¼Œå¦‚æœå¼‚æˆ–è¯¥ä½çš„åŸºåå¯ä»¥ä½¿å¾—ç­”æ¡ˆå˜å¤§ï¼Œåˆ™å¼‚æˆ–ã€‚O(log n)ã€‚<br><strong>æ±‚çº¿æ€§åŸºè¡¨å‡ºçš„æœ€å°å€¼ï¼š</strong> ä»ä½ä½å‘é«˜ä½æ‰¾ï¼Œç¬¬ä¸€ä¸ªåŸºå°±æ˜¯ç­”æ¡ˆã€‚<br><strong>æ±‚ç¬¬kå°å€¼ï¼š</strong> æˆ‘ä»¬ä¹‹æ‰€ä»¥æ— æ³•ç”¨ä¸Šè¿°æ„é€ æ–¹æ³•æ„é€ å‡ºçš„çº¿æ€§åŸºè§£å†³è¿™é¢˜çš„åŸå› åœ¨äºï¼Œæˆ‘ä»¬åªä¿è¯äº†æ¯ä¸ªçº¿æ€§åŸºæœ€é«˜ä½ä¸åŒï¼Œå´å¹¶æœªä¿è¯æ¯ä¸ªä½ä¸Šéƒ½æœ‰å”¯ä¸€çš„ä¸€ä¸ª1ï¼Œå³<br>10000001<br>00000001<br>æ˜¯åˆæ³•çš„çº¿æ€§åŸºï¼Œä½†æ˜¯00000001æ˜¯æœ€å°çš„ï¼Œè€Œæ¬¡å°çš„å´ä¸æ˜¯10000001ï¼Œè€Œæ˜¯00000001 xor 10000001ã€‚<br>äºæ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨ç±»ä¼¼é«˜æ–¯æ¶ˆå…ƒçš„æ–¹æ³•æ¥ä½¿å¾—å…¶æ»¡è¶³â€œåªè¦å­˜åœ¨æœ€é«˜ä½ä¸º p çš„åŸºï¼Œé‚£ä¹ˆå…¶å®ƒåŸºçš„ç¬¬ p ä½éƒ½ä¸èƒ½ä¸º1ã€‚â€è¿™æ ·å°±å¯ä»¥é€šè¿‡ <strong>å°†kæ‹†åˆ†æˆäºŒè¿›åˆ¶ä½</strong>ï¼Œå¦‚æœæ‹†åˆ†åç¬¬ i ä½ä¸º1ï¼Œå°±å°†ansä¸çº¿æ€§åŸºä¸­æœ€é«˜ä½ä¸º i çš„åŸºå¼‚æˆ–ï¼Œè¿™æ ·å°±èƒ½æ±‚å‡ºç¬¬ k å°ã€‚</p><h4 id="ä¾‹é¢˜ç»ƒä¹ "><a href="#ä¾‹é¢˜ç»ƒä¹ " class="headerlink" title="ä¾‹é¢˜ç»ƒä¹ "></a>ä¾‹é¢˜ç»ƒä¹ </h4><h5 id="2019-Multi-University-Training-Contest-1-â€”-Operation"><a href="#2019-Multi-University-Training-Contest-1-â€”-Operation" class="headerlink" title="2019 Multi-University Training Contest 1 â€” Operation"></a>2019 Multi-University Training Contest 1 â€” Operation</h5><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6579" target="_blank" rel="noopener"><strong>æµ‹è¯•åœ°å€</strong></a></p><p><strong>é¢˜æ„ç®€è¿°ï¼š</strong> ç»™å®šä¸€ä¸ªå…·æœ‰ n ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œæœ‰ä¸¤ç§æ“ä½œï¼š</p><ol><li>åœ¨[l , r] ä¸­é€‰æ‹©ä¸€äº›æ•°ï¼Œä½¿ä¹‹å¼‚æˆ–å’Œæœ€å¤§ï¼Œè¾“å‡ºæœ€å¤§å€¼ã€‚</li><li>åœ¨æ•°ç»„æœ€åæ·»åŠ ä¸€ä¸ªæ•°ã€‚</li></ol><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>é¦–å…ˆå¦‚æœä¸çœ‹æ“ä½œ2ï¼Œé‚£ä¹ˆæ˜¾ç„¶æ“ä½œ1å°±æ˜¯æ±‚åŒºé—´å†…æœ€å¤§å¼‚æˆ–å’Œé—®é¢˜ã€‚å¯¹äºè¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹äºæ¯ä¸ªä½ç½®pè®°å½•æœ€é è¿‘å…¶çš„å‰30ä¸ªä½ç½®çš„çº¿æ€§åŸºï¼Œå½“ç„¶è¿™æ ·å¹¶ä¸èƒ½ä¿è¯è®°å½•çš„çº¿æ€§åŸºä¸€å®šåœ¨[p - 30 , p ]å†…ï¼Œæ‰€ä»¥åœ¨æŸ¥è¯¢æ—¶ä¹Ÿè¦ç­›æ‰ä½ç½®åœ¨[l , r]å¤–çš„åŸºã€‚è¯´åˆ°è¿™å„¿è‡ªç„¶å°±åˆå¼•å…¥äº†ä¸€ä¸ªè®°å½•æ¯ä¸ªåŸºåœ¨åŸæ•°ç»„ä¸­çš„ä½ç½®çš„æ•°ç»„posã€‚äºæ˜¯é€šè¿‡pos[N][30]å’Œf[N][30]æˆ‘ä»¬å°±å¯ä»¥åœ¨O(30)æ—¶é—´å†…æŸ¥è¯¢ï¼Œå®Œæˆæ“ä½œ1ã€‚<br>å¯¹äºæ“ä½œ2å‘¢ï¼Œæˆ‘ä»¬è¦æƒ³çš„æ˜¯å¦‚ä½•æ›´æ–° f å’Œ pos æ•°ç»„ã€‚é‚£ä¹ˆå½“æ’å…¥ä¸€ä¸ªæ–°çš„å…ƒç´  x æ—¶ï¼Œæ˜¾ç„¶å…¶æ‰€åœ¨ä½ç½®ä¸ºn+1ï¼ˆnä¸ºæ’å…¥å‰å…ƒç´ æ€»æ•°ï¼‰ï¼Œé‚£ä¹ˆf[n+1][0~30]å’Œf[n][0~30]ä¸åŒä¹‹å¤„å°±åœ¨äºæ–°å…ƒç´  x è¦æ›´æ–°åŸæœ‰çº¿æ€§åŸºï¼Œä½¿å¾—æœ€é å·¦çš„åŸºè¢«é å³ï¼ˆå› ä¸ºæˆ‘ä»¬æ±‚æœ€å¤§å¼‚æˆ–å’Œï¼Œä¸€å®šæ˜¯é å³ä½ç½®çš„åŸºä¼˜å…ˆè¢«é€‰æ‹©ï¼Œæ‰€ä»¥å¦‚æœä¿©ä¸ªåŸºçš„è´¡çŒ®ç›¸åŒï¼Œå°±ç”¨é å³çš„æ›¿ä»£é å·¦çš„ï¼‰çš„åŸºæ›´æ–°å³å¯ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> t,n,m,lastans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> a[N],f[N][<span class="number">40</span>],pos[N][<span class="number">40</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">30</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(pos[r][i] &gt;= l)&#123;</span><br><span class="line">            <span class="comment">//å¹¶ä¸æ˜¯f[r][30]æ‰€æœ‰å…ƒç´ éƒ½æ˜¯åœ¨[l,r]å†…çš„</span></span><br><span class="line">            <span class="keyword">if</span>((ans^f[r][i]) &gt; ans) ans ^= f[r][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    lastans = ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Append</span><span class="params">(<span class="keyword">int</span> tot,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> nex = tot;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= <span class="number">30</span>;i++)</span><br><span class="line">        f[tot][i] = f[tot<span class="number">-1</span>][i],pos[tot][i] = pos[tot<span class="number">-1</span>][i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">30</span>;i &gt;= <span class="number">0</span>;i--) <span class="keyword">if</span>((<span class="number">1</span>&lt;&lt;i)&amp;x)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!f[tot][i])&#123;f[tot][i] = x;pos[tot][i] = nex;<span class="keyword">return</span>;&#125;</span><br><span class="line">        <span class="keyword">if</span>(pos[tot][i] &lt; nex)&#123;</span><br><span class="line">        <span class="comment">/*æ‰¾åˆ°æœ€å·¦è¾¹çš„é‚£ä¸ªåŸºï¼Œ</span></span><br><span class="line"><span class="comment">        è¿™æ ·ä¸æ–­æ›¿æ¢æœ€ç»ˆæœ€å·¦è¾¹çš„åŸºè¢«æŒ¤å‡ºå»</span></span><br><span class="line"><span class="comment">        nexæ˜¯ç›®å‰æœ€é å·¦çš„ä½ç½®*/</span></span><br><span class="line">            <span class="built_in">std</span>::swap(x,f[tot][i]);</span><br><span class="line">            <span class="built_in">std</span>::swap(nex,pos[tot][i]);</span><br><span class="line">        &#125;</span><br><span class="line">        x ^= f[tot][i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        lastans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i),Append(i,a[i]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,op,l,r,x;i &lt;= m;i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;op);</span><br><span class="line">            <span class="keyword">if</span>(op == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;l,&amp;r);</span><br><span class="line">                l ^= lastans;r ^= lastans;</span><br><span class="line">                l %= n;r %= n;</span><br><span class="line">                l++;r++;</span><br><span class="line">                <span class="keyword">if</span>(l &gt; r) <span class="built_in">std</span>::swap(l,r);</span><br><span class="line">                Query(l,r);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">                x ^= lastans;</span><br><span class="line">                Append(++n,x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><ul><li><a href="https://www.lmlphp.com/user/56/article/item/1173/" target="_blank" rel="noopener">å°èœœèœ‚çš„åšå®¢</a></li><li><a href="https://www.cnblogs.com/vb4896/p/6149022.html" target="_blank" rel="noopener">lzw4896sçš„åšå®¢</a></li><li><a href="https://ouuan.github.io/%E7%BA%BF%E6%80%A7%E5%9F%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">ouuançš„åšå®¢</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Treap</title>
      <link href="/2019/07/25/Treap/"/>
      <url>/2019/07/25/Treap/</url>
      
        <content type="html"><![CDATA[<p>Treapæ˜¯æ˜¯è‹±æ–‡Treeå’ŒHeapçš„åˆæˆè¯ï¼Œåˆç§°æ ‘å †ã€‚æ ‘å †æ˜¯æŒ‡å…·æœ‰éšæœºé™„åŠ åŸŸï¼Œä¸”é™„åŠ åŸŸæ»¡è¶³å †æ€§è´¨çš„äºŒå‰æœç´¢æ ‘ã€‚å®ƒå±äºå¹³è¡¡æ ‘çš„ä¸€ç§ï¼Œä¸»è¦æ˜¯ä¸ºäº†å…‹æœäºŒå‰æœç´¢æ ‘æ˜“é€€åŒ–çš„æƒ…å†µã€‚Treapåˆ©ç”¨â€œéšæœºâ€æ¥åˆ›é€ å¹³è¡¡æ¡ä»¶ï¼Œæˆ‘ä»¬åœ¨æ’å…¥æ¯ä¸ªèŠ‚ç‚¹æ—¶ï¼Œé™¤äº†å…¶å€¼valï¼Œæˆ‘ä»¬è¿˜ç»™å®ƒéšæœºé™„åŠ ä¸€ä¸ªæƒå€¼datï¼Œä½¿å¾—æƒå€¼valæ»¡è¶³BSTæ€§è´¨ï¼Œè€Œdatæ»¡è¶³äºŒå‰å †æ€§è´¨ã€‚å¦‚æ­¤ä¸€æ¥æˆ‘ä»¬å°±ä¿è¯äº†æ ‘çš„æ·±åº¦ï¼Œä½¿å¾—æ£€ç´¢ã€æ’å…¥ã€æ±‚å‰é©±ã€åç»§ä»¥åŠåˆ é™¤èŠ‚ç‚¹çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(log N)ã€‚<br><strong>ä¾‹é¢˜ï¼š</strong></p><blockquote><p>æ™®é€šå¹³è¡¡æ ‘BZOJ3224<br>æ‚¨éœ€è¦å†™ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ¥ç»´æŠ¤ä¸€äº›æ•°ï¼Œå…¶ä¸­éœ€è¦æä¾›ä»¥ä¸‹æ“ä½œï¼š</p><ul><li>æ’å…¥æ•°å€¼x</li><li>åˆ é™¤æ•°å€¼xï¼ˆè‹¥æœ‰å¤šä¸ªç›¸åŒçš„æ•°ï¼Œåº”åªåˆ é™¤ä¸€ä¸ªï¼‰</li><li>æŸ¥è¯¢æ•°å€¼xçš„æ’åï¼ˆè‹¥æœ‰å¤šä¸ªç›¸åŒçš„æ•°ï¼Œåº”è¾“å‡ºæœ€å°çš„æ’åï¼‰</li><li>æŸ¥è¯¢æ’åä¸ºxçš„æ•°å€¼</li><li>æ±‚æ•°å€¼xçš„å‰é©±ï¼ˆå‰é©±å®šä¹‰ä¸ºå°äºxçš„æœ€å¤§çš„æ•°ï¼‰</li><li>æ±‚æ•°å€¼xçš„åç»§ï¼ˆåç»§å®šä¹‰ä¸ºå¤§äºxçš„æœ€å°çš„æ•°ï¼‰</li></ul></blockquote><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è¿™æ˜¯ä¸€é“å¹³è¡¡æ ‘çš„æ¨¡æ¿é¢˜ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ“ä½œæ˜¯åœ¨çº¿çš„å¢åˆ æŸ¥ï¼Œä¸”æŸ¥è¯¢åˆ†ä¸ºå››ç§ã€‚æˆ‘ä»¬é‡‡ç”¨Treapè§£å†³ã€‚<br>æ ¹æ®é¢˜æ„ï¼Œæ•°æ®ç§å¯èƒ½æœ‰ç›¸åŒçš„æ•°å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç»™æ¯ä¸ªèŠ‚ç‚¹å¢åŠ ä¸€ä¸ªåŸŸcntï¼Œç”¨æ¥è®°å½•è¯¥èŠ‚ç‚¹çš„â€œå‰¯æœ¬æ•°â€œï¼Œåˆå§‹ä¸º1ã€‚è‹¥æ’å…¥å·²å­˜åœ¨æ˜¯æ•°å€¼ï¼Œå°±ç›´æ¥æŠŠè¯¥â€å‰¯æœ¬æ•°â€œåŠ 1ã€‚åœ¨åˆ é™¤æ—¶ï¼Œå‡å°‘è¯¥å‰¯æœ¬æ•°ï¼Œå½“å‡ä¸º0æ—¶åˆ é™¤è¯¥èŠ‚ç‚¹ã€‚å¦‚æ­¤å°±è§£å†³äº†å…³é”®ç ç›¸åŒçš„é—®é¢˜ã€‚<br>å¯¹äºæŸ¥è¯¢æ’åï¼Œæˆ‘ä»¬å¯ä»¥ç»™æ¯ä¸ªèŠ‚ç‚¹æ–°å¢ä¸€ä¸ªåŸŸsizeï¼Œè®°å½•ä»¥è¯¥èŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„â€å‰¯æœ¬æ•°â€œä¹‹å’Œã€‚<br>ä¸çº¿æ®µæ ‘ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ’å…¥æˆ–è€…åˆ é™¤æ—¶ä»ä¸‹å¾€ä¸Šæ›´æ–°sizeã€‚å¦å¤–ï¼Œåœ¨å‘ç”Ÿæ—‹è½¬æ“ä½œæ—¶ï¼Œä¹Ÿéœ€è¦ä¿®æ”¹sizeã€‚æœ€åï¼Œåœ¨æ£€ç´¢BSTåŸºç¡€ä¸Šï¼Œé€šè¿‡åˆ¤æ–­å·¦å³å­æ ‘sizeçš„å¤§å°ï¼Œé€‰æ‹©é€‚å½“çš„ä¸€ä¾§é€’å½’ï¼Œå°±å¾ˆå®¹æ˜“æŸ¥è¯¢æ’åäº†ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SIZE = <span class="number">100010</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Treap</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> l, r; <span class="comment">// å·¦å³å­èŠ‚ç‚¹åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡</span></span><br><span class="line"><span class="keyword">int</span> val, dat; <span class="comment">// èŠ‚ç‚¹å…³é”®ç ã€æƒå€¼</span></span><br><span class="line"><span class="keyword">int</span> cnt, size; <span class="comment">// å‰¯æœ¬æ•°ã€å­æ ‘å¤§å°</span></span><br><span class="line">&#125; a[SIZE]; <span class="comment">// æ•°ç»„æ¨¡æ‹Ÿé“¾è¡¨</span></span><br><span class="line"><span class="keyword">int</span> tot, root, n, INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">New</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">a[++tot].val = val;</span><br><span class="line">a[tot].dat = rand();</span><br><span class="line">a[tot].cnt = a[tot].size = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> tot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">a[p].size = a[a[p].l].size + a[a[p].r].size + a[p].cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">New(-INF), New(INF);</span><br><span class="line">root = <span class="number">1</span>, a[<span class="number">1</span>].r = <span class="number">2</span>;</span><br><span class="line">Update(root);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetRankByVal</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (p == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (val == a[p].val) <span class="keyword">return</span> a[a[p].l].size + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (val &lt; a[p].val) <span class="keyword">return</span> GetRankByVal(a[p].l, val);</span><br><span class="line"><span class="keyword">return</span> GetRankByVal(a[p].r, val) + a[a[p].l].size + a[p].cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetValByRank</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> rank)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (p == <span class="number">0</span>) <span class="keyword">return</span> INF;</span><br><span class="line"><span class="keyword">if</span> (a[a[p].l].size &gt;= rank) <span class="keyword">return</span> GetValByRank(a[p].l, rank);</span><br><span class="line"><span class="keyword">if</span> (a[a[p].l].size + a[p].cnt &gt;= rank) <span class="keyword">return</span> a[p].val;</span><br><span class="line"><span class="keyword">return</span> GetValByRank(a[p].r, rank - a[a[p].l].size - a[p].cnt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">zig</span><span class="params">(<span class="keyword">int</span> &amp;p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> q = a[p].l;</span><br><span class="line">a[p].l = a[q].r, a[q].r = p, p = q;</span><br><span class="line">Update(a[p].r), Update(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">zag</span><span class="params">(<span class="keyword">int</span> &amp;p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> q = a[p].r;</span><br><span class="line">a[p].r = a[q].l, a[q].l = p, p = q;</span><br><span class="line">Update(a[p].l), Update(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> &amp;p, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (p == <span class="number">0</span>) &#123;</span><br><span class="line">p = New(val);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (val == a[p].val) &#123;</span><br><span class="line">a[p].cnt++, Update(p);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (val &lt; a[p].val) &#123;</span><br><span class="line">Insert(a[p].l, val);</span><br><span class="line"><span class="keyword">if</span> (a[p].dat &lt; a[a[p].l].dat) zig(p); <span class="comment">// ä¸æ»¡è¶³å †æ€§è´¨ï¼Œå³æ—‹</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">Insert(a[p].r, val);</span><br><span class="line"><span class="keyword">if</span> (a[p].dat &lt; a[a[p].r].dat) zag(p); <span class="comment">// ä¸æ»¡è¶³å †æ€§è´¨ï¼Œå·¦æ—‹</span></span><br><span class="line">&#125;</span><br><span class="line">Update(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetPre</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">1</span>; <span class="comment">// a[1].val==-INF</span></span><br><span class="line"><span class="keyword">int</span> p = root;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (val == a[p].val) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[p].l &gt; <span class="number">0</span>) &#123;</span><br><span class="line">p = a[p].l;</span><br><span class="line"><span class="keyword">while</span> (a[p].r &gt; <span class="number">0</span>) p = a[p].r; <span class="comment">// å·¦å­æ ‘ä¸Šä¸€ç›´å‘å³èµ°</span></span><br><span class="line">ans = p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (a[p].val &lt; val &amp;&amp; a[p].val &gt; a[ans].val) ans = p;</span><br><span class="line">p = val &lt; a[p].val ? a[p].l : a[p].r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> a[ans].val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetNext</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">2</span>; <span class="comment">// a[2].val==INF</span></span><br><span class="line"><span class="keyword">int</span> p = root;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (val == a[p].val) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[p].r &gt; <span class="number">0</span>) &#123;</span><br><span class="line">p = a[p].r;</span><br><span class="line"><span class="keyword">while</span> (a[p].l &gt; <span class="number">0</span>) p = a[p].l; <span class="comment">// å³å­æ ‘ä¸Šä¸€ç›´å‘å·¦èµ°</span></span><br><span class="line">ans = p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (a[p].val &gt; val &amp;&amp; a[p].val &lt; a[ans].val) ans = p;</span><br><span class="line">p = val &lt; a[p].val ? a[p].l : a[p].r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> a[ans].val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Remove</span><span class="params">(<span class="keyword">int</span> &amp;p, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (p == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span> (val == a[p].val) &#123; <span class="comment">// æ£€ç´¢åˆ°äº†val</span></span><br><span class="line"><span class="keyword">if</span> (a[p].cnt &gt; <span class="number">1</span>) &#123; <span class="comment">// æœ‰é‡å¤ï¼Œå‡å°‘å‰¯æœ¬æ•°å³å¯</span></span><br><span class="line">a[p].cnt--, Update(p);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (a[p].l || a[p].r) &#123; <span class="comment">// ä¸æ˜¯å¶å­èŠ‚ç‚¹ï¼Œå‘ä¸‹æ—‹è½¬</span></span><br><span class="line"><span class="keyword">if</span> (a[p].r == <span class="number">0</span> || a[a[p].l].dat &gt; a[a[p].r].dat)</span><br><span class="line">zig(p), Remove(a[p].r, val);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">zag(p), Remove(a[p].l, val);</span><br><span class="line">Update(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> p = <span class="number">0</span>; <span class="comment">// å¶å­èŠ‚ç‚¹ï¼Œåˆ é™¤</span></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">val &lt; a[p].val ? Remove(a[p].l, val) : Remove(a[p].r, val);</span><br><span class="line">Update(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Build();</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line"><span class="keyword">while</span> (n--) &#123;</span><br><span class="line"><span class="keyword">int</span> opt, x;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;opt, &amp;x);</span><br><span class="line"><span class="keyword">switch</span> (opt) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">Insert(root, x);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">Remove(root, x);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, GetRankByVal(root, x) - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, GetValByRank(root, x + <span class="number">1</span>));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, GetPre(x));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, GetNext(x));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å‚è€ƒä¹¦ç›®ï¼š</strong></p><ul><li>ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹æç…œä¸œ.P229</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACMå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
